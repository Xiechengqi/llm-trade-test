(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,70305,(e,t,i)=>{"use strict";var s=e.r(58138),r="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},n=s.useState,l=s.useEffect,a=s.useLayoutEffect,o=s.useDebugValue;function h(e){var t=e.getSnapshot;e=e.value;try{var i=t();return!r(e,i)}catch(e){return!0}}var u="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var i=t(),s=n({inst:{value:i,getSnapshot:t}}),r=s[0].inst,u=s[1];return a(function(){r.value=i,r.getSnapshot=t,h(r)&&u({inst:r})},[e,i,t]),l(function(){return h(r)&&u({inst:r}),e(function(){h(r)&&u({inst:r})})},[e]),o(i),i};i.useSyncExternalStore=void 0!==s.useSyncExternalStore?s.useSyncExternalStore:u},34960,(e,t,i)=>{"use strict";t.exports=e.r(70305)},31713,e=>{"use strict";let t,i,s;e.i(68519);var r,n,l,a,o,h,u,c,d,m,p,f,g,v,x,w,b,y,S,j,M,C,N,P,k,E,R,_,T,L=e.i(29511),I=e.i(47163);function A({className:e,...t}){return(0,L.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,L.jsx)("table",{"data-slot":"table",className:(0,I.cn)("w-full caption-bottom text-sm",e),...t})})}function F({className:e,...t}){return(0,L.jsx)("thead",{"data-slot":"table-header",className:(0,I.cn)("[&_tr]:border-b",e),...t})}function z({className:e,...t}){return(0,L.jsx)("tbody",{"data-slot":"table-body",className:(0,I.cn)("[&_tr:last-child]:border-0",e),...t})}function D({className:e,...t}){return(0,L.jsx)("tr",{"data-slot":"table-row",className:(0,I.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",e),...t})}function O({className:e,...t}){return(0,L.jsx)("th",{"data-slot":"table-head",className:(0,I.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t})}function B({className:e,...t}){return(0,L.jsx)("td",{"data-slot":"table-cell",className:(0,I.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t})}var $=e.i(58138);function W(e){var t=e.width,i=e.height;if(t<0)throw Error("Negative width is not allowed for Size");if(i<0)throw Error("Negative height is not allowed for Size");return{width:t,height:i}}function V(e,t){return e.width===t.width&&e.height===t.height}var K=function(){function e(e){var t=this;this._resolutionListener=function(){return t._onResolutionChanged()},this._resolutionMediaQueryList=null,this._observers=[],this._window=e,this._installResolutionListener()}return e.prototype.dispose=function(){this._uninstallResolutionListener(),this._window=null},Object.defineProperty(e.prototype,"value",{get:function(){return this._window.devicePixelRatio},enumerable:!1,configurable:!0}),e.prototype.subscribe=function(e){var t=this,i={next:e};return this._observers.push(i),{unsubscribe:function(){t._observers=t._observers.filter(function(e){return e!==i})}}},e.prototype._installResolutionListener=function(){if(null!==this._resolutionMediaQueryList)throw Error("Resolution listener is already installed");var e=this._window.devicePixelRatio;this._resolutionMediaQueryList=this._window.matchMedia("all and (resolution: ".concat(e,"dppx)")),this._resolutionMediaQueryList.addListener(this._resolutionListener)},e.prototype._uninstallResolutionListener=function(){null!==this._resolutionMediaQueryList&&(this._resolutionMediaQueryList.removeListener(this._resolutionListener),this._resolutionMediaQueryList=null)},e.prototype._reinstallResolutionListener=function(){this._uninstallResolutionListener(),this._installResolutionListener()},e.prototype._onResolutionChanged=function(){var e=this;this._observers.forEach(function(t){return t.next(e._window.devicePixelRatio)}),this._reinstallResolutionListener()},e}(),U=function(){function e(e,t,i){var s;this._canvasElement=null,this._bitmapSizeChangedListeners=[],this._suggestedBitmapSize=null,this._suggestedBitmapSizeChangedListeners=[],this._devicePixelRatioObservable=null,this._canvasElementResizeObserver=null,this._canvasElement=e,this._canvasElementClientSize=W({width:this._canvasElement.clientWidth,height:this._canvasElement.clientHeight}),this._transformBitmapSize=null!=t?t:function(e){return e},this._allowResizeObserver=null==(s=null==i?void 0:i.allowResizeObserver)||s,this._chooseAndInitObserver()}return e.prototype.dispose=function(){var e,t;if(null===this._canvasElement)throw Error("Object is disposed");null==(e=this._canvasElementResizeObserver)||e.disconnect(),this._canvasElementResizeObserver=null,null==(t=this._devicePixelRatioObservable)||t.dispose(),this._devicePixelRatioObservable=null,this._suggestedBitmapSizeChangedListeners.length=0,this._bitmapSizeChangedListeners.length=0,this._canvasElement=null},Object.defineProperty(e.prototype,"canvasElement",{get:function(){if(null===this._canvasElement)throw Error("Object is disposed");return this._canvasElement},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canvasElementClientSize",{get:function(){return this._canvasElementClientSize},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bitmapSize",{get:function(){return W({width:this.canvasElement.width,height:this.canvasElement.height})},enumerable:!1,configurable:!0}),e.prototype.resizeCanvasElement=function(e){this._canvasElementClientSize=W(e),this.canvasElement.style.width="".concat(this._canvasElementClientSize.width,"px"),this.canvasElement.style.height="".concat(this._canvasElementClientSize.height,"px"),this._invalidateBitmapSize()},e.prototype.subscribeBitmapSizeChanged=function(e){this._bitmapSizeChangedListeners.push(e)},e.prototype.unsubscribeBitmapSizeChanged=function(e){this._bitmapSizeChangedListeners=this._bitmapSizeChangedListeners.filter(function(t){return t!==e})},Object.defineProperty(e.prototype,"suggestedBitmapSize",{get:function(){return this._suggestedBitmapSize},enumerable:!1,configurable:!0}),e.prototype.subscribeSuggestedBitmapSizeChanged=function(e){this._suggestedBitmapSizeChangedListeners.push(e)},e.prototype.unsubscribeSuggestedBitmapSizeChanged=function(e){this._suggestedBitmapSizeChangedListeners=this._suggestedBitmapSizeChangedListeners.filter(function(t){return t!==e})},e.prototype.applySuggestedBitmapSize=function(){if(null!==this._suggestedBitmapSize){var e=this._suggestedBitmapSize;this._suggestedBitmapSize=null,this._resizeBitmap(e),this._emitSuggestedBitmapSizeChanged(e,this._suggestedBitmapSize)}},e.prototype._resizeBitmap=function(e){var t=this.bitmapSize;V(t,e)||(this.canvasElement.width=e.width,this.canvasElement.height=e.height,this._emitBitmapSizeChanged(t,e))},e.prototype._emitBitmapSizeChanged=function(e,t){var i=this;this._bitmapSizeChangedListeners.forEach(function(s){return s.call(i,e,t)})},e.prototype._suggestNewBitmapSize=function(e){var t=this._suggestedBitmapSize,i=W(this._transformBitmapSize(e,this._canvasElementClientSize)),s=V(this.bitmapSize,i)?null:i;null===t&&null===s||null!==t&&null!==s&&V(t,s)||(this._suggestedBitmapSize=s,this._emitSuggestedBitmapSizeChanged(t,s))},e.prototype._emitSuggestedBitmapSizeChanged=function(e,t){var i=this;this._suggestedBitmapSizeChangedListeners.forEach(function(s){return s.call(i,e,t)})},e.prototype._chooseAndInitObserver=function(){var e=this;this._allowResizeObserver?new Promise(function(e){var t=new ResizeObserver(function(i){e(i.every(function(e){return"devicePixelContentBoxSize"in e})),t.disconnect()});t.observe(document.body,{box:"device-pixel-content-box"})}).catch(function(){return!1}).then(function(t){return t?e._initResizeObserver():e._initDevicePixelRatioObservable()}):this._initDevicePixelRatioObservable()},e.prototype._initDevicePixelRatioObservable=function(){var e=this;if(null!==this._canvasElement){var t=H(this._canvasElement);if(null===t)throw Error("No window is associated with the canvas");this._devicePixelRatioObservable=new K(t),this._devicePixelRatioObservable.subscribe(function(){return e._invalidateBitmapSize()}),this._invalidateBitmapSize()}},e.prototype._invalidateBitmapSize=function(){if(null!==this._canvasElement){var e,t,i=H(this._canvasElement);if(null!==i){var s,r,n=null!=(t=null==(e=this._devicePixelRatioObservable)?void 0:e.value)?t:i.devicePixelRatio,l=this._canvasElement.getClientRects(),a=void 0!==l[0]?(s=l[0],r=n,W({width:Math.round(s.left*r+s.width*r)-Math.round(s.left*r),height:Math.round(s.top*r+s.height*r)-Math.round(s.top*r)})):W({width:this._canvasElementClientSize.width*n,height:this._canvasElementClientSize.height*n});this._suggestNewBitmapSize(a)}}},e.prototype._initResizeObserver=function(){var e=this;null!==this._canvasElement&&(this._canvasElementResizeObserver=new ResizeObserver(function(t){var i=t.find(function(t){return t.target===e._canvasElement});if(i&&i.devicePixelContentBoxSize&&i.devicePixelContentBoxSize[0]){var s=i.devicePixelContentBoxSize[0],r=W({width:s.inlineSize,height:s.blockSize});e._suggestNewBitmapSize(r)}}),this._canvasElementResizeObserver.observe(this._canvasElement,{box:"device-pixel-content-box"}))},e}();function H(e){return e.ownerDocument.defaultView}var J=function(){function e(e,t,i){if(0===t.width||0===t.height)throw TypeError("Rendering target could only be created on a media with positive width and height");if(this._mediaSize=t,0===i.width||0===i.height)throw TypeError("Rendering target could only be created using a bitmap with positive integer width and height");this._bitmapSize=i,this._context=e}return e.prototype.useMediaCoordinateSpace=function(e){try{return this._context.save(),this._context.setTransform(1,0,0,1,0,0),this._context.scale(this._horizontalPixelRatio,this._verticalPixelRatio),e({context:this._context,mediaSize:this._mediaSize})}finally{this._context.restore()}},e.prototype.useBitmapCoordinateSpace=function(e){try{return this._context.save(),this._context.setTransform(1,0,0,1,0,0),e({context:this._context,mediaSize:this._mediaSize,bitmapSize:this._bitmapSize,horizontalPixelRatio:this._horizontalPixelRatio,verticalPixelRatio:this._verticalPixelRatio})}finally{this._context.restore()}},Object.defineProperty(e.prototype,"_horizontalPixelRatio",{get:function(){return this._bitmapSize.width/this._mediaSize.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_verticalPixelRatio",{get:function(){return this._bitmapSize.height/this._mediaSize.height},enumerable:!1,configurable:!0}),e}();function q(e,t){var i=e.canvasElementClientSize;if(0===i.width||0===i.height)return null;var s=e.bitmapSize;if(0===s.width||0===s.height)return null;var r=e.canvasElement.getContext("2d",t);return null===r?null:new J(r,i,s)}let Y={title:"",visible:!0,lastValueVisible:!0,priceLineVisible:!0,priceLineSource:0,priceLineWidth:1,priceLineColor:"",priceLineStyle:2,baseLineVisible:!0,baseLineWidth:1,baseLineColor:"#B2B5BE",baseLineStyle:0,priceFormat:{type:"price",precision:2,minMove:.01}};function X(e,t){let i={0:[],1:[e.lineWidth,e.lineWidth],2:[2*e.lineWidth,2*e.lineWidth],3:[6*e.lineWidth,6*e.lineWidth],4:[e.lineWidth,4*e.lineWidth]}[t];e.setLineDash(i)}function G(e,t,i,s){e.beginPath();let r=e.lineWidth%2?.5:0;e.moveTo(i,t+r),e.lineTo(s,t+r),e.stroke()}function Q(e,t){if(!e)throw Error("Assertion failed"+(t?": "+t:""))}function Z(e){if(void 0===e)throw Error("Value is undefined");return e}function ee(e){if(null===e)throw Error("Value is null");return e}function et(e){return ee(Z(e))}(r=y||(y={}))[r.Simple=0]="Simple",r[r.WithSteps=1]="WithSteps",r[r.Curved=2]="Curved",(n=S||(S={}))[n.Solid=0]="Solid",n[n.Dotted=1]="Dotted",n[n.Dashed=2]="Dashed",n[n.LargeDashed=3]="LargeDashed",n[n.SparseDotted=4]="SparseDotted";class ei{constructor(){this.t=[]}i(e,t,i){this.t.push({h:e,l:t,o:!0===i})}_(e){let t=this.t.findIndex(t=>e===t.h);t>-1&&this.t.splice(t,1)}u(e){this.t=this.t.filter(t=>t.l!==e)}p(e,t,i){let s=[...this.t];this.t=this.t.filter(e=>!e.o),s.forEach(s=>s.h(e,t,i))}v(){return this.t.length>0}m(){this.t=[]}}function es(e,...t){for(let i of t)for(let t in i)void 0!==i[t]&&Object.prototype.hasOwnProperty.call(i,t)&&!["__proto__","constructor","prototype"].includes(t)&&("object"!=typeof i[t]||void 0===e[t]||Array.isArray(i[t])?e[t]=i[t]:es(e[t],i[t]));return e}function er(e){return"number"==typeof e&&isFinite(e)}function en(e){return"number"==typeof e&&e%1==0}function el(e){return"string"==typeof e}function ea(e){return"boolean"==typeof e}function eo(e){let t,i,s;if(!e||"object"!=typeof e)return e;for(i in t=Array.isArray(e)?[]:{},e)e.hasOwnProperty(i)&&(s=e[i],t[i]=s&&"object"==typeof s?eo(s):s);return t}function eh(e){return null!==e}function eu(e){return null===e?void 0:e}let ec="-apple-system, BlinkMacSystemFont, 'Trebuchet MS', Roboto, Ubuntu, sans-serif";function ed(e,t,i){return void 0===t&&(t=ec),`${i=void 0!==i?`${i} `:""}${e}px ${t}`}class em{constructor(e){this.M={S:1,C:5,k:NaN,P:"",T:"",R:"",D:"",I:0,V:0,B:0,A:0,L:0},this.O=e}N(){let e=this.M,t=this.F(),i=this.W();return e.k===t&&e.T===i||(e.k=t,e.T=i,e.P=ed(t,i),e.A=2.5/12*t,e.I=e.A,e.V=t/12*e.C,e.B=t/12*e.C,e.L=0),e.R=this.H(),e.D=this.U(),this.M}H(){return this.O.N().layout.textColor}U(){return this.O.$()}F(){return this.O.N().layout.fontSize}W(){return this.O.N().layout.fontFamily}}function ep(e){return e<0?0:e>255?255:Math.round(e)||0}function ef(e){return .199*e[0]+.687*e[1]+.114*e[2]}class eg{constructor(e,t){this.q=new Map,this.j=e,t&&(this.q=t)}Y(e,t){if("transparent"===e)return e;let i=this.K(e),s=i[3];return`rgba(${i[0]}, ${i[1]}, ${i[2]}, ${t*s})`}Z(e){let t=this.K(e);return{G:`rgb(${t[0]}, ${t[1]}, ${t[2]})`,X:ef(t)>160?"black":"white"}}J(e){return ef(this.K(e))}tt(e,t,i){var s;let[r,n,l,a]=this.K(e),[o,h,u,c]=this.K(t),d=[ep(r+i*(o-r)),ep(n+i*(h-n)),ep(l+i*(u-l)),(s=a+i*(c-a))<=0||s>1?Math.min(Math.max(s,0),1):Math.round(1e4*s)/1e4];return`rgba(${d[0]}, ${d[1]}, ${d[2]}, ${d[3]})`}K(e){let t,i,s=this.q.get(e);if(s)return s;let r=((t=document.createElement("div")).style.display="none",document.body.appendChild(t),t.style.color=e,i=window.getComputedStyle(t).color,document.body.removeChild(t),i).match(/^rgba?\s*\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d+))?\)$/);if(!r){if(this.j.length)for(let t of this.j){let i=t(e);if(i)return this.q.set(e,i),i}throw Error(`Failed to parse color: ${e}`)}let n=[parseInt(r[1],10),parseInt(r[2],10),parseInt(r[3],10),r[4]?parseFloat(r[4]):1];return this.q.set(e,n),n}}class ev{constructor(){this.it=[]}st(e){this.it=e}nt(e,t,i){this.it.forEach(s=>{s.nt(e,t,i)})}}class ex{nt(e,t,i){e.useBitmapCoordinateSpace(e=>this.et(e,t,i))}}class ew extends ex{constructor(){super(...arguments),this.rt=null}ht(e){this.rt=e}et({context:e,horizontalPixelRatio:t,verticalPixelRatio:i}){if(null===this.rt||null===this.rt.lt)return;let s=this.rt.lt,r=this.rt,n=Math.max(1,Math.floor(t))%2/2,l=l=>{e.beginPath();for(let a=s.to-1;a>=s.from;--a){let s=r.ot[a],o=Math.round(s._t*t)+n,h=s.ut*i,u=l*i+n;e.moveTo(o,h),e.arc(o,h,u,0,2*Math.PI)}e.fill()};r.ct>0&&(e.fillStyle=r.dt,l(r.ft+r.ct)),e.fillStyle=r.vt,l(r.ft)}}function eb(){return{ot:[{_t:0,ut:0,wt:0,gt:0}],vt:"",dt:"",ft:0,ct:0,lt:null}}let ey={from:0,to:1};class eS{constructor(e,t,i){this.Mt=new ev,this.bt=[],this.St=[],this.xt=!0,this.O=e,this.Ct=t,this.yt=i,this.Mt.st(this.bt)}kt(e){this.Pt(),this.xt=!0}Tt(){return this.xt&&(this.Rt(),this.xt=!1),this.Mt}Pt(){let e=this.yt.Dt();e.length!==this.bt.length&&(this.St=e.map(eb),this.bt=this.St.map(e=>{let t=new ew;return t.ht(e),t}),this.Mt.st(this.bt))}Rt(){let e=2===this.Ct.N().mode||!this.Ct.It(),t=this.yt.Vt(),i=this.Ct.Bt(),s=this.O.Et();this.Pt(),t.forEach((t,r)=>{let n=this.St[r],l=t.At(i),a=t.Lt();!e&&null!==l&&t.It()&&null!==a?(n.vt=l.zt,n.ft=l.ft,n.ct=l.Ot,n.ot[0].gt=l.gt,n.ot[0].ut=t.Ft().Nt(l.gt,a.Wt),n.dt=l.Ht??this.O.Ut(n.ot[0].ut/t.Ft().$t()),n.ot[0].wt=i,n.ot[0]._t=s.qt(i),n.lt=ey):n.lt=null})}}class ej extends ex{constructor(e){super(),this.jt=e}et({context:e,bitmapSize:t,horizontalPixelRatio:i,verticalPixelRatio:s}){var r;let n;if(null===this.jt)return;let l=this.jt.Yt.It,a=this.jt.Kt.It;if(!l&&!a)return;let o=Math.round(this.jt._t*i),h=Math.round(this.jt.ut*s);e.lineCap="butt",l&&o>=0&&(e.lineWidth=Math.floor(this.jt.Yt.ct*i),e.strokeStyle=this.jt.Yt.R,e.fillStyle=this.jt.Yt.R,X(e,this.jt.Yt.Zt),r=t.height,e.beginPath(),n=e.lineWidth%2?.5:0,e.moveTo(o+n,0),e.lineTo(o+n,r),e.stroke()),a&&h>=0&&(e.lineWidth=Math.floor(this.jt.Kt.ct*s),e.strokeStyle=this.jt.Kt.R,e.fillStyle=this.jt.Kt.R,X(e,this.jt.Kt.Zt),G(e,h,0,t.width))}}class eM{constructor(e,t){this.xt=!0,this.Gt={Yt:{ct:1,Zt:0,R:"",It:!1},Kt:{ct:1,Zt:0,R:"",It:!1},_t:0,ut:0},this.Xt=new ej(this.Gt),this.Jt=e,this.yt=t}kt(){this.xt=!0}Tt(e){return this.xt&&(this.Rt(),this.xt=!1),this.Xt}Rt(){let e=this.Jt.It(),t=this.yt.Qt().N().crosshair,i=this.Gt;2===t.mode?(i.Kt.It=!1,i.Yt.It=!1):(i.Kt.It=e&&this.Jt.ti(this.yt),i.Yt.It=e&&this.Jt.ii(),i.Kt.ct=t.horzLine.width,i.Kt.Zt=t.horzLine.style,i.Kt.R=t.horzLine.color,i.Yt.ct=t.vertLine.width,i.Yt.Zt=t.vertLine.style,i.Yt.R=t.vertLine.color,i._t=this.Jt.si(),i.ut=this.Jt.ni())}}function eC(e,t,i,s,r,n){e.save(),e.globalCompositeOperation="copy",e.fillStyle=n,e.fillRect(t,i,s,r),e.restore()}function eN(e,t,i,s,r,n){e.beginPath(),e.roundRect?e.roundRect(t,i,s,r,n):(e.lineTo(t+s-n[1],i),0!==n[1]&&e.arcTo(t+s,i,t+s,i+n[1],n[1]),e.lineTo(t+s,i+r-n[2]),0!==n[2]&&e.arcTo(t+s,i+r,t+s-n[2],i+r,n[2]),e.lineTo(t+n[3],i+r),0!==n[3]&&e.arcTo(t,i+r,t,i+r-n[3],n[3]),e.lineTo(t,i+n[0]),0!==n[0]&&e.arcTo(t,i,t+n[0],i,n[0]))}function eP(e,t,i,s,r,n,l=0,a=[0,0,0,0],o=""){var h;if(e.save(),!l||!o||o===n)return eN(e,t,i,s,r,a),e.fillStyle=n,e.fill(),void e.restore();let u=l/2;eN(e,t+u,i+u,s-l,r-l,(h=-u,a.map(e=>0===e?e:e+h))),"transparent"!==n&&(e.fillStyle=n,e.fill()),"transparent"!==o&&(e.lineWidth=l,e.strokeStyle=o,e.closePath(),e.stroke()),e.restore()}function ek(e,t,i,s,r,n,l){e.save(),e.globalCompositeOperation="copy";let a=e.createLinearGradient(0,0,0,r);a.addColorStop(0,n),a.addColorStop(1,l),e.fillStyle=a,e.fillRect(t,i,s,r),e.restore()}class eE{constructor(e,t){this.ht(e,t)}ht(e,t){this.jt=e,this.ei=t}$t(e,t){return this.jt.It?e.k+e.A+e.I:0}nt(e,t,i,s){if(!this.jt.It||0===this.jt.ri.length)return;let r=this.jt.R,n=this.ei.G,l=e.useBitmapCoordinateSpace(e=>{let l=e.context;l.font=t.P;let a=this.hi(e,t,i,s),o=a.ai;return a.li?eP(l,o.oi,o._i,o.ui,o.ci,n,o.di,[o.ft,0,0,o.ft],n):eP(l,o.fi,o._i,o.ui,o.ci,n,o.di,[0,o.ft,o.ft,0],n),this.jt.pi&&(l.fillStyle=r,l.fillRect(o.fi,o.mi,o.wi-o.fi,o.gi)),this.jt.Mi&&(l.fillStyle=t.D,l.fillRect(a.li?o.bi-o.di:0,o._i,o.di,o.Si-o._i)),a});e.useMediaCoordinateSpace(({context:e})=>{let i=l.xi;e.font=t.P,e.textAlign=l.li?"right":"left",e.textBaseline="middle",e.fillStyle=r,e.fillText(this.jt.ri,i.Ci,(i._i+i.Si)/2+i.yi)})}hi(e,t,i,s){let r,n,l,{context:a,bitmapSize:o,mediaSize:h,horizontalPixelRatio:u,verticalPixelRatio:c}=e,d=this.jt.pi||!this.jt.ki?t.C:0,m=this.jt.Pi?t.S:0,p=t.A+this.ei.Ti,f=t.I+this.ei.Ri,g=t.V,v=t.B,x=this.jt.ri,w=t.k,b=i.Di(a,x),y=Math.ceil(i.Ii(a,x)),S=t.S+g+v+y+d,j=Math.max(1,Math.floor(c)),M=Math.round((w+p+f)*c);M%2!=j%2&&(M+=1);let C=m>0?Math.max(1,Math.floor(m*u)):0,N=Math.round(S*u),P=Math.round(d*u),k=Math.round((this.ei.Vi??this.ei.Bi??this.ei.Ei)*c)-Math.floor(.5*c),E=Math.floor(k+j/2-M/2),R=E+M,_="right"===s,T=_?h.width-m:m,L=_?o.width-C:C;return _?(r=L-N,n=L-P,l=T-d-g-m):(r=L+N,n=L+P,l=T+d+g),{li:_,ai:{_i:E,mi:k,Si:R,ui:N,ci:M,ft:2*u,di:C,oi:r,fi:L,wi:n,gi:j,bi:o.width},xi:{_i:E/c,Si:R/c,Ci:l,yi:b}}}}class eR{constructor(e){this.Ai={Ei:0,G:"#000",Ri:0,Ti:0},this.Li={ri:"",It:!1,pi:!0,ki:!1,Ht:"",R:"#FFF",Mi:!1,Pi:!1},this.zi={ri:"",It:!1,pi:!1,ki:!0,Ht:"",R:"#FFF",Mi:!0,Pi:!0},this.xt=!0,this.Oi=new(e||eE)(this.Li,this.Ai),this.Ni=new(e||eE)(this.zi,this.Ai)}ri(){return this.Fi(),this.Li.ri}Ei(){return this.Fi(),this.Ai.Ei}kt(){this.xt=!0}$t(e,t=!1){return Math.max(this.Oi.$t(e,t),this.Ni.$t(e,t))}Wi(){return this.Ai.Vi??null}Hi(){return this.Ai.Vi??this.Ai.Bi??this.Ei()}Ui(e){this.Ai.Bi=e??void 0}$i(){return this.Fi(),this.Li.It||this.zi.It}qi(){return this.Fi(),this.Li.It}Tt(e){return this.Fi(),this.Li.pi=this.Li.pi&&e.N().ticksVisible,this.zi.pi=this.zi.pi&&e.N().ticksVisible,this.Oi.ht(this.Li,this.Ai),this.Ni.ht(this.zi,this.Ai),this.Oi}ji(){return this.Fi(),this.Oi.ht(this.Li,this.Ai),this.Ni.ht(this.zi,this.Ai),this.Ni}Fi(){this.xt&&(this.Li.pi=!0,this.zi.pi=!1,this.Yi(this.Li,this.zi,this.Ai))}}class e_ extends eR{constructor(e,t,i){super(),this.Jt=e,this.Ki=t,this.Zi=i}Yi(e,t,i){if(e.It=!1,2===this.Jt.N().mode)return;let s=this.Jt.N().horzLine;if(!s.labelVisible)return;let r=this.Ki.Lt();if(!this.Jt.It()||this.Ki.Gi()||null===r)return;let n=this.Ki.Xi().Z(s.labelBackgroundColor);i.G=n.G,e.R=n.X;let l=2/12*this.Ki.k();i.Ti=l,i.Ri=l;let a=this.Zi(this.Ki);i.Ei=a.Ei,e.ri=this.Ki.Ji(a.gt,r),e.It=!0}}let eT=/[1-9]/g;class eL{constructor(){this.jt=null}ht(e){this.jt=e}nt(e,t){if(null===this.jt||!1===this.jt.It||0===this.jt.ri.length)return;let i=e.useMediaCoordinateSpace(({context:e})=>(e.font=t.P,Math.round(t.Qi.Ii(e,ee(this.jt).ri,eT))));if(i<=0)return;let s=t.ts,r=i+2*s,n=r/2,l=this.jt.ss,a=this.jt.Ei,o=Math.floor(a-n)+.5;o<0?(a+=Math.abs(0-o),o=Math.floor(a-n)+.5):o+r>l&&(a-=Math.abs(l-(o+r)),o=Math.floor(a-n)+.5);let h=o+r,u=Math.ceil(0+t.S+t.C+t.A+t.k+t.I);e.useBitmapCoordinateSpace(({context:e,horizontalPixelRatio:i,verticalPixelRatio:s})=>{let r=ee(this.jt);e.fillStyle=r.G;let n=Math.round(o*i),l=Math.round(0*s),a=Math.round(h*i),c=Math.round(u*s),d=Math.round(2*i);if(e.beginPath(),e.moveTo(n,l),e.lineTo(n,c-d),e.arcTo(n,c,n+d,c,d),e.lineTo(a-d,c),e.arcTo(a,c,a,c-d,d),e.lineTo(a,l),e.fill(),r.pi){let n=Math.round(r.Ei*i),a=Math.round((l+t.C)*s);e.fillStyle=r.R;let o=Math.max(1,Math.floor(i)),h=Math.floor(.5*i);e.fillRect(n-h,l,o,a-l)}}),e.useMediaCoordinateSpace(({context:e})=>{let i=ee(this.jt),r=0+t.S+t.C+t.A+t.k/2;e.font=t.P,e.textAlign="left",e.textBaseline="middle",e.fillStyle=i.R;let n=t.Qi.Di(e,"Apr0");e.translate(o+s,r+n),e.fillText(i.ri,0,0)})}}class eI{constructor(e,t,i){this.xt=!0,this.Xt=new eL,this.Gt={It:!1,G:"#4c525e",R:"white",ri:"",ss:0,Ei:NaN,pi:!0},this.Ct=e,this.ns=t,this.Zi=i}kt(){this.xt=!0}Tt(){return this.xt&&(this.Rt(),this.xt=!1),this.Xt.ht(this.Gt),this.Xt}Rt(){let e=this.Gt;if(e.It=!1,2===this.Ct.N().mode)return;let t=this.Ct.N().vertLine;if(!t.labelVisible)return;let i=this.ns.Et();if(i.Gi())return;e.ss=i.ss();let s=this.Zi();if(null===s)return;e.Ei=s.Ei;let r=i.es(this.Ct.Bt());e.ri=i.rs(ee(r)),e.It=!0;let n=this.ns.Xi().Z(t.labelBackgroundColor);e.G=n.G,e.R=n.X,e.pi=i.N().ticksVisible}}class eA{constructor(){this.hs=null,this.ls=0}_s(){return this.ls}us(e){this.ls=e}Ft(){return this.hs}cs(e){this.hs=e}ds(e){return[]}fs(){return[]}It(){return!0}}(l=j||(j={}))[l.Normal=0]="Normal",l[l.Magnet=1]="Magnet",l[l.Hidden=2]="Hidden",l[l.MagnetOHLC=3]="MagnetOHLC";class eF extends eA{constructor(e,t){let i,s,r,n;super(),this.yt=null,this.ps=NaN,this.vs=0,this.ws=!1,this.gs=new Map,this.Ms=!1,this.bs=new WeakMap,this.Ss=new WeakMap,this.xs=NaN,this.Cs=NaN,this.ys=NaN,this.ks=NaN,this.ns=e,this.Ps=t,this.Ts=(i=()=>this.ps,s=()=>this.Cs,e=>{let t=s(),r=i();if(e===ee(this.yt).Rs())return{gt:r,Ei:t};{let i=ee(e.Lt());return{gt:e.Ds(t,i),Ei:t}}});const l=(r=()=>this.vs,n=()=>this.si(),()=>{let e=this.ns.Et().Is(r()),t=n();return e&&Number.isFinite(t)?{wt:e,Ei:t}:null});this.Vs=new eI(this,e,l)}N(){return this.Ps}Bs(e,t){this.ys=e,this.ks=t}Es(){this.ys=NaN,this.ks=NaN}As(){return this.ys}Ls(){return this.ks}zs(e,t,i){this.Ms||(this.Ms=!0),this.ws=!0,this.Os(e,t,i)}Bt(){return this.vs}si(){return this.xs}ni(){return this.Cs}It(){return this.ws}Ns(){this.ws=!1,this.Fs(),this.ps=NaN,this.xs=NaN,this.Cs=NaN,this.yt=null,this.Es(),this.Ws()}Hs(e){if(!this.Ps.doNotSnapToHiddenSeriesIndices)return e;let t=this.ns,i=t.Et(),s=null,r=null;for(let i of t.Us()){let t=i.qs().$s(e,-1);if(t){if(t.js===e)return e;(null===s||t.js>s)&&(s=t.js)}let n=i.qs().$s(e,1);if(n){if(n.js===e)return e;(null===r||n.js<r)&&(r=n.js)}}let n=[s,r].filter(eh);if(0===n.length)return e;let l=i.qt(e),a=n.map(e=>Math.abs(l-i.qt(e)));return n[a.indexOf(Math.min(...a))]}Ys(e){let t=this.bs.get(e);t||(t=new eM(this,e),this.bs.set(e,t));let i=this.Ss.get(e);return i||(i=new eS(this.ns,this,e),this.Ss.set(e,i)),[t,i]}ti(e){return e===this.yt&&this.Ps.horzLine.visible}ii(){return this.Ps.vertLine.visible}Ks(e,t){this.ws&&this.yt===e||this.gs.clear();let i=[];return this.yt===e&&i.push(this.Zs(this.gs,t,this.Ts)),i}fs(){return this.ws?[this.Vs]:[]}Gs(){return this.yt}Ws(){this.ns.Xs().forEach(e=>{this.bs.get(e)?.kt(),this.Ss.get(e)?.kt()}),this.gs.forEach(e=>e.kt()),this.Vs.kt()}Js(e){return e&&!e.Rs().Gi()?e.Rs():null}Os(e,t,i){this.Qs(e,t,i)&&this.Ws()}Qs(e,t,i){let s=this.xs,r=this.Cs,n=this.ps,l=this.vs,a=this.yt,o=this.Js(i);this.vs=e,this.xs=isNaN(e)?NaN:this.ns.Et().qt(e),this.yt=i;let h=null!==o?o.Lt():null;return null!==o&&null!==h?(this.ps=t,this.Cs=o.Nt(t,h)):(this.ps=NaN,this.Cs=NaN),s!==this.xs||r!==this.Cs||l!==this.vs||n!==this.ps||a!==this.yt}Fs(){let e=this.ns.tn().map(e=>e.qs().sn()).filter(eh),t=0===e.length?null:Math.max(...e);this.vs=null!==t?t:NaN}Zs(e,t,i){let s=e.get(t);return void 0===s&&(s=new e_(this,t,i),e.set(t,s)),s}}function ez(e){return"left"===e||"right"===e}class eD{constructor(e){this.nn=new Map,this.en=[],this.rn=e}hn(e,t){var i;let s=(i=this.nn.get(e),void 0===i?t:{an:Math.max(i.an,t.an),ln:i.ln||t.ln});this.nn.set(e,s)}_n(){return this.rn}un(e){let t=this.nn.get(e);return void 0===t?{an:this.rn}:{an:Math.max(this.rn,t.an),ln:t.ln}}cn(){this.dn(),this.en=[{fn:0}]}pn(e){this.dn(),this.en=[{fn:1,Wt:e}]}vn(e){this.mn(),this.en.push({fn:5,Wt:e})}dn(){this.mn(),this.en.push({fn:6})}wn(){this.dn(),this.en=[{fn:4}]}gn(e){this.dn(),this.en.push({fn:2,Wt:e})}Mn(e){this.dn(),this.en.push({fn:3,Wt:e})}bn(){return this.en}Sn(e){for(let t of e.en)this.xn(t);this.rn=Math.max(this.rn,e.rn),e.nn.forEach((e,t)=>{this.hn(t,e)})}static Cn(){return new eD(2)}static yn(){return new eD(3)}xn(e){switch(e.fn){case 0:this.cn();break;case 1:this.pn(e.Wt);break;case 2:this.gn(e.Wt);break;case 3:this.Mn(e.Wt);break;case 4:this.wn();break;case 5:this.vn(e.Wt);break;case 6:this.mn()}}mn(){let e=this.en.findIndex(e=>5===e.fn);-1!==e&&this.en.splice(e,1)}}class eO{formatTickmarks(e){return e.map(e=>this.format(e))}}function eB(e,t){if(!er(e))return"n/a";if(!en(t)||t<0||t>16)throw TypeError("invalid length");return 0===t?e.toString():("0000000000000000"+e.toString()).slice(-t)}class e$ extends eO{constructor(e,t){if(super(),t||(t=1),er(e)&&en(e)||(e=100),e<0)throw TypeError("invalid base");this.Ki=e,this.kn=t,this.Pn()}format(e){let t=e<0?"âˆ’":"";return e=Math.abs(e),t+this.Tn(e)}Pn(){if(this.Rn=0,this.Ki>0&&this.kn>0){let e=this.Ki;for(;e>1;)e/=10,this.Rn++}}Tn(e){let t=this.Ki/this.kn,i=Math.floor(e),s="",r=void 0!==this.Rn?this.Rn:NaN;if(t>1){let n=+(Math.round(e*t)-i*t).toFixed(this.Rn);n>=t&&(n-=t,i+=1),s="."+eB(n.toFixed(this.Rn)*this.kn,r)}else i=Math.round(i*t)/t,r>0&&(s="."+eB(0,r));return i.toFixed(0)+s}}class eW extends e${constructor(e=100){super(e)}format(e){return`${super.format(e)}%`}}class eV extends eO{constructor(e){super(),this.Dn=e}format(e){let t="";return e<0&&(t="-",e=-e),e<995?t+this.In(e):e<999995?t+this.In(e/1e3)+"K":e<0x3b9ac9fb?(e=1e3*Math.round(e/1e3),t+this.In(e/1e6)+"M"):(e=1e6*Math.round(e/1e6),t+this.In(e/1e9)+"B")}In(e){let t=Math.pow(10,this.Dn);return((e=Math.round(e*t)/t)>=1e-15&&e<1?e.toFixed(this.Dn).replace(/\.?0+$/,""):String(e)).replace(/(\.[1-9]*)0+$/,(e,t)=>t)}}let eK=/[2-9]/g;class eU{constructor(e=50){this.Vn=0,this.Bn=1,this.En=1,this.An={},this.Ln=new Map,this.zn=e}On(){this.Vn=0,this.Ln.clear(),this.Bn=1,this.En=1,this.An={}}Ii(e,t,i){return this.Nn(e,t,i).width}Di(e,t,i){let s=this.Nn(e,t,i);return((s.actualBoundingBoxAscent||0)-(s.actualBoundingBoxDescent||0))/2}Nn(e,t,i){let s=String(t).replace(i||eK,"0");if(this.Ln.has(s))return Z(this.Ln.get(s)).Fn;if(this.Vn===this.zn){let e=this.An[this.En];delete this.An[this.En],this.Ln.delete(e),this.En++,this.Vn--}e.save(),e.textBaseline="middle";let r=e.measureText(s);return e.restore(),0===r.width&&t.length||(this.Ln.set(s,{Fn:r,Wn:this.Bn}),this.An[this.Bn]=s,this.Vn++,this.Bn++),r}}class eH{constructor(e){this.Hn=null,this.M=null,this.Un="right",this.$n=e}qn(e,t,i){this.Hn=e,this.M=t,this.Un=i}nt(e){null!==this.M&&null!==this.Hn&&this.Hn.nt(e,this.M,this.$n,this.Un)}}class eJ{constructor(e,t,i){this.jn=e,this.$n=new eU(50),this.Yn=t,this.O=i,this.F=-1,this.Xt=new eH(this.$n)}Tt(){let e=this.O.Kn(this.Yn);if(null===e)return null;let t=e.Zn(this.Yn)?e.Gn():this.Yn.Ft();if(null===t)return null;let i=e.Xn(t);if("overlay"===i)return null;let s=this.O.Jn();return s.k!==this.F&&(this.F=s.k,this.$n.On()),this.Xt.qn(this.jn.ji(),s,i),this.Xt}}class eq extends ex{constructor(){super(...arguments),this.jt=null}ht(e){this.jt=e}Qn(e,t){if(!this.jt?.It)return null;let{ut:i,ct:s,te:r}=this.jt;return t>=i-s-7&&t<=i+s+7?{ie:this.jt,te:r}:null}et({context:e,bitmapSize:t,horizontalPixelRatio:i,verticalPixelRatio:s}){if(null===this.jt||!1===this.jt.It)return;let r=Math.round(this.jt.ut*s);r<0||r>t.height||(e.lineCap="butt",e.strokeStyle=this.jt.R,e.lineWidth=Math.floor(this.jt.ct*i),X(e,this.jt.Zt),G(e,r,0,t.width))}}class eY{constructor(e){this.se={ut:0,R:"rgba(0, 0, 0, 0)",ct:1,Zt:0,It:!1},this.ne=new eq,this.xt=!0,this.ee=e,this.re=e.Qt(),this.ne.ht(this.se)}kt(){this.xt=!0}Tt(){return this.ee.It()?(this.xt&&(this.he(),this.xt=!1),this.ne):null}}class eX extends eY{constructor(e){super(e)}he(){this.se.It=!1;let e=this.ee.Ft(),t=e.ae().ae;if(2!==t&&3!==t)return;let i=this.ee.N();if(!i.baseLineVisible||!this.ee.It())return;let s=this.ee.Lt();null!==s&&(this.se.It=!0,this.se.ut=e.Nt(s.Wt,s.Wt),this.se.R=i.baseLineColor,this.se.ct=i.baseLineWidth,this.se.Zt=i.baseLineStyle)}}class eG extends ex{constructor(){super(...arguments),this.jt=null}ht(e){this.jt=e}le(){return this.jt}et({context:e,horizontalPixelRatio:t,verticalPixelRatio:i}){let s=this.jt;if(null===s)return;let r=Math.max(1,Math.floor(t)),n=r%2/2,l=Math.round(s.oe.x*t)+n,a=s.oe.y*i;e.fillStyle=s._e,e.beginPath();let o=Math.max(2,1.5*s.ue)*t;e.arc(l,a,o,0,2*Math.PI,!1),e.fill(),e.fillStyle=s.ce,e.beginPath(),e.arc(l,a,s.ft*t,0,2*Math.PI,!1),e.fill(),e.lineWidth=r,e.strokeStyle=s.de,e.beginPath(),e.arc(l,a,s.ft*t+r/2,0,2*Math.PI,!1),e.stroke()}}let eQ=[{fe:0,pe:.25,ve:4,me:10,we:.25,ge:0,Me:.4,be:.8},{fe:.25,pe:.525,ve:10,me:14,we:0,ge:0,Me:.8,be:0},{fe:.525,pe:1,ve:14,me:14,we:0,ge:0,Me:0,be:0}];class eZ{constructor(e){this.Xt=new eG,this.xt=!0,this.Se=!0,this.xe=performance.now(),this.Ce=this.xe-1,this.ye=e}ke(){this.Ce=this.xe-1,this.kt()}Pe(){if(this.kt(),2===this.ye.N().lastPriceAnimation){let e=performance.now(),t=this.Ce-e;if(t>0)return void(t<650&&(this.Ce+=2600));this.xe=e,this.Ce=e+2600}}kt(){this.xt=!0}Te(){this.Se=!0}It(){return 0!==this.ye.N().lastPriceAnimation}Re(){switch(this.ye.N().lastPriceAnimation){case 0:return!1;case 1:return!0;case 2:return performance.now()<=this.Ce}}Tt(){return this.xt?(this.Rt(),this.xt=!1,this.Se=!1):this.Se&&(this.De(),this.Se=!1),this.Xt}Rt(){this.Xt.ht(null);let e=this.ye.Qt().Et(),t=e.Ie(),i=this.ye.Lt();if(null===t||null===i)return;let s=this.ye.Ve(!0);if(s.Be||!t.Ee(s.js))return;let r={x:e.qt(s.js),y:this.ye.Ft().Nt(s.gt,i.Wt)},n=s.R,l=this.ye.N().lineWidth,a=this.Ae(this.Le(),n);this.Xt.ht({_e:n,ue:l,ce:a.ce,de:a.de,ft:a.ft,oe:r})}De(){let e=this.Xt.le();if(null!==e){let t=this.Ae(this.Le(),e._e);e.ce=t.ce,e.de=t.de,e.ft=t.ft}}Le(){return this.Re()?performance.now()-this.xe:2599}ze(e,t,i,s){return this.ye.Qt().Xi().Y(e,i+(s-i)*t)}Ae(e,t){var i;let s,r=e%2600/2600;for(let e of eQ)if(r>=e.fe&&r<=e.pe){s=e;break}Q(void 0!==s,"Last price animation internal logic error");let n=(r-s.fe)/(s.pe-s.fe);return{ce:this.ze(t,n,s.we,s.ge),de:this.ze(t,n,s.Me,s.be),ft:(i=s.ve)+(s.me-i)*n}}}class e0 extends eY{constructor(e){super(e)}he(){let e=this.se;e.It=!1;let t=this.ee.N();if(!t.priceLineVisible||!this.ee.It())return;let i=this.ee.Ve(0===t.priceLineSource);i.Be||(e.It=!0,e.ut=i.Ei,e.R=this.ee.Oe(i.R),e.ct=t.priceLineWidth,e.Zt=t.priceLineStyle)}}class e1 extends eR{constructor(e){super(),this.Jt=e}Yi(e,t,i){e.It=!1,t.It=!1;let s=this.Jt;if(!s.It())return;let r=s.N(),n=r.lastValueVisible,l=""!==s.Ne(),a=0===r.seriesLastValueMode,o=s.Ve(!1);if(o.Be)return;n&&(e.ri=this.Fe(o,n,a),e.It=0!==e.ri.length),(l||a)&&(t.ri=this.We(o,n,l,a),t.It=t.ri.length>0);let h=s.Oe(o.R),u=this.Jt.Qt().Xi().Z(h);i.G=u.G,i.Ei=o.Ei,t.Ht=s.Qt().Ut(o.Ei/s.Ft().$t()),e.Ht=h,e.R=u.X,t.R=u.X}We(e,t,i,s){let r="",n=this.Jt.Ne();return i&&0!==n.length&&(r+=`${n} `),t&&s&&(r+=this.Jt.Ft().He()?e.Ue:e.$e),r.trim()}Fe(e,t,i){return t?i?this.Jt.Ft().He()?e.$e:e.Ue:e.ri:""}}function e2(e,t,i,s){let r=Number.isFinite(t),n=Number.isFinite(i);return r&&n?e(t,i):r||n?r?t:i:s}class e3{constructor(e,t){this.qe=e,this.je=t}Ye(e){return null!==e&&this.qe===e.qe&&this.je===e.je}Ke(){return new e3(this.qe,this.je)}Ze(){return this.qe}Ge(){return this.je}Xe(){return this.je-this.qe}Gi(){return this.je===this.qe||Number.isNaN(this.je)||Number.isNaN(this.qe)}Sn(e){return null===e?this:new e3(e2(Math.min,this.Ze(),e.Ze(),-1/0),e2(Math.max,this.Ge(),e.Ge(),1/0))}Je(e){if(!er(e)||0==this.je-this.qe)return;let t=.5*(this.je+this.qe),i=this.je-t,s=this.qe-t;i*=e,s*=e,this.je=t+i,this.qe=t+s}Qe(e){er(e)&&(this.je+=e,this.qe+=e)}tr(){return{minValue:this.qe,maxValue:this.je}}static ir(e){return null===e?null:new e3(e.minValue,e.maxValue)}}class e5{constructor(e,t){this.sr=e,this.nr=t||null}er(){return this.sr}rr(){return this.nr}tr(){return{priceRange:null===this.sr?null:this.sr.tr(),margins:this.nr||void 0}}static ir(e){return null===e?null:new e5(e3.ir(e.priceRange),e.margins)}}let e4=[2,4,8,16,32,64,128,256,512];class e6 extends eY{constructor(e,t){super(e),this.hr=t}he(){let e=this.se;e.It=!1;let t=this.hr.N();if(!this.ee.It()||!t.lineVisible)return;let i=this.hr.ar();null!==i&&(e.It=!0,e.ut=i,e.R=t.color,e.ct=t.lineWidth,e.Zt=t.lineStyle,e.te=this.hr.N().id)}}class e9 extends eR{constructor(e,t){super(),this.ye=e,this.hr=t}Yi(e,t,i){e.It=!1,t.It=!1;let s=this.hr.N(),r=s.axisLabelVisible,n=""!==s.title,l=this.ye;if(!r||!l.It())return;let a=this.hr.ar();if(null===a)return;n&&(t.ri=s.title,t.It=!0),t.Ht=l.Qt().Ut(a/l.Ft().$t()),e.ri=this.lr(s.price),e.It=!0;let o=this.ye.Qt().Xi().Z(s.axisLabelColor||s.color);i.G=o.G;let h=s.axisLabelTextColor||o.X;e.R=h,t.R=h,i.Ei=a}lr(e){let t=this.ye.Lt();return null===t?"":this.ye.Ft().Ji(e,t.Wt)}}class e8{constructor(e,t){this.ye=e,this.Ps=t,this._r=new e6(e,this),this.jn=new e9(e,this),this.ur=new eJ(this.jn,e,e.Qt())}cr(e){es(this.Ps,e),this.kt(),this.ye.Qt().dr()}N(){return this.Ps}pr(){return this._r}vr(){return this.ur}mr(){return this.jn}kt(){this._r.kt(),this.jn.kt()}ar(){let e=this.ye,t=e.Ft();if(e.Qt().Et().Gi()||t.Gi())return null;let i=e.Lt();return null===i?null:t.Nt(this.Ps.price,i.Wt)}}class e7{constructor(){this.wr=new WeakMap}gr(e,t,i){let s=1/t*i;return e>=s?1:Math.min(Math.pow(2,Math.floor(Math.log2(s/e))),512)}Mr(e,t,i,s=!1,r){if(0===e.length||t<=1)return e;let n=this.br(t);if(n<=1)return e;let l=this.Sr(e),a=l.Cr.get(n);return void 0!==a||(a=this.yr(e,n,i,s,r,l.Cr),l.Cr.set(n,a)),a}kr(e,t,i,s,r=!1,n){if(i<1||0===e.length)return e;let l=this.Sr(e),a=l.Cr.get(i);if(!a)return this.Mr(e,i,s,r,n);let o=this.Pr(e,t,i,a,r,s,n);return l.Cr.set(i,o),o}br(e){if(e<=2)return 2;for(let t of e4)if(e<=t)return t;return 512}Tr(e){if(0===e.length)return 0;let t=e[0],i=e[e.length-1];return 31*e.length+17*t.js+13*i.js}yr(e,t,i,s=!1,r,n=new Map){if(2===t)return this.Rr(e,2,i,s,r);let l=t/2,a=n.get(l);return a||(a=this.yr(e,l,i,s,r,n),n.set(l,a)),this.Dr(a,i,s,r)}Rr(e,t,i,s=!1,r){let n=this.Ir(e,t,i,s,r);return this.Vr(n,s)}Dr(e,t,i=!1,s){let r=this.Ir(e,2,t,i,s);return this.Vr(r,i)}Ir(e,t,i,s=!1,r){let n=[];for(let l=0;l<e.length;l+=t)if(e.length-l>=t){let t=this.Br(e[l],e[l+1],i,s,r);t.Er=!1,n.push(t)}else if(0===n.length)n.push(this.Ar(e[l],!0));else{let t=n[n.length-1];n[n.length-1]=this.Lr(t,e[l],i,s,r)}return n}zr(e,t){return(e??1)+(t??1)}Br(e,t,i,s=!1,r){if(!s||!i||!r){let i=e.Wt[1]>t.Wt[1]?e.Wt[1]:t.Wt[1],s=e.Wt[2]<t.Wt[2]?e.Wt[2]:t.Wt[2];return{Or:e.js,Nr:t.js,Fr:e.wt,Wr:t.wt,Hr:e.Wt[0],Ur:i,$r:s,qr:t.Wt[3],jr:this.zr(e.jr,t.jr),Yr:void 0,Er:!1}}let n=i(this.Kr(e,r),this.Kr(t,r)),l=r(n),a=l.length?l[l.length-1]:0;return{Or:e.js,Nr:t.js,Fr:e.wt,Wr:t.wt,Hr:e.Wt[0],Ur:Math.max(e.Wt[1],a),$r:Math.min(e.Wt[2],a),qr:a,jr:this.zr(e.jr,t.jr),Yr:n,Er:!1}}Lr(e,t,i,s=!1,r){if(!s||!i||!r)return{Or:e.Or,Nr:t.js,Fr:e.Fr,Wr:t.wt,Hr:e.Hr,Ur:e.Ur>t.Wt[1]?e.Ur:t.Wt[1],$r:e.$r<t.Wt[2]?e.$r:t.Wt[2],qr:t.Wt[3],jr:e.jr+(t.jr??1),Yr:e.Yr,Er:!1};let n=e.Yr,l=this.Kr(t,r),a=n?{data:n,index:e.Or,originalTime:e.Fr,time:e.Fr,priceValues:r(n)}:null,o=a?i(a,l):l.data,h=a?r(o):l.priceValues,u=h.length?h[h.length-1]:0;return{Or:e.Or,Nr:t.js,Fr:e.Fr,Wr:t.wt,Hr:e.Hr,Ur:Math.max(e.Ur,u),$r:Math.min(e.$r,u),qr:u,jr:e.jr+(t.jr??1),Yr:o,Er:!1}}Zr(e,t,i,s,r,n,l=!1,a){let o=t===s?r:e[t];if(i-t==1)return this.Ar(o,!0);let h=t+1===s?r:e[t+1],u=this.Br(o,h,n,l,a);for(let o=t+2;o<i;o++){let t=o===s?r:e[o];u=this.Lr(u,t,n,l,a)}return u}Kr(e,t){let i=e.le??{};return{data:e.le,index:e.js,originalTime:e.Gr,time:e.wt,priceValues:t(i)}}Xr(e,t=!1){let i=!0===t,s=!!e.Yr;return{...{js:e.Or,wt:e.Fr,Gr:e.Fr,Wt:[i?e.qr:e.Hr,e.Ur,e.$r,e.qr],jr:e.jr},le:i?s?e.Yr:{wt:e.Fr}:void 0}}Vr(e,t=!1){return e.map(e=>this.Xr(e,t))}Pr(e,t,i,s,r=!1,n,l){if(0===s.length)return s;let a=e.length-1,o=Math.floor(a/i)*i;if(Math.min(o+i,e.length)-o<i&&e.length>i){let s=e.slice();return s[s.length-1]=t,this.Mr(s,i,n,r,l)}if(Math.floor((a-1)/i)===Math.floor(a/i)||1===s.length){let h=Math.min(o+i,e.length),u=h-o;if(u<=0)return s;let c=1===u?this.Ar(o===a?t:e[o],!0):this.Zr(e,o,h,a,t,n,r,l);return s[s.length-1]=this.Xr(c,r),s}{let s=e.slice();return s[s.length-1]=t,this.Mr(s,i,n,r,l)}}Ar(e,t=!1){return{Or:e.js,Nr:e.js,Fr:e.wt,Wr:e.wt,Hr:e.Wt[0],Ur:e.Wt[1],$r:e.Wt[2],qr:e.Wt[3],jr:e.jr??1,Yr:e.le,Er:t}}Sr(e){let t=this.Jr(e),i=this.Tr(e);return t.Qr!==i&&(t.Cr.clear(),t.Qr=i),t}Jr(e){let t=this.wr.get(e);return void 0===t&&(t={Qr:this.Tr(e),Cr:new Map},this.wr.set(e,t)),t}}class te extends eA{constructor(e){super(),this.ns=e}Qt(){return this.ns}}let tt={Bar:(e,t,i,s)=>{let r=t.upColor,n=t.downColor,l=ee(e(i,s)),a=et(l.Wt[0])<=et(l.Wt[3]);return{th:l.R??(a?r:n)}},Candlestick:(e,t,i,s)=>{let r=t.upColor,n=t.downColor,l=t.borderUpColor,a=t.borderDownColor,o=t.wickUpColor,h=t.wickDownColor,u=ee(e(i,s)),c=et(u.Wt[0])<=et(u.Wt[3]);return{th:u.R??(c?r:n),ih:u.Ht??(c?l:a),sh:u.nh??(c?o:h)}},Custom:(e,t,i,s)=>({th:ee(e(i,s)).R??t.color}),Area:(e,t,i,s)=>{let r=ee(e(i,s));return{th:r.vt??t.lineColor,vt:r.vt??t.lineColor,eh:r.eh??t.topColor,rh:r.rh??t.bottomColor}},Baseline:(e,t,i,s)=>{let r=ee(e(i,s));return{th:r.Wt[3]>=t.baseValue.price?t.topLineColor:t.bottomLineColor,hh:r.hh??t.topLineColor,ah:r.ah??t.bottomLineColor,oh:r.oh??t.topFillColor1,_h:r._h??t.topFillColor2,uh:r.uh??t.bottomFillColor1,dh:r.dh??t.bottomFillColor2}},Line:(e,t,i,s)=>{let r=ee(e(i,s));return{th:r.R??t.color,vt:r.R??t.color}},Histogram:(e,t,i,s)=>({th:ee(e(i,s)).R??t.color})};class ti{constructor(e){this.fh=(e,t)=>void 0!==t?t.Wt:this.ye.qs().ph(e),this.ye=e,this.mh=tt[e.wh()]}gh(e,t){return this.mh(this.fh,this.ye.N(),e,t)}}function ts(e,t,i,s,r=0,n=t.length){let l=n-r;for(;0<l;){let n=l>>1,a=r+n;s(t[a],i)===e?(r=a+1,l-=n+1):l=n}return r}let tr=ts.bind(null,!0),tn=ts.bind(null,!1);(a=M||(M={}))[a.NearestLeft=-1]="NearestLeft",a[a.None=0]="None",a[a.NearestRight=1]="NearestRight";class tl{constructor(){this.Mh=[],this.bh=new Map,this.Sh=new Map,this.xh=[]}Ch(){return this.yh()>0?this.Mh[this.Mh.length-1]:null}kh(){return this.yh()>0?this.Ph(0):null}sn(){return this.yh()>0?this.Ph(this.Mh.length-1):null}yh(){return this.Mh.length}Gi(){return 0===this.yh()}Ee(e){return null!==this.Th(e,0)}ph(e){return this.$s(e)}$s(e,t=0){let i=this.Th(e,t);return null===i?null:{...this.Rh(i),js:this.Ph(i)}}Dh(){return this.Mh}Ih(e,t,i){if(this.Gi())return null;let s=null;for(let r of i)s=ta(s,this.Vh(e,t,r));return s}ht(e){this.Sh.clear(),this.bh.clear(),this.Mh=e,this.xh=e.map(e=>e.js)}Bh(){return this.xh}Ph(e){return this.Mh[e].js}Rh(e){return this.Mh[e]}Th(e,t){let i=this.Eh(e);if(null===i&&0!==t)switch(t){case -1:return this.Ah(e);case 1:return this.Lh(e);default:throw TypeError("Unknown search mode")}return i}Ah(e){let t=this.zh(e);return t>0&&(t-=1),t!==this.Mh.length&&this.Ph(t)<e?t:null}Lh(e){let t=this.Oh(e);return t!==this.Mh.length&&e<this.Ph(t)?t:null}Eh(e){let t=this.zh(e);return t===this.Mh.length||e<this.Mh[t].js?null:t}zh(e){return tr(this.Mh,e,(e,t)=>e.js<t)}Oh(e){return tn(this.Mh,e,(e,t)=>e.js>t)}Nh(e,t,i){let s=null;for(let r=e;r<t;r++){let e=this.Mh[r].Wt[i];Number.isNaN(e)||(null===s?s={Fh:e,Wh:e}:(e<s.Fh&&(s.Fh=e),e>s.Wh&&(s.Wh=e)))}return s}Vh(e,t,i){if(this.Gi())return null;let s=null,r=ee(this.kh()),n=ee(this.sn()),l=Math.max(e,r),a=Math.min(t,n),o=30*Math.ceil(l/30),h=Math.max(o,30*Math.floor(a/30));{let e=this.zh(l),r=this.Oh(Math.min(a,o,t));s=ta(s,this.Nh(e,r,i))}let u=this.bh.get(i);void 0===u&&(u=new Map,this.bh.set(i,u));for(let e=Math.max(o+1,l);e<h;e+=30){let t=Math.floor(e/30),r=u.get(t);if(void 0===r){let e=this.zh(30*t),s=this.Oh((t+1)*30-1);r=this.Nh(e,s,i),u.set(t,r)}s=ta(s,r)}{let e=this.zh(h),t=this.Oh(a);s=ta(s,this.Nh(e,t,i))}return s}}function ta(e,t){return null===e?t:null===t?e:{Fh:Math.min(e.Fh,t.Fh),Wh:Math.max(e.Wh,t.Wh)}}let to={setLineStyle:X};class th{constructor(e){this.Hh=e}nt(e,t,i){this.Hh.draw(e,to)}Uh(e,t,i){this.Hh.drawBackground?.(e,to)}}class tu{constructor(e){this.Ln=null,this.$h=e}Tt(){let e=this.$h.renderer();if(null===e)return null;if(this.Ln?.qh===e)return this.Ln.jh;let t=new th(e);return this.Ln={qh:e,jh:t},t}Yh(){return this.$h.zOrder?.()??"normal"}}class tc{constructor(e){this.Kh=null,this.Zh=e}Gh(){return this.Zh}Ws(){this.Zh.updateAllViews?.()}Ys(){let e=this.Zh.paneViews?.()??[];if(this.Kh?.qh===e)return this.Kh.jh;let t=e.map(e=>new tu(e));return this.Kh={qh:e,jh:t},t}Qn(e,t){return this.Zh.hitTest?.(e,t)??null}}let td=class extends tc{ds(){return[]}};class tm{constructor(e){this.Hh=e}nt(e,t,i){this.Hh.draw(e,to)}Uh(e,t,i){this.Hh.drawBackground?.(e,to)}}class tp{constructor(e){this.Ln=null,this.$h=e}Tt(){let e=this.$h.renderer();if(null===e)return null;if(this.Ln?.qh===e)return this.Ln.jh;let t=new tm(e);return this.Ln={qh:e,jh:t},t}Yh(){return this.$h.zOrder?.()??"normal"}}function tf(e){return{ri:e.text(),Ei:e.coordinate(),Vi:e.fixedCoordinate?.(),R:e.textColor(),G:e.backColor(),It:e.visible?.()??!0,pi:e.tickVisible?.()??!0}}class tg{constructor(e,t){this.Xt=new eL,this.Xh=e,this.Jh=t}Tt(){return this.Xt.ht({ss:this.Jh.ss(),...tf(this.Xh)}),this.Xt}}class tv extends eR{constructor(e,t){super(),this.Xh=e,this.Ki=t}Yi(e,t,i){let s=tf(this.Xh);i.G=s.G,e.R=s.R;let r=2/12*this.Ki.k();i.Ti=r,i.Ri=r,i.Ei=s.Ei,i.Vi=s.Vi,e.ri=s.ri,e.It=s.It,e.pi=s.pi}}class tx extends tc{constructor(e,t){super(e),this.Qh=null,this.ta=null,this.ia=null,this.sa=null,this.ye=t}fs(){let e=this.Zh.timeAxisViews?.()??[];if(this.Qh?.qh===e)return this.Qh.jh;let t=this.ye.Qt().Et(),i=e.map(e=>new tg(e,t));return this.Qh={qh:e,jh:i},i}Ks(){let e=this.Zh.priceAxisViews?.()??[];if(this.ta?.qh===e)return this.ta.jh;let t=this.ye.Ft(),i=e.map(e=>new tv(e,t));return this.ta={qh:e,jh:i},i}na(){let e=this.Zh.priceAxisPaneViews?.()??[];if(this.ia?.qh===e)return this.ia.jh;let t=e.map(e=>new tp(e));return this.ia={qh:e,jh:t},t}ea(){let e=this.Zh.timeAxisPaneViews?.()??[];if(this.sa?.qh===e)return this.sa.jh;let t=e.map(e=>new tp(e));return this.sa={qh:e,jh:t},t}ra(e,t){return this.Zh.autoscaleInfo?.(e,t)??null}}function tw(e,t,i,s){e.forEach(e=>{t(e).forEach(e=>{e.Yh()===i&&s.push(e)})})}function tb(e){return e.Ys()}function ty(e){return e.na()}function tS(e){return e.ea()}let tj=["Area","Line","Baseline"];class tM extends te{constructor(e,t,i,s,r){super(e),this.jt=new tl,this._r=new e0(this),this.ha=[],this.aa=new eX(this),this.la=null,this.oa=null,this._a=null,this.ua=[],this.ca=new e7,this.da=new Map,this.fa=null,this.Ps=i,this.pa=t;const n=new e1(this);if(this.gs=[n],this.ur=new eJ(n,this,e),tj.includes(this.pa)&&(this.la=new eZ(this)),this.va(),this.$h=s(this,this.Qt(),r),"Custom"===this.pa){const e=this.$h;e.ma&&this.wa(e.ma)}}m(){null!==this._a&&clearTimeout(this._a)}Oe(e){return this.Ps.priceLineColor||e}Ve(e){let t,i,s={Be:!0},r=this.Ft();if(this.Qt().Et().Gi()||r.Gi()||this.jt.Gi())return s;let n=this.Qt().Et().Ie(),l=this.Lt();if(null===n||null===l)return s;if(e){let e=this.jt.Ch();if(null===e)return s;t=e,i=e.js}else{let e=this.jt.$s(n.bi(),-1);if(null===e||null===(t=this.jt.ph(e.js)))return s;i=e.js}let a=t.Wt[3],o=this.ga().gh(i,{Wt:t}),h=r.Nt(a,l.Wt);return{Be:!1,gt:a,ri:r.Ji(a,l.Wt),Ue:r.Ma(a),$e:r.ba(a,l.Wt),R:o.th,Ei:h,js:i}}ga(){return null!==this.oa||(this.oa=new ti(this)),this.oa}N(){return this.Ps}cr(e){let t=this.Qt(),{priceScaleId:i,visible:s,priceFormat:r}=e;void 0!==i&&i!==this.Ps.priceScaleId&&t.Sa(this,i),void 0!==s&&s!==this.Ps.visible&&t.xa();let n=void 0!==e.conflationThresholdFactor;es(this.Ps,e),n&&(this.da.clear(),this.Qt().dr()),void 0!==r&&(this.va(),t.Ca()),t.ya(this),t.ka(),this.$h.kt("options")}ht(e,t){this.jt.ht(e),this.da.clear();let i=this.Qt().Et().N();i.enableConflation&&i.precomputeConflationOnInit&&this.Pa(i.precomputeConflationPriority),this.$h.kt("data"),null!==this.la&&(t&&t.Ta?this.la.Pe():0===e.length&&this.la.ke());let s=this.Qt().Kn(this);this.Qt().Ra(s),this.Qt().ya(this),this.Qt().ka(),this.Qt().dr()}Da(e){let t=new e8(this,e);return this.ha.push(t),this.Qt().ya(this),t}Ia(e){let t=this.ha.indexOf(e);-1!==t&&this.ha.splice(t,1),this.Qt().ya(this)}Va(){return this.ha}wh(){return this.pa}Lt(){let e=this.Ba();return null===e?null:{Wt:e.Wt[3],Ea:e.wt}}Ba(){let e=this.Qt().Et().Ie();if(null===e)return null;let t=e.Aa();return this.jt.$s(t,1)}qs(){return this.jt}wa(e){this.fa=e,this.da.clear()}La(){return!!this.Qt().Et().N().enableConflation&&this.za()>1}kr(e){if(!this.La())return;let t=this.za();if(!this.da.has(t))return;let i="Custom"===this.pa,s=i&&this.fa||void 0,r=i&&this.$h.Oa?e=>{let t=this.$h.Oa(e);return Array.isArray(t)?t:["number"==typeof t?t:0]}:void 0,n=this.ca.kr(this.jt.Dh(),e,t,s,i,r),l=new tl;l.ht(n),this.da.set(t,l)}Na(){let e=this.Qt().Et().N().enableConflation;if("Custom"===this.pa&&null===this.fa||!e)return this.jt;let t=this.za(),i=this.da.get(t);return i||(this.Fa(t),this.da.get(t)??this.jt)}Wa(e){let t=this.jt.ph(e);return null===t?null:"Bar"===this.pa||"Candlestick"===this.pa||"Custom"===this.pa?{Hr:t.Wt[0],Ur:t.Wt[1],$r:t.Wt[2],qr:t.Wt[3]}:t.Wt[3]}Ha(e){let t=[];tw(this.ua,tb,"top",t);let i=this.la;return null!==i&&i.It()&&(null===this._a&&i.Re()&&(this._a=setTimeout(()=>{this._a=null,this.Qt().Ua()},0)),i.Te(),t.unshift(i)),t}Ys(){let e=[];this.$a()||e.push(this.aa),e.push(this.$h,this._r);let t=this.ha.map(e=>e.pr());return e.push(...t),tw(this.ua,tb,"normal",e),e}qa(){return this.ja(tb,"bottom")}Ya(e){return this.ja(ty,e)}Ka(e){return this.ja(tS,e)}Za(e,t){return this.ua.map(i=>i.Qn(e,t)).filter(e=>null!==e)}ds(){return[this.ur,...this.ha.map(e=>e.vr())]}Ks(e,t){if(t!==this.hs&&!this.$a())return[];let i=[...this.gs];for(let e of this.ha)i.push(e.mr());return this.ua.forEach(e=>{i.push(...e.Ks())}),i}fs(){let e=[];return this.ua.forEach(t=>{e.push(...t.fs())}),e}ra(e,t){if(void 0!==this.Ps.autoscaleInfoProvider){let i=this.Ps.autoscaleInfoProvider(()=>{let i=this.Ga(e,t);return null===i?null:i.tr()});return e5.ir(i)}return this.Ga(e,t)}qh(){let e=this.Ps.priceFormat;return e.base??1/e.minMove}Xa(){return this.Ja}Ws(){for(let e of(this.$h.kt(),this.gs))e.kt();for(let e of this.ha)e.kt();this._r.kt(),this.aa.kt(),this.la?.kt(),this.ua.forEach(e=>e.Ws())}Ft(){return ee(super.Ft())}At(e){if(!(("Line"===this.pa||"Area"===this.pa||"Baseline"===this.pa)&&this.Ps.crosshairMarkerVisible))return null;let t=this.jt.ph(e);return null===t?null:{gt:t.Wt[3],ft:this.Qa(),Ht:this.tl(),Ot:this.il(),zt:this.sl(e)}}Ne(){return this.Ps.title}It(){return this.Ps.visible}nl(e){this.ua.push(new tx(e,this))}el(e){this.ua=this.ua.filter(t=>t.Gh()!==e)}rl(){if("Custom"===this.pa)return e=>this.$h.Oa(e)}hl(){if("Custom"===this.pa)return e=>this.$h.al(e)}ll(){return this.jt.Bh()}$a(){return!ez(this.Ft().ol())}Ga(e,t){if(!en(e)||!en(t)||this.jt.Gi())return null;let i="Line"===this.pa||"Area"===this.pa||"Baseline"===this.pa||"Histogram"===this.pa?[3]:[2,1],s=this.jt.Ih(e,t,i),r=null!==s?new e3(s.Fh,s.Wh):null,n=null;if("Histogram"===this.wh()){let e=this.Ps.base,t=new e3(e,e);r=null!==r?r.Sn(t):t}return this.ua.forEach(i=>{let s=i.ra(e,t);if(s?.priceRange){let e=new e3(s.priceRange.minValue,s.priceRange.maxValue);r=null!==r?r.Sn(e):e}s?.margins&&(n=s.margins)}),new e5(r,n)}Qa(){switch(this.pa){case"Line":case"Area":case"Baseline":return this.Ps.crosshairMarkerRadius}return 0}tl(){switch(this.pa){case"Line":case"Area":case"Baseline":{let e=this.Ps.crosshairMarkerBorderColor;if(0!==e.length)return e}}return null}il(){switch(this.pa){case"Line":case"Area":case"Baseline":return this.Ps.crosshairMarkerBorderWidth}return 0}sl(e){switch(this.pa){case"Line":case"Area":case"Baseline":{let e=this.Ps.crosshairMarkerBackgroundColor;if(0!==e.length)return e}}return this.ga().gh(e).th}va(){switch(this.Ps.priceFormat.type){case"custom":{let e=this.Ps.priceFormat.formatter;this.Ja={format:e,formatTickmarks:this.Ps.priceFormat.tickmarksFormatter??(t=>t.map(e))};break}case"volume":this.Ja=new eV(this.Ps.priceFormat.precision);break;case"percent":this.Ja=new eW(this.Ps.priceFormat.precision);break;default:{let e=Math.pow(10,this.Ps.priceFormat.precision);this.Ja=new e$(e,this.Ps.priceFormat.minMove*e)}}null!==this.hs&&this.hs._l()}ja(e,t){let i=[];return tw(this.ua,e,t,i),i}za(){let{ul:e,cl:t,dl:i}=this.fl();return this.ca.gr(e,t,i)}fl(){let e=this.Qt().Et(),t=e.ul(),i=window.devicePixelRatio||1,s=e.N().conflationThresholdFactor;return{ul:t,cl:i,dl:this.Ps.conflationThresholdFactor??s??1}}pl(e){let t,i=this.jt.Dh();if("Custom"===this.pa&&null!==this.fa){let s=this.rl();if(!s)throw Error("Custom series with conflation reducer must have a priceValueBuilder method");t=this.ca.Mr(i,e,this.fa,!0,e=>s(e))}else t=this.ca.Mr(i,e);let s=new tl;return s.ht(t),s}Fa(e){let t=this.pl(e);this.da.set(e,t)}Pa(e){if("Custom"!==this.pa||null!==this.fa&&this.rl())for(let t of(this.da.clear(),this.Qt().Et().vl())){let i=()=>{this.ml(t)},s="object"==typeof window&&window||"object"==typeof self&&self;s?.gl?.wl?s.gl.wl(()=>{i()},{Ml:e}):Promise.resolve().then(()=>i())}}ml(e){if(this.da.has(e)||0===this.jt.Dh().length)return;let t=this.pl(e);this.da.set(e,t)}}let tC=[3],tN=[0,1,2,3];class tP{constructor(e){this.Ps=e}bl(e,t,i){if(0===this.Ps.mode)return e;let s=i.Rs(),r=s.Lt();if(null===r)return e;let n=s.Nt(e,r),l=i.Sl().filter(e=>e instanceof tM).reduce((e,s)=>{if(i.Zn(s)||!s.It())return e;let r=s.Ft(),n=s.qs();if(r.Gi()||!n.Ee(t))return e;let l=n.ph(t);if(null===l)return e;let a=et(s.Lt()),o=3===this.Ps.mode?tN:tC;return e.concat(o.map(e=>r.Nt(l.Wt[e],a.Wt)))},[]);if(0===l.length)return e;l.sort((e,t)=>Math.abs(e-n)-Math.abs(t-n));let a=l[0];return s.Ds(a,r)}}function tk(e,t,i){return Math.min(Math.max(e,t),i)}function tE(e){let t=Math.ceil(e);return t%2==0?t-1:t}class tR extends ex{constructor(){super(...arguments),this.jt=null}ht(e){this.jt=e}et({context:e,bitmapSize:t,horizontalPixelRatio:i,verticalPixelRatio:s}){var r;if(null===this.jt)return;let n=Math.max(1,Math.floor(i));e.lineWidth=n,r=()=>{let r=ee(this.jt);if(r.xl){for(let s of(e.strokeStyle=r.Cl,X(e,r.yl),e.beginPath(),r.kl)){let r=Math.round(s.Pl*i);e.moveTo(r,-n),e.lineTo(r,t.height+n)}e.stroke()}if(r.Tl){for(let i of(e.strokeStyle=r.Rl,X(e,r.Dl),e.beginPath(),r.Il)){let r=Math.round(i.Pl*s);e.moveTo(-n,r),e.lineTo(t.width+n,r)}e.stroke()}},e.save(),e.lineWidth%2&&e.translate(.5,.5),r(),e.restore()}}class t_{constructor(e){this.Xt=new tR,this.xt=!0,this.yt=e}kt(){this.xt=!0}Tt(){if(this.xt){let e=this.yt.Qt().N().grid,t={Tl:e.horzLines.visible,xl:e.vertLines.visible,Rl:e.horzLines.color,Cl:e.vertLines.color,Dl:e.horzLines.style,yl:e.vertLines.style,Il:this.yt.Rs().Vl(),kl:(this.yt.Qt().Et().Vl()||[]).map(e=>({Pl:e.coord}))};this.Xt.ht(t),this.xt=!1}return this.Xt}}class tT{constructor(e){this.$h=new t_(e)}pr(){return this.$h}}let tL={Bl:4,El:1e-4};function tI(e,t){let i=100*(e-t)/t;return t<0?-i:i}function tA(e,t){let i=100*(e-t)/t+100;return t<0?-i:i}function tF(e,t){let i=Math.abs(e);if(i<1e-15)return 0;let s=Math.log10(i+t.El)+t.Bl;return e<0?-s:s}function tz(e,t){let i=Math.abs(e);if(i<1e-15)return 0;let s=Math.pow(10,i-t.Bl)-t.El;return e<0?-s:s}function tD(e,t){return null===e?null:new e3(tF(e.Ze(),t),tF(e.Ge(),t))}function tO(e,t){return null===e?null:new e3(tz(e.Ze(),t),tz(e.Ge(),t))}function tB(e){if(null===e)return tL;let t=Math.abs(e.Ge()-e.Ze());if(t>=1||t<1e-15)return tL;let i=Math.ceil(Math.abs(Math.log10(t))),s=tL.Bl+i;return{Bl:s,El:1/Math.pow(10,s)}}class t${constructor(e,t){if(this.Al=e,this.Ll=t,function(e){if(e<0)return!1;if(e>1e18)return!0;for(let t=e;t>1;t/=10)if(t%10!=0)return!1;return!0}(this.Al))this.zl=[2,2.5,2];else{this.zl=[];for(let e=this.Al;1!==e;){if(e%2==0)this.zl.push(2),e/=2;else{if(e%5!=0)throw Error("unexpected base");this.zl.push(2,2.5),e/=5}if(this.zl.length>100)throw Error("something wrong with base")}}}Ol(e,t,i){let s=0===this.Al?0:1/this.Al,r=Math.pow(10,Math.max(0,Math.ceil(Math.log10(e-t)))),n=0,l=this.Ll[0];for(;;){let e=s-r<=1e-14&&r>s+1e-14,t=i*l-r<=1e-14,a=1-r<=1e-14;if(!(e&&t&&a))break;r/=l,l=this.Ll[++n%this.Ll.length]}if(r<=s+1e-14&&(r=s),r=Math.max(1,r),this.zl.length>0&&1e-14>Math.abs(r-1))for(n=0,l=this.zl[0];i*l-r<=1e-14&&r>s+1e-14;)r/=l,l=this.zl[++n%this.zl.length];return r}}class tW{constructor(e,t,i,s){this.Nl=[],this.Ki=e,this.Al=t,this.Fl=i,this.Wl=s}Ol(e,t){if(e<t)throw Error("high < low");let i=this.Ki.$t(),s=(e-t)*this.Hl()/i,r=new t$(this.Al,[2,2.5,2]),n=new t$(this.Al,[2,2,2.5]),l=new t$(this.Al,[2.5,2,2]),a=[];return a.push(r.Ol(e,t,s),n.Ol(e,t,s),l.Ol(e,t,s)),function(e){if(e.length<1)throw Error("array is empty");let t=e[0];for(let i=1;i<e.length;++i)e[i]<t&&(t=e[i]);return t}(a)}Ul(){let e=this.Ki,t=e.Lt();if(null===t)return void(this.Nl=[]);let i=e.$t(),s=this.Fl(i-1,t),r=this.Fl(0,t),n=this.Ki.N().entireTextOnly?this.$l()/2:0,l=i-1-n,a=Math.max(s,r),o=Math.min(s,r);if(a===o)return void(this.Nl=[]);let h=this.Ol(a,o);if(this.ql(t,h,a,o,n,l),e.jl()&&this.Yl(h,o,a)){let e=this.Ki.Kl();this.Zl(t,h,n,l,e,2*e)}let u=this.Nl.map(e=>e.Gl),c=this.Ki.Xl(u);for(let e=0;e<this.Nl.length;e++)this.Nl[e].Jl=c[e]}Vl(){return this.Nl}$l(){return this.Ki.k()}Hl(){return Math.ceil(2.5*this.$l())}ql(e,t,i,s,r,n){let l=this.Nl,a=this.Ki,o=i%t;o+=o<0?t:0;let h=i>=s?1:-1,u=null,c=0;for(let d=i-o;d>s;d-=t){let i=this.Wl(d,e,!0);null!==u&&Math.abs(i-u)<this.Hl()||i<r||i>n||(c<l.length?(l[c].Pl=i,l[c].Jl=a.Ql(d),l[c].Gl=d):l.push({Pl:i,Jl:a.Ql(d),Gl:d}),c++,u=i,a.io()&&(t=this.Ol(d*h,s)))}l.length=c}Zl(e,t,i,s,r,n){let l=this.Nl,a=this.so(e,i,r,n),o=this.so(e,s,-n,-r),h=this.Wl(0,e,!0)-this.Wl(t,e,!0);l.length>0&&l[0].Pl-a.Pl<h/2&&l.shift(),l.length>0&&o.Pl-l[l.length-1].Pl<h/2&&l.pop(),l.unshift(a),l.push(o)}so(e,t,i,s){let r=this.Fl(t+i,e),n=this.Fl(t+s,e),l=Math.min(r,n),a=Math.max(r,n),o=Math.max(.1,this.Ol(a,l)),h=this.Fl(t+(i+s)/2,e),u=h-h%o,c=this.Wl(u,e,!0);return{Jl:this.Ki.Ql(u),Pl:c,Gl:u}}Yl(e,t,i){let s=et(this.Ki.er());return this.Ki.io()&&(s=tO(s,this.Ki.no())),s.Ze()-t<e&&i-s.Ge()<e}}function tV(e){return e.slice().sort((e,t)=>ee(e._s())-ee(t._s()))}(o=C||(C={}))[o.Normal=0]="Normal",o[o.Logarithmic=1]="Logarithmic",o[o.Percentage=2]="Percentage",o[o.IndexedTo100=3]="IndexedTo100";let tK=new eW,tU=new e$(100,1);class tH{constructor(e,t,i,s,r){this.eo=0,this.ro=null,this.sr=null,this.ho=null,this.ao={lo:!1,oo:null},this._o=!1,this.uo=0,this.co=0,this.do=new ei,this.fo=new ei,this.po=[],this.vo=null,this.mo=null,this.wo=null,this.Mo=null,this.bo=null,this.Ja=tU,this.So=tB(null),this.xo=e,this.Ps=t,this.Co=i,this.yo=s,this.ko=r,this.Po=new tW(this,100,this.To.bind(this),this.Ro.bind(this))}ol(){return this.xo}N(){return this.Ps}cr(e){if(es(this.Ps,e),this._l(),void 0!==e.mode&&this.Do({ae:e.mode}),void 0!==e.scaleMargins){let t=Z(e.scaleMargins.top),i=Z(e.scaleMargins.bottom);if(t<0||t>1)throw Error(`Invalid top margin - expect value between 0 and 1, given=${t}`);if(i<0||i>1)throw Error(`Invalid bottom margin - expect value between 0 and 1, given=${i}`);if(t+i>1)throw Error(`Invalid margins - sum of margins must be less than 1, given=${t+i}`);this.Io(),this.wo=null}}Vo(){return this.Ps.autoScale}Bo(){return this._o}io(){return 1===this.Ps.mode}He(){return 2===this.Ps.mode}Eo(){return 3===this.Ps.mode}no(){return this.So}ae(){return{ln:this.Ps.autoScale,Ao:this.Ps.invertScale,ae:this.Ps.mode}}Do(e){let t=this.ae(),i=null;void 0!==e.ln&&(this.Ps.autoScale=e.ln),void 0!==e.ae&&(this.Ps.mode=e.ae,2!==e.ae&&3!==e.ae||(this.Ps.autoScale=!0),this.ao.lo=!1),1===t.ae&&e.ae!==t.ae&&(function(e,t){if(null===e)return!1;let i=tz(e.Ze(),t),s=tz(e.Ge(),t);return isFinite(i)&&isFinite(s)}(this.sr,this.So)?null!==(i=tO(this.sr,this.So))&&this.Lo(i):this.Ps.autoScale=!0),1===e.ae&&e.ae!==t.ae&&null!==(i=tD(this.sr,this.So))&&this.Lo(i);let s=t.ae!==this.Ps.mode;s&&(2===t.ae||this.He())&&this._l(),s&&(3===t.ae||this.Eo())&&this._l(),void 0!==e.Ao&&t.Ao!==e.Ao&&(this.Ps.invertScale=e.Ao,this.zo()),this.fo.p(t,this.ae())}Oo(){return this.fo}k(){return this.Co.fontSize}$t(){return this.eo}No(e){this.eo!==e&&(this.eo=e,this.Io(),this.wo=null)}Fo(){if(this.ro)return this.ro;let e=this.$t()-this.Wo()-this.Ho();return this.ro=e,e}er(){return this.Uo(),this.sr}Lo(e,t){let i=this.sr;(t||null===i&&null!==e||null!==i&&!i.Ye(e))&&(this.wo=null,this.sr=e)}$o(e){this.Lo(e),this.qo(null!==e)}Gi(){return this.Uo(),0===this.eo||!this.sr||this.sr.Gi()}jo(e){return this.Ao()?e:this.$t()-1-e}Nt(e,t){return this.He()?e=tI(e,t):this.Eo()&&(e=tA(e,t)),this.Ro(e,t)}Yo(e,t,i){this.Uo();let s=this.Ho(),r=ee(this.er()),n=r.Ze(),l=r.Ge(),a=this.Fo()-1,o=this.Ao(),h=a/(l-n),u=void 0===i?0:i.from,c=void 0===i?e.length:i.to,d=this.Ko();for(let i=u;i<c;i++){let r=e[i],l=r.gt;if(isNaN(l))continue;let a=l;null!==d&&(a=d(r.gt,t));let u=s+h*(a-n);r.ut=o?u:this.eo-1-u}}Zo(e,t,i){this.Uo();let s=this.Ho(),r=ee(this.er()),n=r.Ze(),l=r.Ge(),a=this.Fo()-1,o=this.Ao(),h=a/(l-n),u=void 0===i?0:i.from,c=void 0===i?e.length:i.to,d=this.Ko();for(let i=u;i<c;i++){let r=e[i],l=r.Hr,a=r.Ur,u=r.$r,c=r.qr;null!==d&&(l=d(r.Hr,t),a=d(r.Ur,t),u=d(r.$r,t),c=d(r.qr,t));let m=s+h*(l-n),p=o?m:this.eo-1-m;r.Go=p,m=s+h*(a-n),r.Xo=p=o?m:this.eo-1-m,m=s+h*(u-n),r.Jo=p=o?m:this.eo-1-m,m=s+h*(c-n),r.Qo=p=o?m:this.eo-1-m}}Ds(e,t){let i=this.To(e,t);return this.t_(i,t)}t_(e,t){var i,s;let r=e;return this.He()?(i=r,t<0&&(i=-i),r=i/100*t+t):this.Eo()&&(s=r-100,t<0&&(s=-s),r=s/100*t+t),r}Sl(){return this.po}Dt(){return this.mo||(this.mo=tV(this.po)),this.mo}i_(e){-1===this.po.indexOf(e)&&(this.po.push(e),this._l(),this.s_())}n_(e){let t=this.po.indexOf(e);if(-1===t)throw Error("source is not attached to scale");this.po.splice(t,1),0===this.po.length&&(this.Do({ln:!0}),this.Lo(null)),this._l(),this.s_()}Lt(){let e=null;for(let t of this.po){let i=t.Lt();null!==i&&(null===e||i.Ea<e.Ea)&&(e=i)}return null===e?null:e.Wt}Ao(){return this.Ps.invertScale}Vl(){let e=null===this.Lt();if(null!==this.wo&&(e||this.wo.e_===e))return this.wo.Vl;this.Po.Ul();let t=this.Po.Vl();return this.wo={Vl:t,e_:e},this.do.p(),t}r_(){return this.do}h_(e){this.He()||this.Eo()||null===this.Mo&&null===this.ho&&(this.Gi()||(this.Mo=this.eo-e,this.ho=ee(this.er()).Ke()))}a_(e){if(this.He()||this.Eo()||null===this.Mo)return;this.Do({ln:!1}),(e=this.eo-e)<0&&(e=0);let t=(this.Mo+.2*(this.eo-1))/(e+.2*(this.eo-1)),i=ee(this.ho).Ke();t=Math.max(t,.1),i.Je(t),this.Lo(i)}l_(){this.He()||this.Eo()||(this.Mo=null,this.ho=null)}o_(e){this.Vo()||null===this.bo&&null===this.ho&&(this.Gi()||(this.bo=e,this.ho=ee(this.er()).Ke()))}__(e){if(this.Vo()||null===this.bo)return;let t=ee(this.er()).Xe()/(this.Fo()-1),i=e-this.bo;this.Ao()&&(i*=-1);let s=i*t,r=ee(this.ho).Ke();r.Qe(s),this.Lo(r,!0),this.wo=null}u_(){this.Vo()||null!==this.bo&&(this.bo=null,this.ho=null)}Xa(){return this.Ja||this._l(),this.Ja}Ji(e,t){switch(this.Ps.mode){case 2:return this.c_(tI(e,t));case 3:return this.Xa().format(tA(e,t));default:return this.lr(e)}}Ql(e){switch(this.Ps.mode){case 2:return this.c_(e);case 3:return this.Xa().format(e);default:return this.lr(e)}}Xl(e){switch(this.Ps.mode){case 2:return this.d_(e);case 3:return this.Xa().formatTickmarks(e);default:return this.f_(e)}}Ma(e){return this.lr(e,ee(this.vo).Xa())}ba(e,t){return e=tI(e,t),this.c_(e,tK)}p_(){return this.po}v_(e){this.ao={oo:e,lo:!1}}Ws(){this.po.forEach(e=>e.Ws())}jl(){return this.Ps.ensureEdgeTickMarksVisible&&this.Vo()}Kl(){return this.k()/2}_l(){this.wo=null;let e=1/0;for(let t of(this.vo=null,this.po))t._s()<e&&(e=t._s(),this.vo=t);let t=100;null!==this.vo&&(t=Math.round(this.vo.qh())),this.Ja=tU,this.He()?(this.Ja=tK,t=100):this.Eo()?(this.Ja=new e$(100,1),t=100):null!==this.vo&&(this.Ja=this.vo.Xa()),this.Po=new tW(this,t,this.To.bind(this),this.Ro.bind(this)),this.Po.Ul()}s_(){this.mo=null}m_(){return null===this.vo||this.He()||this.Eo()?1:1/this.vo.qh()}Xi(){return this.ko}qo(e){this._o=e}Wo(){return this.Ao()?this.Ps.scaleMargins.bottom*this.$t()+this.co:this.Ps.scaleMargins.top*this.$t()+this.uo}Ho(){return this.Ao()?this.Ps.scaleMargins.top*this.$t()+this.uo:this.Ps.scaleMargins.bottom*this.$t()+this.co}Uo(){this.ao.lo||(this.ao.lo=!0,this.w_())}Io(){this.ro=null}Ro(e,t){if(this.Uo(),this.Gi())return 0;e=this.io()&&e?tF(e,this.So):e;let i=ee(this.er()),s=this.Ho()+(this.Fo()-1)*(e-i.Ze())/i.Xe();return this.jo(s)}To(e,t){if(this.Uo(),this.Gi())return 0;let i=this.jo(e),s=ee(this.er()),r=s.Ze()+s.Xe()*((i-this.Ho())/(this.Fo()-1));return this.io()?tz(r,this.So):r}zo(){this.wo=null,this.Po.Ul()}w_(){var e,t,i,s,r;if(this.Bo()&&!this.Vo())return;let n=this.ao.oo;if(null===n)return;let l=null,a=this.p_(),o=0,h=0;for(let e of a){if(!e.It())continue;let a=e.Lt();if(null===a)continue;let u=e.ra(n.Aa(),n.bi()),c=u&&u.er();if(null!==c){switch(this.Ps.mode){case 1:c=tD(c,this.So);break;case 2:t=c,i=a.Wt,c=new e3(tI(t.Ze(),i),tI(t.Ge(),i));break;case 3:s=c,r=a.Wt,c=new e3(tA(s.Ze(),r),tA(s.Ge(),r))}if(l=null===l?c:l.Sn(ee(c)),null!==u){let e=u.rr();null!==e&&(o=Math.max(o,e.above),h=Math.max(h,e.below))}}}if(this.jl()&&(o=Math.max(o,this.Kl()),h=Math.max(h,this.Kl())),o===this.uo&&h===this.co||(this.uo=o,this.co=h,this.wo=null,this.Io()),null!==l){if(l.Ze()===l.Ge()){let e=5*this.m_();this.io()&&(l=tO(l,this.So)),l=new e3(l.Ze()-e,l.Ge()+e),this.io()&&(l=tD(l,this.So))}if(this.io()){let t=tO(l,this.So),i=tB(t);if(e=this.So,i.Bl!==e.Bl||i.El!==e.El){let e=null!==this.ho?tO(this.ho,this.So):null;this.So=i,l=tD(t,i),null!==e&&(this.ho=tD(e,i))}}this.Lo(l)}else null===this.sr&&(this.Lo(new e3(-.5,.5)),this.So=tB(null))}Ko(){return this.He()?tI:this.Eo()?tA:this.io()?e=>tF(e,this.So):null}g_(e,t,i){return void 0===t?(void 0===i&&(i=this.Xa()),i.format(e)):t(e)}M_(e,t,i){return void 0===t?(void 0===i&&(i=this.Xa()),i.formatTickmarks(e)):t(e)}lr(e,t){return this.g_(e,this.yo.priceFormatter,t)}f_(e,t){let i=this.yo.priceFormatter;return this.M_(e,this.yo.tickmarksPriceFormatter??(i?e=>e.map(i):void 0),t)}c_(e,t){return this.g_(e,this.yo.percentageFormatter,t)}d_(e,t){let i=this.yo.percentageFormatter;return this.M_(e,this.yo.tickmarksPercentageFormatter??(i?e=>e.map(i):void 0),t)}}function tJ(e){return e instanceof tM}class tq{constructor(e,t){this.po=[],this.b_=new Map,this.eo=0,this.S_=0,this.x_=1,this.mo=null,this.C_=!1,this.y_=new ei,this.ua=[],this.Jh=e,this.ns=t,this.k_=new tT(this);const i=t.N();this.P_=this.T_("left",i.leftPriceScale),this.R_=this.T_("right",i.rightPriceScale),this.P_.Oo().i(this.D_.bind(this,this.P_),this),this.R_.Oo().i(this.D_.bind(this,this.R_),this),this.I_(i)}I_(e){if(e.leftPriceScale&&this.P_.cr(e.leftPriceScale),e.rightPriceScale&&this.R_.cr(e.rightPriceScale),e.localization&&(this.P_._l(),this.R_._l()),e.overlayPriceScales)for(let t of Array.from(this.b_.values())){let i=ee(t[0].Ft());i.cr(e.overlayPriceScales),e.localization&&i._l()}}V_(e){switch(e){case"left":return this.P_;case"right":return this.R_}return this.b_.has(e)?Z(this.b_.get(e))[0].Ft():null}m(){this.Qt().B_().u(this),this.P_.Oo().u(this),this.R_.Oo().u(this),this.po.forEach(e=>{e.m&&e.m()}),this.ua=this.ua.filter(e=>{let t=e.Gh();return t.detached&&t.detached(),!1}),this.y_.p()}E_(){return this.x_}A_(e){this.x_=e}Qt(){return this.ns}ss(){return this.S_}$t(){return this.eo}L_(e){this.S_=e,this.z_()}No(e){this.eo=e,this.P_.No(e),this.R_.No(e),this.po.forEach(t=>{if(this.Zn(t)){let i=t.Ft();null!==i&&i.No(e)}}),this.z_()}O_(e){this.C_=e}N_(){return this.C_}F_(){return this.po.filter(tJ)}Sl(){return this.po}Zn(e){let t=e.Ft();return null===t||this.P_!==t&&this.R_!==t}i_(e,t,i){this.W_(e,t,i?e._s():this.po.length)}n_(e,t){let i=this.po.indexOf(e);Q(-1!==i,"removeDataSource: invalid data source"),this.po.splice(i,1),t||this.po.forEach((e,t)=>e.us(t));let s=ee(e.Ft()).ol();if(this.b_.has(s)){let t=Z(this.b_.get(s)),i=t.indexOf(e);-1!==i&&(t.splice(i,1),0===t.length&&this.b_.delete(s))}let r=e.Ft();r&&r.Sl().indexOf(e)>=0&&(r.n_(e),this.H_(r)),this.mo=null}Xn(e){return e===this.P_?"left":e===this.R_?"right":"overlay"}U_(){return this.P_}q_(){return this.R_}j_(e,t){e.h_(t)}Y_(e,t){e.a_(t),this.z_()}K_(e){e.l_()}Z_(e,t){e.o_(t)}G_(e,t){e.__(t),this.z_()}X_(e){e.u_()}z_(){this.po.forEach(e=>{e.Ws()})}Rs(){let e=null;return this.ns.N().rightPriceScale.visible&&0!==this.R_.Sl().length?e=this.R_:this.ns.N().leftPriceScale.visible&&0!==this.P_.Sl().length?e=this.P_:0!==this.po.length&&(e=this.po[0].Ft()),null===e&&(e=this.R_),e}Gn(){let e=null;return this.ns.N().rightPriceScale.visible?e=this.R_:this.ns.N().leftPriceScale.visible&&(e=this.P_),e}H_(e){null!==e&&e.Vo()&&this.J_(e)}Q_(e){let t=this.Jh.Ie();e.Do({ln:!0}),null!==t&&e.v_(t),this.z_()}tu(){this.J_(this.P_),this.J_(this.R_)}iu(){this.H_(this.P_),this.H_(this.R_),this.po.forEach(e=>{this.Zn(e)&&this.H_(e.Ft())}),this.z_(),this.ns.dr()}Dt(){return null===this.mo&&(this.mo=tV(this.po)),this.mo}su(e,t){t=tk(t,0,this.po.length-1);let i=this.po.indexOf(e);for(let s of(Q(-1!==i,"setSeriesOrder: invalid data source"),this.po.splice(i,1),this.po.splice(t,0,e),this.po.forEach((e,t)=>e.us(t)),this.mo=null,[this.P_,this.R_]))s.s_(),s._l();this.ns.dr()}Vt(){return this.Dt().filter(tJ)}nu(){return this.y_}eu(){return this.k_}nl(e){this.ua.push(new td(e))}el(e){this.ua=this.ua.filter(t=>t.Gh()!==e),e.detached&&e.detached(),this.ns.dr()}ru(){return this.ua}Za(e,t){return this.ua.map(i=>i.Qn(e,t)).filter(e=>null!==e)}J_(e){let t=e.p_();if(t&&t.length>0&&!this.Jh.Gi()){let t=this.Jh.Ie();null!==t&&e.v_(t)}e.Ws()}W_(e,t,i){let s=this.V_(t);if(null===s&&(s=this.T_(t,this.ns.N().overlayPriceScales)),this.po.splice(i,0,e),!ez(t)){let i=this.b_.get(t)||[];i.push(e),this.b_.set(t,i)}e.us(i),s.i_(e),e.cs(s),this.H_(s),this.mo=null}D_(e,t,i){t.ae!==i.ae&&this.J_(e)}T_(e,t){let i=new tH(e,{visible:!0,autoScale:!0,...eo(t)},this.ns.N().layout,this.ns.N().localization,this.ns.Xi());return i.No(this.$t()),i}}function tY(e){return{hu:e.hu,au:{te:e.lu.externalId},ou:e.lu.cursorStyle}}function tX(e,t,i){let s=[e,...e.Dt()],r=function(e,t,i){var s,r;let n,l;for(let a of e)for(let e of a.Za?.(t,i)??[])s=e.zOrder,(r=n?.zOrder)&&("top"!==s||"top"===r)&&("normal"!==s||"bottom"!==r)||(n=e,l=a);return n&&l?{lu:n,hu:l}:null}(s,t,i);if("top"===r?.lu.zOrder)return tY(r);for(let n of s){if(r&&r.hu===n&&"bottom"!==r.lu.zOrder&&!r.lu.isBackground)return tY(r);if(void 0!==n.Ys){let s=function(e,t,i,s){for(let r of e){let e=r.Tt(s);if(null!==e&&e.Qn){let s=e.Qn(t,i);if(null!==s)return{_u:r,au:s}}}return null}(n.Ys(e),t,i,e);if(null!==s)return{hu:n,_u:s._u,au:s.au}}if(r&&r.hu===n&&"bottom"!==r.lu.zOrder&&r.lu.isBackground)return tY(r)}return r?.lu?tY(r):null}class tG{constructor(e,t,i=50){this.Vn=0,this.Bn=1,this.En=1,this.Ln=new Map,this.An=new Map,this.uu=e,this.cu=t,this.zn=i}du(e){let t=e.time,i=this.cu.cacheKey(t),s=this.Ln.get(i);if(void 0!==s)return s.fu;if(this.Vn===this.zn){let e=this.An.get(this.En);this.An.delete(this.En),this.Ln.delete(Z(e)),this.En++,this.Vn--}let r=this.uu(e);return this.Ln.set(i,{fu:r,Wn:this.Bn}),this.An.set(this.Bn,i),this.Vn++,this.Bn++,r}}class tQ{constructor(e,t){Q(e<=t,"right should be >= left"),this.pu=e,this.vu=t}Aa(){return this.pu}bi(){return this.vu}mu(){return this.vu-this.pu+1}Ee(e){return this.pu<=e&&e<=this.vu}Ye(e){return this.pu===e.Aa()&&this.vu===e.bi()}}function tZ(e,t){return null===e||null===t?e===t:e.Ye(t)}class t0{constructor(){this.wu=new Map,this.Ln=null,this.gu=!1}Mu(e){this.gu=e,this.Ln=null}bu(e,t){this.Su(t),this.Ln=null;for(let i=t;i<e.length;++i){let t=e[i],s=this.wu.get(t.timeWeight);void 0===s&&(s=[],this.wu.set(t.timeWeight,s)),s.push({index:i,time:t.time,weight:t.timeWeight,originalTime:t.originalTime})}}xu(e,t,i,s,r){let n=Math.ceil(t/e);return null!==this.Ln&&this.Ln.Cu===n&&r===this.Ln.yu&&i===this.Ln.ku||(this.Ln={yu:r,ku:i,Vl:this.Pu(n,i,s),Cu:n}),this.Ln.Vl}Su(e){if(0===e)return void this.wu.clear();let t=[];for(let i of(this.wu.forEach((i,s)=>{e<=i[0].index?t.push(s):i.splice(tr(i,e,t=>t.index<e),1/0)}),t))this.wu.delete(i)}Pu(e,t,i){let s=[],r=e=>!t||i.has(e.index);for(let t of Array.from(this.wu.keys()).sort((e,t)=>t-e)){if(!this.wu.get(t))continue;let i=s;s=[];let n=i.length,l=0,a=Z(this.wu.get(t)),o=a.length,h=1/0,u=-1/0;for(let t=0;t<o;t++){let o=a[t],c=o.index;for(;l<n;){let e=i[l],t=e.index;if(!(t<c&&r(e))){h=t;break}l++,s.push(e),u=t,h=1/0}if(h-c>=e&&c-u>=e&&r(o))s.push(o),u=c;else if(this.gu)return i}for(;l<n;l++)r(i[l])&&s.push(i[l])}return s}}class t1{constructor(e){this.Tu=e}Ru(){return null===this.Tu?null:new tQ(Math.floor(this.Tu.Aa()),Math.ceil(this.Tu.bi()))}Du(){return this.Tu}static Iu(){return new t1(null)}}function t2(e,t){return e.weight>t.weight?e:t}class t3{constructor(e,t,i,s){this.S_=0,this.Vu=null,this.Bu=[],this.bo=null,this.Mo=null,this.Eu=new t0,this.Au=new Map,this.Lu=t1.Iu(),this.zu=!0,this.Ou=new ei,this.Nu=new ei,this.Fu=new ei,this.Wu=null,this.Hu=null,this.Uu=new Map,this.$u=-1,this.qu=[],this.ju=1,this.Ps=t,this.yo=i,this.Yu=t.rightOffset,this.Ku=t.barSpacing,this.ns=e,this.Zu(t),this.cu=s,this.Gu(),this.Eu.Mu(t.uniformDistribution),this.Xu(),this.Ju()}N(){return this.Ps}Qu(e){es(this.yo,e),this.tc(),this.Gu()}cr(e,t){es(this.Ps,e),this.Ps.fixLeftEdge&&this.sc(),this.Ps.fixRightEdge&&this.nc(),void 0!==e.barSpacing&&this.ns.gn(e.barSpacing),void 0!==e.rightOffset&&this.ns.Mn(e.rightOffset),this.Zu(e),void 0===e.minBarSpacing&&void 0===e.maxBarSpacing||this.ns.gn(e.barSpacing??this.Ku),void 0!==e.ignoreWhitespaceIndices&&e.ignoreWhitespaceIndices!==this.Ps.ignoreWhitespaceIndices&&this.Ju(),this.tc(),this.Gu(),void 0===e.enableConflation&&void 0===e.conflationThresholdFactor||this.Xu(),this.Fu.p()}Is(e){return this.Bu[e]?.time??null}es(e){return this.Bu[e]??null}ec(e,t){if(this.Bu.length<1)return null;if(this.cu.key(e)>this.cu.key(this.Bu[this.Bu.length-1].time))return t?this.Bu.length-1:null;let i=tr(this.Bu,this.cu.key(e),(e,t)=>this.cu.key(e.time)<t);return this.cu.key(e)<this.cu.key(this.Bu[i].time)?t?i:null:i}Gi(){return 0===this.S_||0===this.Bu.length||null===this.Vu}rc(){return this.Bu.length>0}Ie(){return this.hc(),this.Lu.Ru()}ac(){return this.hc(),this.Lu.Du()}lc(){let e=this.Ie();if(null===e)return null;let t={from:e.Aa(),to:e.bi()};return this.oc(t)}oc(e){let t=Math.round(e.from),i=Math.round(e.to),s=ee(this._c()),r=ee(this.uc());return{from:ee(this.es(Math.max(s,t))),to:ee(this.es(Math.min(r,i)))}}cc(e){return{from:ee(this.ec(e.from,!0)),to:ee(this.ec(e.to,!0))}}ss(){return this.S_}L_(e){if(!isFinite(e)||e<=0||this.S_===e)return;let t=this.ac(),i=this.S_;if(this.S_=e,this.zu=!0,this.Ps.lockVisibleTimeRangeOnResize&&0!==i){let t=this.Ku*e/i;this.Ku=t}this.Ps.fixLeftEdge&&null!==t&&0>=t.Aa()&&(this.Yu-=Math.round((i-e)/this.Ku)+1,this.zu=!0),this.dc(),this.fc()}qt(e){if(this.Gi()||!en(e))return 0;let t=this.vc()+this.Yu-e;return this.S_-(t+.5)*this.Ku-1}mc(e,t){let i=this.vc(),s=void 0===t?0:t.from,r=void 0===t?e.length:t.to;for(let t=s;t<r;t++){let s=e[t].wt,r=i+this.Yu-s,n=this.S_-(r+.5)*this.Ku-1;e[t]._t=n}}wc(e,t){let i=Math.ceil(this.gc(e));return t&&this.Ps.ignoreWhitespaceIndices&&!this.Mc(i)?this.bc(i):i}Mn(e){this.zu=!0,this.Yu=e,this.fc(),this.ns.Sc(),this.ns.dr()}ul(){return this.Ku}gn(e){let t=this.Ku;if(this.xc(e),void 0!==this.Ps.rightOffsetPixels&&0!==t){let e=this.Yu*t/this.Ku;this.Yu=e}this.fc(),this.ns.Sc(),this.ns.dr()}Cc(){return this.Yu}Vl(){if(this.Gi())return null;if(null!==this.Hu)return this.Hu;let e=this.Ku,t=5*(this.ns.N().layout.fontSize+4)/8*(this.Ps.tickMarkMaxCharacterLength||8),i=Math.round(t/e),s=ee(this.Ie()),r=Math.max(s.Aa(),s.Aa()-i),n=Math.max(s.bi(),s.bi()-i),l=this.Eu.xu(e,t,this.Ps.ignoreWhitespaceIndices,this.Uu,this.$u),a=this._c()+i,o=this.uc()-i,h=this.yc(),u=this.Ps.fixLeftEdge||h,c=this.Ps.fixRightEdge||h,d=0;for(let e of l){let i;r<=e.index&&e.index<=n&&(d<this.qu.length?((i=this.qu[d]).coord=this.qt(e.index),i.label=this.kc(e),i.weight=e.weight):(i={needAlignCoordinate:!1,coord:this.qt(e.index),label:this.kc(e),weight:e.weight},this.qu.push(i)),this.Ku>t/2&&!h?i.needAlignCoordinate=!1:i.needAlignCoordinate=u&&e.index<=a||c&&e.index>=o,d++)}return this.qu.length=d,this.Hu=this.qu,this.qu}Pc(){let e;this.zu=!0,this.gn(this.Ps.barSpacing),e=void 0!==this.Ps.rightOffsetPixels?this.Ps.rightOffsetPixels/this.ul():this.Ps.rightOffset,this.Mn(e)}Tc(e){this.zu=!0,this.Vu=e,this.fc(),this.sc()}Rc(e,t){let i=this.gc(e),s=this.ul();this.gn(s+s/10*t),this.Ps.rightBarStaysOnScroll||this.Mn(this.Cc()+(i-this.gc(e)))}h_(e){this.bo&&this.u_(),null===this.Mo&&null===this.Wu&&(this.Gi()||(this.Mo=e,this.Dc()))}a_(e){if(null===this.Wu)return;let t=tk(this.S_-e,0,this.S_),i=tk(this.S_-ee(this.Mo),0,this.S_);0!==t&&0!==i&&this.gn(this.Wu.ul*t/i)}l_(){null!==this.Mo&&(this.Mo=null,this.Ic())}o_(e){null===this.bo&&null===this.Wu&&(this.Gi()||(this.bo=e,this.Dc()))}__(e){if(null===this.bo)return;let t=(this.bo-e)/this.ul();this.Yu=ee(this.Wu).Cc+t,this.zu=!0,this.fc()}u_(){null!==this.bo&&(this.bo=null,this.Ic())}Vc(){this.Bc(this.Ps.rightOffset)}Bc(e,t=400){if(!isFinite(e))throw RangeError("offset is required and must be finite number");if(!isFinite(t)||t<=0)throw RangeError("animationDuration (optional) must be finite positive number");let i=this.Yu,s=performance.now();this.ns.vn({Ec:e=>(e-s)/t>=1,Ac:r=>{let n=(r-s)/t;return n>=1?e:i+(e-i)*n}})}kt(e,t){this.zu=!0,this.Bu=e,this.Eu.bu(e,t),this.fc()}Lc(){return this.Ou}zc(){return this.Nu}Oc(){return this.Fu}vc(){return this.Vu||0}Nc(e,t){let i=e.mu(),s=t&&this.Ps.rightOffsetPixels||0;this.xc((this.S_-s)/i),this.Yu=e.bi()-this.vc(),t&&(this.Yu=s?s/this.ul():this.Ps.rightOffset),this.fc(),this.zu=!0,this.ns.Sc(),this.ns.dr()}Fc(){let e=this._c(),t=this.uc();if(null===e||null===t)return;let i=!this.Ps.rightOffsetPixels&&this.Ps.rightOffset||0;this.Nc(new tQ(e,t+i),!0)}Wc(e){let t=new tQ(e.from,e.to);this.Nc(t)}rs(e){return void 0!==this.yo.timeFormatter?this.yo.timeFormatter(e.originalTime):this.cu.formatHorzItem(e.time)}Ju(){if(this.Ps.ignoreWhitespaceIndices){for(let e of(this.Uu.clear(),this.ns.tn()))for(let t of e.ll())this.Uu.set(t,!0);this.$u++}}Hc(){return this.ju}vl(){let e=1/(window.devicePixelRatio||1),t=this.Ps.minBarSpacing;if(t>=e)return[1];let i=[1],s=2;for(;s<=512;)t<e/s&&i.push(s),s*=2;return i}yc(){let e=this.ns.N().handleScroll,t=this.ns.N().handleScale;return!(e.horzTouchDrag||e.mouseWheel||e.pressedMouseMove||e.vertTouchDrag||t.axisDoubleClickReset.time||t.axisPressedMouseMove.time||t.mouseWheel||t.pinch)}_c(){return 0===this.Bu.length?null:0}uc(){return 0===this.Bu.length?null:this.Bu.length-1}Uc(e){return(this.S_-1-e)/this.Ku}gc(e){let t=this.Uc(e);return Math.round(1e6*(this.vc()+this.Yu-t))/1e6}xc(e){let t=this.Ku;this.Ku=e,this.dc(),t!==this.Ku&&(this.zu=!0,this.$c(),this.Xu())}hc(){if(!this.zu)return;if(this.zu=!1,this.Gi())return void this.qc(t1.Iu());let e=this.vc(),t=this.S_/this.Ku,i=this.Yu+e,s=new tQ(i-t+1,i);this.qc(new t1(s))}dc(){let e=tk(this.Ku,this.jc(),this.Yc());this.Ku!==e&&(this.Ku=e,this.zu=!0)}Yc(){return this.Ps.maxBarSpacing>0?this.Ps.maxBarSpacing:.5*this.S_}jc(){return this.Ps.fixLeftEdge&&this.Ps.fixRightEdge&&0!==this.Bu.length?this.S_/this.Bu.length:this.Ps.minBarSpacing}Xu(){if(!this.Ps.enableConflation)return void(this.ju=1);let e=1/(window.devicePixelRatio||1)*(this.Ps.conflationThresholdFactor??1);if(this.Ku>=e)return void(this.ju=1);let t=Math.pow(2,Math.floor(Math.log2(e/this.Ku)));this.ju=Math.min(t,512)}fc(){let e=this.Kc();null!==e&&this.Yu<e&&(this.Yu=e,this.zu=!0);let t=this.Zc();this.Yu>t&&(this.Yu=t,this.zu=!0)}Kc(){let e=this._c(),t=this.Vu;return null===e||null===t?null:e-t-1+(this.Ps.fixLeftEdge?this.S_/this.Ku:Math.min(2,this.Bu.length))}Zc(){return this.Ps.fixRightEdge?0:this.S_/this.Ku-Math.min(2,this.Bu.length)}Dc(){this.Wu={ul:this.ul(),Cc:this.Cc()}}Ic(){this.Wu=null}kc(e){let t=this.Au.get(e.weight);return void 0===t&&(t=new tG(e=>this.Gc(e),this.cu),this.Au.set(e.weight,t)),t.du(e)}Gc(e){return this.cu.formatTickmark(e,this.yo)}qc(e){let t=this.Lu;this.Lu=e,tZ(t.Ru(),this.Lu.Ru())||this.Ou.p(),tZ(t.Du(),this.Lu.Du())||this.Nu.p(),this.$c()}$c(){this.Hu=null}tc(){this.$c(),this.Au.clear()}Gu(){this.cu.updateFormatter(this.yo)}sc(){if(!this.Ps.fixLeftEdge)return;let e=this._c();if(null===e)return;let t=this.Ie();if(null===t)return;let i=t.Aa()-e;if(i<0){let e=this.Yu-i-1;this.Mn(e)}this.dc()}nc(){this.fc(),this.dc()}Mc(e){return!this.Ps.ignoreWhitespaceIndices||this.Uu.get(e)||!1}bc(e){let t=function*(e){let t=Math.round(e),i=t<e,s=1;for(;;)i?(yield t+s,yield t-s):(yield t-s,yield t+s),s++}(e),i=this.uc();for(;i;){let e=t.next().value;if(this.Uu.get(e))return e;if(e<0||e>i)break}return e}Zu(e){if(void 0!==e.rightOffsetPixels){let t=e.rightOffsetPixels/(e.barSpacing||this.Ku);this.ns.Mn(t)}}}(h=N||(N={}))[h.OnTouchEnd=0]="OnTouchEnd",h[h.OnNextTap=1]="OnNextTap";class t5{constructor(e,t,i){this.Xc=[],this.Jc=[],this.Qc=null,this.S_=0,this.td=null,this.sd=new ei,this.nd=new ei,this.ed=null,this.rd=e,this.Ps=t,this.cu=i,this.ko=new eg(this.Ps.layout.colorParsers),this.hd=new em(this),this.Jh=new t3(this,t.timeScale,this.Ps.localization,i),this.Ct=new eF(this,t.crosshair),this.ad=new tP(t.crosshair),t.addDefaultPane&&(this.ld(0),this.Xc[0].A_(2)),this.od=this._d(0),this.ud=this._d(1)}Ca(){this.dd(eD.yn())}dr(){this.dd(eD.Cn())}Ua(){this.dd(new eD(1))}ya(e){let t=this.fd(e);this.dd(t)}pd(){return this.td}vd(e){if(this.td?.hu===e?.hu&&this.td?.au?.te===e?.au?.te)return;let t=this.td;this.td=e,null!==t&&this.ya(t.hu),null!==e&&e.hu!==t?.hu&&this.ya(e.hu)}N(){return this.Ps}cr(e){es(this.Ps,e),this.Xc.forEach(t=>t.I_(e)),void 0!==e.timeScale&&this.Jh.cr(e.timeScale),void 0!==e.localization&&this.Jh.Qu(e.localization),(e.leftPriceScale||e.rightPriceScale)&&this.sd.p(),this.od=this._d(0),this.ud=this._d(1),this.Ca()}md(e,t,i=0){let s=this.Xc[i];if(void 0===s)return;if("left"===e)return es(this.Ps,{leftPriceScale:t}),s.I_({leftPriceScale:t}),this.sd.p(),void this.Ca();if("right"===e)return es(this.Ps,{rightPriceScale:t}),s.I_({rightPriceScale:t}),this.sd.p(),void this.Ca();let r=this.wd(e,i);null!==r&&(r.Ft.cr(t),this.sd.p())}wd(e,t){let i=this.Xc[t];if(void 0===i)return null;let s=i.V_(e);return null!==s?{Gs:i,Ft:s}:null}Et(){return this.Jh}Xs(){return this.Xc}gd(){return this.Ct}Md(){return this.nd}bd(e,t){e.No(t),this.Sc()}L_(e){this.S_=e,this.Jh.L_(this.S_),this.Xc.forEach(t=>t.L_(e)),this.Sc()}Sd(e){1!==this.Xc.length&&(Q(e>=0&&e<this.Xc.length,"Invalid pane index"),this.Xc.splice(e,1),this.Ca())}xd(e,t){if(this.Xc.length<2)return;Q(e>=0&&e<this.Xc.length,"Invalid pane index");let i=this.Xc[e],s=this.Xc.reduce((e,t)=>e+t.E_(),0),r=this.Xc.reduce((e,t)=>e+t.$t(),0),n=r-30*(this.Xc.length-1);t=Math.min(n,Math.max(30,t));let l=s/r,a=i.$t();i.A_(t*l);let o=t-a,h=this.Xc.length-1;for(let e of this.Xc)if(e!==i){let t=Math.min(n,Math.max(30,e.$t()-o/h));o-=e.$t()-t,h-=1;let i=t*l;e.A_(i)}this.Ca()}Cd(e,t){Q(e>=0&&e<this.Xc.length&&t>=0&&t<this.Xc.length,"Invalid pane index");let i=this.Xc[e],s=this.Xc[t];this.Xc[e]=s,this.Xc[t]=i,this.Ca()}yd(e,t){if(Q(e>=0&&e<this.Xc.length&&t>=0&&t<this.Xc.length,"Invalid pane index"),e===t)return;let[i]=this.Xc.splice(e,1);this.Xc.splice(t,0,i),this.Ca()}j_(e,t,i){e.j_(t,i)}Y_(e,t,i){e.Y_(t,i),this.ka(),this.dd(this.kd(e,2))}K_(e,t){e.K_(t),this.dd(this.kd(e,2))}Z_(e,t,i){t.Vo()||e.Z_(t,i)}G_(e,t,i){t.Vo()||(e.G_(t,i),this.ka(),this.dd(this.kd(e,2)))}X_(e,t){t.Vo()||(e.X_(t),this.dd(this.kd(e,2)))}Q_(e,t){e.Q_(t),this.dd(this.kd(e,2))}Pd(e){this.Jh.h_(e)}Td(e,t){let i=this.Et();if(i.Gi()||0===t)return;let s=i.ss();e=Math.max(1,Math.min(e,s)),i.Rc(e,t),this.Sc()}Rd(e){this.Dd(0),this.Id(e),this.Vd()}Bd(e){this.Jh.a_(e),this.Sc()}Ed(){this.Jh.l_(),this.dr()}Dd(e){this.Jh.o_(e)}Id(e){this.Jh.__(e),this.Sc()}Vd(){this.Jh.u_(),this.dr()}tn(){return this.Jc}Us(){return null===this.Qc&&(this.Qc=this.Jc.filter(e=>e.It())),this.Qc}xa(){this.Qc=null}Ad(e,t,i,s,r){this.Ct.Bs(e,t);let n=NaN,l=this.Jh.wc(e,!0),a=this.Jh.Ie();null!==a&&(l=Math.min(Math.max(a.Aa(),l),a.bi())),l=this.Ct.Hs(l);let o=s.Rs(),h=o.Lt();if(null!==h&&(n=o.Ds(t,h)),n=this.ad.bl(n,l,s),this.Ct.zs(l,n,s),this.Ua(),!r){let r=tX(s,e,t);this.vd(r&&{hu:r.hu,au:r.au,ou:r.ou||null}),this.nd.p(this.Ct.Bt(),{x:e,y:t},i)}}Ld(e,t,i){let s=i.Rs(),r=s.Lt(),n=s.Nt(e,ee(r)),l=this.Jh.ec(t,!0),a=this.Jh.qt(ee(l));this.Ad(a,n,null,i,!0)}zd(e){this.gd().Ns(),this.Ua(),e||this.nd.p(null,null,null)}ka(){let e=this.Ct.Gs();if(null!==e){let t=this.Ct.As(),i=this.Ct.Ls();this.Ad(t,i,null,e)}this.Ct.Ws()}Od(e,t,i){let s=this.Jh.Is(0);void 0!==t&&void 0!==i&&this.Jh.kt(t,i);let r=this.Jh.Is(0),n=this.Jh.vc(),l=this.Jh.Ie();if(null!==l&&null!==s&&null!==r){let t=l.Ee(n),a=this.cu.key(s)>this.cu.key(r),o=null!==e&&e>n&&!a,h=this.Jh.N().allowShiftVisibleRangeOnWhitespaceReplacement,u=t&&(void 0!==i||h)&&this.Jh.N().shiftVisibleRangeOnNewBar;if(o&&!u){let t=e-n;this.Jh.Mn(this.Jh.Cc()-t)}}this.Jh.Tc(e)}Ra(e){null!==e&&e.iu()}Kn(e){if(e instanceof tq)return e;let t=this.Xc.find(t=>t.Dt().includes(e));return void 0===t?null:t}Sc(){this.Xc.forEach(e=>e.iu()),this.ka()}m(){this.Xc.forEach(e=>e.m()),this.Xc.length=0,this.Ps.localization.priceFormatter=void 0,this.Ps.localization.percentageFormatter=void 0,this.Ps.localization.timeFormatter=void 0}Nd(){return this.hd}Jn(){return this.hd.N()}B_(){return this.sd}Fd(e,t){let i=this.ld(t);this.Wd(e,i),this.Jc.push(e),this.xa(),1===this.Jc.length?this.Ca():this.dr()}Hd(e){let t=this.Kn(e),i=this.Jc.indexOf(e);Q(-1!==i,"Series not found");let s=ee(t);this.Jc.splice(i,1),s.n_(e),e.m&&e.m(),this.xa(),this.Jh.Ju(),this.Ud(s)}Sa(e,t){let i=ee(this.Kn(e));i.n_(e,!0),i.i_(e,t,!0)}Fc(){let e=eD.Cn();e.cn(),this.dd(e)}$d(e){let t=eD.Cn();t.pn(e),this.dd(t)}wn(){let e=eD.Cn();e.wn(),this.dd(e)}gn(e){let t=eD.Cn();t.gn(e),this.dd(t)}Mn(e){let t=eD.Cn();t.Mn(e),this.dd(t)}vn(e){let t=eD.Cn();t.vn(e),this.dd(t)}dn(){let e=eD.Cn();e.dn(),this.dd(e)}qd(){return this.Ps.rightPriceScale.visible?"right":"left"}jd(e,t){if(Q(t>=0,"Index should be greater or equal to 0"),t===this.Yd(e))return;let i=ee(this.Kn(e));i.n_(e);let s=this.ld(t);this.Wd(e,s),0===i.Sl().length&&this.Ud(i),this.Ca()}Kd(){return this.ud}$(){return this.od}Ut(e){let t=this.ud,i=this.od;if(t===i)return t;if(e=Math.max(0,Math.min(100,Math.round(100*e))),null===this.ed||this.ed.eh!==i||this.ed.rh!==t)this.ed={eh:i,rh:t,Zd:new Map};else{let t=this.ed.Zd.get(e);if(void 0!==t)return t}let s=this.ko.tt(i,t,e/100);return this.ed.Zd.set(e,s),s}Gd(e){return this.Xc.indexOf(e)}Xi(){return this.ko}Xd(){return this.Jd()}Jd(e){let t=new tq(this.Jh,this);this.Xc.push(t);let i=e??this.Xc.length-1,s=eD.yn();return s.hn(i,{an:0,ln:!0}),this.dd(s),t}ld(e){return Q(e>=0,"Index should be greater or equal to 0"),(e=Math.min(this.Xc.length,e))<this.Xc.length?this.Xc[e]:this.Jd(e)}Yd(e){return this.Xc.findIndex(t=>t.F_().includes(e))}kd(e,t){let i=new eD(t);if(null!==e){let s=this.Xc.indexOf(e);i.hn(s,{an:t})}return i}fd(e,t){return void 0===t&&(t=2),this.kd(this.Kn(e),t)}dd(e){this.rd&&this.rd(e),this.Xc.forEach(e=>e.eu().pr().kt())}Wd(e,t){let i=e.N().priceScaleId,s=void 0!==i?i:this.qd();t.i_(e,s),ez(s)||e.cr(e.N())}_d(e){let t=this.Ps.layout;return"gradient"===t.background.type?0===e?t.background.topColor:t.background.bottomColor:t.background.color}Ud(e){!e.N_()&&0===e.Sl().length&&this.Xc.length>1&&this.Xc.splice(this.Gd(e),1)}}function t4(e){if(e>=1)return 0;let t=0;for(;t<8&&!(1e-8>Math.abs(Math.round(e)-e));t++)e*=10;return t}function t6(e){return!er(e)&&!el(e)}(u=P||(P={}))[u.Disabled=0]="Disabled",u[u.Continuous=1]="Continuous",u[u.OnDataUpdate=2]="OnDataUpdate",(c=k||(k={}))[c.LastBar=0]="LastBar",c[c.LastVisible=1]="LastVisible",(d=E||(E={})).Solid="solid",d.VerticalGradient="gradient",(m=R||(R={}))[m.Year=0]="Year",m[m.Month=1]="Month",m[m.DayOfMonth=2]="DayOfMonth",m[m.Time=3]="Time",m[m.TimeWithSeconds=4]="TimeWithSeconds";class t9{constructor(e="yyyy-MM-dd",t="default"){this.Qd=e,this.tf=t}du(e){return function(e,t,i){return t.replace(/yyyy/g,eB(e.getUTCFullYear(),4)).replace(/yy/g,eB(e.getUTCFullYear()%100,2)).replace(/MMMM/g,new Date(e.getUTCFullYear(),e.getUTCMonth(),1).toLocaleString(i,{month:"long"})).replace(/MMM/g,new Date(e.getUTCFullYear(),e.getUTCMonth(),1).toLocaleString(i,{month:"short"})).replace(/MM/g,eB(e.getUTCMonth()+1,2)).replace(/dd/g,eB(e.getUTCDate(),2))}(e,this.Qd,this.tf)}}class t8{constructor(e){this.if=e||"%h:%m:%s"}du(e){return this.if.replace("%h",eB(e.getUTCHours(),2)).replace("%m",eB(e.getUTCMinutes(),2)).replace("%s",eB(e.getUTCSeconds(),2))}}let t7={sf:"yyyy-MM-dd",nf:"%h:%m:%s",ef:" ",rf:"default"};class ie{constructor(e={}){const t={...t7,...e};this.hf=new t9(t.sf,t.rf),this.af=new t8(t.nf),this.lf=t.ef}du(e){return`${this.hf.du(e)}${this.lf}${this.af.du(e)}`}}function it(e){return 60*e*6e4}function ii(e){return 60*e*1e3}let is=[{_f:1e3,uf:10},{_f:ii(1),uf:20},{_f:ii(5),uf:21},{_f:ii(30),uf:22},{_f:it(1),uf:30},{_f:it(3),uf:31},{_f:it(6),uf:32},{_f:it(12),uf:33}];function ir(e,t){if(e.getUTCFullYear()!==t.getUTCFullYear())return 70;if(e.getUTCMonth()!==t.getUTCMonth())return 60;if(e.getUTCDate()!==t.getUTCDate())return 50;for(let i=is.length-1;i>=0;--i)if(Math.floor(t.getTime()/is[i]._f)!==Math.floor(e.getTime()/is[i]._f))return is[i].uf;return 0}function il(e){let t=e;if(el(e)&&(t=io(e)),!t6(t))throw Error("time must be of type BusinessDay");return{cf:Math.round(new Date(Date.UTC(t.year,t.month-1,t.day,0,0,0,0)).getTime()/1e3),df:t}}function ia(e){if(!er(e))throw Error("time must be of type isUTCTimestamp");return{cf:e}}function io(e){let t=new Date(e);if(isNaN(t.getTime()))throw Error(`Invalid date string=${e}, expected format=yyyy-mm-dd`);return{day:t.getUTCDate(),month:t.getUTCMonth()+1,year:t.getUTCFullYear()}}function ih(e){el(e.time)&&(e.time=io(e.time))}class iu{options(){return this.Ps}setOptions(e){this.Ps=e,this.updateFormatter(e.localization)}preprocessData(e){Array.isArray(e)?e.forEach(ih):ih(e)}createConverterToInternalObj(e){return ee(0===e.length?null:t6(e[0].time)||el(e[0].time)?il:ia)}key(e){return"object"==typeof e&&"cf"in e?e.cf:this.key(this.convertHorzItemToInternal(e))}cacheKey(e){return void 0===e.df?new Date(1e3*e.cf).getTime():new Date(Date.UTC(e.df.year,e.df.month-1,e.df.day)).getTime()}convertHorzItemToInternal(e){return er(e)?ia(e):t6(e)?il(e):il(io(e))}updateFormatter(e){if(!this.Ps)return;let t=e.dateFormat;this.Ps.timeScale.timeVisible?this.ff=new ie({sf:t,nf:this.Ps.timeScale.secondsVisible?"%h:%m:%s":"%h:%m",ef:"   ",rf:e.locale}):this.ff=new t9(t,e.locale)}formatHorzItem(e){return this.ff.du(new Date(1e3*e.cf))}formatTickmark(e,t){let i=function(e,t,i){switch(e){case 0:case 10:return t?i?4:3:2;case 20:case 21:case 22:case 30:case 31:case 32:case 33:return t?3:2;case 50:return 2;case 60:return 1;case 70:return 0}}(e.weight,this.Ps.timeScale.timeVisible,this.Ps.timeScale.secondsVisible),s=this.Ps.timeScale;if(void 0!==s.tickMarkFormatter){let r=s.tickMarkFormatter(e.originalTime,i,t.locale);if(null!==r)return r}return function(e,t,i){let s={};switch(t){case 0:s.year="numeric";break;case 1:s.month="short";break;case 2:s.day="numeric";break;case 3:s.hour12=!1,s.hour="2-digit",s.minute="2-digit";break;case 4:s.hour12=!1,s.hour="2-digit",s.minute="2-digit",s.second="2-digit"}let r=new Date(void 0===e.df?1e3*e.cf:Date.UTC(e.df.year,e.df.month-1,e.df.day));return new Date(r.getUTCFullYear(),r.getUTCMonth(),r.getUTCDate(),r.getUTCHours(),r.getUTCMinutes(),r.getUTCSeconds(),r.getUTCMilliseconds()).toLocaleString(i,s)}(e.time,i,t.locale)}maxTickMarkWeight(e){let t=e.reduce(t2,e[0]).weight;return t>30&&t<50&&(t=30),t}fillWeightsForPoints(e,t){!function(e,t=0){if(0===e.length)return;let i=0===t?null:e[t-1].time.cf,s=null!==i?new Date(1e3*i):null,r=0;for(let n=t;n<e.length;++n){let t=e[n],l=new Date(1e3*t.time.cf);null!==s&&(t.timeWeight=ir(l,s)),r+=t.time.cf-(i||t.time.cf),i=t.time.cf,s=l}if(0===t&&e.length>1){let t=Math.ceil(r/(e.length-1)),i=new Date(1e3*(e[0].time.cf-t));e[0].timeWeight=ir(new Date(1e3*e[0].time.cf),i)}}(e,t)}static pf(e){return es({localization:{dateFormat:"dd MMM 'yy"}},e??{})}}let ic="undefined"!=typeof window;function id(){return!!ic&&window.navigator.userAgent.toLowerCase().indexOf("firefox")>-1}function im(){return!!ic&&/iPhone|iPad|iPod/.test(window.navigator.platform)}class ip{constructor(e,t,i){this.vf=0,this.mf=null,this.wf={_t:-1/0,ut:1/0},this.gf=0,this.Mf=null,this.bf={_t:-1/0,ut:1/0},this.Sf=null,this.xf=!1,this.Cf=null,this.yf=null,this.kf=!1,this.Pf=!1,this.Tf=!1,this.Rf=null,this.Df=null,this.If=null,this.Vf=null,this.Bf=null,this.Ef=null,this.Af=null,this.Lf=0,this.zf=!1,this.Of=!1,this.Nf=!1,this.Ff=0,this.Wf=null,this.Hf=!im(),this.Uf=e=>{this.$f(e)},this.qf=e=>{if(this.jf(e)){let t=this.Yf(e);if(++this.gf,this.Mf&&this.gf>1){let{Kf:i}=this.Zf(ix(e),this.bf);i<30&&!this.Tf&&this.Gf(t,this.Jf.Xf),this.Qf()}}else{let t=this.Yf(e);if(++this.vf,this.mf&&this.vf>1){let{Kf:i}=this.Zf(ix(e),this.wf);i<5&&!this.Pf&&this.tp(t,this.Jf.ip),this.sp()}}},this.np=e,this.Jf=t,this.Ps=i,this.ep()}m(){null!==this.Rf&&(this.Rf(),this.Rf=null),null!==this.Df&&(this.Df(),this.Df=null),null!==this.Vf&&(this.Vf(),this.Vf=null),null!==this.Bf&&(this.Bf(),this.Bf=null),null!==this.Ef&&(this.Ef(),this.Ef=null),null!==this.If&&(this.If(),this.If=null),this.rp(),this.sp()}hp(e){this.Vf&&this.Vf();let t=this.ap.bind(this);if(this.Vf=()=>{this.np.removeEventListener("mousemove",t)},this.np.addEventListener("mousemove",t),this.jf(e))return;let i=this.Yf(e);this.tp(i,this.Jf.lp),this.Hf=!0}sp(){null!==this.mf&&clearTimeout(this.mf),this.vf=0,this.mf=null,this.wf={_t:-1/0,ut:1/0}}Qf(){null!==this.Mf&&clearTimeout(this.Mf),this.gf=0,this.Mf=null,this.bf={_t:-1/0,ut:1/0}}ap(e){if(this.Nf||null!==this.yf||this.jf(e))return;let t=this.Yf(e);this.tp(t,this.Jf.op),this.Hf=!0}_p(e){let t=ib(e.changedTouches,ee(this.Wf));if(null===t||(this.Ff=iw(e),null!==this.Af)||this.Of)return;this.zf=!0;let{up:i,cp:s,Kf:r}=this.Zf(ix(t),ee(this.yf));if(this.kf||!(r<5)){if(!this.kf){let e=.5*i,t=s>=e&&!this.Ps.dp(),r=e>s&&!this.Ps.fp();t||r||(this.Of=!0),this.kf=!0,this.Tf=!0,this.rp(),this.Qf()}if(!this.Of){let i=this.Yf(e,t);this.Gf(i,this.Jf.pp),iv(e)}}}vp(e){if(0!==e.button)return;let{Kf:t}=this.Zf(ix(e),ee(this.Cf));if(t>=5&&(this.Pf=!0,this.sp()),this.Pf){let t=this.Yf(e);this.tp(t,this.Jf.mp)}}Zf(e,t){let i=Math.abs(t._t-e._t),s=Math.abs(t.ut-e.ut);return{up:i,cp:s,Kf:i+s}}wp(e){let t=ib(e.changedTouches,ee(this.Wf));if(null===t&&0===e.touches.length&&(t=e.changedTouches[0]),null===t)return;this.Wf=null,this.Ff=iw(e),this.rp(),this.yf=null,this.Ef&&(this.Ef(),this.Ef=null);let i=this.Yf(e,t);if(this.Gf(i,this.Jf.gp),++this.gf,this.Mf&&this.gf>1){let{Kf:e}=this.Zf(ix(t),this.bf);e<30&&!this.Tf&&this.Gf(i,this.Jf.Xf),this.Qf()}else this.Tf||(this.Gf(i,this.Jf.Mp),this.Jf.Mp&&iv(e));0===this.gf&&iv(e),0===e.touches.length&&this.xf&&(this.xf=!1,iv(e))}$f(e){if(0!==e.button)return;let t=this.Yf(e);if(this.Cf=null,this.Nf=!1,this.Bf&&(this.Bf(),this.Bf=null),id()&&this.np.ownerDocument.documentElement.removeEventListener("mouseleave",this.Uf),!this.jf(e))if(this.tp(t,this.Jf.bp),++this.vf,this.mf&&this.vf>1){let{Kf:i}=this.Zf(ix(e),this.wf);i<5&&!this.Pf&&this.tp(t,this.Jf.ip),this.sp()}else this.Pf||this.tp(t,this.Jf.Sp)}rp(){null!==this.Sf&&(clearTimeout(this.Sf),this.Sf=null)}xp(e){if(null!==this.Wf)return;let t=e.changedTouches[0];this.Wf=t.identifier,this.Ff=iw(e);let i=this.np.ownerDocument.documentElement;this.Tf=!1,this.kf=!1,this.Of=!1,this.yf=ix(t),this.Ef&&(this.Ef(),this.Ef=null);{let t=this._p.bind(this),s=this.wp.bind(this);this.Ef=()=>{i.removeEventListener("touchmove",t),i.removeEventListener("touchend",s)},i.addEventListener("touchmove",t,{passive:!1}),i.addEventListener("touchend",s,{passive:!1}),this.rp(),this.Sf=setTimeout(this.Cp.bind(this,e),240)}let s=this.Yf(e,t);this.Gf(s,this.Jf.yp),this.Mf||(this.gf=0,this.Mf=setTimeout(this.Qf.bind(this),500),this.bf=ix(t))}kp(e){if(0!==e.button)return;let t=this.np.ownerDocument.documentElement;id()&&t.addEventListener("mouseleave",this.Uf),this.Pf=!1,this.Cf=ix(e),this.Bf&&(this.Bf(),this.Bf=null);{let e=this.vp.bind(this),i=this.$f.bind(this);this.Bf=()=>{t.removeEventListener("mousemove",e),t.removeEventListener("mouseup",i)},t.addEventListener("mousemove",e),t.addEventListener("mouseup",i)}if(this.Nf=!0,this.jf(e))return;let i=this.Yf(e);this.tp(i,this.Jf.Pp),this.mf||(this.vf=0,this.mf=setTimeout(this.sp.bind(this),500),this.wf=ix(e))}ep(){var e;this.np.addEventListener("mouseenter",this.hp.bind(this)),this.np.addEventListener("touchcancel",this.rp.bind(this));{let e=this.np.ownerDocument,t=e=>{this.Jf.Tp&&(e.composed&&this.np.contains(e.composedPath()[0])||e.target&&this.np.contains(e.target)||this.Jf.Tp())};this.Df=()=>{e.removeEventListener("touchstart",t)},this.Rf=()=>{e.removeEventListener("mousedown",t)},e.addEventListener("mousedown",t),e.addEventListener("touchstart",t,{passive:!0})}im()&&(this.If=()=>{this.np.removeEventListener("dblclick",this.qf)},this.np.addEventListener("dblclick",this.qf)),this.np.addEventListener("mouseleave",this.Rp.bind(this)),this.np.addEventListener("touchstart",this.xp.bind(this),{passive:!0}),e=this.np,ic&&void 0!==window.chrome&&e.addEventListener("mousedown",e=>{if(1===e.button)return e.preventDefault(),!1}),this.np.addEventListener("mousedown",this.kp.bind(this)),this.Dp(),this.np.addEventListener("touchmove",()=>{},{passive:!1})}Dp(){void 0===this.Jf.Ip&&void 0===this.Jf.Vp&&void 0===this.Jf.Bp||(this.np.addEventListener("touchstart",e=>this.Ep(e.touches),{passive:!0}),this.np.addEventListener("touchmove",e=>{if(2===e.touches.length&&null!==this.Af&&void 0!==this.Jf.Vp){let t=ig(e.touches[0],e.touches[1])/this.Lf;this.Jf.Vp(this.Af,t),iv(e)}},{passive:!1}),this.np.addEventListener("touchend",e=>{this.Ep(e.touches)}))}Ep(e){1===e.length&&(this.zf=!1),2!==e.length||this.zf||this.xf?this.Ap():this.Lp(e)}Lp(e){let t=this.np.getBoundingClientRect()||{left:0,top:0};this.Af={_t:(e[0].clientX-t.left+(e[1].clientX-t.left))/2,ut:(e[0].clientY-t.top+(e[1].clientY-t.top))/2},this.Lf=ig(e[0],e[1]),void 0!==this.Jf.Ip&&this.Jf.Ip(),this.rp()}Ap(){null!==this.Af&&(this.Af=null,void 0!==this.Jf.Bp&&this.Jf.Bp())}Rp(e){if(this.Vf&&this.Vf(),this.jf(e)||!this.Hf)return;let t=this.Yf(e);this.tp(t,this.Jf.zp),this.Hf=!im()}Cp(e){let t=ib(e.touches,ee(this.Wf));if(null===t)return;let i=this.Yf(e,t);this.Gf(i,this.Jf.Op),this.Tf=!0,this.xf=!0}jf(e){return e.sourceCapabilities&&void 0!==e.sourceCapabilities.firesTouchEvents?e.sourceCapabilities.firesTouchEvents:iw(e)<this.Ff+500}Gf(e,t){t&&t.call(this.Jf,e)}tp(e,t){t&&t.call(this.Jf,e)}Yf(e,t){let i=t||e,s=this.np.getBoundingClientRect()||{left:0,top:0};return{clientX:i.clientX,clientY:i.clientY,pageX:i.pageX,pageY:i.pageY,screenX:i.screenX,screenY:i.screenY,localX:i.clientX-s.left,localY:i.clientY-s.top,ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey,metaKey:e.metaKey,Np:!e.type.startsWith("mouse")&&"contextmenu"!==e.type&&"click"!==e.type,Fp:e.type,Wp:i.target,_u:e.view,Hp:()=>{"touchstart"!==e.type&&iv(e)}}}}function ig(e,t){let i=e.clientX-t.clientX,s=e.clientY-t.clientY;return Math.sqrt(i*i+s*s)}function iv(e){e.cancelable&&e.preventDefault()}function ix(e){return{_t:e.pageX,ut:e.pageY}}function iw(e){return e.timeStamp||performance.now()}function ib(e,t){for(let i=0;i<e.length;++i)if(e[i].identifier===t)return e[i];return null}class iy{constructor(e,t,i){this.Up=null,this.$p=null,this.qp=!0,this.jp=null,this.Yp=e,this.Kp=e.Zp()[t],this.Gp=e.Zp()[i],this.Xp=document.createElement("tr"),this.Xp.style.height="1px",this.Jp=document.createElement("td"),this.Jp.style.position="relative",this.Jp.style.padding="0",this.Jp.style.margin="0",this.Jp.setAttribute("colspan","3"),this.Qp(),this.Xp.appendChild(this.Jp),this.qp=this.Yp.N().layout.panes.enableResize,this.qp?this.tv():(this.Up=null,this.$p=null)}m(){null!==this.$p&&this.$p.m()}iv(){return this.Xp}sv(){return W({width:this.Kp.sv().width,height:1})}nv(){return W({width:this.Kp.nv().width,height:+window.devicePixelRatio})}ev(e,t,i){let s=this.nv();e.fillStyle=this.Yp.N().layout.panes.separatorColor,e.fillRect(t,i,s.width,s.height)}kt(){this.Qp(),this.Yp.N().layout.panes.enableResize!==this.qp&&(this.qp=this.Yp.N().layout.panes.enableResize,this.qp?this.tv():(null!==this.Up&&(this.Jp.removeChild(this.Up.rv),this.Jp.removeChild(this.Up.hv),this.Up=null),null!==this.$p&&(this.$p.m(),this.$p=null)))}tv(){let e=document.createElement("div"),t=e.style;t.position="fixed",t.display="none",t.zIndex="49",t.top="0",t.left="0",t.width="100%",t.height="100%",t.cursor="row-resize",this.Jp.appendChild(e);let i=document.createElement("div"),s=i.style;s.position="absolute",s.zIndex="50",s.top="-4px",s.height="9px",s.width="100%",s.backgroundColor="",s.cursor="row-resize",this.Jp.appendChild(i);let r={lp:this.av.bind(this),zp:this.lv.bind(this),Pp:this.ov.bind(this),yp:this.ov.bind(this),mp:this._v.bind(this),pp:this._v.bind(this),bp:this.uv.bind(this),gp:this.uv.bind(this)};this.$p=new ip(i,r,{dp:()=>!1,fp:()=>!0}),this.Up={hv:i,rv:e}}Qp(){this.Jp.style.background=this.Yp.N().layout.panes.separatorColor}av(e){null!==this.Up&&(this.Up.hv.style.backgroundColor=this.Yp.N().layout.panes.separatorHoverColor)}lv(e){null!==this.Up&&null===this.jp&&(this.Up.hv.style.backgroundColor="")}ov(e){if(null===this.Up)return;let t=this.Kp.cv().E_()+this.Gp.cv().E_(),i=t/(this.Kp.sv().height+this.Gp.sv().height),s=30*i;t<=2*s||(this.jp={dv:e.pageY,fv:this.Kp.cv().E_(),pv:t-s,vv:t,mv:i,wv:s},this.Up.rv.style.display="block")}_v(e){let t=this.jp;if(null===t)return;let i=(e.pageY-t.dv)*t.mv,s=tk(t.fv+i,t.wv,t.pv);this.Kp.cv().A_(s),this.Gp.cv().A_(t.vv-s),this.Yp.Qt().Ca()}uv(e){null!==this.jp&&null!==this.Up&&(this.jp=null,this.Up.rv.style.display="none")}}function iS(e,t,i){let s=(e.gv-t.gv)/(e.wt-t.wt);return Math.sign(s)*Math.min(Math.abs(s),i)}class ij{constructor(e,t,i,s){this.Mv=null,this.bv=null,this.Sv=null,this.xv=null,this.Cv=null,this.yv=0,this.kv=0,this.Pv=e,this.Tv=t,this.Rv=i,this.kn=s}Dv(e,t){if(null!==this.Mv){if(this.Mv.wt===t)return void(this.Mv.gv=e);if(Math.abs(this.Mv.gv-e)<this.kn)return}this.xv=this.Sv,this.Sv=this.bv,this.bv=this.Mv,this.Mv={wt:t,gv:e}}fe(e,t){var i,s,r,n,l,a,o;let h;if(null===this.Mv||null===this.bv||t-this.Mv.wt>50)return;let u=0,c=iS(this.Mv,this.bv,this.Tv),d=(i=this.Mv,s=this.bv,i.gv-s.gv),m=[c],p=[d];if(u+=d,null!==this.Sv){let e=iS(this.bv,this.Sv,this.Tv);if(Math.sign(e)===Math.sign(c)){let t=(r=this.bv,n=this.Sv,r.gv-n.gv);if(m.push(e),p.push(t),u+=t,null!==this.xv){let e=iS(this.Sv,this.xv,this.Tv);if(Math.sign(e)===Math.sign(c)){let t=(l=this.Sv,a=this.xv,l.gv-a.gv);m.push(e),p.push(t),u+=t}}}}let f=0;for(let e=0;e<m.length;++e)f+=p[e]/u*m[e];Math.abs(f)<this.Pv||(this.Cv={gv:e,wt:t},this.kv=f,this.yv=(o=Math.abs(f),Math.log(-((h=Math.log(this.Rv))/o))/h))}Ac(e){let t=ee(this.Cv),i=e-t.wt;return t.gv+this.kv*(Math.pow(this.Rv,i)-1)/Math.log(this.Rv)}Ec(e){return null===this.Cv||this.Iv(e)===this.yv}Iv(e){return Math.min(e-ee(this.Cv).wt,this.yv)}}class iM{constructor(e,t){this.Vv=void 0,this.Bv=void 0,this.Ev=void 0,this.ws=!1,this.Av=e,this.Lv=t,this.zv()}kt(){this.zv()}Ov(){this.Vv&&this.Av.removeChild(this.Vv),this.Bv&&this.Av.removeChild(this.Bv),this.Vv=void 0,this.Bv=void 0}Nv(){return this.ws!==this.Fv()||this.Ev!==this.Wv()}Wv(){return this.Lv.Qt().Xi().J(this.Lv.N().layout.textColor)>160?"dark":"light"}Fv(){return this.Lv.N().layout.attributionLogo}Hv(){let e=new URL(location.href);return e.hostname?"&utm_source="+e.hostname+e.pathname:""}zv(){this.Nv()&&(this.Ov(),this.ws=this.Fv(),this.ws&&(this.Ev=this.Wv(),this.Bv=document.createElement("style"),this.Bv.innerText="a#tv-attr-logo{--fill:#131722;--stroke:#fff;position:absolute;left:10px;bottom:10px;height:19px;width:35px;margin:0;padding:0;border:0;z-index:3;}a#tv-attr-logo[data-dark]{--fill:#D1D4DC;--stroke:#131722;}",this.Vv=document.createElement("a"),this.Vv.href=`https://www.tradingview.com/?utm_medium=lwc-link&utm_campaign=lwc-chart${this.Hv()}`,this.Vv.title="Charting by TradingView",this.Vv.id="tv-attr-logo",this.Vv.target="_blank",this.Vv.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="35" height="19" fill="none"><g fill-rule="evenodd" clip-path="url(#a)" clip-rule="evenodd"><path fill="var(--stroke)" d="M2 0H0v10h6v9h21.4l.5-1.3 6-15 1-2.7H23.7l-.5 1.3-.2.6a5 5 0 0 0-7-.9V0H2Zm20 17h4l5.2-13 .8-2h-7l-1 2.5-.2.5-1.5 3.8-.3.7V17Zm-.8-10a3 3 0 0 0 .7-2.7A3 3 0 1 0 16.8 7h4.4ZM14 7V2H2v6h6v9h4V7h2Z"/><path fill="var(--fill)" d="M14 2H2v6h6v9h6V2Zm12 15h-7l6-15h7l-6 15Zm-7-9a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"/></g><defs><clipPath id="a"><path fill="var(--stroke)" d="M0 0h35v19H0z"/></clipPath></defs></svg>',this.Vv.toggleAttribute("data-dark","dark"===this.Ev),this.Av.appendChild(this.Bv),this.Av.appendChild(this.Vv)))}}function iC(e,t){let i=ee(e.ownerDocument).createElement("canvas");e.appendChild(i);let s=function(e,t){if("device-pixel-content-box"===t.type)return new U(e,t.transform,t.options);throw Error("Unsupported binding target")}(i,{type:"device-pixel-content-box",options:{allowResizeObserver:!0},transform:(e,t)=>({width:Math.max(e.width,t.width),height:Math.max(e.height,t.height)})});return s.resizeCanvasElement(t),s}function iN(e){e.width=1,e.height=1,e.getContext("2d")?.clearRect(0,0,1,1)}function iP(e,t,i,s){e.Uh&&e.Uh(t,i,s)}function ik(e,t,i,s){e.nt(t,i,s)}function iE(e,t,i,s){for(let r of e(i,s)){let e=r.Tt(s);null!==e&&t(e)}}function iR(e,t){return i=>void 0===i.Ft||(i.Ft()?.ol()??"")!==t?[]:i.Ya?.(e)??[]}function i_(e,t,i,s){if(!e.length)return;let r=0,n=e[0].$t(s,!0),l=1===t?i/2-(e[0].Hi()-n/2):e[0].Hi()-n/2-i/2;l=Math.max(0,l);for(let n=1;n<e.length;n++){let a=e[n],o=e[n-1],h=o.$t(s,!1),u=a.Hi(),c=o.Hi();if(1===t?u>c-h:u<c+h){let s=c-h*t;a.Ui(s);let n=s-t*h/2;if((1===t?n<0:n>i)&&l>0){let s=Math.min(1===t?-1-n:n-i,l);for(let i=r;i<e.length;i++)e[i].Ui(e[i].Hi()+t*s);l-=s}}else r=n,l=1===t?c-h-u:u-(c+h)}}class iT{constructor(e,t,i,s){this.Ki=null,this.Uv=null,this.$v=!1,this.qv=new eU(200),this.jv=null,this.Yv=0,this.Kv=!1,this.Zv=()=>{this.Kv||this.yt.Gv().Qt().dr()},this.Xv=()=>{this.Kv||this.yt.Gv().Qt().dr()},this.yt=e,this.Ps=t,this.Co=t.layout,this.hd=i,this.Jv="left"===s,this.Qv=iR("normal",s),this.tm=iR("top",s),this.im=iR("bottom",s),this.Jp=document.createElement("div"),this.Jp.style.height="100%",this.Jp.style.overflow="hidden",this.Jp.style.width="25px",this.Jp.style.left="0",this.Jp.style.position="relative",this.sm=iC(this.Jp,W({width:16,height:16})),this.sm.subscribeSuggestedBitmapSizeChanged(this.Zv);const r=this.sm.canvasElement;r.style.position="absolute",r.style.zIndex="1",r.style.left="0",r.style.top="0",this.nm=iC(this.Jp,W({width:16,height:16})),this.nm.subscribeSuggestedBitmapSizeChanged(this.Xv);const n=this.nm.canvasElement;n.style.position="absolute",n.style.zIndex="2",n.style.left="0",n.style.top="0";const l={Pp:this.ov.bind(this),yp:this.ov.bind(this),mp:this._v.bind(this),pp:this._v.bind(this),Tp:this.rm.bind(this),bp:this.uv.bind(this),gp:this.uv.bind(this),ip:this.hm.bind(this),Xf:this.hm.bind(this),lp:this.am.bind(this),zp:this.lv.bind(this)};this.$p=new ip(this.nm.canvasElement,l,{dp:()=>!this.Ps.handleScroll.vertTouchDrag,fp:()=>!0})}m(){this.$p.m(),this.nm.unsubscribeSuggestedBitmapSizeChanged(this.Xv),iN(this.nm.canvasElement),this.nm.dispose(),this.sm.unsubscribeSuggestedBitmapSizeChanged(this.Zv),iN(this.sm.canvasElement),this.sm.dispose(),null!==this.Ki&&this.Ki.r_().u(this),this.Ki=null}iv(){return this.Jp}k(){return this.Co.fontSize}lm(){let e=this.hd.N();return this.jv!==e.P&&(this.qv.On(),this.jv=e.P),e}om(){var e,t;if(null===this.Ki)return 0;let i=0,s=this.lm(),r=ee(this.sm.canvasElement.getContext("2d",{colorSpace:this.yt.Gv().N().layout.colorSpace}));r.save();let n=this.Ki.Vl();r.font=this._m(),n.length>0&&(i=Math.max(this.qv.Ii(r,n[0].Jl),this.qv.Ii(r,n[n.length-1].Jl)));let l=this.um();for(let e=l.length;e--;){let t=this.qv.Ii(r,l[e].ri());t>i&&(i=t)}let a=this.Ki.Lt();if(null!==a&&null!==this.Uv&&2!==(e=this.Ps.crosshair).mode&&e.horzLine.visible&&e.horzLine.labelVisible){let e=this.Ki.Ds(1,a),t=this.Ki.Ds(this.Uv.height-2,a);i=Math.max(i,this.qv.Ii(r,this.Ki.Ji(Math.floor(Math.min(e,t))+.11111111111111,a)),this.qv.Ii(r,this.Ki.Ji(Math.ceil(Math.max(e,t))-.11111111111111,a)))}r.restore();let o=i||34;return(t=Math.ceil(s.S+s.C+s.V+s.B+5+o))+t%2}dm(e){null!==this.Uv&&V(this.Uv,e)||(this.Uv=e,this.Kv=!0,this.sm.resizeCanvasElement(e),this.nm.resizeCanvasElement(e),this.Kv=!1,this.Jp.style.width=`${e.width}px`,this.Jp.style.height=`${e.height}px`)}fm(){return ee(this.Uv).width}cs(e){this.Ki!==e&&(null!==this.Ki&&this.Ki.r_().u(this),this.Ki=e,e.r_().i(this.do.bind(this),this))}Ft(){return this.Ki}On(){let e=this.yt.cv();this.yt.Gv().Qt().Q_(e,ee(this.Ft()))}pm(e){if(null===this.Uv)return;let t={colorSpace:this.yt.Gv().N().layout.colorSpace};if(1!==e){this.vm(),this.sm.applySuggestedBitmapSize();let e=q(this.sm,t);null!==e&&(e.useBitmapCoordinateSpace(e=>{this.wm(e),this.gm(e)}),this.yt.Mm(e,this.im),this.bm(e),this.yt.Mm(e,this.Qv),this.Sm(e))}this.nm.applySuggestedBitmapSize();let i=q(this.nm,t);null!==i&&(i.useBitmapCoordinateSpace(({context:e,bitmapSize:t})=>{e.clearRect(0,0,t.width,t.height)}),this.xm(i),this.yt.Mm(i,this.tm))}nv(){return this.sm.bitmapSize}ev(e,t,i,s){let r=this.nv();if(r.width>0&&r.height>0&&(e.drawImage(this.sm.canvasElement,t,i),s)){let s=this.nm.canvasElement;e.drawImage(s,t,i)}}kt(){this.Ki?.Vl()}ov(e){if(null===this.Ki||this.Ki.Gi()||!this.Ps.handleScale.axisPressedMouseMove.price)return;let t=this.yt.Gv().Qt(),i=this.yt.cv();this.$v=!0,t.j_(i,this.Ki,e.localY)}_v(e){if(null===this.Ki||!this.Ps.handleScale.axisPressedMouseMove.price)return;let t=this.yt.Gv().Qt(),i=this.yt.cv(),s=this.Ki;t.Y_(i,s,e.localY)}rm(){if(null===this.Ki||!this.Ps.handleScale.axisPressedMouseMove.price)return;let e=this.yt.Gv().Qt(),t=this.yt.cv(),i=this.Ki;this.$v&&(this.$v=!1,e.K_(t,i))}uv(e){if(null===this.Ki||!this.Ps.handleScale.axisPressedMouseMove.price)return;let t=this.yt.Gv().Qt(),i=this.yt.cv();this.$v=!1,t.K_(i,this.Ki)}hm(e){this.Ps.handleScale.axisDoubleClickReset.price&&this.On()}am(e){null!==this.Ki&&(!this.yt.Gv().Qt().N().handleScale.axisPressedMouseMove.price||this.Ki.He()||this.Ki.Eo()||this.Cm(1))}lv(e){this.Cm(0)}um(){let e=[],t=null===this.Ki?void 0:this.Ki;return(i=>{for(let s=0;s<i.length;++s){let r=i[s].Ks(this.yt.cv(),t);for(let t=0;t<r.length;t++)e.push(r[t])}})(this.yt.cv().Dt()),e}wm({context:e,bitmapSize:t}){let{width:i,height:s}=t,r=this.yt.cv().Qt(),n=r.$(),l=r.Kd();n===l?eC(e,0,0,i,s,n):ek(e,0,0,i,s,n,l)}gm({context:e,bitmapSize:t,horizontalPixelRatio:i}){let s;if(null===this.Uv||null===this.Ki||!this.Ki.N().borderVisible)return;e.fillStyle=this.Ki.N().borderColor;let r=Math.max(1,Math.floor(this.lm().S*i));s=this.Jv?t.width-r:0,e.fillRect(s,0,r,t.height)}bm(e){if(null===this.Uv||null===this.Ki)return;let t=this.Ki.Vl(),i=this.Ki.N(),s=this.lm(),r=this.Jv?this.Uv.width-s.C:0;i.borderVisible&&i.ticksVisible&&e.useBitmapCoordinateSpace(({context:e,horizontalPixelRatio:n,verticalPixelRatio:l})=>{e.fillStyle=i.borderColor;let a=Math.max(1,Math.floor(l)),o=Math.floor(.5*l),h=Math.round(s.C*n);for(let i of(e.beginPath(),t))e.rect(Math.floor(r*n),Math.round(i.Pl*l)-o,h,a);e.fill()}),e.useMediaCoordinateSpace(({context:e})=>{e.font=this._m(),e.fillStyle=i.textColor??this.Co.textColor,e.textAlign=this.Jv?"right":"left",e.textBaseline="middle";let n=this.Jv?Math.round(r-s.V):Math.round(r+s.C+s.V),l=t.map(t=>this.qv.Di(e,t.Jl));for(let i=t.length;i--;){let s=t[i];e.fillText(s.Jl,n,s.Pl+l[i])}})}vm(){if(null===this.Uv||null===this.Ki)return;let e=this.Uv.height/2,t=[],i=this.Ki.Dt().slice(),s=this.yt.cv(),r=this.lm();this.Ki===s.Gn()&&this.yt.cv().Dt().forEach(e=>{s.Zn(e)&&i.push(e)});let n=this.Ki.Sl()[0],l=this.Ki;i.forEach(i=>{let r=i.Ks(s,l);r.forEach(e=>{e.$i()&&null===e.Wi()&&(e.Ui(null),t.push(e))}),n===i&&r.length>0&&(e=r[0].Ei())}),this.Ki.N().alignLabels&&this.ym(t,r,e)}ym(e,t,i){if(null===this.Uv)return;let s=e.filter(e=>e.Ei()<=i),r=e.filter(e=>e.Ei()>i);for(let i of(s.sort((e,t)=>t.Ei()-e.Ei()),s.length&&r.length&&r.push(s[0]),r.sort((e,t)=>e.Ei()-t.Ei()),e)){let e=Math.floor(i.$t(t)/2),s=i.Ei();s>-e&&s<e&&i.Ui(e),s>this.Uv.height-e&&s<this.Uv.height+e&&i.Ui(this.Uv.height-e)}i_(s,1,this.Uv.height,t),i_(r,-1,this.Uv.height,t)}Sm(e){if(null===this.Uv)return;let t=this.um(),i=this.lm(),s=this.Jv?"right":"left";t.forEach(t=>{t.qi()&&t.Tt(ee(this.Ki)).nt(e,i,this.qv,s)})}xm(e){if(null===this.Uv||null===this.Ki)return;let t=this.yt.Gv().Qt(),i=[],s=this.yt.cv(),r=t.gd().Ks(s,this.Ki);r.length&&i.push(r);let n=this.lm(),l=this.Jv?"right":"left";i.forEach(t=>{t.forEach(t=>{t.Tt(ee(this.Ki)).nt(e,n,this.qv,l)})})}Cm(e){this.Jp.style.cursor=1===e?"ns-resize":"default"}do(){let e=this.om();this.Yv<e&&this.yt.Gv().Qt().Ca(),this.Yv=e}_m(){return ed(this.Co.fontSize,this.Co.fontFamily)}}function iL(e,t){return e.qa?.(t)??[]}function iI(e,t){return e.Ys?.(t)??[]}function iA(e,t){return e.ds?.(t)??[]}function iF(e,t){return e.Ha?.(t)??[]}class iz{constructor(e,t){this.Uv=W({width:0,height:0}),this.km=null,this.Pm=null,this.Tm=null,this.Rm=null,this.Dm=!1,this.Im=new ei,this.Vm=new ei,this.Bm=0,this.Em=!1,this.Am=null,this.Lm=!1,this.zm=null,this.Om=null,this.Kv=!1,this.Zv=()=>{this.Kv||null===this.Nm||this.ns().dr()},this.Xv=()=>{this.Kv||null===this.Nm||this.ns().dr()},this.Lv=e,this.Nm=t,this.Nm.nu().i(this.Fm.bind(this),this,!0),this.Wm=document.createElement("td"),this.Wm.style.padding="0",this.Wm.style.position="relative";const i=document.createElement("div");i.style.width="100%",i.style.height="100%",i.style.position="relative",i.style.overflow="hidden",this.Hm=document.createElement("td"),this.Hm.style.padding="0",this.Um=document.createElement("td"),this.Um.style.padding="0",this.Wm.appendChild(i),this.sm=iC(i,W({width:16,height:16})),this.sm.subscribeSuggestedBitmapSizeChanged(this.Zv);const s=this.sm.canvasElement;s.style.position="absolute",s.style.zIndex="1",s.style.left="0",s.style.top="0",this.nm=iC(i,W({width:16,height:16})),this.nm.subscribeSuggestedBitmapSizeChanged(this.Xv);const r=this.nm.canvasElement;r.style.position="absolute",r.style.zIndex="2",r.style.left="0",r.style.top="0",this.Xp=document.createElement("tr"),this.Xp.appendChild(this.Hm),this.Xp.appendChild(this.Wm),this.Xp.appendChild(this.Um),this.$m(),this.$p=new ip(this.nm.canvasElement,this,{dp:()=>null===this.Am&&!this.Lv.N().handleScroll.vertTouchDrag,fp:()=>null===this.Am&&!this.Lv.N().handleScroll.horzTouchDrag})}m(){null!==this.km&&this.km.m(),null!==this.Pm&&this.Pm.m(),this.Tm=null,this.nm.unsubscribeSuggestedBitmapSizeChanged(this.Xv),iN(this.nm.canvasElement),this.nm.dispose(),this.sm.unsubscribeSuggestedBitmapSizeChanged(this.Zv),iN(this.sm.canvasElement),this.sm.dispose(),null!==this.Nm&&(this.Nm.nu().u(this),this.Nm.m()),this.$p.m()}cv(){return ee(this.Nm)}qm(e){null!==this.Nm&&this.Nm.nu().u(this),this.Nm=e,null!==this.Nm&&this.Nm.nu().i(iz.prototype.Fm.bind(this),this,!0),this.$m(),this.Lv.Zp().indexOf(this)===this.Lv.Zp().length-1?(this.Tm=this.Tm??new iM(this.Wm,this.Lv),this.Tm.kt()):(this.Tm?.Ov(),this.Tm=null)}Gv(){return this.Lv}iv(){return this.Xp}$m(){if(null!==this.Nm&&(this.jm(),0!==this.ns().tn().length)){if(null!==this.km){let e=this.Nm.U_();this.km.cs(ee(e))}if(null!==this.Pm){let e=this.Nm.q_();this.Pm.cs(ee(e))}}}Ym(){null!==this.km&&this.km.kt(),null!==this.Pm&&this.Pm.kt()}E_(){return null!==this.Nm?this.Nm.E_():0}A_(e){this.Nm&&this.Nm.A_(e)}lp(e){if(!this.Nm)return;this.Km();let t=e.localX,i=e.localY;this.Zm(t,i,e)}Pp(e){this.Km(),this.Gm(),this.Zm(e.localX,e.localY,e)}op(e){if(!this.Nm)return;this.Km();let t=e.localX,i=e.localY;this.Zm(t,i,e)}Sp(e){null!==this.Nm&&(this.Km(),this.Xm(e))}ip(e){null!==this.Nm&&this.Jm(this.Vm,e)}Xf(e){this.ip(e)}mp(e){this.Km(),this.Qm(e),this.Zm(e.localX,e.localY,e)}bp(e){null!==this.Nm&&(this.Km(),this.Em=!1,this.tw(e))}Mp(e){null!==this.Nm&&this.Xm(e)}Op(e){if(this.Em=!0,null===this.Am){let t={x:e.localX,y:e.localY};this.iw(t,t,e)}}zp(e){null!==this.Nm&&(this.Km(),this.Nm.Qt().vd(null),this.sw())}nw(){return this.Im}ew(){return this.Vm}Ip(){this.Bm=1,this.ns().dn()}Vp(e,t){if(!this.Lv.N().handleScale.pinch)return;let i=5*(t-this.Bm);this.Bm=t,this.ns().Td(e._t,i)}yp(e){this.Em=!1,this.Lm=null!==this.Am,this.Gm();let t=this.ns().gd();null!==this.Am&&t.It()&&(this.zm={x:t.si(),y:t.ni()},this.Am={x:e.localX,y:e.localY})}pp(e){if(null===this.Nm)return;let t=e.localX,i=e.localY;if(null===this.Am)this.Qm(e);else{this.Lm=!1;let s=ee(this.zm),r=s.x+(t-this.Am.x),n=s.y+(i-this.Am.y);this.Zm(r,n,e)}}gp(e){0===this.Gv().N().trackingMode.exitMode&&(this.Lm=!0),this.rw(),this.tw(e)}Qn(e,t){let i=this.Nm;return null===i?null:tX(i,e,t)}hw(e,t){ee("left"===t?this.km:this.Pm).dm(W({width:e,height:this.Uv.height}))}sv(){return this.Uv}dm(e){V(this.Uv,e)||(this.Uv=e,this.Kv=!0,this.sm.resizeCanvasElement(e),this.nm.resizeCanvasElement(e),this.Kv=!1,this.Wm.style.width=e.width+"px",this.Wm.style.height=e.height+"px")}aw(){let e=ee(this.Nm);for(let t of(e.H_(e.U_()),e.H_(e.q_()),e.Sl()))if(e.Zn(t)){let i=t.Ft();null!==i&&e.H_(i),t.Ws()}for(let t of e.ru())t.Ws()}nv(){return this.sm.bitmapSize}ev(e,t,i,s){let r=this.nv();if(r.width>0&&r.height>0&&(e.drawImage(this.sm.canvasElement,t,i),s)){let s=this.nm.canvasElement;null!==e&&e.drawImage(s,t,i)}}pm(e){if(0===e||null===this.Nm)return;e>1&&this.aw(),null!==this.km&&this.km.pm(e),null!==this.Pm&&this.Pm.pm(e);let t={colorSpace:this.Lv.N().layout.colorSpace};if(1!==e){this.sm.applySuggestedBitmapSize();let e=q(this.sm,t);null!==e&&(e.useBitmapCoordinateSpace(e=>{this.wm(e)}),this.Nm&&(this.lw(e,iL),this.ow(e),this.lw(e,iI),this.lw(e,iA)))}this.nm.applySuggestedBitmapSize();let i=q(this.nm,t);null!==i&&(i.useBitmapCoordinateSpace(({context:e,bitmapSize:t})=>{e.clearRect(0,0,t.width,t.height)}),this._w(i),this.lw(i,iF),this.lw(i,iA))}uw(){return this.km}cw(){return this.Pm}Mm(e,t){this.lw(e,t)}Fm(){null!==this.Nm&&this.Nm.nu().u(this),this.Nm=null}Xm(e){this.Jm(this.Im,e)}Jm(e,t){let i=t.localX,s=t.localY;e.v()&&e.p(this.ns().Et().wc(i),{x:i,y:s},t)}wm({context:e,bitmapSize:t}){let{width:i,height:s}=t,r=this.ns(),n=r.$(),l=r.Kd();n===l?eC(e,0,0,i,s,l):ek(e,0,0,i,s,n,l)}ow(e){let t=ee(this.Nm),i=t.eu().pr().Tt(t);null!==i&&i.nt(e,!1)}_w(e){this.dw(e,iI,ik,this.ns().gd())}lw(e,t){let i=ee(this.Nm),s=i.Dt(),r=i.ru();for(let i of r)this.dw(e,t,iP,i);for(let i of s)this.dw(e,t,iP,i);for(let i of r)this.dw(e,t,ik,i);for(let i of s)this.dw(e,t,ik,i)}dw(e,t,i,s){let r=ee(this.Nm),n=r.Qt().pd(),l=null!==n&&n.hu===s,a=null!==n&&l&&void 0!==n.au?n.au.ie:void 0;iE(t,t=>i(t,e,l,a),s,r)}jm(){if(null===this.Nm)return;let e=this.Lv,t=this.Nm.U_().N().visible,i=this.Nm.q_().N().visible;t||null===this.km||(this.Hm.removeChild(this.km.iv()),this.km.m(),this.km=null),i||null===this.Pm||(this.Um.removeChild(this.Pm.iv()),this.Pm.m(),this.Pm=null);let s=e.Qt().Nd();t&&null===this.km&&(this.km=new iT(this,e.N(),s,"left"),this.Hm.appendChild(this.km.iv())),i&&null===this.Pm&&(this.Pm=new iT(this,e.N(),s,"right"),this.Um.appendChild(this.Pm.iv()))}fw(e){return e.Np&&this.Em||null!==this.Am}Zm(e,t,i){e=Math.max(0,Math.min(e,this.Uv.width-1)),t=Math.max(0,Math.min(t,this.Uv.height-1)),this.ns().Ad(e,t,i,ee(this.Nm))}sw(){this.ns().zd()}rw(){this.Lm&&(this.Am=null,this.sw())}iw(e,t,i){this.Am=e,this.Lm=!1,this.Zm(t.x,t.y,i);let s=this.ns().gd();this.zm={x:s.si(),y:s.ni()}}ns(){return this.Lv.Qt()}tw(e){if(!this.Dm)return;let t=this.ns(),i=this.cv();if(t.X_(i,i.Rs()),this.Rm=null,this.Dm=!1,t.Vd(),null!==this.Om){let e=performance.now(),i=t.Et();this.Om.fe(i.Cc(),e),this.Om.Ec(e)||t.vn(this.Om)}}Km(){this.Am=null}Gm(){if(this.Nm){if(this.ns().dn(),document.activeElement!==document.body&&document.activeElement!==document.documentElement)ee(document.activeElement).blur();else{let e=document.getSelection();null!==e&&e.removeAllRanges()}this.Nm.Rs().Gi()||this.ns().Et().Gi()}}Qm(e){if(null===this.Nm)return;let t=this.ns(),i=t.Et();if(i.Gi())return;let s=this.Lv.N(),r=s.handleScroll,n=s.kineticScroll;if((!r.pressedMouseMove||e.Np)&&(!r.horzTouchDrag&&!r.vertTouchDrag||!e.Np))return;let l=this.Nm.Rs(),a=performance.now();if(null!==this.Rm||this.fw(e)||(this.Rm={x:e.clientX,y:e.clientY,cf:a,pw:e.localX,mw:e.localY}),null!==this.Rm&&!this.Dm&&(this.Rm.x!==e.clientX||this.Rm.y!==e.clientY)){if(e.Np&&n.touch||!e.Np&&n.mouse){let e=i.ul();this.Om=new ij(.2/e,7/e,.997,15/e),this.Om.Dv(i.Cc(),this.Rm.cf)}else this.Om=null;l.Gi()||t.Z_(this.Nm,l,e.localY),t.Dd(e.localX),this.Dm=!0}this.Dm&&(l.Gi()||t.G_(this.Nm,l,e.localY),t.Id(e.localX),null!==this.Om&&this.Om.Dv(i.Cc(),a))}}class iD{constructor(e,t,i,s,r){this.xt=!0,this.Uv=W({width:0,height:0}),this.Zv=()=>this.pm(3),this.Jv="left"===e,this.hd=i.Nd,this.Ps=t,this.ww=s,this.gw=r,this.Jp=document.createElement("div"),this.Jp.style.width="25px",this.Jp.style.height="100%",this.Jp.style.overflow="hidden",this.sm=iC(this.Jp,W({width:16,height:16})),this.sm.subscribeSuggestedBitmapSizeChanged(this.Zv)}m(){this.sm.unsubscribeSuggestedBitmapSizeChanged(this.Zv),iN(this.sm.canvasElement),this.sm.dispose()}iv(){return this.Jp}sv(){return this.Uv}dm(e){V(this.Uv,e)||(this.Uv=e,this.sm.resizeCanvasElement(e),this.Jp.style.width=`${e.width}px`,this.Jp.style.height=`${e.height}px`,this.xt=!0)}pm(e){if(e<3&&!this.xt||0===this.Uv.width||0===this.Uv.height)return;this.xt=!1,this.sm.applySuggestedBitmapSize();let t=q(this.sm,{colorSpace:this.Ps.layout.colorSpace});null!==t&&t.useBitmapCoordinateSpace(e=>{this.wm(e),this.gm(e)})}nv(){return this.sm.bitmapSize}ev(e,t,i){let s=this.nv();s.width>0&&s.height>0&&e.drawImage(this.sm.canvasElement,t,i)}gm({context:e,bitmapSize:t,horizontalPixelRatio:i,verticalPixelRatio:s}){if(!this.ww())return;e.fillStyle=this.Ps.timeScale.borderColor;let r=Math.floor(this.hd.N().S*i),n=Math.floor(this.hd.N().S*s),l=this.Jv?t.width-r:0;e.fillRect(l,0,r,n)}wm({context:e,bitmapSize:t}){eC(e,0,0,t.width,t.height,this.gw())}}function iO(e){return t=>t.Ka?.(e)??[]}let iB=iO("normal"),i$=iO("top"),iW=iO("bottom");class iV{constructor(e,t){this.Mw=null,this.bw=null,this.M=null,this.Sw=!1,this.Uv=W({width:0,height:0}),this.xw=new ei,this.qv=new eU(5),this.Kv=!1,this.Zv=()=>{this.Kv||this.Lv.Qt().dr()},this.Xv=()=>{this.Kv||this.Lv.Qt().dr()},this.Lv=e,this.cu=t,this.Ps=e.N().layout,this.Vv=document.createElement("tr"),this.Cw=document.createElement("td"),this.Cw.style.padding="0",this.yw=document.createElement("td"),this.yw.style.padding="0",this.Jp=document.createElement("td"),this.Jp.style.height="25px",this.Jp.style.padding="0",this.kw=document.createElement("div"),this.kw.style.width="100%",this.kw.style.height="100%",this.kw.style.position="relative",this.kw.style.overflow="hidden",this.Jp.appendChild(this.kw),this.sm=iC(this.kw,W({width:16,height:16})),this.sm.subscribeSuggestedBitmapSizeChanged(this.Zv);const i=this.sm.canvasElement;i.style.position="absolute",i.style.zIndex="1",i.style.left="0",i.style.top="0",this.nm=iC(this.kw,W({width:16,height:16})),this.nm.subscribeSuggestedBitmapSizeChanged(this.Xv);const s=this.nm.canvasElement;s.style.position="absolute",s.style.zIndex="2",s.style.left="0",s.style.top="0",this.Vv.appendChild(this.Cw),this.Vv.appendChild(this.Jp),this.Vv.appendChild(this.yw),this.Pw(),this.Lv.Qt().B_().i(this.Pw.bind(this),this),this.$p=new ip(this.nm.canvasElement,this,{dp:()=>!0,fp:()=>!this.Lv.N().handleScroll.horzTouchDrag})}m(){this.$p.m(),null!==this.Mw&&this.Mw.m(),null!==this.bw&&this.bw.m(),this.nm.unsubscribeSuggestedBitmapSizeChanged(this.Xv),iN(this.nm.canvasElement),this.nm.dispose(),this.sm.unsubscribeSuggestedBitmapSizeChanged(this.Zv),iN(this.sm.canvasElement),this.sm.dispose()}iv(){return this.Vv}Tw(){return this.Mw}Rw(){return this.bw}Pp(e){if(this.Sw)return;this.Sw=!0;let t=this.Lv.Qt();!t.Et().Gi()&&this.Lv.N().handleScale.axisPressedMouseMove.time&&t.Pd(e.localX)}yp(e){this.Pp(e)}Tp(){let e=this.Lv.Qt();!e.Et().Gi()&&this.Sw&&(this.Sw=!1,this.Lv.N().handleScale.axisPressedMouseMove.time&&e.Ed())}mp(e){let t=this.Lv.Qt();!t.Et().Gi()&&this.Lv.N().handleScale.axisPressedMouseMove.time&&t.Bd(e.localX)}pp(e){this.mp(e)}bp(){this.Sw=!1;let e=this.Lv.Qt();e.Et().Gi()&&!this.Lv.N().handleScale.axisPressedMouseMove.time||e.Ed()}gp(){this.bp()}ip(){this.Lv.N().handleScale.axisDoubleClickReset.time&&this.Lv.Qt().wn()}Xf(){this.ip()}lp(){this.Lv.Qt().N().handleScale.axisPressedMouseMove.time&&this.Cm(1)}zp(){this.Cm(0)}sv(){return this.Uv}Dw(){return this.xw}Iw(e,t,i){V(this.Uv,e)||(this.Uv=e,this.Kv=!0,this.sm.resizeCanvasElement(e),this.nm.resizeCanvasElement(e),this.Kv=!1,this.Jp.style.width=`${e.width}px`,this.Jp.style.height=`${e.height}px`,this.xw.p(e)),null!==this.Mw&&this.Mw.dm(W({width:t,height:e.height})),null!==this.bw&&this.bw.dm(W({width:i,height:e.height}))}Vw(){let e=this.Bw();return Math.ceil(e.S+e.C+e.k+e.A+e.I+e.Ew)}kt(){this.Lv.Qt().Et().Vl()}nv(){return this.sm.bitmapSize}ev(e,t,i,s){let r=this.nv();if(r.width>0&&r.height>0&&(e.drawImage(this.sm.canvasElement,t,i),s)){let s=this.nm.canvasElement;e.drawImage(s,t,i)}}pm(e){if(0===e)return;let t={colorSpace:this.Ps.colorSpace};if(1!==e){this.sm.applySuggestedBitmapSize();let i=q(this.sm,t);null!==i&&(i.useBitmapCoordinateSpace(e=>{this.wm(e),this.gm(e),this.Aw(i,iW)}),this.bm(i),this.Aw(i,iB)),null!==this.Mw&&this.Mw.pm(e),null!==this.bw&&this.bw.pm(e)}this.nm.applySuggestedBitmapSize();let i=q(this.nm,t);null!==i&&(i.useBitmapCoordinateSpace(({context:e,bitmapSize:t})=>{e.clearRect(0,0,t.width,t.height)}),this.Lw([...this.Lv.Qt().tn(),this.Lv.Qt().gd()],i),this.Aw(i,i$))}Aw(e,t){let i=this.Lv.Qt().tn();for(let s of i)iE(t,t=>iP(t,e,!1,void 0),s,void 0);for(let s of i)iE(t,t=>ik(t,e,!1,void 0),s,void 0)}wm({context:e,bitmapSize:t}){eC(e,0,0,t.width,t.height,this.Lv.Qt().Kd())}gm({context:e,bitmapSize:t,verticalPixelRatio:i}){if(this.Lv.N().timeScale.borderVisible){e.fillStyle=this.zw();let s=Math.max(1,Math.floor(this.Bw().S*i));e.fillRect(0,0,t.width,s)}}bm(e){let t=this.Lv.Qt().Et(),i=t.Vl();if(!i||0===i.length)return;let s=this.cu.maxTickMarkWeight(i),r=this.Bw(),n=t.N();n.borderVisible&&n.ticksVisible&&e.useBitmapCoordinateSpace(({context:e,horizontalPixelRatio:t,verticalPixelRatio:s})=>{e.strokeStyle=this.zw(),e.fillStyle=this.zw();let n=Math.max(1,Math.floor(t)),l=Math.floor(.5*t);e.beginPath();let a=Math.round(r.C*s);for(let s=i.length;s--;){let r=Math.round(i[s].coord*t);e.rect(r-l,0,n,a)}e.fill()}),e.useMediaCoordinateSpace(({context:e})=>{let t=r.S+r.C+r.A+r.k/2;for(let r of(e.textAlign="center",e.textBaseline="middle",e.fillStyle=this.H(),e.font=this._m(),i))if(r.weight<s){let i=r.needAlignCoordinate?this.Ow(e,r.coord,r.label):r.coord;e.fillText(r.label,i,t)}for(let r of(this.Lv.N().timeScale.allowBoldLabels&&(e.font=this.Nw()),i))if(r.weight>=s){let i=r.needAlignCoordinate?this.Ow(e,r.coord,r.label):r.coord;e.fillText(r.label,i,t)}})}Ow(e,t,i){let s=this.qv.Ii(e,i),r=Math.floor(t-s/2)+.5;return r<0?t+=Math.abs(0-r):r+s>this.Uv.width&&(t-=Math.abs(this.Uv.width-(r+s))),t}Lw(e,t){let i=this.Bw();for(let s of e)for(let e of s.fs())e.Tt().nt(t,i)}zw(){return this.Lv.N().timeScale.borderColor}H(){return this.Ps.textColor}F(){return this.Ps.fontSize}_m(){return ed(this.F(),this.Ps.fontFamily)}Nw(){return ed(this.F(),this.Ps.fontFamily,"bold")}Bw(){null===this.M&&(this.M={S:1,L:NaN,A:NaN,I:NaN,ts:NaN,C:5,k:NaN,P:"",Qi:new eU,Ew:0});let e=this.M,t=this._m();if(e.P!==t){let i=this.F();e.k=i,e.P=t,e.A=3*i/12,e.I=3*i/12,e.ts=9*i/12,e.L=0,e.Ew=4*i/12,e.Qi.On()}return this.M}Cm(e){this.Jp.style.cursor=1===e?"ew-resize":"default"}Pw(){let e=this.Lv.Qt(),t=e.N();t.leftPriceScale.visible||null===this.Mw||(this.Cw.removeChild(this.Mw.iv()),this.Mw.m(),this.Mw=null),t.rightPriceScale.visible||null===this.bw||(this.yw.removeChild(this.bw.iv()),this.bw.m(),this.bw=null);let i={Nd:this.Lv.Qt().Nd()},s=()=>t.leftPriceScale.borderVisible&&e.Et().N().borderVisible,r=()=>e.Kd();t.leftPriceScale.visible&&null===this.Mw&&(this.Mw=new iD("left",t,i,s,r),this.Cw.appendChild(this.Mw.iv())),t.rightPriceScale.visible&&null===this.bw&&(this.bw=new iD("right",t,i,s,r),this.yw.appendChild(this.bw.iv()))}}let iK=!!ic&&!!navigator.userAgentData&&navigator.userAgentData.brands.some(e=>e.brand.includes("Chromium"))&&!!ic&&(navigator?.userAgentData?.platform?"Windows"===navigator.userAgentData.platform:navigator.userAgent.toLowerCase().indexOf("win")>=0);class iU{constructor(e,t,i){var s;this.Fw=[],this.Ww=[],this.Hw=0,this.eo=0,this.S_=0,this.Uw=0,this.$w=0,this.qw=null,this.jw=!1,this.Im=new ei,this.Vm=new ei,this.nd=new ei,this.Yw=null,this.Kw=null,this.Av=e,this.Ps=t,this.cu=i,this.Vv=document.createElement("div"),this.Vv.classList.add("tv-lightweight-charts"),this.Vv.style.overflow="hidden",this.Vv.style.direction="ltr",this.Vv.style.width="100%",this.Vv.style.height="100%",(s=this.Vv).style.userSelect="none",s.style.webkitUserSelect="none",s.style.msUserSelect="none",s.style.MozUserSelect="none",s.style.webkitTapHighlightColor="transparent",this.Zw=document.createElement("table"),this.Zw.setAttribute("cellspacing","0"),this.Vv.appendChild(this.Zw),this.Gw=this.Xw.bind(this),iH(this.Ps)&&this.Jw(!0),this.ns=new t5(this.rd.bind(this),this.Ps,i),this.Qt().Md().i(this.Qw.bind(this),this),this.tg=new iV(this,this.cu),this.Zw.appendChild(this.tg.iv());const r=t.autoSize&&this.ig();let n=this.Ps.width,l=this.Ps.height;if(r||0===n||0===l){const t=e.getBoundingClientRect();n=n||t.width,l=l||t.height}this.sg(n,l),this.ng(),e.appendChild(this.Vv),this.eg(),this.ns.Et().Oc().i(this.ns.Ca.bind(this.ns),this),this.ns.B_().i(this.ns.Ca.bind(this.ns),this)}Qt(){return this.ns}N(){return this.Ps}Zp(){return this.Fw}rg(){return this.tg}m(){for(let e of(this.Jw(!1),0!==this.Hw&&window.cancelAnimationFrame(this.Hw),this.ns.Md().u(this),this.ns.Et().Oc().u(this),this.ns.B_().u(this),this.ns.m(),this.Fw))this.Zw.removeChild(e.iv()),e.nw().u(this),e.ew().u(this),e.m();for(let e of(this.Fw=[],this.Ww))this.hg(e);this.Ww=[],ee(this.tg).m(),null!==this.Vv.parentElement&&this.Vv.parentElement.removeChild(this.Vv),this.nd.m(),this.Im.m(),this.Vm.m(),this.ag()}sg(e,t,i=!1){var s;let r,n;if(this.eo===t&&this.S_===e)return;let l=(r=Math.floor((s=W({width:e,height:t})).width),W({width:r-r%2,height:(n=Math.floor(s.height))-n%2}));this.eo=l.height,this.S_=l.width;let a=this.eo+"px",o=this.S_+"px";ee(this.Vv).style.height=a,ee(this.Vv).style.width=o,this.Zw.style.height=a,this.Zw.style.width=o,i?this.lg(eD.yn(),performance.now()):this.ns.Ca()}pm(e){void 0===e&&(e=eD.yn());for(let t=0;t<this.Fw.length;t++)this.Fw[t].pm(e.un(t).an);this.Ps.timeScale.visible&&this.tg.pm(e._n())}cr(e){let t=iH(this.Ps);this.ns.cr(e);let i=iH(this.Ps);i!==t&&this.Jw(i),e.layout?.panes&&this.og(),this.eg(),this._g(e)}nw(){return this.Im}ew(){return this.Vm}Md(){return this.nd}ug(e=!1){null!==this.qw&&(this.lg(this.qw,performance.now()),this.qw=null);let t=this.cg(null),i=document.createElement("canvas");i.width=t.width,i.height=t.height;let s=ee(i.getContext("2d"));return this.cg(s,e),i}dg(e){return("left"!==e||this.fg())&&("right"!==e||this.pg())&&0!==this.Fw.length?ee("left"===e?this.Fw[0].uw():this.Fw[0].cw()).fm():0}vg(){return this.Ps.autoSize&&null!==this.Yw}hv(){return this.Vv}mg(e){this.Kw=e,this.Kw?this.hv().style.setProperty("cursor",e):this.hv().style.removeProperty("cursor")}wg(){return this.Kw}gg(e){return Z(this.Fw[e]).sv()}og(){this.Ww.forEach(e=>{e.kt()})}_g(e){(void 0!==e.autoSize||!this.Yw||void 0===e.width&&void 0===e.height)&&(e.autoSize&&!this.Yw&&this.ig(),!1===e.autoSize&&null!==this.Yw&&this.ag(),e.autoSize||void 0===e.width&&void 0===e.height||this.sg(e.width||this.S_,e.height||this.eo))}cg(e,t){let i=0,s=0,r=this.Fw[0],n=(i,s)=>{let r=0;for(let n=0;n<this.Fw.length;n++){let l=this.Fw[n],a=ee("left"===i?l.uw():l.cw()),o=a.nv();if(null!==e&&a.ev(e,s,r,t),r+=o.height,n<this.Fw.length-1){let t=this.Ww[n],i=t.nv();null!==e&&t.ev(e,s,r),r+=i.height}}};this.fg()&&(n("left",0),i+=ee(r.uw()).nv().width);for(let r=0;r<this.Fw.length;r++){let n=this.Fw[r],l=n.nv();if(null!==e&&n.ev(e,i,s,t),s+=l.height,r<this.Fw.length-1){let t=this.Ww[r],n=t.nv();null!==e&&t.ev(e,i,s),s+=n.height}}i+=r.nv().width,this.pg()&&(n("right",i),i+=ee(r.cw()).nv().width);let l=(t,i,s)=>{ee("left"===t?this.tg.Tw():this.tg.Rw()).ev(ee(e),i,s)};if(this.Ps.timeScale.visible){let i=this.tg.nv();if(null!==e){let n=0;this.fg()&&(l("left",n,s),n=ee(r.uw()).nv().width),this.tg.ev(e,n,s,t),n+=i.width,this.pg()&&l("right",n,s)}s+=i.height}return W({width:i,height:s})}Mg(){var e,t,i;let s=0,r=0,n=0;for(let e of this.Fw)this.fg()&&(r=Math.max(r,ee(e.uw()).om(),this.Ps.leftPriceScale.minimumWidth)),this.pg()&&(n=Math.max(n,ee(e.cw()).om(),this.Ps.rightPriceScale.minimumWidth)),s+=e.E_();r=(t=r)+t%2,n=(i=n)+i%2;let l=this.S_,a=this.eo,o=Math.max(l-r-n,0),h=+this.Ww.length,u=this.Ps.timeScale.visible,c=u?Math.max(this.tg.Vw(),this.Ps.timeScale.minimumHeight):0,d=h+(c=(e=c)+e%2),m=a<d?0:a-d,p=m/s,f=0,g=window.devicePixelRatio||1;for(let e=0;e<this.Fw.length;++e){let t=this.Fw[e];t.qm(this.ns.Xs()[e]);let i=0;i=Math.max(e===this.Fw.length-1?Math.ceil((m-f)*g)/g:Math.round(t.E_()*p*g)/g,2),f+=i,t.dm(W({width:o,height:i})),this.fg()&&t.hw(r,"left"),this.pg()&&t.hw(n,"right"),t.cv()&&this.ns.bd(t.cv(),i)}this.tg.Iw(W({width:u?o:0,height:c}),u?r:0,u?n:0),this.ns.L_(o),this.Uw!==r&&(this.Uw=r),this.$w!==n&&(this.$w=n)}Jw(e){e?this.Vv.addEventListener("wheel",this.Gw,{passive:!1}):this.Vv.removeEventListener("wheel",this.Gw)}bg(e){switch(e.deltaMode){case e.DOM_DELTA_PAGE:return 120;case e.DOM_DELTA_LINE:return 32}return iK?1/window.devicePixelRatio:1}Xw(e){if(!(0!==e.deltaX&&this.Ps.handleScroll.mouseWheel||0!==e.deltaY&&this.Ps.handleScale.mouseWheel))return;let t=this.bg(e),i=t*e.deltaX/100,s=-t*e.deltaY/100;if(e.cancelable&&e.preventDefault(),0!==s&&this.Ps.handleScale.mouseWheel){let t=Math.sign(s)*Math.min(1,Math.abs(s)),i=e.clientX-this.Vv.getBoundingClientRect().left;this.Qt().Td(i,t)}0!==i&&this.Ps.handleScroll.mouseWheel&&this.Qt().Rd(-80*i)}lg(e,t){let i=e._n();3===i&&this.Sg(),3!==i&&2!==i||(this.xg(e),this.Cg(e,t),this.tg.kt(),this.Fw.forEach(e=>{e.Ym()}),3===this.qw?._n()&&(this.qw.Sn(e),this.Sg(),this.xg(this.qw),this.Cg(this.qw,t),e=this.qw,this.qw=null)),this.pm(e)}Cg(e,t){for(let i of e.bn())this.xn(i,t)}xg(e){let t=this.ns.Xs();for(let i=0;i<t.length;i++)e.un(i).ln&&t[i].tu()}xn(e,t){let i=this.ns.Et();switch(e.fn){case 0:i.Fc();break;case 1:i.Wc(e.Wt);break;case 2:i.gn(e.Wt);break;case 3:i.Mn(e.Wt);break;case 4:i.Pc();break;case 5:e.Wt.Ec(t)||i.Mn(e.Wt.Ac(t))}}rd(e){null!==this.qw?this.qw.Sn(e):this.qw=e,this.jw||(this.jw=!0,this.Hw=window.requestAnimationFrame(e=>{if(this.jw=!1,this.Hw=0,null!==this.qw){let t=this.qw;for(let i of(this.qw=null,this.lg(t,e),t.bn()))if(5===i.fn&&!i.Wt.Ec(e)){this.Qt().vn(i.Wt);break}}}))}Sg(){this.ng()}hg(e){this.Zw.removeChild(e.iv()),e.m()}ng(){let e=this.ns.Xs(),t=e.length,i=this.Fw.length;for(let e=t;e<i;e++){let e=Z(this.Fw.pop());this.Zw.removeChild(e.iv()),e.nw().u(this),e.ew().u(this),e.m();let t=this.Ww.pop();void 0!==t&&this.hg(t)}for(let s=i;s<t;s++){let t=new iz(this,e[s]);if(t.nw().i(this.yg.bind(this,t),this),t.ew().i(this.kg.bind(this,t),this),this.Fw.push(t),s>0){let e=new iy(this,s-1,s);this.Ww.push(e),this.Zw.insertBefore(e.iv(),this.tg.iv())}this.Zw.insertBefore(t.iv(),this.tg.iv())}for(let i=0;i<t;i++){let t=e[i],s=this.Fw[i];s.cv()!==t?s.qm(t):s.$m()}this.eg(),this.Mg()}Pg(e,t,i,s){let r,n=new Map;if(null!==e&&this.ns.tn().forEach(t=>{let i=t.qs().$s(e);null!==i&&n.set(t,i)}),null!==e){let t=this.ns.Et().es(e)?.originalTime;void 0!==t&&(r=t)}let l=this.Qt().pd(),a=null!==l&&l.hu instanceof tM?l.hu:void 0,o=null!==l&&void 0!==l.au?l.au.te:void 0,h=this.Tg(s);return{Gr:r,js:e??void 0,Rg:t??void 0,Dg:-1!==h?h:void 0,Ig:a,Vg:n,Bg:o,Eg:i??void 0}}Tg(e){let t=-1;if(e)t=this.Fw.indexOf(e);else{let e=this.Qt().gd().Gs();null!==e&&(t=this.Qt().Xs().indexOf(e))}return t}yg(e,t,i,s){this.Im.p(()=>this.Pg(t,i,s,e))}kg(e,t,i,s){this.Vm.p(()=>this.Pg(t,i,s,e))}Qw(e,t,i){this.mg(this.Qt().pd()?.ou??null),this.nd.p(()=>this.Pg(e,t,i))}eg(){let e=this.Ps.timeScale.visible?"":"none";this.tg.iv().style.display=e}fg(){return this.Fw[0].cv().U_().N().visible}pg(){return this.Fw[0].cv().q_().N().visible}ig(){return"ResizeObserver"in window&&(this.Yw=new ResizeObserver(e=>{let t=e[e.length-1];t&&this.sg(t.contentRect.width,t.contentRect.height)}),this.Yw.observe(this.Av,{box:"border-box"}),!0)}ag(){null!==this.Yw&&this.Yw.disconnect(),this.Yw=null}}function iH(e){return!!(e.handleScroll.mouseWheel||e.handleScale.mouseWheel)}function iJ(e,t,i,s){let r=i.value,n={js:t,wt:e,Wt:[r,r,r,r],Gr:s};return void 0!==i.color&&(n.R=i.color),n}function iq(e,t,i,s){let r=i.value,n={js:t,wt:e,Wt:[r,r,r,r],Gr:s};return void 0!==i.lineColor&&(n.vt=i.lineColor),void 0!==i.topColor&&(n.eh=i.topColor),void 0!==i.bottomColor&&(n.rh=i.bottomColor),n}function iY(e,t,i,s){let r=i.value,n={js:t,wt:e,Wt:[r,r,r,r],Gr:s};return void 0!==i.topLineColor&&(n.hh=i.topLineColor),void 0!==i.bottomLineColor&&(n.ah=i.bottomLineColor),void 0!==i.topFillColor1&&(n.oh=i.topFillColor1),void 0!==i.topFillColor2&&(n._h=i.topFillColor2),void 0!==i.bottomFillColor1&&(n.uh=i.bottomFillColor1),void 0!==i.bottomFillColor2&&(n.dh=i.bottomFillColor2),n}function iX(e,t,i,s){let r={js:t,wt:e,Wt:[i.open,i.high,i.low,i.close],Gr:s};return void 0!==i.color&&(r.R=i.color),r}function iG(e,t,i,s){let r={js:t,wt:e,Wt:[i.open,i.high,i.low,i.close],Gr:s};return void 0!==i.color&&(r.R=i.color),void 0!==i.borderColor&&(r.Ht=i.borderColor),void 0!==i.wickColor&&(r.nh=i.wickColor),r}function iQ(e,t,i,s,r){let n=Z(r)(i),l=Math.max(...n),a=Math.min(...n),o=n[n.length-1],{time:h,color:u,...c}=i;return{js:t,wt:e,Wt:[o,l,a,o],Gr:s,le:c,R:u}}function iZ(e){return void 0!==e.Wt}function i0(e,t){return void 0!==t.customValues&&(e.Ag=t.customValues),e}function i1(e){return(t,i,s,r,n,l)=>(l?l(s):void 0===s.open&&void 0===s.value)?i0({wt:t,js:i,Gr:r},s):i0(e(t,i,s,r,n),s)}function i2(e){return({Candlestick:i1(iG),Bar:i1(iX),Area:i1(iq),Baseline:i1(iY),Histogram:i1(iJ),Line:i1(iJ),Custom:i1(iQ)})[e]}function i3(e){return{js:0,Lg:new Map,Ea:e}}function i5(e,t){if(void 0!==e&&0!==e.length)return{zg:t.key(e[0].wt),Og:t.key(e[e.length-1].wt)}}function i4(e){let t;return e.forEach(e=>{void 0===t&&(t=e.Gr)}),Z(t)}class i6{constructor(e){this.Ng=new Map,this.Fg=new Map,this.Wg=new Map,this.Hg=[],this.cu=e}m(){this.Ng.clear(),this.Fg.clear(),this.Wg.clear(),this.Hg=[]}Ug(e,t){let i=0!==this.Ng.size,s=!1,r=this.Fg.get(e);if(void 0!==r)if(1===this.Fg.size)i=!1,s=!0,this.Ng.clear();else for(let t of this.Hg)t.pointData.Lg.delete(e)&&(s=!0);let n=[];if(0!==t.length){let i=t.map(e=>e.time),r=this.cu.createConverterToInternalObj(t),l=i2(e.wh()),a=e.rl(),o=e.hl();n=t.map((t,n)=>{let h=r(t.time),u=this.cu.key(h),c=this.Ng.get(u);void 0===c&&(c=i3(h),this.Ng.set(u,c),s=!0);let d=l(h,c.js,t,i[n],a,o);return c.Lg.set(e,d),d})}i&&this.$g(),this.qg(e,n);let l=-1;if(s){let e=[];this.Ng.forEach(t=>{e.push({timeWeight:0,time:t.Ea,pointData:t,originalTime:i4(t.Lg)})}),e.sort((e,t)=>this.cu.key(e.time)-this.cu.key(t.time)),l=this.jg(e)}return this.Yg(e,l,function(e,t,i){let s=i5(e,i),r=i5(t,i);if(void 0!==s&&void 0!==r)return{Kg:!1,Ta:s.Og>=r.Og&&s.zg>=r.zg}}(this.Fg.get(e),r,this.cu))}Hd(e){return this.Ug(e,[])}Zg(e,t,i){if(i&&e.La())throw Error("Historical updates are not supported when conflation is enabled. Conflation requires data to be processed in order.");void 0===t.Gr&&(t.Gr=t.time),this.cu.preprocessData(t);let s=this.cu.createConverterToInternalObj([t])(t.time),r=this.Wg.get(e);if(!i&&void 0!==r&&this.cu.key(s)<this.cu.key(r))throw Error(`Cannot update oldest data, last time=${r}, new time=${s}`);let n=this.Ng.get(this.cu.key(s));if(i&&void 0===n)throw Error("Cannot update non-existing data point when historicalUpdate is true");let l=void 0===n;void 0===n&&(n=i3(s),this.Ng.set(this.cu.key(s),n));let a=i2(e.wh()),o=e.rl(),h=e.hl(),u=a(s,n.js,t,t.Gr,o,h),c=!i&&!l&&void 0!==r&&this.cu.key(s)===this.cu.key(r);n.Lg.set(e,u),i?this.Gg(e,u,n.js):(c&&e.La()&&iZ(u)&&e.kr(u),this.Xg(e,u));let d={Ta:iZ(u),Kg:i};if(!l)return this.Yg(e,-1,d);let m={timeWeight:0,time:n.Ea,pointData:n,originalTime:i4(n.Lg)},p=tr(this.Hg,this.cu.key(m.time),(e,t)=>this.cu.key(e.time)<t);this.Hg.splice(p,0,m);for(let e=p;e<this.Hg.length;++e)i9(this.Hg[e].pointData,e);return this.cu.fillWeightsForPoints(this.Hg,p),this.Yg(e,p,d)}Jg(e,t){let i=this.Fg.get(e);if(void 0===i||t<=0)return[[],this.Qg()];t=Math.min(t,i.length);let s=i.splice(-t).reverse();for(let t of(0===i.length?this.Wg.delete(e):this.Wg.set(e,i[i.length-1].wt),s)){let i=this.Ng.get(this.cu.key(t.wt));if(i&&(i.Lg.delete(e),0===i.Lg.size)){this.Ng.delete(this.cu.key(i.Ea)),this.Hg.splice(i.js,1);for(let e=i.js;e<this.Hg.length;++e)i9(this.Hg[e].pointData,e)}}return[s,this.Yg(e,this.Hg.length-1,{Kg:!1,Ta:!1})]}Xg(e,t){let i=this.Fg.get(e);void 0===i&&(i=[],this.Fg.set(e,i));let s=0!==i.length?i[i.length-1]:null;null===s||this.cu.key(t.wt)>this.cu.key(s.wt)?iZ(t)&&i.push(t):iZ(t)?i[i.length-1]=t:i.splice(-1,1),this.Wg.set(e,t.wt)}Gg(e,t,i){let s=this.Fg.get(e);if(void 0===s)return;let r=tr(s,i,(e,t)=>e.js<t);iZ(t)?s[r]=t:s.splice(r,1)}qg(e,t){0!==t.length?(this.Fg.set(e,t.filter(iZ)),this.Wg.set(e,t[t.length-1].wt)):(this.Fg.delete(e),this.Wg.delete(e))}$g(){for(let e of this.Hg)0===e.pointData.Lg.size&&this.Ng.delete(this.cu.key(e.time))}jg(e){let t=-1;for(let i=0;i<this.Hg.length&&i<e.length;++i){let s=this.Hg[i],r=e[i];if(this.cu.key(s.time)!==this.cu.key(r.time)){t=i;break}r.timeWeight=s.timeWeight,i9(r.pointData,i)}if(-1===t&&this.Hg.length!==e.length&&(t=Math.min(this.Hg.length,e.length)),-1===t)return -1;for(let i=t;i<e.length;++i)i9(e[i].pointData,i);return this.cu.fillWeightsForPoints(e,t),this.Hg=e,t}tM(){if(0===this.Fg.size)return null;let e=0;return this.Fg.forEach(t=>{0!==t.length&&(e=Math.max(e,t[t.length-1].js))}),e}Yg(e,t,i){let s=this.Qg();if(-1!==t)this.Fg.forEach((t,r)=>{s.F_.set(r,{le:t,iM:r===e?i:void 0})}),this.Fg.has(e)||s.F_.set(e,{le:[],iM:i}),s.Et.sM=this.Hg,s.Et.nM=t;else{let t=this.Fg.get(e);s.F_.set(e,{le:t||[],iM:i})}return s}Qg(){return{F_:new Map,Et:{vc:this.tM()}}}}function i9(e,t){e.js=t,e.Lg.forEach(e=>{e.js=t})}function i8(e,t){return e.wt<t}function i7(e,t){return t<e.wt}function se(e,t,i){let s=t.Aa(),r=t.bi(),n=tr(e,s,i8),l=tn(e,r,i7);if(!i)return{from:n,to:l};let a=n,o=l;return n>0&&n<e.length&&e[n].wt>=s&&(a=n-1),l>0&&l<e.length&&e[l-1].wt<=r&&(o=l+1),{from:a,to:o}}class st{constructor(e,t,i){this.eM=!0,this.rM=!0,this.hM=!0,this.aM=[],this.lM=null,this.oM=-1,this.ee=e,this.re=t,this._M=i}kt(e){this.eM=!0,"data"===e&&(this.rM=!0),"options"===e&&(this.hM=!0)}Tt(){return this.ee.It()?(this.uM(),null===this.lM?null:this.cM):null}dM(){this.aM=this.aM.map(e=>({...e,...this.ee.ga().gh(e.wt)}))}fM(){this.lM=null}uM(){let e=this.re.Et(),t=e.N().enableConflation?e.Hc():0;t!==this.oM&&(this.rM=!0,this.oM=t),this.rM&&(this.pM(),this.rM=!1),this.hM&&(this.dM(),this.hM=!1),this.eM&&(this.vM(),this.eM=!1)}vM(){let e=this.ee.Ft(),t=this.re.Et();if(this.fM(),t.Gi()||e.Gi())return;let i=t.Ie();if(null===i||0===this.ee.qs().yh())return;let s=this.ee.Lt();null!==s&&(this.lM=se(this.aM,i,this._M),this.mM(e,t,s.Wt),this.wM())}}class si{constructor(e,t){this.gM=e,this.Ki=t}nt(e,t,i){this.gM.draw(e,this.Ki,t,i)}}class ss extends st{constructor(e,t,i){super(e,t,!1),this.$h=i,this.cM=new si(this.$h.renderer(),t=>{let i=e.Lt();return null===i?null:e.Ft().Nt(t,i.Wt)})}get ma(){return this.$h.conflationReducer}Oa(e){return this.$h.priceValueBuilder(e)}al(e){return this.$h.isWhitespace(e)}pM(){let e=this.ee.ga();this.aM=this.ee.Na().Dh().map(t=>({wt:t.js,_t:NaN,...e.gh(t.js),MM:t.le}))}mM(e,t){t.mc(this.aM,eu(this.lM))}wM(){this.$h.update({bars:this.aM.map(sr),barSpacing:this.re.Et().ul(),visibleRange:this.lM,conflationFactor:this.re.Et().Hc()},this.ee.N())}}function sr(e){return{x:e._t,time:e.wt,originalData:e.MM,barColor:e.th}}let sn={color:"#2196f3"},sl=(e,t,i)=>new ss(e,t,et(i));function sa(e){let t={value:e.Wt[3],time:e.Gr};return void 0!==e.Ag&&(t.customValues=e.Ag),t}function so(e){let t=sa(e);return void 0!==e.R&&(t.color=e.R),t}function sh(e){let t=sa(e);return void 0!==e.vt&&(t.lineColor=e.vt),void 0!==e.eh&&(t.topColor=e.eh),void 0!==e.rh&&(t.bottomColor=e.rh),t}function su(e){let t=sa(e);return void 0!==e.hh&&(t.topLineColor=e.hh),void 0!==e.ah&&(t.bottomLineColor=e.ah),void 0!==e.oh&&(t.topFillColor1=e.oh),void 0!==e._h&&(t.topFillColor2=e._h),void 0!==e.uh&&(t.bottomFillColor1=e.uh),void 0!==e.dh&&(t.bottomFillColor2=e.dh),t}function sc(e){let t={open:e.Wt[0],high:e.Wt[1],low:e.Wt[2],close:e.Wt[3],time:e.Gr};return void 0!==e.Ag&&(t.customValues=e.Ag),t}function sd(e){let t=sc(e);return void 0!==e.R&&(t.color=e.R),t}function sm(e){let t=sc(e),{R:i,Ht:s,nh:r}=e;return void 0!==i&&(t.color=i),void 0!==s&&(t.borderColor=s),void 0!==r&&(t.wickColor=r),t}function sp(e){return({Area:sh,Line:so,Baseline:su,Histogram:so,Bar:sd,Candlestick:sm,Custom:sf})[e]}function sf(e){let t=e.Gr;return{...e.le,time:t}}let sg={vertLine:{color:"#9598A1",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#131722"},horzLine:{color:"#9598A1",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#131722"},mode:1,doNotSnapToHiddenSeriesIndices:!1},sv={vertLines:{color:"#D6DCDE",style:0,visible:!0},horzLines:{color:"#D6DCDE",style:0,visible:!0}},sx={background:{type:"solid",color:"#FFFFFF"},textColor:"#191919",fontSize:12,fontFamily:ec,panes:{enableResize:!0,separatorColor:"#E0E3EB",separatorHoverColor:"rgba(178, 181, 189, 0.2)"},attributionLogo:!0,colorSpace:"srgb",colorParsers:[]},sw={autoScale:!0,mode:0,invertScale:!1,alignLabels:!0,borderVisible:!0,borderColor:"#2B2B43",entireTextOnly:!1,visible:!1,ticksVisible:!1,scaleMargins:{bottom:.1,top:.2},minimumWidth:0,ensureEdgeTickMarksVisible:!1},sb={rightOffset:0,barSpacing:6,minBarSpacing:.5,maxBarSpacing:0,fixLeftEdge:!1,fixRightEdge:!1,lockVisibleTimeRangeOnResize:!1,rightBarStaysOnScroll:!1,borderVisible:!0,borderColor:"#2B2B43",visible:!0,timeVisible:!1,secondsVisible:!0,shiftVisibleRangeOnNewBar:!0,allowShiftVisibleRangeOnWhitespaceReplacement:!1,ticksVisible:!1,uniformDistribution:!1,minimumHeight:0,allowBoldLabels:!0,ignoreWhitespaceIndices:!1,enableConflation:!1,conflationThresholdFactor:1,precomputeConflationOnInit:!1,precomputeConflationPriority:"background"};function sy(){return{addDefaultPane:!0,width:0,height:0,autoSize:!1,layout:sx,crosshair:sg,grid:sv,overlayPriceScales:{...sw},leftPriceScale:{...sw,visible:!1},rightPriceScale:{...sw,visible:!0},timeScale:sb,localization:{locale:ic?navigator.language:"",dateFormat:"dd MMM 'yy"},handleScroll:{mouseWheel:!0,pressedMouseMove:!0,horzTouchDrag:!0,vertTouchDrag:!0},handleScale:{axisPressedMouseMove:{time:!0,price:!0},axisDoubleClickReset:{time:!0,price:!0},mouseWheel:!0,pinch:!0},kineticScroll:{mouse:!1,touch:!0},trackingMode:{exitMode:1}}}class sS{constructor(e,t,i){this.Yp=e,this.bM=t,this.SM=i??0}applyOptions(e){this.Yp.Qt().md(this.bM,e,this.SM)}options(){return this.Ki().N()}width(){return ez(this.bM)?this.Yp.dg(this.bM):0}setVisibleRange(e){this.setAutoScale(!1),this.Ki().$o(new e3(e.from,e.to))}getVisibleRange(){let e,t,i=this.Ki().er();if(null===i)return null;if(this.Ki().io()){let s=this.Ki().m_(),r=t4(s);e=Number((Math.round((i=tO(i,this.Ki().no())).Ze()/s)*s).toFixed(r)),t=Number((Math.round(i.Ge()/s)*s).toFixed(r))}else e=i.Ze(),t=i.Ge();return{from:e,to:t}}setAutoScale(e){this.applyOptions({autoScale:e})}Ki(){return ee(this.Yp.Qt().wd(this.bM,this.SM)).Ft}}class sj{constructor(e,t,i,s){this.Yp=e,this.yt=i,this.xM=t,this.CM=s}getHeight(){return this.yt.$t()}setHeight(e){let t=this.Yp.Qt(),i=t.Gd(this.yt);t.xd(i,e)}getStretchFactor(){return this.yt.E_()}setStretchFactor(e){this.yt.A_(e),this.Yp.Qt().Ca()}paneIndex(){return this.Yp.Qt().Gd(this.yt)}moveTo(e){let t=this.paneIndex();t!==e&&(Q(e>=0&&e<this.Yp.Zp().length,"Invalid pane index"),this.Yp.Qt().yd(t,e))}getSeries(){return this.yt.F_().map(e=>this.xM(e))??[]}getHTMLElement(){let e=this.Yp.Zp();return e&&0!==e.length&&e[this.paneIndex()]?e[this.paneIndex()].iv():null}attachPrimitive(e){this.yt.nl(e),e.attached&&e.attached({chart:this.CM,requestUpdate:()=>this.yt.Qt().Ca()})}detachPrimitive(e){this.yt.el(e)}priceScale(e){if(null===this.yt.V_(e))throw Error(`Cannot find price scale with id: ${e}`);return new sS(this.Yp,e,this.paneIndex())}setPreserveEmptyPane(e){this.yt.O_(e)}preserveEmptyPane(){return this.yt.N_()}addCustomSeries(e,t={},i=0){return this.CM.addCustomSeries(e,t,i)}addSeries(e,t={}){return this.CM.addSeries(e,t,this.paneIndex())}}let sM={color:"#FF0000",price:0,lineStyle:2,lineWidth:1,lineVisible:!0,axisLabelVisible:!0,title:"",axisLabelColor:"",axisLabelTextColor:""};class sC{constructor(e){this.hr=e}applyOptions(e){this.hr.cr(e)}options(){return this.hr.N()}yM(){return this.hr}}class sN{constructor(e,t,i,s,r,n){this.kM=new ei,this.ee=e,this.PM=t,this.TM=i,this.cu=r,this.CM=s,this.RM=n}m(){this.kM.m()}priceFormatter(){return this.ee.Xa()}priceToCoordinate(e){let t=this.ee.Lt();return null===t?null:this.ee.Ft().Nt(e,t.Wt)}coordinateToPrice(e){let t=this.ee.Lt();return null===t?null:this.ee.Ft().Ds(e,t.Wt)}barsInLogicalRange(e){if(null===e)return null;let t=new t1(new tQ(e.from,e.to)).Ru(),i=this.ee.qs();if(i.Gi())return null;let s=i.$s(t.Aa(),1),r=i.$s(t.bi(),-1),n=ee(i.kh()),l=ee(i.sn());if(null!==s&&null!==r&&s.js>r.js)return{barsBefore:e.from-n,barsAfter:l-e.to};let a={barsBefore:null===s||s.js===n?e.from-n:s.js-n,barsAfter:null===r||r.js===l?l-e.to:l-r.js};return null!==s&&null!==r&&(a.from=s.Gr,a.to=r.Gr),a}setData(e){this.cu,this.ee.wh(),this.PM.DM(this.ee,e),this.IM("full")}update(e,t=!1){this.ee.wh(),this.PM.VM(this.ee,e,t),this.IM("update")}pop(e=1){let t=this.PM.BM(this.ee,e);0!==t.length&&this.IM("update");let i=sp(this.seriesType());return t.map(e=>i(e))}dataByIndex(e,t){let i=this.ee.qs().$s(e,t);return null===i?null:sp(this.seriesType())(i)}data(){let e=sp(this.seriesType());return this.ee.qs().Dh().map(t=>e(t))}subscribeDataChanged(e){this.kM.i(e)}unsubscribeDataChanged(e){this.kM._(e)}applyOptions(e){this.ee.cr(e)}options(){return eo(this.ee.N())}priceScale(){return this.TM.priceScale(this.ee.Ft().ol(),this.getPane().paneIndex())}createPriceLine(e){let t=es(eo(sM),e);return new sC(this.ee.Da(t))}removePriceLine(e){this.ee.Ia(e.yM())}priceLines(){return this.ee.Va().map(e=>new sC(e))}seriesType(){return this.ee.wh()}lastValueData(e){let t=this.ee.Ve(e);return t.Be?{noData:!0}:{noData:!1,price:t.gt,color:t.R}}attachPrimitive(e){this.ee.nl(e),e.attached&&e.attached({chart:this.CM,series:this,requestUpdate:()=>this.ee.Qt().Ca(),horzScaleBehavior:this.cu})}detachPrimitive(e){this.ee.el(e),e.detached&&e.detached(),this.ee.Qt().Ca()}getPane(){let e=this.ee,t=ee(this.ee.Qt().Kn(e));return this.RM(t)}moveToPane(e){this.ee.Qt().jd(this.ee,e)}seriesOrder(){let e=this.ee.Qt().Kn(this.ee);return null===e?-1:e.F_().indexOf(this.ee)}setSeriesOrder(e){let t=this.ee.Qt().Kn(this.ee);null!==t&&t.su(this.ee,e)}IM(e){this.kM.v()&&this.kM.p(e)}}class sP{constructor(e,t,i){this.EM=new ei,this.Nu=new ei,this.xw=new ei,this.ns=e,this.Jh=e.Et(),this.tg=t,this.Jh.Lc().i(this.AM.bind(this)),this.Jh.zc().i(this.LM.bind(this)),this.tg.Dw().i(this.zM.bind(this)),this.cu=i}m(){this.Jh.Lc().u(this),this.Jh.zc().u(this),this.tg.Dw().u(this),this.EM.m(),this.Nu.m(),this.xw.m()}scrollPosition(){return this.Jh.Cc()}scrollToPosition(e,t){t?this.Jh.Bc(e,1e3):this.ns.Mn(e)}scrollToRealTime(){this.Jh.Vc()}getVisibleRange(){let e=this.Jh.lc();return null===e?null:{from:e.from.originalTime,to:e.to.originalTime}}setVisibleRange(e){let t={from:this.cu.convertHorzItemToInternal(e.from),to:this.cu.convertHorzItemToInternal(e.to)},i=this.Jh.cc(t);this.ns.$d(i)}getVisibleLogicalRange(){let e=this.Jh.ac();return null===e?null:{from:e.Aa(),to:e.bi()}}setVisibleLogicalRange(e){Q(e.from<=e.to,"The from index cannot be after the to index."),this.ns.$d(e)}resetTimeScale(){this.ns.wn()}fitContent(){this.ns.Fc()}logicalToCoordinate(e){let t=this.ns.Et();return t.Gi()?null:t.qt(e)}coordinateToLogical(e){return this.Jh.Gi()?null:this.Jh.wc(e)}timeToIndex(e,t){let i=this.cu.convertHorzItemToInternal(e);return this.Jh.ec(i,t)}timeToCoordinate(e){let t=this.timeToIndex(e,!1);return null===t?null:this.Jh.qt(t)}coordinateToTime(e){let t=this.ns.Et(),i=t.wc(e),s=t.es(i);return null===s?null:s.originalTime}width(){return this.tg.sv().width}height(){return this.tg.sv().height}subscribeVisibleTimeRangeChange(e){this.EM.i(e)}unsubscribeVisibleTimeRangeChange(e){this.EM._(e)}subscribeVisibleLogicalRangeChange(e){this.Nu.i(e)}unsubscribeVisibleLogicalRangeChange(e){this.Nu._(e)}subscribeSizeChange(e){this.xw.i(e)}unsubscribeSizeChange(e){this.xw._(e)}applyOptions(e){this.Jh.cr(e)}options(){return{...eo(this.Jh.N()),barSpacing:this.Jh.ul()}}AM(){this.EM.v()&&this.EM.p(this.getVisibleRange())}LM(){this.Nu.v()&&this.Nu.p(this.getVisibleLogicalRange())}zM(e){this.xw.p(e.width,e.height)}}function sk(e){return function(e){if(ea(e.handleScale)){let t=e.handleScale;e.handleScale={axisDoubleClickReset:{time:t,price:t},axisPressedMouseMove:{time:t,price:t},mouseWheel:t,pinch:t}}else if(void 0!==e.handleScale){let{axisPressedMouseMove:t,axisDoubleClickReset:i}=e.handleScale;ea(t)&&(e.handleScale.axisPressedMouseMove={time:t,price:t}),ea(i)&&(e.handleScale.axisDoubleClickReset={time:i,price:i})}let t=e.handleScroll;ea(t)&&(e.handleScroll={horzTouchDrag:t,vertTouchDrag:t,mouseWheel:t,pressedMouseMove:t})}(e),e}class sE{constructor(e,t,i){this.OM=new Map,this.NM=new Map,this.FM=new ei,this.WM=new ei,this.HM=new ei,this.Xc=new WeakMap,this.UM=new i6(t);const s=void 0===i?eo(sy()):es(eo(sy()),sk(i));this.$M=t,this.Yp=new iU(e,s,t),this.Yp.nw().i(e=>{this.FM.v()&&this.FM.p(this.qM(e()))},this),this.Yp.ew().i(e=>{this.WM.v()&&this.WM.p(this.qM(e()))},this),this.Yp.Md().i(e=>{this.HM.v()&&this.HM.p(this.qM(e()))},this);const r=this.Yp.Qt();this.jM=new sP(r,this.Yp.rg(),this.$M)}remove(){this.Yp.nw().u(this),this.Yp.ew().u(this),this.Yp.Md().u(this),this.jM.m(),this.Yp.m(),this.OM.clear(),this.NM.clear(),this.FM.m(),this.WM.m(),this.HM.m(),this.UM.m()}resize(e,t,i){this.autoSizeActive()||this.Yp.sg(e,t,i)}addCustomSeries(e,t={},i=0){let s,r=(s=et(e),{type:"Custom",isBuiltIn:!1,defaultOptions:{...sn,...s.defaultOptions()},YM:sl,KM:s});return this.ZM(r,t,i)}addSeries(e,t={},i=0){return this.ZM(e,t,i)}removeSeries(e){let t=Z(this.OM.get(e)),i=this.UM.Hd(t);this.Yp.Qt().Hd(t),this.GM(i),this.OM.delete(e),this.NM.delete(t)}DM(e,t){this.GM(this.UM.Ug(e,t))}VM(e,t,i){this.GM(this.UM.Zg(e,t,i))}BM(e,t){let[i,s]=this.UM.Jg(e,t);return 0!==i.length&&this.GM(s),i}subscribeClick(e){this.FM.i(e)}unsubscribeClick(e){this.FM._(e)}subscribeCrosshairMove(e){this.HM.i(e)}unsubscribeCrosshairMove(e){this.HM._(e)}subscribeDblClick(e){this.WM.i(e)}unsubscribeDblClick(e){this.WM._(e)}priceScale(e,t=0){return new sS(this.Yp,e,t)}timeScale(){return this.jM}applyOptions(e){this.Yp.cr(sk(e))}options(){return this.Yp.N()}takeScreenshot(e=!1,t=!1){let i,s;try{t||(i=this.Yp.Qt().N().crosshair.mode,this.Yp.cr({crosshair:{mode:2}})),s=this.Yp.ug(e)}finally{t||void 0===i||this.Yp.Qt().cr({crosshair:{mode:i}})}return s}addPane(e=!1){let t=this.Yp.Qt().Xd();return t.O_(e),this.XM(t)}removePane(e){this.Yp.Qt().Sd(e)}swapPanes(e,t){this.Yp.Qt().Cd(e,t)}autoSizeActive(){return this.Yp.vg()}chartElement(){return this.Yp.hv()}panes(){return this.Yp.Qt().Xs().map(e=>this.XM(e))}paneSize(e=0){let t=this.Yp.gg(e);return{height:t.height,width:t.width}}setCrosshairPosition(e,t,i){let s=this.OM.get(i);if(void 0===s)return;let r=this.Yp.Qt().Kn(s);null!==r&&this.Yp.Qt().Ld(e,t,r)}clearCrosshairPosition(){this.Yp.Qt().zd(!0)}horzBehaviour(){return this.$M}ZM(e,t={},i=0){var s;Q(void 0!==e.YM),void 0===(s=t.priceFormat)||"custom"===s.type||void 0!==s.minMove&&void 0===s.precision&&(s.precision=t4(s.minMove)),"Candlestick"===e.type&&(void 0!==t.borderColor&&(t.borderUpColor=t.borderColor,t.borderDownColor=t.borderColor),void 0!==t.wickColor&&(t.wickUpColor=t.wickColor,t.wickDownColor=t.wickColor));let r=es(eo(Y),eo(e.defaultOptions),t),n=e.YM,l=new tM(this.Yp.Qt(),e.type,r,n,e.KM);this.Yp.Qt().Fd(l,i);let a=new sN(l,this,this,this,this.$M,e=>this.XM(e));return this.OM.set(a,l),this.NM.set(l,a),a}GM(e){let t=this.Yp.Qt();t.Od(e.Et.vc,e.Et.sM,e.Et.nM),e.F_.forEach((e,t)=>t.ht(e.le,e.iM)),t.Et().Ju(),t.Sc()}JM(e){return Z(this.NM.get(e))}qM(e){let t=new Map;e.Vg.forEach((e,i)=>{let s=i.wh(),r=sp(s)(e);if("Custom"!==s){var n;Q(void 0!==(n=r).open||void 0!==n.value)}else{let e=i.hl();Q(!e||!1===e(r))}t.set(this.JM(i),r)});let i=void 0!==e.Ig&&this.NM.has(e.Ig)?this.JM(e.Ig):void 0;return{time:e.Gr,logical:e.js,point:e.Rg,paneIndex:e.Dg,hoveredSeries:i,hoveredObjectId:e.Bg,seriesData:t,sourceEvent:e.Eg}}XM(e){let t=this.Xc.get(e);return t||(t=new sj(this.Yp,e=>this.JM(e),e,this),this.Xc.set(e,t)),t}}class sR extends st{constructor(e,t){super(e,t,!0)}mM(e,t,i){t.mc(this.aM,eu(this.lM)),e.Yo(this.aM,i,eu(this.lM))}QM(e,t){return{wt:e,gt:t,_t:NaN,ut:NaN}}pM(){let e=this.ee.ga();this.aM=this.ee.Na().Dh().map(t=>{let i;if((t.jr??1)>1){let e=t.Wt[1],s=t.Wt[2],r=t.Wt[3];i=Math.abs(e-r)>Math.abs(s-r)?e:s}else i=t.Wt[3];return this.tb(t.js,i,e)})}}function s_(e,t,i,s,r,n,l){if(0===t.length||s.from>=t.length||s.to<=0)return;let{context:a,horizontalPixelRatio:o,verticalPixelRatio:h}=e,u=t[s.from],c=n(e,u),d=u;if(s.to-s.from<2){let t=r/2;a.beginPath();let i={_t:u._t-t,ut:u.ut},s={_t:u._t+t,ut:u.ut};a.moveTo(i._t*o,i.ut*h),a.lineTo(s._t*o,s.ut*h),l(e,c,i,s)}else{let r=(t,i)=>{l(e,c,d,i),a.beginPath(),c=t,d=i},m=d;a.beginPath(),a.moveTo(u._t*o,u.ut*h);for(let l=s.from+1;l<s.to;++l){let s=n(e,m=t[l]);switch(i){case 0:a.lineTo(m._t*o,m.ut*h);break;case 1:a.lineTo(m._t*o,t[l-1].ut*h),s!==c&&(r(s,m),a.lineTo(m._t*o,t[l-1].ut*h)),a.lineTo(m._t*o,m.ut*h);break;case 2:{let[e,i]=function(e,t,i){var s,r;let n=Math.max(0,t-1),l=Math.min(e.length-1,i+1);return[(s=e[t],r=sL(sT(e[i],e[n]),6),{_t:s._t+r._t,ut:s.ut+r.ut}),sT(e[i],sL(sT(e[l],e[t]),6))]}(t,l-1,l);a.bezierCurveTo(e._t*o,e.ut*h,i._t*o,i.ut*h,m._t*o,m.ut*h)}}1!==i&&s!==c&&(r(s,m),a.moveTo(m._t*o,m.ut*h))}(d!==m||d===m&&1===i)&&l(e,c,d,m)}}function sT(e,t){return{_t:e._t-t._t,ut:e.ut-t.ut}}function sL(e,t){return{_t:e._t/t,ut:e.ut/t}}function sI(e,t){let i=e.context;i.strokeStyle=t,i.stroke()}class sA extends ex{constructor(){super(...arguments),this.rt=null}ht(e){this.rt=e}et(e){if(null===this.rt)return;let{ot:t,lt:i,ib:s,sb:r,ct:n,Zt:l,nb:a}=this.rt;if(null===i)return;let o=e.context;o.lineCap="butt",o.lineWidth=n*e.verticalPixelRatio,X(o,l),o.lineJoin="round";let h=this.eb.bind(this);void 0!==r&&s_(e,t,r,i,s,h,sI),a&&function(e,t,i,s,r){if(s.to-s.from<=0)return;let{horizontalPixelRatio:n,verticalPixelRatio:l,context:a}=e,o=null,h=Math.max(1,Math.floor(n))%2/2,u=i*l+h;for(let i=s.to-1;i>=s.from;--i){let s=t[i];if(s){let t=r(e,s);t!==o&&(a.beginPath(),null!==o&&a.fill(),a.fillStyle=t,o=t);let i=Math.round(s._t*n)+h,c=s.ut*l;a.moveTo(i,c),a.arc(i,c,u,0,2*Math.PI)}}a.fill()}(e,t,a,i,h)}}class sF extends sA{eb(e,t){return t.vt}}class sz extends sR{constructor(){super(...arguments),this.cM=new sF}tb(e,t,i){return{...this.QM(e,t),...i.gh(e)}}wM(){let e=this.ee.N(),t={ot:this.aM,Zt:e.lineStyle,sb:e.lineVisible?e.lineType:void 0,ct:e.lineWidth,nb:e.pointMarkersVisible?e.pointMarkersRadius||e.lineWidth/2+2:void 0,lt:this.lM,ib:this.re.Et().ul()};this.cM.ht(t)}}let sD={type:"Line",isBuiltIn:!0,defaultOptions:{color:"#2196f3",lineStyle:0,lineWidth:3,lineType:0,lineVisible:!0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBorderWidth:2,crosshairMarkerBackgroundColor:"",lastPriceAnimation:0,pointMarkersVisible:!1},YM:(e,t)=>new sz(e,t)};class sO extends st{constructor(e,t){super(e,t,!1)}mM(e,t,i){t.mc(this.aM,eu(this.lM)),e.Zo(this.aM,i,eu(this.lM))}Lb(e,t,i){return{wt:e,Hr:t.Wt[0],Ur:t.Wt[1],$r:t.Wt[2],qr:t.Wt[3],_t:NaN,Go:NaN,Xo:NaN,Jo:NaN,Qo:NaN}}pM(){let e=this.ee.ga();this.aM=this.ee.Na().Dh().map(t=>this.tb(t.js,t,e))}}class sB extends ex{constructor(){super(...arguments),this.jt=null,this.Ib=0}ht(e){this.jt=e}et(e){if(null===this.jt||0===this.jt.qs.length||null===this.jt.lt)return;let{horizontalPixelRatio:t}=e;this.Ib=function(e,t){if(e>=2.5&&e<=4)return Math.floor(3*t);let i=1-.2*Math.atan(Math.max(4,e)-4)/(.5*Math.PI),s=Math.min(Math.floor(e*i*t),Math.floor(e*t));return Math.max(Math.floor(t),s)}(this.jt.ul,t),this.Ib>=2&&Math.floor(t)%2!=this.Ib%2&&this.Ib--;let i=this.jt.qs;this.jt.zb&&this.Ob(e,i,this.jt.lt),this.jt.Mi&&this.gm(e,i,this.jt.lt);let s=this.Nb(t);(!this.jt.Mi||this.Ib>2*s)&&this.Fb(e,i,this.jt.lt)}Ob(e,t,i){if(null===this.jt)return;let{context:s,horizontalPixelRatio:r,verticalPixelRatio:n}=e,l="",a=Math.min(Math.floor(r),Math.floor(this.jt.ul*r)),o=Math.floor(.5*(a=Math.max(Math.floor(r),Math.min(a,this.Ib)))),h=null;for(let e=i.from;e<i.to;e++){let i=t[e];i.sh!==l&&(s.fillStyle=i.sh,l=i.sh);let u=Math.round(Math.min(i.Go,i.Qo)*n),c=Math.round(Math.max(i.Go,i.Qo)*n),d=Math.round(i.Xo*n),m=Math.round(i.Jo*n),p=Math.round(r*i._t)-o,f=p+a-1;null!==h&&(p=Math.min(p=Math.max(h+1,p),f));let g=f-p+1;s.fillRect(p,d,g,u-d),s.fillRect(p,c+1,g,m-c),h=f}}Nb(e){let t=Math.floor(+e);this.Ib<=2*t&&(t=Math.floor(.5*(this.Ib-1)));let i=Math.max(Math.floor(e),t);return this.Ib<=2*i?Math.max(Math.floor(e),Math.floor(+e)):i}gm(e,t,i){if(null===this.jt)return;let{context:s,horizontalPixelRatio:r,verticalPixelRatio:n}=e,l="",a=this.Nb(r),o=null;for(let e=i.from;e<i.to;e++){let i=t[e];i.ih!==l&&(s.fillStyle=i.ih,l=i.ih);let d=Math.round(i._t*r)-Math.floor(.5*this.Ib),m=d+this.Ib-1,p=Math.round(Math.min(i.Go,i.Qo)*n),f=Math.round(Math.max(i.Go,i.Qo)*n);if(null!==o&&(d=Math.min(d=Math.max(o+1,d),m)),this.jt.ul*r>2*a){var h,u,c;h=d,u=m-d+1,c=f-p+1,s.fillRect(h+a,p,u-2*a,a),s.fillRect(h+a,p+c-a,u-2*a,a),s.fillRect(h,p,a,c),s.fillRect(h+u-a,p,a,c)}else{let e=m-d+1;s.fillRect(d,p,e,f-p+1)}o=m}}Fb(e,t,i){if(null===this.jt)return;let{context:s,horizontalPixelRatio:r,verticalPixelRatio:n}=e,l="",a=this.Nb(r);for(let e=i.from;e<i.to;e++){let i=t[e],o=Math.round(Math.min(i.Go,i.Qo)*n),h=Math.round(Math.max(i.Go,i.Qo)*n),u=Math.round(i._t*r)-Math.floor(.5*this.Ib),c=u+this.Ib-1;if(i.th!==l){let e=i.th;s.fillStyle=e,l=e}this.jt.Mi&&(u+=a,o+=a,c-=a,h-=a),o>h||s.fillRect(u,o,c-u+1,h-o+1)}}}class s$ extends sO{constructor(){super(...arguments),this.cM=new sB}tb(e,t,i){return{...this.Lb(e,t,i),...i.gh(e)}}wM(){let e=this.ee.N();this.cM.ht({qs:this.aM,ul:this.re.Et().ul(),zb:e.wickVisible,Mi:e.borderVisible,lt:this.lM})}}let sW={type:"Candlestick",isBuiltIn:!0,defaultOptions:{upColor:"#26a69a",downColor:"#ef5350",wickVisible:!0,borderVisible:!0,borderColor:"#378658",borderUpColor:"#26a69a",borderDownColor:"#ef5350",wickColor:"#737375",wickUpColor:"#26a69a",wickDownColor:"#ef5350"},YM:(e,t)=>new s$(e,t)};class sV{constructor(e,t){this.ee=e,this.Zh=t,this.jb()}detach(){this.ee.detachPrimitive(this.Zh)}getSeries(){return this.ee}applyOptions(e){this.Zh&&this.Zh.cr&&this.Zh.cr(e)}jb(){this.ee.attachPrimitive(this.Zh)}}let sK={autoScale:!0,zOrder:"normal"};function sU(e,t){return tE(Math.min(Math.max(e,12),30)*t)}function sH(e,t){switch(e){case"arrowDown":case"arrowUp":return sU(t,1);case"circle":return sU(t,.8);case"square":return sU(t,.7)}}function sJ(e){let t;return(t=Math.ceil(sU(e,1)))%2!=0?t-1:t}function sq(e){return Math.max(sU(e,.1),3)}function sY(e,t,i){return t?e:i?Math.ceil(e/2):0}function sX(e,t,i,s){let r=(sH("arrowUp",s)-1)/2*i.pS,n=(tE(s/2)-1)/2*i.pS;t.beginPath(),e?(t.moveTo(i._t-r,i.ut),t.lineTo(i._t,i.ut-r),t.lineTo(i._t+r,i.ut),t.lineTo(i._t+n,i.ut),t.lineTo(i._t+n,i.ut+r),t.lineTo(i._t-n,i.ut+r)):(t.moveTo(i._t-r,i.ut),t.lineTo(i._t,i.ut+r),t.lineTo(i._t+r,i.ut),t.lineTo(i._t+n,i.ut),t.lineTo(i._t+n,i.ut-r),t.lineTo(i._t-n,i.ut-r)),t.lineTo(i._t-n,i.ut),t.fill()}function sG(e,t,i,s,r,n){let l=(sH("arrowUp",s)-1)/2,a=(tE(s/2)-1)/2;return r>=t-a-2&&r<=t+a+2&&n>=(e?i:i-l)-2&&n<=(e?i+l:i)+2||!(r<t-l-3)&&!(r>t+l+3)&&!(n<(e?i-l-3:i))&&!(n>(e?i:i+l+3))&&Math.abs(n-i)+3>=Math.abs(r-t)/2}class sQ{constructor(){this.jt=null,this.$n=new eU,this.F=-1,this.W="",this.jv="",this.vS="normal"}ht(e){this.jt=e}qn(e,t,i){this.F===e&&this.W===t||(this.F=e,this.W=t,this.jv=ed(e,t),this.$n.On()),this.vS=i}Qn(e,t){if(null===this.jt||null===this.jt.lt)return null;for(let i=this.jt.lt.from;i<this.jt.lt.to;i++){let s=this.jt.ot[i];if(s&&function(e,t,i){var s,r,n,l;let a;return!(void 0===e.ri||(s=e.ri._t,r=e.ri.ut,n=e.ri.ss,l=e.ri.$t,a=l/2,!(t>=s)||!(t<=s+n)||!(i>=r-a)||!(i<=r+a)))||function(e,t,i){var s,r,n,l,a,o;if(0===e.yh)return!1;switch(e.wS){case"arrowDown":return sG(!0,e._t,e.ut,e.yh,t,i);case"arrowUp":return sG(!1,e._t,e.ut,e.yh,t,i);case"circle":let h,u,c;return s=e._t,r=e.ut,n=e.yh,h=2+sH("circle",n)/2,Math.sqrt((u=s-t)*u+(c=r-i)*c)<=h;case"square":let d,m,p,f;return l=e._t,a=e.ut,o=e.yh,p=l-(m=((d=sH("square",o))-1)/2),f=a-m,t>=p&&t<=p+d&&i>=f&&i<=f+d}}(e,t,i)}(s,e,t))return{zOrder:"normal",externalId:s.te??""}}return null}draw(e){"aboveSeries"!==this.vS&&e.useBitmapCoordinateSpace(e=>{this.et(e)})}drawBackground(e){"aboveSeries"===this.vS&&e.useBitmapCoordinateSpace(e=>{this.et(e)})}et({context:e,horizontalPixelRatio:t,verticalPixelRatio:i}){if(null!==this.jt&&null!==this.jt.lt){e.textBaseline="middle",e.font=this.jv;for(let s=this.jt.lt.from;s<this.jt.lt.to;s++){let r=this.jt.ot[s];void 0!==r.ri&&(r.ri.ss=this.$n.Ii(e,r.ri.mS),r.ri.$t=this.F,r.ri._t=r._t-r.ri.ss/2),function(e,t,i,s){var r,n,l;let a;t.fillStyle=e.R,void 0!==e.ri&&(r=e.ri.mS,n=e.ri._t,l=e.ri.ut,t.save(),t.scale(i,s),t.fillText(r,n,l),t.restore()),function(e,t,i){if(0!==e.yh){switch(e.wS){case"arrowDown":return sX(!1,t,i,e.yh);case"arrowUp":return sX(!0,t,i,e.yh);case"circle":let s;return s=(sH("circle",e.yh)-1)/2,t.beginPath(),t.arc(i._t,i.ut,s*i.pS,0,2*Math.PI,!1),t.fill();case"square":let r,n,l,a;return n=((r=sH("square",e.yh))-1)*i.pS/2,l=i._t-n,a=i.ut-n,t.fillRect(l,a,r*i.pS,r*i.pS)}e.wS}}(e,t,(a=Math.max(1,Math.floor(i))%2/2,{_t:Math.round(e._t*i)+a,ut:e.ut*s,pS:i}))}(r,e,t,i)}}}}function sZ(e){return"atPriceTop"===e||"atPriceBottom"===e||"atPriceMiddle"===e}class s0{constructor(e,t,i){this.bS=[],this.xt=!0,this.SS=!0,this.Xt=new sQ,this.ye=e,this.Lv=t,this.jt={ot:[],lt:null},this.Ps=i}renderer(){if(!this.ye.options().visible)return null;this.xt&&this.xS();let e=this.Lv.options().layout;return this.Xt.qn(e.fontSize,e.fontFamily,this.Ps.zOrder),this.Xt.ht(this.jt),this.Xt}CS(e){this.bS=e,this.kt("data")}kt(e){this.xt=!0,"data"===e&&(this.SS=!0)}yS(e){this.xt=!0,this.Ps=e}zOrder(){return"aboveSeries"===this.Ps.zOrder?"top":this.Ps.zOrder}xS(){let e=this.Lv.timeScale(),t=this.bS;this.SS&&(this.jt.ot=t.map(e=>({wt:e.time,_t:0,ut:0,yh:0,wS:e.shape,R:e.color,te:e.id,kS:e.kS,ri:void 0})),this.SS=!1);let i=this.Lv.options().layout;this.jt.lt=null;let s=e.getVisibleLogicalRange();if(null===s)return;let r=new tQ(Math.floor(s.from),Math.ceil(s.to));if(null===this.ye.data()[0]||0===this.jt.ot.length)return;let n=NaN,l=sq(e.options().barSpacing),a={gS:l,MS:l};this.jt.lt=se(this.jt.ot,r,!0);for(let s=this.jt.lt.from;s<this.jt.lt.to;s++){let r=t[s];r.time!==n&&(a.gS=l,a.MS=l,n=r.time);let o=this.jt.ot[s];o._t=ee(e.logicalToCoordinate(r.time)),void 0!==r.text&&r.text.length>0&&(o.ri={mS:r.text,_t:0,ut:0,ss:0,$t:0});let h=this.ye.dataByIndex(r.time,0);null!==h&&function(e,t,i,s,r,n,l,a){let o=function(e,t,i){if(sZ(t.position)&&void 0!==t.price)return t.price;if("value"in e&&"number"==typeof e.value)return e.value;if("open"in e&&"high"in e&&"low"in e&&"close"in e){if("inBar"===t.position)return e.close;if("aboveBar"===t.position)return i?e.low:e.high;if("belowBar"===t.position)return i?e.high:e.low}}(i,t,l.priceScale().options().invertScale);if(void 0===o)return;let h=sZ(t.position),u=a.timeScale(),c=er(t.size)?Math.max(t.size,0):1,d=sJ(u.options().barSpacing)*c,m=d/2;switch(e.yh=d,t.position){case"inBar":case"atPriceMiddle":return e.ut=ee(l.priceToCoordinate(o)),void 0!==e.ri&&(e.ri.ut=e.ut+m+n+.6*r);case"aboveBar":case"atPriceTop":{let t=h?0:s.gS;return e.ut=ee(l.priceToCoordinate(o))-m-t,void 0!==e.ri&&(e.ri.ut=e.ut-m-.6*r,s.gS+=1.2*r),h||(s.gS+=d+n)}case"belowBar":case"atPriceBottom":{let t=h?0:s.MS;return e.ut=ee(l.priceToCoordinate(o))+m+t,void 0!==e.ri&&(e.ri.ut=e.ut+m+n+.6*r,s.MS+=1.2*r),h||(s.MS+=d+n)}}}(o,r,h,a,i.fontSize,l,this.ye,this.Lv)}this.xt=!1}}class s1{constructor(e){this.$h=null,this.bS=[],this.PS=[],this.TS=null,this.ye=null,this.Lv=null,this.RS=!0,this.DS=null,this.IS=null,this.VS=null,this.BS=!0,this.Ps={...sK,...e}}attached(e){this.ES(),this.Lv=e.chart,this.ye=e.series,this.$h=new s0(this.ye,ee(this.Lv),this.Ps),this.dS=e.requestUpdate,this.ye.subscribeDataChanged(e=>this.IM(e)),this.BS=!0,this.Jb()}Jb(){this.dS&&this.dS()}detached(){this.ye&&this.TS&&this.ye.unsubscribeDataChanged(this.TS),this.Lv=null,this.ye=null,this.$h=null,this.TS=null}CS(e){this.BS=!0,this.bS=e,this.ES(),this.RS=!0,this.IS=null,this.Jb()}AS(){return this.bS}paneViews(){return this.$h?[this.$h]:[]}updateAllViews(){this.LS()}hitTest(e,t){return this.$h?this.$h.renderer()?.Qn(e,t)??null:null}autoscaleInfo(e,t){if(this.Ps.autoScale&&this.$h){let e=this.zS();if(e)return{priceRange:null,margins:e}}return null}cr(e){var t;this.Ps=(t={...this.Ps,...e},{...sK,...t}),this.Jb&&this.Jb()}zS(){let e=ee(this.Lv).timeScale().options().barSpacing;if(this.RS||e!==this.VS){if(this.VS=e,this.bS.length>0){let t=sq(e),i=1.5*sJ(e)+2*t,s=this.OS();this.DS={above:sY(i,s.aboveBar,s.inBar),below:sY(i,s.belowBar,s.inBar)}}else this.DS=null;this.RS=!1}return this.DS}OS(){return null===this.IS&&(this.IS=this.bS.reduce((e,t)=>(e[t.position]||(e[t.position]=!0),e),{inBar:!1,aboveBar:!1,belowBar:!1,atPriceTop:!1,atPriceBottom:!1,atPriceMiddle:!1})),this.IS}ES(){if(!this.BS||!this.Lv||!this.ye)return;let e=this.Lv.timeScale(),t=this.ye?.data();if(null==e.getVisibleLogicalRange()||!this.ye||0===t.length)return void(this.PS=[]);let i=e.timeToIndex(ee(t[0].time),!0);this.PS=this.bS.map((t,s)=>{let r=e.timeToIndex(t.time,!0),n=ee(this.ye).dataByIndex(r,r<i?1:-1),l={time:e.timeToIndex(ee(n).time,!1),position:t.position,shape:t.shape,color:t.color,id:t.id,kS:s,text:t.text,size:t.size,price:t.price,Gr:t.time};if(("atPriceTop"===t.position||"atPriceBottom"===t.position||"atPriceMiddle"===t.position)&&void 0===t.price)throw Error(`Price is required for position ${t.position}`);return{...l,position:t.position,price:t.price}}),this.BS=!1}LS(e){this.$h&&(this.ES(),this.$h.CS(this.PS),this.$h.yS(this.Ps),this.$h.kt(e))}IM(e){this.BS=!0,this.Jb()}}class s2 extends sV{constructor(e,t,i){super(e,t),i&&this.setMarkers(i)}setMarkers(e){this.Zh.CS(e)}markers(){return this.Zh.AS()}}({...Y,color:"#2196f3"});var s3=e.i(10965);let s5=(0,s3.default)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);var s4=e.i(67881),s6=e.i(49463);function s9(e,[t,i]){return Math.min(i,Math.max(t,e))}function s8(e,t,{checkForDefaultPrevented:i=!0}={}){return function(s){if(e?.(s),!1===i||!s.defaultPrevented)return t?.(s)}}function s7(e,t=[]){let i=[],s=()=>{let t=i.map(e=>$.createContext(e));return function(i){let s=i?.[e]||t;return $.useMemo(()=>({[`__scope${e}`]:{...i,[e]:s}}),[i,s])}};return s.scopeName=e,[function(t,s){let r=$.createContext(s),n=i.length;i=[...i,s];let l=t=>{let{scope:i,children:s,...l}=t,a=i?.[e]?.[n]||r,o=$.useMemo(()=>l,Object.values(l));return(0,L.jsx)(a.Provider,{value:o,children:s})};return l.displayName=t+"Provider",[l,function(i,l){let a=l?.[e]?.[n]||r,o=$.useContext(a);if(o)return o;if(void 0!==s)return s;throw Error(`\`${i}\` must be used within \`${t}\``)}]},function(...e){let t=e[0];if(1===e.length)return t;let i=()=>{let i=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let s=i.reduce((t,{useScope:i,scopeName:s})=>{let r=i(e)[`__scope${s}`];return{...t,...r}},{});return $.useMemo(()=>({[`__scope${t.scopeName}`]:s}),[s])}};return i.scopeName=t.scopeName,i}(s,...t)]}var re=e.i(866),rt=e.i(64701);function ri(e){let t=e+"CollectionProvider",[i,s]=s7(t),[r,n]=i(t,{collectionRef:{current:null},itemMap:new Map}),l=e=>{let{scope:t,children:i}=e,s=$.default.useRef(null),n=$.default.useRef(new Map).current;return(0,L.jsx)(r,{scope:t,itemMap:n,collectionRef:s,children:i})};l.displayName=t;let a=e+"CollectionSlot",o=$.default.forwardRef((e,t)=>{let{scope:i,children:s}=e,r=n(a,i),l=(0,re.useComposedRefs)(t,r.collectionRef);return(0,L.jsx)(rt.Slot,{ref:l,children:s})});o.displayName=a;let h=e+"CollectionItemSlot",u="data-radix-collection-item",c=$.default.forwardRef((e,t)=>{let{scope:i,children:s,...r}=e,l=$.default.useRef(null),a=(0,re.useComposedRefs)(t,l),o=n(h,i);return $.default.useEffect(()=>(o.itemMap.set(l,{ref:l,...r}),()=>void o.itemMap.delete(l))),(0,L.jsx)(rt.Slot,{...{[u]:""},ref:a,children:s})});return c.displayName=h,[{Provider:l,Slot:o,ItemSlot:c},function(t){let i=n(e+"CollectionConsumer",t);return $.default.useCallback(()=>{let e=i.collectionRef.current;if(!e)return[];let t=Array.from(e.querySelectorAll(`[${u}]`));return Array.from(i.itemMap.values()).sort((e,i)=>t.indexOf(e.ref.current)-t.indexOf(i.ref.current))},[i.collectionRef,i.itemMap])},s]}var rs=$.createContext(void 0);function rr(e){let t=$.useContext(rs);return e||t||"ltr"}var rn=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"].reduce((e,t)=>{let i=$.forwardRef((e,i)=>{let{asChild:s,...r}=e,n=s?rt.Slot:t;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,L.jsx)(n,{...r,ref:i})});return i.displayName=`Primitive.${t}`,{...e,[t]:i}},{});function rl(e,t){e&&s6.flushSync(()=>e.dispatchEvent(t))}function ra(e){let t=$.useRef(e);return $.useEffect(()=>{t.current=e}),$.useMemo(()=>(...e)=>t.current?.(...e),[])}var ro="dismissableLayer.update",rh=$.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),ru=$.forwardRef((e,t)=>{let{disableOutsidePointerEvents:i=!1,onEscapeKeyDown:s,onPointerDownOutside:r,onFocusOutside:n,onInteractOutside:l,onDismiss:a,...o}=e,h=$.useContext(rh),[u,c]=$.useState(null),d=u?.ownerDocument??globalThis?.document,[,m]=$.useState({}),p=(0,re.useComposedRefs)(t,e=>c(e)),f=Array.from(h.layers),[g]=[...h.layersWithOutsidePointerEventsDisabled].slice(-1),v=f.indexOf(g),x=u?f.indexOf(u):-1,w=h.layersWithOutsidePointerEventsDisabled.size>0,b=x>=v,y=function(e,t=globalThis?.document){let i=ra(e),s=$.useRef(!1),r=$.useRef(()=>{});return $.useEffect(()=>{let e=e=>{if(e.target&&!s.current){let s=function(){rm("dismissableLayer.pointerDownOutside",i,n,{discrete:!0})},n={originalEvent:e};"touch"===e.pointerType?(t.removeEventListener("click",r.current),r.current=s,t.addEventListener("click",r.current,{once:!0})):s()}else t.removeEventListener("click",r.current);s.current=!1},n=window.setTimeout(()=>{t.addEventListener("pointerdown",e)},0);return()=>{window.clearTimeout(n),t.removeEventListener("pointerdown",e),t.removeEventListener("click",r.current)}},[t,i]),{onPointerDownCapture:()=>s.current=!0}}(e=>{let t=e.target,i=[...h.branches].some(e=>e.contains(t));b&&!i&&(r?.(e),l?.(e),e.defaultPrevented||a?.())},d),S=function(e,t=globalThis?.document){let i=ra(e),s=$.useRef(!1);return $.useEffect(()=>{let e=e=>{e.target&&!s.current&&rm("dismissableLayer.focusOutside",i,{originalEvent:e},{discrete:!1})};return t.addEventListener("focusin",e),()=>t.removeEventListener("focusin",e)},[t,i]),{onFocusCapture:()=>s.current=!0,onBlurCapture:()=>s.current=!1}}(e=>{let t=e.target;![...h.branches].some(e=>e.contains(t))&&(n?.(e),l?.(e),e.defaultPrevented||a?.())},d);return!function(e,t=globalThis?.document){let i=ra(e);$.useEffect(()=>{let e=e=>{"Escape"===e.key&&i(e)};return t.addEventListener("keydown",e,{capture:!0}),()=>t.removeEventListener("keydown",e,{capture:!0})},[i,t])}(e=>{x===h.layers.size-1&&(s?.(e),!e.defaultPrevented&&a&&(e.preventDefault(),a()))},d),$.useEffect(()=>{if(u)return i&&(0===h.layersWithOutsidePointerEventsDisabled.size&&(_=d.body.style.pointerEvents,d.body.style.pointerEvents="none"),h.layersWithOutsidePointerEventsDisabled.add(u)),h.layers.add(u),rd(),()=>{i&&1===h.layersWithOutsidePointerEventsDisabled.size&&(d.body.style.pointerEvents=_)}},[u,d,i,h]),$.useEffect(()=>()=>{u&&(h.layers.delete(u),h.layersWithOutsidePointerEventsDisabled.delete(u),rd())},[u,h]),$.useEffect(()=>{let e=()=>m({});return document.addEventListener(ro,e),()=>document.removeEventListener(ro,e)},[]),(0,L.jsx)(rn.div,{...o,ref:p,style:{pointerEvents:w?b?"auto":"none":void 0,...e.style},onFocusCapture:s8(e.onFocusCapture,S.onFocusCapture),onBlurCapture:s8(e.onBlurCapture,S.onBlurCapture),onPointerDownCapture:s8(e.onPointerDownCapture,y.onPointerDownCapture)})});ru.displayName="DismissableLayer";var rc=$.forwardRef((e,t)=>{let i=$.useContext(rh),s=$.useRef(null),r=(0,re.useComposedRefs)(t,s);return $.useEffect(()=>{let e=s.current;if(e)return i.branches.add(e),()=>{i.branches.delete(e)}},[i.branches]),(0,L.jsx)(rn.div,{...e,ref:r})});function rd(){let e=new CustomEvent(ro);document.dispatchEvent(e)}function rm(e,t,i,{discrete:s}){let r=i.originalEvent.target,n=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:i});t&&r.addEventListener(e,t,{once:!0}),s?rl(r,n):r.dispatchEvent(n)}rc.displayName="DismissableLayerBranch";var rp=0;function rf(){$.useEffect(()=>{let e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??rg()),document.body.insertAdjacentElement("beforeend",e[1]??rg()),rp++,()=>{1===rp&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),rp--}},[])}function rg(){let e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var rv="focusScope.autoFocusOnMount",rx="focusScope.autoFocusOnUnmount",rw={bubbles:!1,cancelable:!0},rb=$.forwardRef((e,t)=>{let{loop:i=!1,trapped:s=!1,onMountAutoFocus:r,onUnmountAutoFocus:n,...l}=e,[a,o]=$.useState(null),h=ra(r),u=ra(n),c=$.useRef(null),d=(0,re.useComposedRefs)(t,e=>o(e)),m=$.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;$.useEffect(()=>{if(s){let e=function(e){if(m.paused||!a)return;let t=e.target;a.contains(t)?c.current=t:rj(c.current,{select:!0})},t=function(e){if(m.paused||!a)return;let t=e.relatedTarget;null!==t&&(a.contains(t)||rj(c.current,{select:!0}))};document.addEventListener("focusin",e),document.addEventListener("focusout",t);let i=new MutationObserver(function(e){if(document.activeElement===document.body)for(let t of e)t.removedNodes.length>0&&rj(a)});return a&&i.observe(a,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",e),document.removeEventListener("focusout",t),i.disconnect()}}},[s,a,m.paused]),$.useEffect(()=>{if(a){rM.add(m);let e=document.activeElement;if(!a.contains(e)){let t=new CustomEvent(rv,rw);a.addEventListener(rv,h),a.dispatchEvent(t),t.defaultPrevented||(function(e,{select:t=!1}={}){let i=document.activeElement;for(let s of e)if(rj(s,{select:t}),document.activeElement!==i)return}(ry(a).filter(e=>"A"!==e.tagName),{select:!0}),document.activeElement===e&&rj(a))}return()=>{a.removeEventListener(rv,h),setTimeout(()=>{let t=new CustomEvent(rx,rw);a.addEventListener(rx,u),a.dispatchEvent(t),t.defaultPrevented||rj(e??document.body,{select:!0}),a.removeEventListener(rx,u),rM.remove(m)},0)}}},[a,h,u,m]);let p=$.useCallback(e=>{if(!i&&!s||m.paused)return;let t="Tab"===e.key&&!e.altKey&&!e.ctrlKey&&!e.metaKey,r=document.activeElement;if(t&&r){var n;let t,s=e.currentTarget,[l,a]=[rS(t=ry(n=s),n),rS(t.reverse(),n)];l&&a?e.shiftKey||r!==a?e.shiftKey&&r===l&&(e.preventDefault(),i&&rj(a,{select:!0})):(e.preventDefault(),i&&rj(l,{select:!0})):r===s&&e.preventDefault()}},[i,s,m.paused]);return(0,L.jsx)(rn.div,{tabIndex:-1,...l,ref:d,onKeyDown:p})});function ry(e){let t=[],i=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:e=>{let t="INPUT"===e.tagName&&"hidden"===e.type;return e.disabled||e.hidden||t?NodeFilter.FILTER_SKIP:e.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;i.nextNode();)t.push(i.currentNode);return t}function rS(e,t){for(let i of e)if(!function(e,{upTo:t}){if("hidden"===getComputedStyle(e).visibility)return!0;for(;e&&(void 0===t||e!==t);){if("none"===getComputedStyle(e).display)return!0;e=e.parentElement}return!1}(i,{upTo:t}))return i}function rj(e,{select:t=!1}={}){if(e&&e.focus){var i;let s=document.activeElement;e.focus({preventScroll:!0}),e!==s&&(i=e)instanceof HTMLInputElement&&"select"in i&&t&&e.select()}}rb.displayName="FocusScope";var rM=(s=[],{add(e){let t=s[0];e!==t&&t?.pause(),(s=rC(s,e)).unshift(e)},remove(e){s=rC(s,e),s[0]?.resume()}});function rC(e,t){let i=[...e],s=i.indexOf(t);return -1!==s&&i.splice(s,1),i}var rN=globalThis?.document?$.useLayoutEffect:()=>{},rP=$["useId".toString()]||(()=>void 0),rk=0;function rE(e){let[t,i]=$.useState(rP());return rN(()=>{e||i(e=>e??String(rk++))},[e]),e||(t?`radix-${t}`:"")}let rR=["top","right","bottom","left"],r_=Math.min,rT=Math.max,rL=Math.round,rI=Math.floor,rA=e=>({x:e,y:e}),rF={left:"right",right:"left",bottom:"top",top:"bottom"},rz={start:"end",end:"start"};function rD(e,t){return"function"==typeof e?e(t):e}function rO(e){return e.split("-")[0]}function rB(e){return e.split("-")[1]}function r$(e){return"x"===e?"y":"x"}function rW(e){return"y"===e?"height":"width"}let rV=new Set(["top","bottom"]);function rK(e){return rV.has(rO(e))?"y":"x"}function rU(e){return e.replace(/start|end/g,e=>rz[e])}let rH=["left","right"],rJ=["right","left"],rq=["top","bottom"],rY=["bottom","top"];function rX(e){return e.replace(/left|right|bottom|top/g,e=>rF[e])}function rG(e){return"number"!=typeof e?{top:0,right:0,bottom:0,left:0,...e}:{top:e,right:e,bottom:e,left:e}}function rQ(e){let{x:t,y:i,width:s,height:r}=e;return{width:s,height:r,top:i,left:t,right:t+s,bottom:i+r,x:t,y:i}}function rZ(e,t,i){let s,{reference:r,floating:n}=e,l=rK(t),a=r$(rK(t)),o=rW(a),h=rO(t),u="y"===l,c=r.x+r.width/2-n.width/2,d=r.y+r.height/2-n.height/2,m=r[o]/2-n[o]/2;switch(h){case"top":s={x:c,y:r.y-n.height};break;case"bottom":s={x:c,y:r.y+r.height};break;case"right":s={x:r.x+r.width,y:d};break;case"left":s={x:r.x-n.width,y:d};break;default:s={x:r.x,y:r.y}}switch(rB(t)){case"start":s[a]-=m*(i&&u?-1:1);break;case"end":s[a]+=m*(i&&u?-1:1)}return s}let r0=async(e,t,i)=>{let{placement:s="bottom",strategy:r="absolute",middleware:n=[],platform:l}=i,a=n.filter(Boolean),o=await (null==l.isRTL?void 0:l.isRTL(t)),h=await l.getElementRects({reference:e,floating:t,strategy:r}),{x:u,y:c}=rZ(h,s,o),d=s,m={},p=0;for(let i=0;i<a.length;i++){let{name:n,fn:f}=a[i],{x:g,y:v,data:x,reset:w}=await f({x:u,y:c,initialPlacement:s,placement:d,strategy:r,middlewareData:m,rects:h,platform:l,elements:{reference:e,floating:t}});u=null!=g?g:u,c=null!=v?v:c,m={...m,[n]:{...m[n],...x}},w&&p<=50&&(p++,"object"==typeof w&&(w.placement&&(d=w.placement),w.rects&&(h=!0===w.rects?await l.getElementRects({reference:e,floating:t,strategy:r}):w.rects),{x:u,y:c}=rZ(h,d,o)),i=-1)}return{x:u,y:c,placement:d,strategy:r,middlewareData:m}};async function r1(e,t){var i;void 0===t&&(t={});let{x:s,y:r,platform:n,rects:l,elements:a,strategy:o}=e,{boundary:h="clippingAncestors",rootBoundary:u="viewport",elementContext:c="floating",altBoundary:d=!1,padding:m=0}=rD(t,e),p=rG(m),f=a[d?"floating"===c?"reference":"floating":c],g=rQ(await n.getClippingRect({element:null==(i=await (null==n.isElement?void 0:n.isElement(f)))||i?f:f.contextElement||await (null==n.getDocumentElement?void 0:n.getDocumentElement(a.floating)),boundary:h,rootBoundary:u,strategy:o})),v="floating"===c?{x:s,y:r,width:l.floating.width,height:l.floating.height}:l.reference,x=await (null==n.getOffsetParent?void 0:n.getOffsetParent(a.floating)),w=await (null==n.isElement?void 0:n.isElement(x))&&await (null==n.getScale?void 0:n.getScale(x))||{x:1,y:1},b=rQ(n.convertOffsetParentRelativeRectToViewportRelativeRect?await n.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:v,offsetParent:x,strategy:o}):v);return{top:(g.top-b.top+p.top)/w.y,bottom:(b.bottom-g.bottom+p.bottom)/w.y,left:(g.left-b.left+p.left)/w.x,right:(b.right-g.right+p.right)/w.x}}function r2(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function r3(e){return rR.some(t=>e[t]>=0)}let r5=new Set(["left","top"]);async function r4(e,t){let{placement:i,platform:s,elements:r}=e,n=await (null==s.isRTL?void 0:s.isRTL(r.floating)),l=rO(i),a=rB(i),o="y"===rK(i),h=r5.has(l)?-1:1,u=n&&o?-1:1,c=rD(t,e),{mainAxis:d,crossAxis:m,alignmentAxis:p}="number"==typeof c?{mainAxis:c,crossAxis:0,alignmentAxis:null}:{mainAxis:c.mainAxis||0,crossAxis:c.crossAxis||0,alignmentAxis:c.alignmentAxis};return a&&"number"==typeof p&&(m="end"===a?-1*p:p),o?{x:m*u,y:d*h}:{x:d*h,y:m*u}}function r6(){return"undefined"!=typeof window}function r9(e){return ne(e)?(e.nodeName||"").toLowerCase():"#document"}function r8(e){var t;return(null==e||null==(t=e.ownerDocument)?void 0:t.defaultView)||window}function r7(e){var t;return null==(t=(ne(e)?e.ownerDocument:e.document)||window.document)?void 0:t.documentElement}function ne(e){return!!r6()&&(e instanceof Node||e instanceof r8(e).Node)}function nt(e){return!!r6()&&(e instanceof Element||e instanceof r8(e).Element)}function ni(e){return!!r6()&&(e instanceof HTMLElement||e instanceof r8(e).HTMLElement)}function ns(e){return!!r6()&&"undefined"!=typeof ShadowRoot&&(e instanceof ShadowRoot||e instanceof r8(e).ShadowRoot)}let nr=new Set(["inline","contents"]);function nn(e){let{overflow:t,overflowX:i,overflowY:s,display:r}=ng(e);return/auto|scroll|overlay|hidden|clip/.test(t+s+i)&&!nr.has(r)}let nl=new Set(["table","td","th"]),na=[":popover-open",":modal"];function no(e){return na.some(t=>{try{return e.matches(t)}catch(e){return!1}})}let nh=["transform","translate","scale","rotate","perspective"],nu=["transform","translate","scale","rotate","perspective","filter"],nc=["paint","layout","strict","content"];function nd(e){let t=nm(),i=nt(e)?ng(e):e;return nh.some(e=>!!i[e]&&"none"!==i[e])||!!i.containerType&&"normal"!==i.containerType||!t&&!!i.backdropFilter&&"none"!==i.backdropFilter||!t&&!!i.filter&&"none"!==i.filter||nu.some(e=>(i.willChange||"").includes(e))||nc.some(e=>(i.contain||"").includes(e))}function nm(){return"undefined"!=typeof CSS&&!!CSS.supports&&CSS.supports("-webkit-backdrop-filter","none")}let np=new Set(["html","body","#document"]);function nf(e){return np.has(r9(e))}function ng(e){return r8(e).getComputedStyle(e)}function nv(e){return nt(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function nx(e){if("html"===r9(e))return e;let t=e.assignedSlot||e.parentNode||ns(e)&&e.host||r7(e);return ns(t)?t.host:t}function nw(e,t,i){var s;void 0===t&&(t=[]),void 0===i&&(i=!0);let r=function e(t){let i=nx(t);return nf(i)?t.ownerDocument?t.ownerDocument.body:t.body:ni(i)&&nn(i)?i:e(i)}(e),n=r===(null==(s=e.ownerDocument)?void 0:s.body),l=r8(r);if(n){let e=nb(l);return t.concat(l,l.visualViewport||[],nn(r)?r:[],e&&i?nw(e):[])}return t.concat(r,nw(r,[],i))}function nb(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function ny(e){let t=ng(e),i=parseFloat(t.width)||0,s=parseFloat(t.height)||0,r=ni(e),n=r?e.offsetWidth:i,l=r?e.offsetHeight:s,a=rL(i)!==n||rL(s)!==l;return a&&(i=n,s=l),{width:i,height:s,$:a}}function nS(e){return nt(e)?e:e.contextElement}function nj(e){let t=nS(e);if(!ni(t))return rA(1);let i=t.getBoundingClientRect(),{width:s,height:r,$:n}=ny(t),l=(n?rL(i.width):i.width)/s,a=(n?rL(i.height):i.height)/r;return l&&Number.isFinite(l)||(l=1),a&&Number.isFinite(a)||(a=1),{x:l,y:a}}let nM=rA(0);function nC(e){let t=r8(e);return nm()&&t.visualViewport?{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}:nM}function nN(e,t,i,s){var r;void 0===t&&(t=!1),void 0===i&&(i=!1);let n=e.getBoundingClientRect(),l=nS(e),a=rA(1);t&&(s?nt(s)&&(a=nj(s)):a=nj(e));let o=(void 0===(r=i)&&(r=!1),s&&(!r||s===r8(l))&&r)?nC(l):rA(0),h=(n.left+o.x)/a.x,u=(n.top+o.y)/a.y,c=n.width/a.x,d=n.height/a.y;if(l){let e=r8(l),t=s&&nt(s)?r8(s):s,i=e,r=nb(i);for(;r&&s&&t!==i;){let e=nj(r),t=r.getBoundingClientRect(),s=ng(r),n=t.left+(r.clientLeft+parseFloat(s.paddingLeft))*e.x,l=t.top+(r.clientTop+parseFloat(s.paddingTop))*e.y;h*=e.x,u*=e.y,c*=e.x,d*=e.y,h+=n,u+=l,r=nb(i=r8(r))}}return rQ({width:c,height:d,x:h,y:u})}function nP(e,t){let i=nv(e).scrollLeft;return t?t.left+i:nN(r7(e)).left+i}function nk(e,t){let i=e.getBoundingClientRect();return{x:i.left+t.scrollLeft-nP(e,i),y:i.top+t.scrollTop}}let nE=new Set(["absolute","fixed"]);function nR(e,t,i){var s;let r;if("viewport"===t)r=function(e,t){let i=r8(e),s=r7(e),r=i.visualViewport,n=s.clientWidth,l=s.clientHeight,a=0,o=0;if(r){n=r.width,l=r.height;let e=nm();(!e||e&&"fixed"===t)&&(a=r.offsetLeft,o=r.offsetTop)}let h=nP(s);if(h<=0){let e=s.ownerDocument,t=e.body,i=getComputedStyle(t),r="CSS1Compat"===e.compatMode&&parseFloat(i.marginLeft)+parseFloat(i.marginRight)||0,l=Math.abs(s.clientWidth-t.clientWidth-r);l<=25&&(n-=l)}else h<=25&&(n+=h);return{width:n,height:l,x:a,y:o}}(e,i);else if("document"===t){let t,i,n,l,a,o,h;s=r7(e),t=r7(s),i=nv(s),n=s.ownerDocument.body,l=rT(t.scrollWidth,t.clientWidth,n.scrollWidth,n.clientWidth),a=rT(t.scrollHeight,t.clientHeight,n.scrollHeight,n.clientHeight),o=-i.scrollLeft+nP(s),h=-i.scrollTop,"rtl"===ng(n).direction&&(o+=rT(t.clientWidth,n.clientWidth)-l),r={width:l,height:a,x:o,y:h}}else if(nt(t)){let e,s,n,l,a,o;s=(e=nN(t,!0,"fixed"===i)).top+t.clientTop,n=e.left+t.clientLeft,l=ni(t)?nj(t):rA(1),a=t.clientWidth*l.x,o=t.clientHeight*l.y,r={width:a,height:o,x:n*l.x,y:s*l.y}}else{let i=nC(e);r={x:t.x-i.x,y:t.y-i.y,width:t.width,height:t.height}}return rQ(r)}function n_(e){return"static"===ng(e).position}function nT(e,t){if(!ni(e)||"fixed"===ng(e).position)return null;if(t)return t(e);let i=e.offsetParent;return r7(e)===i&&(i=i.ownerDocument.body),i}function nL(e,t){var i;let s=r8(e);if(no(e))return s;if(!ni(e)){let t=nx(e);for(;t&&!nf(t);){if(nt(t)&&!n_(t))return t;t=nx(t)}return s}let r=nT(e,t);for(;r&&(i=r,nl.has(r9(i)))&&n_(r);)r=nT(r,t);return r&&nf(r)&&n_(r)&&!nd(r)?s:r||function(e){let t=nx(e);for(;ni(t)&&!nf(t);){if(nd(t))return t;if(no(t))break;t=nx(t)}return null}(e)||s}let nI=async function(e){let t=this.getOffsetParent||nL,i=this.getDimensions,s=await i(e.floating);return{reference:function(e,t,i){let s=ni(t),r=r7(t),n="fixed"===i,l=nN(e,!0,n,t),a={scrollLeft:0,scrollTop:0},o=rA(0);if(s||!s&&!n)if(("body"!==r9(t)||nn(r))&&(a=nv(t)),s){let e=nN(t,!0,n,t);o.x=e.x+t.clientLeft,o.y=e.y+t.clientTop}else r&&(o.x=nP(r));n&&!s&&r&&(o.x=nP(r));let h=!r||s||n?rA(0):nk(r,a);return{x:l.left+a.scrollLeft-o.x-h.x,y:l.top+a.scrollTop-o.y-h.y,width:l.width,height:l.height}}(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:s.width,height:s.height}}},nA={convertOffsetParentRelativeRectToViewportRelativeRect:function(e){let{elements:t,rect:i,offsetParent:s,strategy:r}=e,n="fixed"===r,l=r7(s),a=!!t&&no(t.floating);if(s===l||a&&n)return i;let o={scrollLeft:0,scrollTop:0},h=rA(1),u=rA(0),c=ni(s);if((c||!c&&!n)&&(("body"!==r9(s)||nn(l))&&(o=nv(s)),ni(s))){let e=nN(s);h=nj(s),u.x=e.x+s.clientLeft,u.y=e.y+s.clientTop}let d=!l||c||n?rA(0):nk(l,o);return{width:i.width*h.x,height:i.height*h.y,x:i.x*h.x-o.scrollLeft*h.x+u.x+d.x,y:i.y*h.y-o.scrollTop*h.y+u.y+d.y}},getDocumentElement:r7,getClippingRect:function(e){let{element:t,boundary:i,rootBoundary:s,strategy:r}=e,n=[..."clippingAncestors"===i?no(t)?[]:function(e,t){let i=t.get(e);if(i)return i;let s=nw(e,[],!1).filter(e=>nt(e)&&"body"!==r9(e)),r=null,n="fixed"===ng(e).position,l=n?nx(e):e;for(;nt(l)&&!nf(l);){let t=ng(l),i=nd(l);i||"fixed"!==t.position||(r=null),(n?!i&&!r:!i&&"static"===t.position&&!!r&&nE.has(r.position)||nn(l)&&!i&&function e(t,i){let s=nx(t);return!(s===i||!nt(s)||nf(s))&&("fixed"===ng(s).position||e(s,i))}(e,l))?s=s.filter(e=>e!==l):r=t,l=nx(l)}return t.set(e,s),s}(t,this._c):[].concat(i),s],l=n[0],a=n.reduce((e,i)=>{let s=nR(t,i,r);return e.top=rT(s.top,e.top),e.right=r_(s.right,e.right),e.bottom=r_(s.bottom,e.bottom),e.left=rT(s.left,e.left),e},nR(t,l,r));return{width:a.right-a.left,height:a.bottom-a.top,x:a.left,y:a.top}},getOffsetParent:nL,getElementRects:nI,getClientRects:function(e){return Array.from(e.getClientRects())},getDimensions:function(e){let{width:t,height:i}=ny(e);return{width:t,height:i}},getScale:nj,isElement:nt,isRTL:function(e){return"rtl"===ng(e).direction}};function nF(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}let nz=e=>({name:"arrow",options:e,async fn(t){let{x:i,y:s,placement:r,rects:n,platform:l,elements:a,middlewareData:o}=t,{element:h,padding:u=0}=rD(e,t)||{};if(null==h)return{};let c=rG(u),d={x:i,y:s},m=r$(rK(r)),p=rW(m),f=await l.getDimensions(h),g="y"===m,v=g?"clientHeight":"clientWidth",x=n.reference[p]+n.reference[m]-d[m]-n.floating[p],w=d[m]-n.reference[m],b=await (null==l.getOffsetParent?void 0:l.getOffsetParent(h)),y=b?b[v]:0;y&&await (null==l.isElement?void 0:l.isElement(b))||(y=a.floating[v]||n.floating[p]);let S=y/2-f[p]/2-1,j=r_(c[g?"top":"left"],S),M=r_(c[g?"bottom":"right"],S),C=y-f[p]-M,N=y/2-f[p]/2+(x/2-w/2),P=rT(j,r_(N,C)),k=!o.arrow&&null!=rB(r)&&N!==P&&n.reference[p]/2-(N<j?j:M)-f[p]/2<0,E=k?N<j?N-j:N-C:0;return{[m]:d[m]+E,data:{[m]:P,centerOffset:N-P-E,...k&&{alignmentOffset:E}},reset:k}}});var nD="undefined"!=typeof document?$.useLayoutEffect:function(){};function nO(e,t){let i,s,r;if(e===t)return!0;if(typeof e!=typeof t)return!1;if("function"==typeof e&&e.toString()===t.toString())return!0;if(e&&t&&"object"==typeof e){if(Array.isArray(e)){if((i=e.length)!==t.length)return!1;for(s=i;0!=s--;)if(!nO(e[s],t[s]))return!1;return!0}if((i=(r=Object.keys(e)).length)!==Object.keys(t).length)return!1;for(s=i;0!=s--;)if(!({}).hasOwnProperty.call(t,r[s]))return!1;for(s=i;0!=s--;){let i=r[s];if(("_owner"!==i||!e.$$typeof)&&!nO(e[i],t[i]))return!1}return!0}return e!=e&&t!=t}function nB(e){return"undefined"==typeof window?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function n$(e,t){let i=nB(e);return Math.round(t*i)/i}function nW(e){let t=$.useRef(e);return nD(()=>{t.current=e}),t}var nV=$.forwardRef((e,t)=>{let{children:i,width:s=10,height:r=5,...n}=e;return(0,L.jsx)(rn.svg,{...n,ref:t,width:s,height:r,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?i:(0,L.jsx)("polygon",{points:"0,0 30,0 15,10"})})});function nK(e){let[t,i]=$.useState(void 0);return rN(()=>{if(e){i({width:e.offsetWidth,height:e.offsetHeight});let t=new ResizeObserver(t=>{let s,r;if(!Array.isArray(t)||!t.length)return;let n=t[0];if("borderBoxSize"in n){let e=n.borderBoxSize,t=Array.isArray(e)?e[0]:e;s=t.inlineSize,r=t.blockSize}else s=e.offsetWidth,r=e.offsetHeight;i({width:s,height:r})});return t.observe(e,{box:"border-box"}),()=>t.unobserve(e)}i(void 0)},[e]),t}nV.displayName="Arrow";var nU="Popper",[nH,nJ]=s7(nU),[nq,nY]=nH(nU),nX=e=>{let{__scopePopper:t,children:i}=e,[s,r]=$.useState(null);return(0,L.jsx)(nq,{scope:t,anchor:s,onAnchorChange:r,children:i})};nX.displayName=nU;var nG="PopperAnchor",nQ=$.forwardRef((e,t)=>{let{__scopePopper:i,virtualRef:s,...r}=e,n=nY(nG,i),l=$.useRef(null),a=(0,re.useComposedRefs)(t,l);return $.useEffect(()=>{n.onAnchorChange(s?.current||l.current)}),s?null:(0,L.jsx)(rn.div,{...r,ref:a})});nQ.displayName=nG;var nZ="PopperContent",[n0,n1]=nH(nZ),n2=$.forwardRef((e,t)=>{var i,s,r,n,l,a,o,h,u,c,d,m,p,f,g,v,x,w,b,y,S;let{__scopePopper:j,side:M="bottom",sideOffset:C=0,align:N="center",alignOffset:P=0,arrowPadding:k=0,avoidCollisions:E=!0,collisionBoundary:R=[],collisionPadding:_=0,sticky:T="partial",hideWhenDetached:I=!1,updatePositionStrategy:A="optimized",onPlaced:F,...z}=e,D=nY(nZ,j),[O,B]=$.useState(null),W=(0,re.useComposedRefs)(t,e=>B(e)),[V,K]=$.useState(null),U=nK(V),H=U?.width??0,J=U?.height??0,q="number"==typeof _?_:{top:0,right:0,bottom:0,left:0,..._},Y=Array.isArray(R)?R:[R],X=Y.length>0,G={padding:q,boundary:Y.filter(n6),altBoundary:X},{refs:Q,floatingStyles:Z,placement:ee,isPositioned:et,middlewareData:ei}=function(e){void 0===e&&(e={});let{placement:t="bottom",strategy:i="absolute",middleware:s=[],platform:r,elements:{reference:n,floating:l}={},transform:a=!0,whileElementsMounted:o,open:h}=e,[u,c]=$.useState({x:0,y:0,strategy:i,placement:t,middlewareData:{},isPositioned:!1}),[d,m]=$.useState(s);nO(d,s)||m(s);let[p,f]=$.useState(null),[g,v]=$.useState(null),x=$.useCallback(e=>{e!==S.current&&(S.current=e,f(e))},[]),w=$.useCallback(e=>{e!==j.current&&(j.current=e,v(e))},[]),b=n||p,y=l||g,S=$.useRef(null),j=$.useRef(null),M=$.useRef(u),C=null!=o,N=nW(o),P=nW(r),k=nW(h),E=$.useCallback(()=>{var e,s;let r,n,l;if(!S.current||!j.current)return;let a={placement:t,strategy:i,middleware:d};P.current&&(a.platform=P.current),(e=S.current,s=j.current,r=new Map,l={...(n={platform:nA,...a}).platform,_c:r},r0(e,s,{...n,platform:l})).then(e=>{let t={...e,isPositioned:!1!==k.current};R.current&&!nO(M.current,t)&&(M.current=t,s6.flushSync(()=>{c(t)}))})},[d,t,i,P,k]);nD(()=>{!1===h&&M.current.isPositioned&&(M.current.isPositioned=!1,c(e=>({...e,isPositioned:!1})))},[h]);let R=$.useRef(!1);nD(()=>(R.current=!0,()=>{R.current=!1}),[]),nD(()=>{if(b&&(S.current=b),y&&(j.current=y),b&&y){if(N.current)return N.current(b,y,E);E()}},[b,y,E,N,C]);let _=$.useMemo(()=>({reference:S,floating:j,setReference:x,setFloating:w}),[x,w]),T=$.useMemo(()=>({reference:b,floating:y}),[b,y]),L=$.useMemo(()=>{let e={position:i,left:0,top:0};if(!T.floating)return e;let t=n$(T.floating,u.x),s=n$(T.floating,u.y);return a?{...e,transform:"translate("+t+"px, "+s+"px)",...nB(T.floating)>=1.5&&{willChange:"transform"}}:{position:i,left:t,top:s}},[i,a,T.floating,u.x,u.y]);return $.useMemo(()=>({...u,update:E,refs:_,elements:T,floatingStyles:L}),[u,E,_,T,L])}({strategy:"fixed",placement:M+("center"!==N?"-"+N:""),whileElementsMounted:(...e)=>(function(e,t,i,s){let r;void 0===s&&(s={});let{ancestorScroll:n=!0,ancestorResize:l=!0,elementResize:a="function"==typeof ResizeObserver,layoutShift:o="function"==typeof IntersectionObserver,animationFrame:h=!1}=s,u=nS(e),c=n||l?[...u?nw(u):[],...nw(t)]:[];c.forEach(e=>{n&&e.addEventListener("scroll",i,{passive:!0}),l&&e.addEventListener("resize",i)});let d=u&&o?function(e,t){let i,s=null,r=r7(e);function n(){var e;clearTimeout(i),null==(e=s)||e.disconnect(),s=null}return!function l(a,o){void 0===a&&(a=!1),void 0===o&&(o=1),n();let h=e.getBoundingClientRect(),{left:u,top:c,width:d,height:m}=h;if(a||t(),!d||!m)return;let p={rootMargin:-rI(c)+"px "+-rI(r.clientWidth-(u+d))+"px "+-rI(r.clientHeight-(c+m))+"px "+-rI(u)+"px",threshold:rT(0,r_(1,o))||1},f=!0;function g(t){let s=t[0].intersectionRatio;if(s!==o){if(!f)return l();s?l(!1,s):i=setTimeout(()=>{l(!1,1e-7)},1e3)}1!==s||nF(h,e.getBoundingClientRect())||l(),f=!1}try{s=new IntersectionObserver(g,{...p,root:r.ownerDocument})}catch(e){s=new IntersectionObserver(g,p)}s.observe(e)}(!0),n}(u,i):null,m=-1,p=null;a&&(p=new ResizeObserver(e=>{let[s]=e;s&&s.target===u&&p&&(p.unobserve(t),cancelAnimationFrame(m),m=requestAnimationFrame(()=>{var e;null==(e=p)||e.observe(t)})),i()}),u&&!h&&p.observe(u),p.observe(t));let f=h?nN(e):null;return h&&function t(){let s=nN(e);f&&!nF(f,s)&&i(),f=s,r=requestAnimationFrame(t)}(),i(),()=>{var e;c.forEach(e=>{n&&e.removeEventListener("scroll",i),l&&e.removeEventListener("resize",i)}),null==d||d(),null==(e=p)||e.disconnect(),p=null,h&&cancelAnimationFrame(r)}})(...e,{animationFrame:"always"===A}),elements:{reference:D.anchor},middleware:[{...{name:"offset",options:r=i={mainAxis:C+J,alignmentAxis:P},async fn(e){var t,i;let{x:s,y:n,placement:l,middlewareData:a}=e,o=await r4(e,r);return l===(null==(t=a.offset)?void 0:t.placement)&&null!=(i=a.arrow)&&i.alignmentOffset?{}:{x:s+o.x,y:n+o.y,data:{...o,placement:l}}}},options:[i,s]},E&&{...{name:"shift",options:u=o={mainAxis:!0,crossAxis:!1,limiter:"partial"===T?{...(void 0===(a=n)&&(a={}),{options:a,fn(e){let{x:t,y:i,placement:s,rects:r,middlewareData:n}=e,{offset:l=0,mainAxis:o=!0,crossAxis:h=!0}=rD(a,e),u={x:t,y:i},c=rK(s),d=r$(c),m=u[d],p=u[c],f=rD(l,e),g="number"==typeof f?{mainAxis:f,crossAxis:0}:{mainAxis:0,crossAxis:0,...f};if(o){let e="y"===d?"height":"width",t=r.reference[d]-r.floating[e]+g.mainAxis,i=r.reference[d]+r.reference[e]-g.mainAxis;m<t?m=t:m>i&&(m=i)}if(h){var v,x;let e="y"===d?"width":"height",t=r5.has(rO(s)),i=r.reference[c]-r.floating[e]+(t&&(null==(v=n.offset)?void 0:v[c])||0)+(t?0:g.crossAxis),l=r.reference[c]+r.reference[e]+(t?0:(null==(x=n.offset)?void 0:x[c])||0)-(t?g.crossAxis:0);p<i?p=i:p>l&&(p=l)}return{[d]:m,[c]:p}}}),options:[n,l]}:void 0,...G},async fn(e){let{x:t,y:i,placement:s}=e,{mainAxis:r=!0,crossAxis:n=!1,limiter:l={fn:e=>{let{x:t,y:i}=e;return{x:t,y:i}}},...a}=rD(u,e),o={x:t,y:i},h=await r1(e,a),c=rK(rO(s)),d=r$(c),m=o[d],p=o[c];if(r){let e="y"===d?"top":"left",t="y"===d?"bottom":"right",i=m+h[e],s=m-h[t];m=rT(i,r_(m,s))}if(n){let e="y"===c?"top":"left",t="y"===c?"bottom":"right",i=p+h[e],s=p-h[t];p=rT(i,r_(p,s))}let f=l.fn({...e,[d]:m,[c]:p});return{...f,data:{x:f.x-t,y:f.y-i,enabled:{[d]:r,[c]:n}}}}},options:[o,h]},E&&{...{name:"flip",options:m=c={...G},async fn(e){var t,i,s,r,n,l,a,o;let h,u,c,{placement:d,middlewareData:p,rects:f,initialPlacement:g,platform:v,elements:x}=e,{mainAxis:w=!0,crossAxis:b=!0,fallbackPlacements:y,fallbackStrategy:S="bestFit",fallbackAxisSideDirection:j="none",flipAlignment:M=!0,...C}=rD(m,e);if(null!=(t=p.arrow)&&t.alignmentOffset)return{};let N=rO(d),P=rK(g),k=rO(g)===g,E=await (null==v.isRTL?void 0:v.isRTL(x.floating)),R=y||(k||!M?[rX(g)]:(h=rX(g),[rU(g),h,rU(h)])),_="none"!==j;!y&&_&&R.push(...(u=rB(g),c=function(e,t,i){switch(e){case"top":case"bottom":if(i)return t?rJ:rH;return t?rH:rJ;case"left":case"right":return t?rq:rY;default:return[]}}(rO(g),"start"===j,E),u&&(c=c.map(e=>e+"-"+u),M&&(c=c.concat(c.map(rU)))),c));let T=[g,...R],L=await r1(e,C),I=[],A=(null==(i=p.flip)?void 0:i.overflows)||[];if(w&&I.push(L[N]),b){let e,t,i,s,r=(l=d,a=f,void 0===(o=E)&&(o=!1),e=rB(l),i=rW(t=r$(rK(l))),s="x"===t?e===(o?"end":"start")?"right":"left":"start"===e?"bottom":"top",a.reference[i]>a.floating[i]&&(s=rX(s)),[s,rX(s)]);I.push(L[r[0]],L[r[1]])}if(A=[...A,{placement:d,overflows:I}],!I.every(e=>e<=0)){let e=((null==(s=p.flip)?void 0:s.index)||0)+1,t=T[e];if(t&&("alignment"!==b||P===rK(t)||A.every(e=>rK(e.placement)!==P||e.overflows[0]>0)))return{data:{index:e,overflows:A},reset:{placement:t}};let i=null==(r=A.filter(e=>e.overflows[0]<=0).sort((e,t)=>e.overflows[1]-t.overflows[1])[0])?void 0:r.placement;if(!i)switch(S){case"bestFit":{let e=null==(n=A.filter(e=>{if(_){let t=rK(e.placement);return t===P||"y"===t}return!0}).map(e=>[e.placement,e.overflows.filter(e=>e>0).reduce((e,t)=>e+t,0)]).sort((e,t)=>e[1]-t[1])[0])?void 0:n[0];e&&(i=e);break}case"initialPlacement":i=g}if(d!==i)return{reset:{placement:i}}}return{}}},options:[c,d]},{...{name:"size",options:g=p={...G,apply:({elements:e,rects:t,availableWidth:i,availableHeight:s})=>{let{width:r,height:n}=t.reference,l=e.floating.style;l.setProperty("--radix-popper-available-width",`${i}px`),l.setProperty("--radix-popper-available-height",`${s}px`),l.setProperty("--radix-popper-anchor-width",`${r}px`),l.setProperty("--radix-popper-anchor-height",`${n}px`)}},async fn(e){var t,i;let s,r,{placement:n,rects:l,platform:a,elements:o}=e,{apply:h=()=>{},...u}=rD(g,e),c=await r1(e,u),d=rO(n),m=rB(n),p="y"===rK(n),{width:f,height:v}=l.floating;"top"===d||"bottom"===d?(s=d,r=m===(await (null==a.isRTL?void 0:a.isRTL(o.floating))?"start":"end")?"left":"right"):(r=d,s="end"===m?"top":"bottom");let x=v-c.top-c.bottom,w=f-c.left-c.right,b=r_(v-c[s],x),y=r_(f-c[r],w),S=!e.middlewareData.shift,j=b,M=y;if(null!=(t=e.middlewareData.shift)&&t.enabled.x&&(M=w),null!=(i=e.middlewareData.shift)&&i.enabled.y&&(j=x),S&&!m){let e=rT(c.left,0),t=rT(c.right,0),i=rT(c.top,0),s=rT(c.bottom,0);p?M=f-2*(0!==e||0!==t?e+t:rT(c.left,c.right)):j=v-2*(0!==i||0!==s?i+s:rT(c.top,c.bottom))}await h({...e,availableWidth:M,availableHeight:j});let C=await a.getDimensions(o.floating);return f!==C.width||v!==C.height?{reset:{rects:!0}}:{}}},options:[p,f]},V&&{...{name:"arrow",options:w=v={element:V,padding:k},fn(e){let{element:t,padding:i}="function"==typeof w?w(e):w;return t&&({}).hasOwnProperty.call(t,"current")?null!=t.current?nz({element:t.current,padding:i}).fn(e):{}:t?nz({element:t,padding:i}).fn(e):{}}},options:[v,x]},n9({arrowWidth:H,arrowHeight:J}),I&&{...{name:"hide",options:S=b={strategy:"referenceHidden",...G},async fn(e){let{rects:t}=e,{strategy:i="referenceHidden",...s}=rD(S,e);switch(i){case"referenceHidden":{let i=r2(await r1(e,{...s,elementContext:"reference"}),t.reference);return{data:{referenceHiddenOffsets:i,referenceHidden:r3(i)}}}case"escaped":{let i=r2(await r1(e,{...s,altBoundary:!0}),t.floating);return{data:{escapedOffsets:i,escaped:r3(i)}}}default:return{}}}},options:[b,y]}]}),[es,er]=n8(ee),en=ra(F);rN(()=>{et&&en?.()},[et,en]);let el=ei.arrow?.x,ea=ei.arrow?.y,eo=ei.arrow?.centerOffset!==0,[eh,eu]=$.useState();return rN(()=>{O&&eu(window.getComputedStyle(O).zIndex)},[O]),(0,L.jsx)("div",{ref:Q.setFloating,"data-radix-popper-content-wrapper":"",style:{...Z,transform:et?Z.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:eh,"--radix-popper-transform-origin":[ei.transformOrigin?.x,ei.transformOrigin?.y].join(" "),...ei.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:(0,L.jsx)(n0,{scope:j,placedSide:es,onArrowChange:K,arrowX:el,arrowY:ea,shouldHideArrow:eo,children:(0,L.jsx)(rn.div,{"data-side":es,"data-align":er,...z,ref:W,style:{...z.style,animation:et?void 0:"none"}})})})});n2.displayName=nZ;var n3="PopperArrow",n5={top:"bottom",right:"left",bottom:"top",left:"right"},n4=$.forwardRef(function(e,t){let{__scopePopper:i,...s}=e,r=n1(n3,i),n=n5[r.placedSide];return(0,L.jsx)("span",{ref:r.onArrowChange,style:{position:"absolute",left:r.arrowX,top:r.arrowY,[n]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[r.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[r.placedSide],visibility:r.shouldHideArrow?"hidden":void 0},children:(0,L.jsx)(nV,{...s,ref:t,style:{...s.style,display:"block"}})})});function n6(e){return null!==e}n4.displayName=n3;var n9=e=>({name:"transformOrigin",options:e,fn(t){let{placement:i,rects:s,middlewareData:r}=t,n=r.arrow?.centerOffset!==0,l=n?0:e.arrowWidth,a=n?0:e.arrowHeight,[o,h]=n8(i),u={start:"0%",center:"50%",end:"100%"}[h],c=(r.arrow?.x??0)+l/2,d=(r.arrow?.y??0)+a/2,m="",p="";return"bottom"===o?(m=n?u:`${c}px`,p=`${-a}px`):"top"===o?(m=n?u:`${c}px`,p=`${s.floating.height+a}px`):"right"===o?(m=`${-a}px`,p=n?u:`${d}px`):"left"===o&&(m=`${s.floating.width+a}px`,p=n?u:`${d}px`),{data:{x:m,y:p}}}});function n8(e){let[t,i="center"]=e.split("-");return[t,i]}var n7=$.forwardRef((e,t)=>{let{container:i,...s}=e,[r,n]=$.useState(!1);rN(()=>n(!0),[]);let l=i||r&&globalThis?.document?.body;return l?s6.default.createPortal((0,L.jsx)(rn.div,{...s,ref:t}),l):null});function le({prop:e,defaultProp:t,onChange:i=()=>{}}){let[s,r]=function({defaultProp:e,onChange:t}){let i=$.useState(e),[s]=i,r=$.useRef(s),n=ra(t);return $.useEffect(()=>{r.current!==s&&(n(s),r.current=s)},[s,r,n]),i}({defaultProp:t,onChange:i}),n=void 0!==e,l=n?e:s,a=ra(i);return[l,$.useCallback(t=>{if(n){let i="function"==typeof t?t(e):t;i!==e&&a(i)}else r(t)},[n,e,r,a])]}function lt(e){let t=$.useRef({value:e,previous:e});return $.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}n7.displayName="Portal";var li=$.forwardRef((e,t)=>(0,L.jsx)(rn.span,{...e,ref:t,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...e.style}}));li.displayName="VisuallyHidden";var ls=new WeakMap,lr=new WeakMap,ln={},ll=0,la=function(e){return e&&(e.host||la(e.parentNode))},lo=function(e,t,i,s){var r=(Array.isArray(e)?e:[e]).map(function(e){if(t.contains(e))return e;var i=la(e);return i&&t.contains(i)?i:(console.error("aria-hidden",e,"in not contained inside",t,". Doing nothing"),null)}).filter(function(e){return!!e});ln[i]||(ln[i]=new WeakMap);var n=ln[i],l=[],a=new Set,o=new Set(r),h=function(e){!e||a.has(e)||(a.add(e),h(e.parentNode))};r.forEach(h);var u=function(e){!e||o.has(e)||Array.prototype.forEach.call(e.children,function(e){if(a.has(e))u(e);else try{var t=e.getAttribute(s),r=null!==t&&"false"!==t,o=(ls.get(e)||0)+1,h=(n.get(e)||0)+1;ls.set(e,o),n.set(e,h),l.push(e),1===o&&r&&lr.set(e,!0),1===h&&e.setAttribute(i,"true"),r||e.setAttribute(s,"true")}catch(t){console.error("aria-hidden: cannot operate on ",e,t)}})};return u(t),a.clear(),ll++,function(){l.forEach(function(e){var t=ls.get(e)-1,r=n.get(e)-1;ls.set(e,t),n.set(e,r),t||(lr.has(e)||e.removeAttribute(s),lr.delete(e)),r||e.removeAttribute(i)}),--ll||(ls=new WeakMap,ls=new WeakMap,lr=new WeakMap,ln={})}},lh=function(e,t,i){void 0===i&&(i="data-aria-hidden");var s=Array.from(Array.isArray(e)?e:[e]),r=t||("undefined"==typeof document?null:(Array.isArray(e)?e[0]:e).ownerDocument.body);return r?(s.push.apply(s,Array.from(r.querySelectorAll("[aria-live], script"))),lo(s,r,i,"aria-hidden")):function(){return null}},lu=function(){return(lu=Object.assign||function(e){for(var t,i=1,s=arguments.length;i<s;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function lc(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&0>t.indexOf(s)&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,s=Object.getOwnPropertySymbols(e);r<s.length;r++)0>t.indexOf(s[r])&&Object.prototype.propertyIsEnumerable.call(e,s[r])&&(i[s[r]]=e[s[r]]);return i}var ld=("function"==typeof SuppressedError&&SuppressedError,"right-scroll-bar-position"),lm="width-before-scroll-bar";function lp(e,t){return"function"==typeof e?e(t):e&&(e.current=t),e}var lf="undefined"!=typeof window?$.useLayoutEffect:$.useEffect,lg=new WeakMap,lv=(void 0===p&&(p={}),(void 0===f&&(f=function(e){return e}),g=[],v=!1,x={read:function(){if(v)throw Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return g.length?g[g.length-1]:null},useMedium:function(e){var t=f(e,v);return g.push(t),function(){g=g.filter(function(e){return e!==t})}},assignSyncMedium:function(e){for(v=!0;g.length;){var t=g;g=[],t.forEach(e)}g={push:function(t){return e(t)},filter:function(){return g}}},assignMedium:function(e){v=!0;var t=[];if(g.length){var i=g;g=[],i.forEach(e),t=g}var s=function(){var i=t;t=[],i.forEach(e)},r=function(){return Promise.resolve().then(s)};r(),g={push:function(e){t.push(e),r()},filter:function(e){return t=t.filter(e),g}}}}).options=lu({async:!0,ssr:!1},p),x),lx=function(){},lw=$.forwardRef(function(e,t){var i,s,r,n,l=$.useRef(null),a=$.useState({onScrollCapture:lx,onWheelCapture:lx,onTouchMoveCapture:lx}),o=a[0],h=a[1],u=e.forwardProps,c=e.children,d=e.className,m=e.removeScrollBar,p=e.enabled,f=e.shards,g=e.sideCar,v=e.noRelative,x=e.noIsolation,w=e.inert,b=e.allowPinchZoom,y=e.as,S=e.gapMode,j=lc(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),M=(i=[l,t],s=function(e){return i.forEach(function(t){return lp(t,e)})},(r=(0,$.useState)(function(){return{value:null,callback:s,facade:{get current(){return r.value},set current(value){var e=r.value;e!==value&&(r.value=value,r.callback(value,e))}}}})[0]).callback=s,n=r.facade,lf(function(){var e=lg.get(n);if(e){var t=new Set(e),s=new Set(i),r=n.current;t.forEach(function(e){s.has(e)||lp(e,null)}),s.forEach(function(e){t.has(e)||lp(e,r)})}lg.set(n,i)},[i]),n),C=lu(lu({},j),o);return $.createElement($.Fragment,null,p&&$.createElement(g,{sideCar:lv,removeScrollBar:m,shards:f,noRelative:v,noIsolation:x,inert:w,setCallbacks:h,allowPinchZoom:!!b,lockRef:l,gapMode:S}),u?$.cloneElement($.Children.only(c),lu(lu({},C),{ref:M})):$.createElement(void 0===y?"div":y,lu({},C,{className:d,ref:M}),c))});lw.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1},lw.classNames={fullWidth:lm,zeroRight:ld};var lb=function(e){var t=e.sideCar,i=lc(e,["sideCar"]);if(!t)throw Error("Sidecar: please provide `sideCar` property to import the right car");var s=t.read();if(!s)throw Error("Sidecar medium not found");return $.createElement(s,lu({},i))};lb.isSideCarExport=!0;var ly=function(){var e=0,t=null;return{add:function(i){if(0==e&&(t=function(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=T||("undefined"!=typeof __webpack_nonce__?__webpack_nonce__:void 0);return t&&e.setAttribute("nonce",t),e}())){var s,r;(s=t).styleSheet?s.styleSheet.cssText=i:s.appendChild(document.createTextNode(i)),r=t,(document.head||document.getElementsByTagName("head")[0]).appendChild(r)}e++},remove:function(){--e||!t||(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},lS=function(){var e=ly();return function(t,i){$.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&i])}},lj=function(){var e=lS();return function(t){return e(t.styles,t.dynamic),null}},lM={left:0,top:0,right:0,gap:0},lC=function(e){return parseInt(e||"",10)||0},lN=function(e){var t=window.getComputedStyle(document.body),i=t["padding"===e?"paddingLeft":"marginLeft"],s=t["padding"===e?"paddingTop":"marginTop"],r=t["padding"===e?"paddingRight":"marginRight"];return[lC(i),lC(s),lC(r)]},lP=function(e){if(void 0===e&&(e="margin"),"undefined"==typeof window)return lM;var t=lN(e),i=document.documentElement.clientWidth,s=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,s-i+t[2]-t[0])}},lk=lj(),lE="data-scroll-locked",lR=function(e,t,i,s){var r=e.left,n=e.top,l=e.right,a=e.gap;return void 0===i&&(i="margin"),"\n  .".concat("with-scroll-bars-hidden"," {\n   overflow: hidden ").concat(s,";\n   padding-right: ").concat(a,"px ").concat(s,";\n  }\n  body[").concat(lE,"] {\n    overflow: hidden ").concat(s,";\n    overscroll-behavior: contain;\n    ").concat([t&&"position: relative ".concat(s,";"),"margin"===i&&"\n    padding-left: ".concat(r,"px;\n    padding-top: ").concat(n,"px;\n    padding-right: ").concat(l,"px;\n    margin-left:0;\n    margin-top:0;\n    margin-right: ").concat(a,"px ").concat(s,";\n    "),"padding"===i&&"padding-right: ".concat(a,"px ").concat(s,";")].filter(Boolean).join(""),"\n  }\n  \n  .").concat(ld," {\n    right: ").concat(a,"px ").concat(s,";\n  }\n  \n  .").concat(lm," {\n    margin-right: ").concat(a,"px ").concat(s,";\n  }\n  \n  .").concat(ld," .").concat(ld," {\n    right: 0 ").concat(s,";\n  }\n  \n  .").concat(lm," .").concat(lm," {\n    margin-right: 0 ").concat(s,";\n  }\n  \n  body[").concat(lE,"] {\n    ").concat("--removed-body-scroll-bar-size",": ").concat(a,"px;\n  }\n")},l_=function(){var e=parseInt(document.body.getAttribute(lE)||"0",10);return isFinite(e)?e:0},lT=function(){$.useEffect(function(){return document.body.setAttribute(lE,(l_()+1).toString()),function(){var e=l_()-1;e<=0?document.body.removeAttribute(lE):document.body.setAttribute(lE,e.toString())}},[])},lL=function(e){var t=e.noRelative,i=e.noImportant,s=e.gapMode,r=void 0===s?"margin":s;lT();var n=$.useMemo(function(){return lP(r)},[r]);return $.createElement(lk,{styles:lR(n,!t,r,i?"":"!important")})},lI=!1;if("undefined"!=typeof window)try{var lA=Object.defineProperty({},"passive",{get:function(){return lI=!0,!0}});window.addEventListener("test",lA,lA),window.removeEventListener("test",lA,lA)}catch(e){lI=!1}var lF=!!lI&&{passive:!1},lz=function(e,t){if(!(e instanceof Element))return!1;var i=window.getComputedStyle(e);return"hidden"!==i[t]&&(i.overflowY!==i.overflowX||"TEXTAREA"===e.tagName||"visible"!==i[t])},lD=function(e,t){var i=t.ownerDocument,s=t;do{if("undefined"!=typeof ShadowRoot&&s instanceof ShadowRoot&&(s=s.host),lO(e,s)){var r=lB(e,s);if(r[1]>r[2])return!0}s=s.parentNode}while(s&&s!==i.body)return!1},lO=function(e,t){return"v"===e?lz(t,"overflowY"):lz(t,"overflowX")},lB=function(e,t){return"v"===e?[t.scrollTop,t.scrollHeight,t.clientHeight]:[t.scrollLeft,t.scrollWidth,t.clientWidth]},l$=function(e,t,i,s,r){var n,l=(n=window.getComputedStyle(t).direction,"h"===e&&"rtl"===n?-1:1),a=l*s,o=i.target,h=t.contains(o),u=!1,c=a>0,d=0,m=0;do{if(!o)break;var p=lB(e,o),f=p[0],g=p[1]-p[2]-l*f;(f||g)&&lO(e,o)&&(d+=g,m+=f);var v=o.parentNode;o=v&&v.nodeType===Node.DOCUMENT_FRAGMENT_NODE?v.host:v}while(!h&&o!==document.body||h&&(t.contains(o)||t===o))return c&&(r&&1>Math.abs(d)||!r&&a>d)?u=!0:!c&&(r&&1>Math.abs(m)||!r&&-a>m)&&(u=!0),u},lW=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},lV=function(e){return[e.deltaX,e.deltaY]},lK=function(e){return e&&"current"in e?e.current:e},lU=0,lH=[];let lJ=(w=function(e){var t=$.useRef([]),i=$.useRef([0,0]),s=$.useRef(),r=$.useState(lU++)[0],n=$.useState(lj)[0],l=$.useRef(e);$.useEffect(function(){l.current=e},[e]),$.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(r));var t=(function(e,t,i){if(i||2==arguments.length)for(var s,r=0,n=t.length;r<n;r++)!s&&r in t||(s||(s=Array.prototype.slice.call(t,0,r)),s[r]=t[r]);return e.concat(s||Array.prototype.slice.call(t))})([e.lockRef.current],(e.shards||[]).map(lK),!0).filter(Boolean);return t.forEach(function(e){return e.classList.add("allow-interactivity-".concat(r))}),function(){document.body.classList.remove("block-interactivity-".concat(r)),t.forEach(function(e){return e.classList.remove("allow-interactivity-".concat(r))})}}},[e.inert,e.lockRef.current,e.shards]);var a=$.useCallback(function(e,t){if("touches"in e&&2===e.touches.length||"wheel"===e.type&&e.ctrlKey)return!l.current.allowPinchZoom;var r,n=lW(e),a=i.current,o="deltaX"in e?e.deltaX:a[0]-n[0],h="deltaY"in e?e.deltaY:a[1]-n[1],u=e.target,c=Math.abs(o)>Math.abs(h)?"h":"v";if("touches"in e&&"h"===c&&"range"===u.type)return!1;var d=window.getSelection(),m=d&&d.anchorNode;if(m&&(m===u||m.contains(u)))return!1;var p=lD(c,u);if(!p)return!0;if(p?r=c:(r="v"===c?"h":"v",p=lD(c,u)),!p)return!1;if(!s.current&&"changedTouches"in e&&(o||h)&&(s.current=r),!r)return!0;var f=s.current||r;return l$(f,t,e,"h"===f?o:h,!0)},[]),o=$.useCallback(function(e){if(lH.length&&lH[lH.length-1]===n){var i="deltaY"in e?lV(e):lW(e),s=t.current.filter(function(t){var s;return t.name===e.type&&(t.target===e.target||e.target===t.shadowParent)&&(s=t.delta,s[0]===i[0]&&s[1]===i[1])})[0];if(s&&s.should){e.cancelable&&e.preventDefault();return}if(!s){var r=(l.current.shards||[]).map(lK).filter(Boolean).filter(function(t){return t.contains(e.target)});(r.length>0?a(e,r[0]):!l.current.noIsolation)&&e.cancelable&&e.preventDefault()}}},[]),h=$.useCallback(function(e,i,s,r){var n={name:e,delta:i,target:s,should:r,shadowParent:function(e){for(var t=null;null!==e;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}(s)};t.current.push(n),setTimeout(function(){t.current=t.current.filter(function(e){return e!==n})},1)},[]),u=$.useCallback(function(e){i.current=lW(e),s.current=void 0},[]),c=$.useCallback(function(t){h(t.type,lV(t),t.target,a(t,e.lockRef.current))},[]),d=$.useCallback(function(t){h(t.type,lW(t),t.target,a(t,e.lockRef.current))},[]);$.useEffect(function(){return lH.push(n),e.setCallbacks({onScrollCapture:c,onWheelCapture:c,onTouchMoveCapture:d}),document.addEventListener("wheel",o,lF),document.addEventListener("touchmove",o,lF),document.addEventListener("touchstart",u,lF),function(){lH=lH.filter(function(e){return e!==n}),document.removeEventListener("wheel",o,lF),document.removeEventListener("touchmove",o,lF),document.removeEventListener("touchstart",u,lF)}},[]);var m=e.removeScrollBar,p=e.inert;return $.createElement($.Fragment,null,p?$.createElement(n,{styles:"\n  .block-interactivity-".concat(r," {pointer-events: none;}\n  .allow-interactivity-").concat(r," {pointer-events: all;}\n")}):null,m?$.createElement(lL,{noRelative:e.noRelative,gapMode:e.gapMode}):null)},lv.useMedium(w),lb);var lq=$.forwardRef(function(e,t){return $.createElement(lw,lu({},e,{ref:t,sideCar:lJ}))});lq.classNames=lw.classNames;var lY=[" ","Enter","ArrowUp","ArrowDown"],lX=[" ","Enter"],lG="Select",[lQ,lZ,l0]=ri(lG),[l1,l2]=s7(lG,[l0,nJ]),l3=nJ(),[l5,l4]=l1(lG),[l6,l9]=l1(lG),l8=e=>{let{__scopeSelect:t,children:i,open:s,defaultOpen:r,onOpenChange:n,value:l,defaultValue:a,onValueChange:o,dir:h,name:u,autoComplete:c,disabled:d,required:m,form:p}=e,f=l3(t),[g,v]=$.useState(null),[x,w]=$.useState(null),[b,y]=$.useState(!1),S=rr(h),[j=!1,M]=le({prop:s,defaultProp:r,onChange:n}),[C,N]=le({prop:l,defaultProp:a,onChange:o}),P=$.useRef(null),k=!g||p||!!g.closest("form"),[E,R]=$.useState(new Set),_=Array.from(E).map(e=>e.props.value).join(";");return(0,L.jsx)(nX,{...f,children:(0,L.jsxs)(l5,{required:m,scope:t,trigger:g,onTriggerChange:v,valueNode:x,onValueNodeChange:w,valueNodeHasChildren:b,onValueNodeHasChildrenChange:y,contentId:rE(),value:C,onValueChange:N,open:j,onOpenChange:M,dir:S,triggerPointerDownPosRef:P,disabled:d,children:[(0,L.jsx)(lQ.Provider,{scope:t,children:(0,L.jsx)(l6,{scope:e.__scopeSelect,onNativeOptionAdd:$.useCallback(e=>{R(t=>new Set(t).add(e))},[]),onNativeOptionRemove:$.useCallback(e=>{R(t=>{let i=new Set(t);return i.delete(e),i})},[]),children:i})}),k?(0,L.jsxs)(aA,{"aria-hidden":!0,required:m,tabIndex:-1,name:u,autoComplete:c,value:C,onChange:e=>N(e.target.value),disabled:d,form:p,children:[void 0===C?(0,L.jsx)("option",{value:""}):null,Array.from(E)]},_):null]})})};l8.displayName=lG;var l7="SelectTrigger",ae=$.forwardRef((e,t)=>{let{__scopeSelect:i,disabled:s=!1,...r}=e,n=l3(i),l=l4(l7,i),a=l.disabled||s,o=(0,re.useComposedRefs)(t,l.onTriggerChange),h=lZ(i),u=$.useRef("touch"),[c,d,m]=aF(e=>{let t=h().filter(e=>!e.disabled),i=t.find(e=>e.value===l.value),s=az(t,e,i);void 0!==s&&l.onValueChange(s.value)}),p=e=>{a||(l.onOpenChange(!0),m()),e&&(l.triggerPointerDownPosRef.current={x:Math.round(e.pageX),y:Math.round(e.pageY)})};return(0,L.jsx)(nQ,{asChild:!0,...n,children:(0,L.jsx)(rn.button,{type:"button",role:"combobox","aria-controls":l.contentId,"aria-expanded":l.open,"aria-required":l.required,"aria-autocomplete":"none",dir:l.dir,"data-state":l.open?"open":"closed",disabled:a,"data-disabled":a?"":void 0,"data-placeholder":aI(l.value)?"":void 0,...r,ref:o,onClick:s8(r.onClick,e=>{e.currentTarget.focus(),"mouse"!==u.current&&p(e)}),onPointerDown:s8(r.onPointerDown,e=>{u.current=e.pointerType;let t=e.target;t.hasPointerCapture(e.pointerId)&&t.releasePointerCapture(e.pointerId),0===e.button&&!1===e.ctrlKey&&"mouse"===e.pointerType&&(p(e),e.preventDefault())}),onKeyDown:s8(r.onKeyDown,e=>{let t=""!==c.current;e.ctrlKey||e.altKey||e.metaKey||1!==e.key.length||d(e.key),(!t||" "!==e.key)&&lY.includes(e.key)&&(p(),e.preventDefault())})})})});ae.displayName=l7;var at="SelectValue",ai=$.forwardRef((e,t)=>{let{__scopeSelect:i,className:s,style:r,children:n,placeholder:l="",...a}=e,o=l4(at,i),{onValueNodeHasChildrenChange:h}=o,u=void 0!==n,c=(0,re.useComposedRefs)(t,o.onValueNodeChange);return rN(()=>{h(u)},[h,u]),(0,L.jsx)(rn.span,{...a,ref:c,style:{pointerEvents:"none"},children:aI(o.value)?(0,L.jsx)(L.Fragment,{children:l}):n})});ai.displayName=at;var as=$.forwardRef((e,t)=>{let{__scopeSelect:i,children:s,...r}=e;return(0,L.jsx)(rn.span,{"aria-hidden":!0,...r,ref:t,children:s||"â–¼"})});as.displayName="SelectIcon";var ar=e=>(0,L.jsx)(n7,{asChild:!0,...e});ar.displayName="SelectPortal";var an="SelectContent",al=$.forwardRef((e,t)=>{let i=l4(an,e.__scopeSelect),[s,r]=$.useState();return(rN(()=>{r(new DocumentFragment)},[]),i.open)?(0,L.jsx)(ah,{...e,ref:t}):s?s6.createPortal((0,L.jsx)(aa,{scope:e.__scopeSelect,children:(0,L.jsx)(lQ.Slot,{scope:e.__scopeSelect,children:(0,L.jsx)("div",{children:e.children})})}),s):null});al.displayName=an;var[aa,ao]=l1(an),ah=$.forwardRef((e,t)=>{let{__scopeSelect:i,position:s="item-aligned",onCloseAutoFocus:r,onEscapeKeyDown:n,onPointerDownOutside:l,side:a,sideOffset:o,align:h,alignOffset:u,arrowPadding:c,collisionBoundary:d,collisionPadding:m,sticky:p,hideWhenDetached:f,avoidCollisions:g,...v}=e,x=l4(an,i),[w,b]=$.useState(null),[y,S]=$.useState(null),j=(0,re.useComposedRefs)(t,e=>b(e)),[M,C]=$.useState(null),[N,P]=$.useState(null),k=lZ(i),[E,R]=$.useState(!1),_=$.useRef(!1);$.useEffect(()=>{if(w)return lh(w)},[w]),rf();let T=$.useCallback(e=>{let[t,...i]=k().map(e=>e.ref.current),[s]=i.slice(-1),r=document.activeElement;for(let i of e)if(i===r||(i?.scrollIntoView({block:"nearest"}),i===t&&y&&(y.scrollTop=0),i===s&&y&&(y.scrollTop=y.scrollHeight),i?.focus(),document.activeElement!==r))return},[k,y]),I=$.useCallback(()=>T([M,w]),[T,M,w]);$.useEffect(()=>{E&&I()},[E,I]);let{onOpenChange:A,triggerPointerDownPosRef:F}=x;$.useEffect(()=>{if(w){let e={x:0,y:0},t=t=>{e={x:Math.abs(Math.round(t.pageX)-(F.current?.x??0)),y:Math.abs(Math.round(t.pageY)-(F.current?.y??0))}},i=i=>{e.x<=10&&e.y<=10?i.preventDefault():w.contains(i.target)||A(!1),document.removeEventListener("pointermove",t),F.current=null};return null!==F.current&&(document.addEventListener("pointermove",t),document.addEventListener("pointerup",i,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",t),document.removeEventListener("pointerup",i,{capture:!0})}}},[w,A,F]),$.useEffect(()=>{let e=()=>A(!1);return window.addEventListener("blur",e),window.addEventListener("resize",e),()=>{window.removeEventListener("blur",e),window.removeEventListener("resize",e)}},[A]);let[z,D]=aF(e=>{let t=k().filter(e=>!e.disabled),i=t.find(e=>e.ref.current===document.activeElement),s=az(t,e,i);s&&setTimeout(()=>s.ref.current.focus())}),O=$.useCallback((e,t,i)=>{let s=!_.current&&!i;(void 0!==x.value&&x.value===t||s)&&(C(e),s&&(_.current=!0))},[x.value]),B=$.useCallback(()=>w?.focus(),[w]),W=$.useCallback((e,t,i)=>{let s=!_.current&&!i;(void 0!==x.value&&x.value===t||s)&&P(e)},[x.value]),V="popper"===s?ac:au,K=V===ac?{side:a,sideOffset:o,align:h,alignOffset:u,arrowPadding:c,collisionBoundary:d,collisionPadding:m,sticky:p,hideWhenDetached:f,avoidCollisions:g}:{};return(0,L.jsx)(aa,{scope:i,content:w,viewport:y,onViewportChange:S,itemRefCallback:O,selectedItem:M,onItemLeave:B,itemTextRefCallback:W,focusSelectedItem:I,selectedItemText:N,position:s,isPositioned:E,searchRef:z,children:(0,L.jsx)(lq,{as:rt.Slot,allowPinchZoom:!0,children:(0,L.jsx)(rb,{asChild:!0,trapped:x.open,onMountAutoFocus:e=>{e.preventDefault()},onUnmountAutoFocus:s8(r,e=>{x.trigger?.focus({preventScroll:!0}),e.preventDefault()}),children:(0,L.jsx)(ru,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:n,onPointerDownOutside:l,onFocusOutside:e=>e.preventDefault(),onDismiss:()=>x.onOpenChange(!1),children:(0,L.jsx)(V,{role:"listbox",id:x.contentId,"data-state":x.open?"open":"closed",dir:x.dir,onContextMenu:e=>e.preventDefault(),...v,...K,onPlaced:()=>R(!0),ref:j,style:{display:"flex",flexDirection:"column",outline:"none",...v.style},onKeyDown:s8(v.onKeyDown,e=>{let t=e.ctrlKey||e.altKey||e.metaKey;if("Tab"===e.key&&e.preventDefault(),t||1!==e.key.length||D(e.key),["ArrowUp","ArrowDown","Home","End"].includes(e.key)){let t=k().filter(e=>!e.disabled).map(e=>e.ref.current);if(["ArrowUp","End"].includes(e.key)&&(t=t.slice().reverse()),["ArrowUp","ArrowDown"].includes(e.key)){let i=e.target,s=t.indexOf(i);t=t.slice(s+1)}setTimeout(()=>T(t)),e.preventDefault()}})})})})})})});ah.displayName="SelectContentImpl";var au=$.forwardRef((e,t)=>{let{__scopeSelect:i,onPlaced:s,...r}=e,n=l4(an,i),l=ao(an,i),[a,o]=$.useState(null),[h,u]=$.useState(null),c=(0,re.useComposedRefs)(t,e=>u(e)),d=lZ(i),m=$.useRef(!1),p=$.useRef(!0),{viewport:f,selectedItem:g,selectedItemText:v,focusSelectedItem:x}=l,w=$.useCallback(()=>{if(n.trigger&&n.valueNode&&a&&h&&f&&g&&v){let e=n.trigger.getBoundingClientRect(),t=h.getBoundingClientRect(),i=n.valueNode.getBoundingClientRect(),r=v.getBoundingClientRect();if("rtl"!==n.dir){let s=r.left-t.left,n=i.left-s,l=e.left-n,o=e.width+l,h=Math.max(o,t.width),u=s9(n,[10,Math.max(10,window.innerWidth-10-h)]);a.style.minWidth=o+"px",a.style.left=u+"px"}else{let s=t.right-r.right,n=window.innerWidth-i.right-s,l=window.innerWidth-e.right-n,o=e.width+l,h=Math.max(o,t.width),u=s9(n,[10,Math.max(10,window.innerWidth-10-h)]);a.style.minWidth=o+"px",a.style.right=u+"px"}let l=d(),o=window.innerHeight-20,u=f.scrollHeight,c=window.getComputedStyle(h),p=parseInt(c.borderTopWidth,10),x=parseInt(c.paddingTop,10),w=parseInt(c.borderBottomWidth,10),b=p+x+u+parseInt(c.paddingBottom,10)+w,y=Math.min(5*g.offsetHeight,b),S=window.getComputedStyle(f),j=parseInt(S.paddingTop,10),M=parseInt(S.paddingBottom,10),C=e.top+e.height/2-10,N=g.offsetHeight/2,P=p+x+(g.offsetTop+N);if(P<=C){let e=l.length>0&&g===l[l.length-1].ref.current;a.style.bottom="0px";let t=Math.max(o-C,N+(e?M:0)+(h.clientHeight-f.offsetTop-f.offsetHeight)+w);a.style.height=P+t+"px"}else{let e=l.length>0&&g===l[0].ref.current;a.style.top="0px";let t=Math.max(C,p+f.offsetTop+(e?j:0)+N);a.style.height=t+(b-P)+"px",f.scrollTop=P-C+f.offsetTop}a.style.margin="10px 0",a.style.minHeight=y+"px",a.style.maxHeight=o+"px",s?.(),requestAnimationFrame(()=>m.current=!0)}},[d,n.trigger,n.valueNode,a,h,f,g,v,n.dir,s]);rN(()=>w(),[w]);let[b,y]=$.useState();rN(()=>{h&&y(window.getComputedStyle(h).zIndex)},[h]);let S=$.useCallback(e=>{e&&!0===p.current&&(w(),x?.(),p.current=!1)},[w,x]);return(0,L.jsx)(ad,{scope:i,contentWrapper:a,shouldExpandOnScrollRef:m,onScrollButtonChange:S,children:(0,L.jsx)("div",{ref:o,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:b},children:(0,L.jsx)(rn.div,{...r,ref:c,style:{boxSizing:"border-box",maxHeight:"100%",...r.style}})})})});au.displayName="SelectItemAlignedPosition";var ac=$.forwardRef((e,t)=>{let{__scopeSelect:i,align:s="start",collisionPadding:r=10,...n}=e,l=l3(i);return(0,L.jsx)(n2,{...l,...n,ref:t,align:s,collisionPadding:r,style:{boxSizing:"border-box",...n.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});ac.displayName="SelectPopperPosition";var[ad,am]=l1(an,{}),ap="SelectViewport",af=$.forwardRef((e,t)=>{let{__scopeSelect:i,nonce:s,...r}=e,n=ao(ap,i),l=am(ap,i),a=(0,re.useComposedRefs)(t,n.onViewportChange),o=$.useRef(0);return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:s}),(0,L.jsx)(lQ.Slot,{scope:i,children:(0,L.jsx)(rn.div,{"data-radix-select-viewport":"",role:"presentation",...r,ref:a,style:{position:"relative",flex:1,overflow:"hidden auto",...r.style},onScroll:s8(r.onScroll,e=>{let t=e.currentTarget,{contentWrapper:i,shouldExpandOnScrollRef:s}=l;if(s?.current&&i){let e=Math.abs(o.current-t.scrollTop);if(e>0){let s=window.innerHeight-20,r=Math.max(parseFloat(i.style.minHeight),parseFloat(i.style.height));if(r<s){let n=r+e,l=Math.min(s,n),a=n-l;i.style.height=l+"px","0px"===i.style.bottom&&(t.scrollTop=a>0?a:0,i.style.justifyContent="flex-end")}}}o.current=t.scrollTop})})})]})});af.displayName=ap;var ag="SelectGroup",[av,ax]=l1(ag);$.forwardRef((e,t)=>{let{__scopeSelect:i,...s}=e,r=rE();return(0,L.jsx)(av,{scope:i,id:r,children:(0,L.jsx)(rn.div,{role:"group","aria-labelledby":r,...s,ref:t})})}).displayName=ag;var aw="SelectLabel";$.forwardRef((e,t)=>{let{__scopeSelect:i,...s}=e,r=ax(aw,i);return(0,L.jsx)(rn.div,{id:r.id,...s,ref:t})}).displayName=aw;var ab="SelectItem",[ay,aS]=l1(ab),aj=$.forwardRef((e,t)=>{let{__scopeSelect:i,value:s,disabled:r=!1,textValue:n,...l}=e,a=l4(ab,i),o=ao(ab,i),h=a.value===s,[u,c]=$.useState(n??""),[d,m]=$.useState(!1),p=(0,re.useComposedRefs)(t,e=>o.itemRefCallback?.(e,s,r)),f=rE(),g=$.useRef("touch"),v=()=>{r||(a.onValueChange(s),a.onOpenChange(!1))};if(""===s)throw Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return(0,L.jsx)(ay,{scope:i,value:s,disabled:r,textId:f,isSelected:h,onItemTextChange:$.useCallback(e=>{c(t=>t||(e?.textContent??"").trim())},[]),children:(0,L.jsx)(lQ.ItemSlot,{scope:i,value:s,disabled:r,textValue:u,children:(0,L.jsx)(rn.div,{role:"option","aria-labelledby":f,"data-highlighted":d?"":void 0,"aria-selected":h&&d,"data-state":h?"checked":"unchecked","aria-disabled":r||void 0,"data-disabled":r?"":void 0,tabIndex:r?void 0:-1,...l,ref:p,onFocus:s8(l.onFocus,()=>m(!0)),onBlur:s8(l.onBlur,()=>m(!1)),onClick:s8(l.onClick,()=>{"mouse"!==g.current&&v()}),onPointerUp:s8(l.onPointerUp,()=>{"mouse"===g.current&&v()}),onPointerDown:s8(l.onPointerDown,e=>{g.current=e.pointerType}),onPointerMove:s8(l.onPointerMove,e=>{g.current=e.pointerType,r?o.onItemLeave?.():"mouse"===g.current&&e.currentTarget.focus({preventScroll:!0})}),onPointerLeave:s8(l.onPointerLeave,e=>{e.currentTarget===document.activeElement&&o.onItemLeave?.()}),onKeyDown:s8(l.onKeyDown,e=>{(o.searchRef?.current===""||" "!==e.key)&&(lX.includes(e.key)&&v()," "===e.key&&e.preventDefault())})})})})});aj.displayName=ab;var aM="SelectItemText",aC=$.forwardRef((e,t)=>{let{__scopeSelect:i,className:s,style:r,...n}=e,l=l4(aM,i),a=ao(aM,i),o=aS(aM,i),h=l9(aM,i),[u,c]=$.useState(null),d=(0,re.useComposedRefs)(t,e=>c(e),o.onItemTextChange,e=>a.itemTextRefCallback?.(e,o.value,o.disabled)),m=u?.textContent,p=$.useMemo(()=>(0,L.jsx)("option",{value:o.value,disabled:o.disabled,children:m},o.value),[o.disabled,o.value,m]),{onNativeOptionAdd:f,onNativeOptionRemove:g}=h;return rN(()=>(f(p),()=>g(p)),[f,g,p]),(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(rn.span,{id:o.textId,...n,ref:d}),o.isSelected&&l.valueNode&&!l.valueNodeHasChildren?s6.createPortal(n.children,l.valueNode):null]})});aC.displayName=aM;var aN="SelectItemIndicator",aP=$.forwardRef((e,t)=>{let{__scopeSelect:i,...s}=e;return aS(aN,i).isSelected?(0,L.jsx)(rn.span,{"aria-hidden":!0,...s,ref:t}):null});aP.displayName=aN;var ak="SelectScrollUpButton",aE=$.forwardRef((e,t)=>{let i=ao(ak,e.__scopeSelect),s=am(ak,e.__scopeSelect),[r,n]=$.useState(!1),l=(0,re.useComposedRefs)(t,s.onScrollButtonChange);return rN(()=>{if(i.viewport&&i.isPositioned){let e=function(){n(t.scrollTop>0)},t=i.viewport;return e(),t.addEventListener("scroll",e),()=>t.removeEventListener("scroll",e)}},[i.viewport,i.isPositioned]),r?(0,L.jsx)(aT,{...e,ref:l,onAutoScroll:()=>{let{viewport:e,selectedItem:t}=i;e&&t&&(e.scrollTop=e.scrollTop-t.offsetHeight)}}):null});aE.displayName=ak;var aR="SelectScrollDownButton",a_=$.forwardRef((e,t)=>{let i=ao(aR,e.__scopeSelect),s=am(aR,e.__scopeSelect),[r,n]=$.useState(!1),l=(0,re.useComposedRefs)(t,s.onScrollButtonChange);return rN(()=>{if(i.viewport&&i.isPositioned){let e=function(){let e=t.scrollHeight-t.clientHeight;n(Math.ceil(t.scrollTop)<e)},t=i.viewport;return e(),t.addEventListener("scroll",e),()=>t.removeEventListener("scroll",e)}},[i.viewport,i.isPositioned]),r?(0,L.jsx)(aT,{...e,ref:l,onAutoScroll:()=>{let{viewport:e,selectedItem:t}=i;e&&t&&(e.scrollTop=e.scrollTop+t.offsetHeight)}}):null});a_.displayName=aR;var aT=$.forwardRef((e,t)=>{let{__scopeSelect:i,onAutoScroll:s,...r}=e,n=ao("SelectScrollButton",i),l=$.useRef(null),a=lZ(i),o=$.useCallback(()=>{null!==l.current&&(window.clearInterval(l.current),l.current=null)},[]);return $.useEffect(()=>()=>o(),[o]),rN(()=>{let e=a().find(e=>e.ref.current===document.activeElement);e?.ref.current?.scrollIntoView({block:"nearest"})},[a]),(0,L.jsx)(rn.div,{"aria-hidden":!0,...r,ref:t,style:{flexShrink:0,...r.style},onPointerDown:s8(r.onPointerDown,()=>{null===l.current&&(l.current=window.setInterval(s,50))}),onPointerMove:s8(r.onPointerMove,()=>{n.onItemLeave?.(),null===l.current&&(l.current=window.setInterval(s,50))}),onPointerLeave:s8(r.onPointerLeave,()=>{o()})})});$.forwardRef((e,t)=>{let{__scopeSelect:i,...s}=e;return(0,L.jsx)(rn.div,{"aria-hidden":!0,...s,ref:t})}).displayName="SelectSeparator";var aL="SelectArrow";function aI(e){return""===e||void 0===e}$.forwardRef((e,t)=>{let{__scopeSelect:i,...s}=e,r=l3(i),n=l4(aL,i),l=ao(aL,i);return n.open&&"popper"===l.position?(0,L.jsx)(n4,{...r,...s,ref:t}):null}).displayName=aL;var aA=$.forwardRef((e,t)=>{let{value:i,...s}=e,r=$.useRef(null),n=(0,re.useComposedRefs)(t,r),l=lt(i);return $.useEffect(()=>{let e=r.current,t=Object.getOwnPropertyDescriptor(window.HTMLSelectElement.prototype,"value").set;if(l!==i&&t){let s=new Event("change",{bubbles:!0});t.call(e,i),e.dispatchEvent(s)}},[l,i]),(0,L.jsx)(li,{asChild:!0,children:(0,L.jsx)("select",{...s,ref:n,defaultValue:i})})});function aF(e){let t=ra(e),i=$.useRef(""),s=$.useRef(0),r=$.useCallback(e=>{let r=i.current+e;t(r),function e(t){i.current=t,window.clearTimeout(s.current),""!==t&&(s.current=window.setTimeout(()=>e(""),1e3))}(r)},[t]),n=$.useCallback(()=>{i.current="",window.clearTimeout(s.current)},[]);return $.useEffect(()=>()=>window.clearTimeout(s.current),[]),[i,r,n]}function az(e,t,i){var s,r;let n=t.length>1&&Array.from(t).every(e=>e===t[0])?t[0]:t,l=i?e.indexOf(i):-1,a=(s=e,r=Math.max(l,0),s.map((e,t)=>s[(r+t)%s.length]));1===n.length&&(a=a.filter(e=>e!==i));let o=a.find(e=>e.textValue.toLowerCase().startsWith(n.toLowerCase()));return o!==i?o:void 0}aA.displayName="BubbleSelect";let aD=(0,s3.default)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),aO=(0,s3.default)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),aB=(0,s3.default)("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);function a$({...e}){return(0,L.jsx)(l8,{"data-slot":"select",...e})}function aW({...e}){return(0,L.jsx)(ai,{"data-slot":"select-value",...e})}function aV({className:e,size:t="default",children:i,...s}){return(0,L.jsxs)(ae,{"data-slot":"select-trigger","data-size":t,className:(0,I.cn)("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...s,children:[i,(0,L.jsx)(as,{asChild:!0,children:(0,L.jsx)(aO,{className:"size-4 opacity-50"})})]})}function aK({className:e,children:t,position:i="popper",...s}){return(0,L.jsx)(ar,{children:(0,L.jsxs)(al,{"data-slot":"select-content",className:(0,I.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===i&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:i,...s,children:[(0,L.jsx)(aH,{}),(0,L.jsx)(af,{className:(0,I.cn)("p-1","popper"===i&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:t}),(0,L.jsx)(aJ,{})]})})}function aU({className:e,children:t,...i}){return(0,L.jsxs)(aj,{"data-slot":"select-item",className:(0,I.cn)("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",e),...i,children:[(0,L.jsx)("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:(0,L.jsx)(aP,{children:(0,L.jsx)(aD,{className:"size-4"})})}),(0,L.jsx)(aC,{children:t})]})}function aH({className:e,...t}){return(0,L.jsx)(aE,{"data-slot":"select-scroll-up-button",className:(0,I.cn)("flex cursor-default items-center justify-center py-1",e),...t,children:(0,L.jsx)(aB,{className:"size-4"})})}function aJ({className:e,...t}){return(0,L.jsx)(a_,{"data-slot":"select-scroll-down-button",className:(0,I.cn)("flex cursor-default items-center justify-center py-1",e),...t,children:(0,L.jsx)(aO,{className:"size-4"})})}var aq=e=>{var t;let i,s,{present:r,children:n}=e,l=function(e){var t,i;let[s,r]=$.useState(),n=$.useRef({}),l=$.useRef(e),a=$.useRef("none"),[o,h]=(t=e?"mounted":"unmounted",i={mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}},$.useReducer((e,t)=>i[e][t]??e,t));return $.useEffect(()=>{let e=aY(n.current);a.current="mounted"===o?e:"none"},[o]),rN(()=>{let t=n.current,i=l.current;if(i!==e){let s=a.current,r=aY(t);e?h("MOUNT"):"none"===r||t?.display==="none"?h("UNMOUNT"):i&&s!==r?h("ANIMATION_OUT"):h("UNMOUNT"),l.current=e}},[e,h]),rN(()=>{if(s){let e,t=s.ownerDocument.defaultView??window,i=i=>{let r=aY(n.current).includes(i.animationName);if(i.target===s&&r&&(h("ANIMATION_END"),!l.current)){let i=s.style.animationFillMode;s.style.animationFillMode="forwards",e=t.setTimeout(()=>{"forwards"===s.style.animationFillMode&&(s.style.animationFillMode=i)})}},r=e=>{e.target===s&&(a.current=aY(n.current))};return s.addEventListener("animationstart",r),s.addEventListener("animationcancel",i),s.addEventListener("animationend",i),()=>{t.clearTimeout(e),s.removeEventListener("animationstart",r),s.removeEventListener("animationcancel",i),s.removeEventListener("animationend",i)}}h("ANIMATION_END")},[s,h]),{isPresent:["mounted","unmountSuspended"].includes(o),ref:$.useCallback(e=>{e&&(n.current=getComputedStyle(e)),r(e)},[])}}(r),a="function"==typeof n?n({present:l.isPresent}):$.Children.only(n),o=(0,re.useComposedRefs)(l.ref,(t=a,(s=(i=Object.getOwnPropertyDescriptor(t.props,"ref")?.get)&&"isReactWarning"in i&&i.isReactWarning)?t.ref:(s=(i=Object.getOwnPropertyDescriptor(t,"ref")?.get)&&"isReactWarning"in i&&i.isReactWarning)?t.props.ref:t.props.ref||t.ref));return"function"==typeof n||l.isPresent?$.cloneElement(a,{ref:o}):null};function aY(e){return e?.animationName||"none"}aq.displayName="Presence";var aX="Popover",[aG,aQ]=s7(aX,[nJ]),aZ=nJ(),[a0,a1]=aG(aX),a2=e=>{let{__scopePopover:t,children:i,open:s,defaultOpen:r,onOpenChange:n,modal:l=!1}=e,a=aZ(t),o=$.useRef(null),[h,u]=$.useState(!1),[c=!1,d]=le({prop:s,defaultProp:r,onChange:n});return(0,L.jsx)(nX,{...a,children:(0,L.jsx)(a0,{scope:t,contentId:rE(),triggerRef:o,open:c,onOpenChange:d,onOpenToggle:$.useCallback(()=>d(e=>!e),[d]),hasCustomAnchor:h,onCustomAnchorAdd:$.useCallback(()=>u(!0),[]),onCustomAnchorRemove:$.useCallback(()=>u(!1),[]),modal:l,children:i})})};a2.displayName=aX;var a3="PopoverAnchor";$.forwardRef((e,t)=>{let{__scopePopover:i,...s}=e,r=a1(a3,i),n=aZ(i),{onCustomAnchorAdd:l,onCustomAnchorRemove:a}=r;return $.useEffect(()=>(l(),()=>a()),[l,a]),(0,L.jsx)(nQ,{...n,...s,ref:t})}).displayName=a3;var a5="PopoverTrigger",a4=$.forwardRef((e,t)=>{let{__scopePopover:i,...s}=e,r=a1(a5,i),n=aZ(i),l=(0,re.useComposedRefs)(t,r.triggerRef),a=(0,L.jsx)(rn.button,{type:"button","aria-haspopup":"dialog","aria-expanded":r.open,"aria-controls":r.contentId,"data-state":ol(r.open),...s,ref:l,onClick:s8(e.onClick,r.onOpenToggle)});return r.hasCustomAnchor?a:(0,L.jsx)(nQ,{asChild:!0,...n,children:a})});a4.displayName=a5;var a6="PopoverPortal",[a9,a8]=aG(a6,{forceMount:void 0}),a7=e=>{let{__scopePopover:t,forceMount:i,children:s,container:r}=e,n=a1(a6,t);return(0,L.jsx)(a9,{scope:t,forceMount:i,children:(0,L.jsx)(aq,{present:i||n.open,children:(0,L.jsx)(n7,{asChild:!0,container:r,children:s})})})};a7.displayName=a6;var oe="PopoverContent",ot=$.forwardRef((e,t)=>{let i=a8(oe,e.__scopePopover),{forceMount:s=i.forceMount,...r}=e,n=a1(oe,e.__scopePopover);return(0,L.jsx)(aq,{present:s||n.open,children:n.modal?(0,L.jsx)(oi,{...r,ref:t}):(0,L.jsx)(os,{...r,ref:t})})});ot.displayName=oe;var oi=$.forwardRef((e,t)=>{let i=a1(oe,e.__scopePopover),s=$.useRef(null),r=(0,re.useComposedRefs)(t,s),n=$.useRef(!1);return $.useEffect(()=>{let e=s.current;if(e)return lh(e)},[]),(0,L.jsx)(lq,{as:rt.Slot,allowPinchZoom:!0,children:(0,L.jsx)(or,{...e,ref:r,trapFocus:i.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:s8(e.onCloseAutoFocus,e=>{e.preventDefault(),n.current||i.triggerRef.current?.focus()}),onPointerDownOutside:s8(e.onPointerDownOutside,e=>{let t=e.detail.originalEvent,i=0===t.button&&!0===t.ctrlKey;n.current=2===t.button||i},{checkForDefaultPrevented:!1}),onFocusOutside:s8(e.onFocusOutside,e=>e.preventDefault(),{checkForDefaultPrevented:!1})})})}),os=$.forwardRef((e,t)=>{let i=a1(oe,e.__scopePopover),s=$.useRef(!1),r=$.useRef(!1);return(0,L.jsx)(or,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:t=>{e.onCloseAutoFocus?.(t),t.defaultPrevented||(s.current||i.triggerRef.current?.focus(),t.preventDefault()),s.current=!1,r.current=!1},onInteractOutside:t=>{e.onInteractOutside?.(t),t.defaultPrevented||(s.current=!0,"pointerdown"===t.detail.originalEvent.type&&(r.current=!0));let n=t.target;i.triggerRef.current?.contains(n)&&t.preventDefault(),"focusin"===t.detail.originalEvent.type&&r.current&&t.preventDefault()}})}),or=$.forwardRef((e,t)=>{let{__scopePopover:i,trapFocus:s,onOpenAutoFocus:r,onCloseAutoFocus:n,disableOutsidePointerEvents:l,onEscapeKeyDown:a,onPointerDownOutside:o,onFocusOutside:h,onInteractOutside:u,...c}=e,d=a1(oe,i),m=aZ(i);return rf(),(0,L.jsx)(rb,{asChild:!0,loop:!0,trapped:s,onMountAutoFocus:r,onUnmountAutoFocus:n,children:(0,L.jsx)(ru,{asChild:!0,disableOutsidePointerEvents:l,onInteractOutside:u,onEscapeKeyDown:a,onPointerDownOutside:o,onFocusOutside:h,onDismiss:()=>d.onOpenChange(!1),children:(0,L.jsx)(n2,{"data-state":ol(d.open),role:"dialog",id:d.contentId,...m,...c,ref:t,style:{...c.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),on="PopoverClose";function ol(e){return e?"open":"closed"}function oa({...e}){return(0,L.jsx)(a2,{"data-slot":"popover",...e})}function oo({...e}){return(0,L.jsx)(a4,{"data-slot":"popover-trigger",...e})}function oh({className:e,align:t="center",sideOffset:i=4,...s}){return(0,L.jsx)(a7,{children:(0,L.jsx)(ot,{"data-slot":"popover-content",align:t,sideOffset:i,className:(0,I.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",e),...s})})}$.forwardRef((e,t)=>{let{__scopePopover:i,...s}=e,r=a1(on,i);return(0,L.jsx)(rn.button,{type:"button",...s,ref:t,onClick:s8(e.onClick,()=>r.onOpenChange(!1))})}).displayName=on,$.forwardRef((e,t)=>{let{__scopePopover:i,...s}=e,r=aZ(i);return(0,L.jsx)(n4,{...r,...s,ref:t})}).displayName="PopoverArrow";var ou=/[\\\/_+.#"@\[\(\{&]/,oc=/[\\\/_+.#"@\[\(\{&]/g,od=/[\s-]/,om=/[\s-]/g;function op(e){return e.toLowerCase().replace(om," ")}var of="Dialog",[og,ov]=s7(of),[ox,ow]=og(of),ob=e=>{let{__scopeDialog:t,children:i,open:s,defaultOpen:r,onOpenChange:n,modal:l=!0}=e,a=$.useRef(null),o=$.useRef(null),[h=!1,u]=le({prop:s,defaultProp:r,onChange:n});return(0,L.jsx)(ox,{scope:t,triggerRef:a,contentRef:o,contentId:rE(),titleId:rE(),descriptionId:rE(),open:h,onOpenChange:u,onOpenToggle:$.useCallback(()=>u(e=>!e),[u]),modal:l,children:i})};ob.displayName=of;var oy="DialogTrigger";$.forwardRef((e,t)=>{let{__scopeDialog:i,...s}=e,r=ow(oy,i),n=(0,re.useComposedRefs)(t,r.triggerRef);return(0,L.jsx)(rn.button,{type:"button","aria-haspopup":"dialog","aria-expanded":r.open,"aria-controls":r.contentId,"data-state":oD(r.open),...s,ref:n,onClick:s8(e.onClick,r.onOpenToggle)})}).displayName=oy;var oS="DialogPortal",[oj,oM]=og(oS,{forceMount:void 0}),oC=e=>{let{__scopeDialog:t,forceMount:i,children:s,container:r}=e,n=ow(oS,t);return(0,L.jsx)(oj,{scope:t,forceMount:i,children:$.Children.map(s,e=>(0,L.jsx)(aq,{present:i||n.open,children:(0,L.jsx)(n7,{asChild:!0,container:r,children:e})}))})};oC.displayName=oS;var oN="DialogOverlay",oP=$.forwardRef((e,t)=>{let i=oM(oN,e.__scopeDialog),{forceMount:s=i.forceMount,...r}=e,n=ow(oN,e.__scopeDialog);return n.modal?(0,L.jsx)(aq,{present:s||n.open,children:(0,L.jsx)(ok,{...r,ref:t})}):null});oP.displayName=oN;var ok=$.forwardRef((e,t)=>{let{__scopeDialog:i,...s}=e,r=ow(oN,i);return(0,L.jsx)(lq,{as:rt.Slot,allowPinchZoom:!0,shards:[r.contentRef],children:(0,L.jsx)(rn.div,{"data-state":oD(r.open),...s,ref:t,style:{pointerEvents:"auto",...s.style}})})}),oE="DialogContent",oR=$.forwardRef((e,t)=>{let i=oM(oE,e.__scopeDialog),{forceMount:s=i.forceMount,...r}=e,n=ow(oE,e.__scopeDialog);return(0,L.jsx)(aq,{present:s||n.open,children:n.modal?(0,L.jsx)(o_,{...r,ref:t}):(0,L.jsx)(oT,{...r,ref:t})})});oR.displayName=oE;var o_=$.forwardRef((e,t)=>{let i=ow(oE,e.__scopeDialog),s=$.useRef(null),r=(0,re.useComposedRefs)(t,i.contentRef,s);return $.useEffect(()=>{let e=s.current;if(e)return lh(e)},[]),(0,L.jsx)(oL,{...e,ref:r,trapFocus:i.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:s8(e.onCloseAutoFocus,e=>{e.preventDefault(),i.triggerRef.current?.focus()}),onPointerDownOutside:s8(e.onPointerDownOutside,e=>{let t=e.detail.originalEvent,i=0===t.button&&!0===t.ctrlKey;(2===t.button||i)&&e.preventDefault()}),onFocusOutside:s8(e.onFocusOutside,e=>e.preventDefault())})}),oT=$.forwardRef((e,t)=>{let i=ow(oE,e.__scopeDialog),s=$.useRef(!1),r=$.useRef(!1);return(0,L.jsx)(oL,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:t=>{e.onCloseAutoFocus?.(t),t.defaultPrevented||(s.current||i.triggerRef.current?.focus(),t.preventDefault()),s.current=!1,r.current=!1},onInteractOutside:t=>{e.onInteractOutside?.(t),t.defaultPrevented||(s.current=!0,"pointerdown"===t.detail.originalEvent.type&&(r.current=!0));let n=t.target;i.triggerRef.current?.contains(n)&&t.preventDefault(),"focusin"===t.detail.originalEvent.type&&r.current&&t.preventDefault()}})}),oL=$.forwardRef((e,t)=>{let{__scopeDialog:i,trapFocus:s,onOpenAutoFocus:r,onCloseAutoFocus:n,...l}=e,a=ow(oE,i),o=$.useRef(null),h=(0,re.useComposedRefs)(t,o);return rf(),(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(rb,{asChild:!0,loop:!0,trapped:s,onMountAutoFocus:r,onUnmountAutoFocus:n,children:(0,L.jsx)(ru,{role:"dialog",id:a.contentId,"aria-describedby":a.descriptionId,"aria-labelledby":a.titleId,"data-state":oD(a.open),...l,ref:h,onDismiss:()=>a.onOpenChange(!1)})}),(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(oW,{titleId:a.titleId}),(0,L.jsx)(oV,{contentRef:o,descriptionId:a.descriptionId})]})]})}),oI="DialogTitle";$.forwardRef((e,t)=>{let{__scopeDialog:i,...s}=e,r=ow(oI,i);return(0,L.jsx)(rn.h2,{id:r.titleId,...s,ref:t})}).displayName=oI;var oA="DialogDescription";$.forwardRef((e,t)=>{let{__scopeDialog:i,...s}=e,r=ow(oA,i);return(0,L.jsx)(rn.p,{id:r.descriptionId,...s,ref:t})}).displayName=oA;var oF="DialogClose",oz=$.forwardRef((e,t)=>{let{__scopeDialog:i,...s}=e,r=ow(oF,i);return(0,L.jsx)(rn.button,{type:"button",...s,ref:t,onClick:s8(e.onClick,()=>r.onOpenChange(!1))})});function oD(e){return e?"open":"closed"}oz.displayName=oF;var oO="DialogTitleWarning",[oB,o$]=(b={contentName:oE,titleName:oI,docsSlug:"dialog"},t=$.createContext(b),(i=e=>{let{children:i,...s}=e,r=$.useMemo(()=>s,Object.values(s));return(0,L.jsx)(t.Provider,{value:r,children:i})}).displayName=oO+"Provider",[i,function(e){let i=$.useContext(t);if(i)return i;if(void 0!==b)return b;throw Error(`\`${e}\` must be used within \`${oO}\``)}]),oW=({titleId:e})=>{let t=o$(oO),i=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return $.useEffect(()=>{e&&(document.getElementById(e)||console.error(i))},[i,e]),null},oV=({contentRef:e,descriptionId:t})=>{let i=o$("DialogDescriptionWarning"),s=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${i.contentName}}.`;return $.useEffect(()=>{let i=e.current?.getAttribute("aria-describedby");t&&i&&(document.getElementById(t)||console.warn(s))},[s,e,t]),null};function oK(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}var oU=Symbol.for("react.lazy"),oH=$[" use ".trim().toString()];function oJ(e){var t;return null!=e&&"object"==typeof e&&"$$typeof"in e&&e.$$typeof===oU&&"_payload"in e&&"object"==typeof(t=e._payload)&&null!==t&&"then"in t}var oq=Symbol("radix.slottable");function oY(e){return $.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===oq}var oX=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{var i,s;let r,n,l,a=(s=i=`Primitive.${t}`,(r=$.forwardRef((e,t)=>{let{children:i,...s}=e;if(oJ(i)&&"function"==typeof oH&&(i=oH(i._payload)),$.isValidElement(i)){var r;let e,n,l=(r=i,(n=(e=Object.getOwnPropertyDescriptor(r.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?r.ref:(n=(e=Object.getOwnPropertyDescriptor(r,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?r.props.ref:r.props.ref||r.ref),a=function(e,t){let i={...t};for(let s in t){let r=e[s],n=t[s];/^on[A-Z]/.test(s)?r&&n?i[s]=(...e)=>{let t=n(...e);return r(...e),t}:r&&(i[s]=r):"style"===s?i[s]={...r,...n}:"className"===s&&(i[s]=[r,n].filter(Boolean).join(" "))}return{...e,...i}}(s,i.props);return i.type!==$.Fragment&&(a.ref=t?function(...e){return t=>{let i=!1,s=e.map(e=>{let s=oK(e,t);return i||"function"!=typeof s||(i=!0),s});if(i)return()=>{for(let t=0;t<s.length;t++){let i=s[t];"function"==typeof i?i():oK(e[t],null)}}}}(t,l):l),$.cloneElement(i,a)}return $.Children.count(i)>1?$.Children.only(null):null})).displayName=`${s}.SlotClone`,n=r,(l=$.forwardRef((e,t)=>{let{children:i,...s}=e;oJ(i)&&"function"==typeof oH&&(i=oH(i._payload));let r=$.Children.toArray(i),l=r.find(oY);if(l){let e=l.props.children,i=r.map(t=>t!==l?t:$.Children.count(e)>1?$.Children.only(null):$.isValidElement(e)?e.props.children:null);return(0,L.jsx)(n,{...s,ref:t,children:$.isValidElement(e)?$.cloneElement(e,void 0,i):null})}return(0,L.jsx)(n,{...s,ref:t,children:i})})).displayName=`${i}.Slot`,l),o=$.forwardRef((e,i)=>{let{asChild:s,...r}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,L.jsx)(s?a:t,{...r,ref:i})});return o.displayName=`Primitive.${t}`,{...e,[t]:o}},{}),oG=globalThis?.document?$.useLayoutEffect:()=>{},oQ=$[" useId ".trim().toString()]||(()=>void 0),oZ=0;function o0(e){let[t,i]=$.useState(oQ());return oG(()=>{e||i(e=>e??String(oZ++))},[e]),e||(t?`radix-${t}`:"")}var o1=e.i(34960),o2='[cmdk-group=""]',o3='[cmdk-group-items=""]',o5='[cmdk-item=""]',o4=`${o5}:not([aria-disabled="true"])`,o6="cmdk-item-select",o9="data-value",o8=(e,t,i)=>{var s;return s=e,function e(t,i,s,r,n,l,a){if(l===i.length)return n===t.length?1:.99;var o=`${n},${l}`;if(void 0!==a[o])return a[o];for(var h,u,c,d,m=r.charAt(l),p=s.indexOf(m,n),f=0;p>=0;)(h=e(t,i,s,r,p+1,l+1,a))>f&&(p===n?h*=1:ou.test(t.charAt(p-1))?(h*=.8,(c=t.slice(n,p-1).match(oc))&&n>0&&(h*=Math.pow(.999,c.length))):od.test(t.charAt(p-1))?(h*=.9,(d=t.slice(n,p-1).match(om))&&n>0&&(h*=Math.pow(.999,d.length))):(h*=.17,n>0&&(h*=Math.pow(.999,p-n))),t.charAt(p)!==i.charAt(l)&&(h*=.9999)),(h<.1&&s.charAt(p-1)===r.charAt(l+1)||r.charAt(l+1)===r.charAt(l)&&s.charAt(p-1)!==r.charAt(l))&&.1*(u=e(t,i,s,r,p+1,l+2,a))>h&&(h=.1*u),h>f&&(f=h),p=s.indexOf(m,p+1);return a[o]=f,f}(s=i&&i.length>0?`${s+" "+i.join(" ")}`:s,t,op(s),op(t),0,0,{})},o7=$.createContext(void 0),he=$.createContext(void 0),ht=$.createContext(void 0),hi=$.forwardRef((e,t)=>{let i=hd(()=>{var t,i;return{search:"",value:null!=(i=null!=(t=e.value)?t:e.defaultValue)?i:"",filtered:{count:0,items:new Map,groups:new Set}}}),s=hd(()=>new Set),r=hd(()=>new Map),n=hd(()=>new Map),l=hd(()=>new Set),a=hu(e),{label:o,children:h,value:u,onValueChange:c,filter:d,shouldFilter:m,loop:p,disablePointerSelection:f=!1,vimBindings:g=!0,...v}=e,x=o0(),w=o0(),b=o0(),y=$.useRef(null),S=hg();hc(()=>{if(void 0!==u){let e=u.trim();i.current.value=e,j.emit()}},[u]),hc(()=>{S(6,E)},[]);let j=$.useMemo(()=>({subscribe:e=>(l.current.add(e),()=>l.current.delete(e)),snapshot:()=>i.current,setState:(e,t,s)=>{var r,n,l;if(!Object.is(i.current[e],t)){if(i.current[e]=t,"search"===e)k(),N(),S(1,P);else if("value"===e&&(s||S(5,E),(null==(r=a.current)?void 0:r.value)!==void 0)){null==(l=(n=a.current).onValueChange)||l.call(n,null!=t?t:"");return}j.emit()}},emit:()=>{l.current.forEach(e=>e())}}),[]),M=$.useMemo(()=>({value:(e,t,s)=>{var r;t!==(null==(r=n.current.get(e))?void 0:r.value)&&(n.current.set(e,{value:t,keywords:s}),i.current.filtered.items.set(e,C(t,s)),S(2,()=>{N(),j.emit()}))},item:(e,t)=>(s.current.add(e),t&&(r.current.has(t)?r.current.get(t).add(e):r.current.set(t,new Set([e]))),S(3,()=>{k(),N(),i.current.value||P(),j.emit()}),()=>{n.current.delete(e),s.current.delete(e),i.current.filtered.items.delete(e);let t=R();S(4,()=>{k(),(null==t?void 0:t.getAttribute("id"))===e&&P(),j.emit()})}),group:e=>(r.current.has(e)||r.current.set(e,new Set),()=>{n.current.delete(e),r.current.delete(e)}),filter:()=>a.current.shouldFilter,label:o||e["aria-label"],getDisablePointerSelection:()=>a.current.disablePointerSelection,listId:x,inputId:b,labelId:w,listInnerRef:y}),[]);function C(e,t){var s,r;let n=null!=(r=null==(s=a.current)?void 0:s.filter)?r:o8;return e?n(e,i.current.search,t):0}function N(){if(!i.current.search||!1===a.current.shouldFilter)return;let e=i.current.filtered.items,t=[];i.current.filtered.groups.forEach(i=>{let s=r.current.get(i),n=0;s.forEach(t=>{n=Math.max(e.get(t),n)}),t.push([i,n])});let s=y.current;_().sort((t,i)=>{var s,r;let n=t.getAttribute("id"),l=i.getAttribute("id");return(null!=(s=e.get(l))?s:0)-(null!=(r=e.get(n))?r:0)}).forEach(e=>{let t=e.closest(o3);t?t.appendChild(e.parentElement===t?e:e.closest(`${o3} > *`)):s.appendChild(e.parentElement===s?e:e.closest(`${o3} > *`))}),t.sort((e,t)=>t[1]-e[1]).forEach(e=>{var t;let i=null==(t=y.current)?void 0:t.querySelector(`${o2}[${o9}="${encodeURIComponent(e[0])}"]`);null==i||i.parentElement.appendChild(i)})}function P(){let e=_().find(e=>"true"!==e.getAttribute("aria-disabled")),t=null==e?void 0:e.getAttribute(o9);j.setState("value",t||void 0)}function k(){var e,t,l,o;if(!i.current.search||!1===a.current.shouldFilter){i.current.filtered.count=s.current.size;return}i.current.filtered.groups=new Set;let h=0;for(let r of s.current){let s=C(null!=(t=null==(e=n.current.get(r))?void 0:e.value)?t:"",null!=(o=null==(l=n.current.get(r))?void 0:l.keywords)?o:[]);i.current.filtered.items.set(r,s),s>0&&h++}for(let[e,t]of r.current)for(let s of t)if(i.current.filtered.items.get(s)>0){i.current.filtered.groups.add(e);break}i.current.filtered.count=h}function E(){var e,t,i;let s=R();s&&((null==(e=s.parentElement)?void 0:e.firstChild)===s&&(null==(i=null==(t=s.closest(o2))?void 0:t.querySelector('[cmdk-group-heading=""]'))||i.scrollIntoView({block:"nearest"})),s.scrollIntoView({block:"nearest"}))}function R(){var e;return null==(e=y.current)?void 0:e.querySelector(`${o5}[aria-selected="true"]`)}function _(){var e;return Array.from((null==(e=y.current)?void 0:e.querySelectorAll(o4))||[])}function T(e){let t=_()[e];t&&j.setState("value",t.getAttribute(o9))}function L(e){var t;let i=R(),s=_(),r=s.findIndex(e=>e===i),n=s[r+e];null!=(t=a.current)&&t.loop&&(n=r+e<0?s[s.length-1]:r+e===s.length?s[0]:s[r+e]),n&&j.setState("value",n.getAttribute(o9))}function I(e){let t=R(),i=null==t?void 0:t.closest(o2),s;for(;i&&!s;)s=null==(i=e>0?function(e,t){let i=e.nextElementSibling;for(;i;){if(i.matches(t))return i;i=i.nextElementSibling}}(i,o2):function(e,t){let i=e.previousElementSibling;for(;i;){if(i.matches(t))return i;i=i.previousElementSibling}}(i,o2))?void 0:i.querySelector(o4);s?j.setState("value",s.getAttribute(o9)):L(e)}let A=()=>T(_().length-1),F=e=>{e.preventDefault(),e.metaKey?A():e.altKey?I(1):L(1)},z=e=>{e.preventDefault(),e.metaKey?T(0):e.altKey?I(-1):L(-1)};return $.createElement(oX.div,{ref:t,tabIndex:-1,...v,"cmdk-root":"",onKeyDown:e=>{var t;if(null==(t=v.onKeyDown)||t.call(v,e),!e.defaultPrevented)switch(e.key){case"n":case"j":g&&e.ctrlKey&&F(e);break;case"ArrowDown":F(e);break;case"p":case"k":g&&e.ctrlKey&&z(e);break;case"ArrowUp":z(e);break;case"Home":e.preventDefault(),T(0);break;case"End":e.preventDefault(),A();break;case"Enter":if(!e.nativeEvent.isComposing&&229!==e.keyCode){e.preventDefault();let t=R();if(t){let e=new Event(o6);t.dispatchEvent(e)}}}}},$.createElement("label",{"cmdk-label":"",htmlFor:M.inputId,id:M.labelId,style:hx},o),hv(e,e=>$.createElement(he.Provider,{value:j},$.createElement(o7.Provider,{value:M},e))))}),hs=$.forwardRef((e,t)=>{var i,s;let r=o0(),n=$.useRef(null),l=$.useContext(ht),a=$.useContext(o7),o=hu(e),h=null!=(s=null==(i=o.current)?void 0:i.forceMount)?s:null==l?void 0:l.forceMount;hc(()=>{if(!h)return a.item(r,null==l?void 0:l.id)},[h]);let u=hf(r,n,[e.value,e.children,n],e.keywords),c=$.useContext(he),d=hp(e=>e.value&&e.value===u.current),m=hp(e=>!!h||!1===a.filter()||!e.search||e.filtered.items.get(r)>0);function p(){var e,t;f(),null==(t=(e=o.current).onSelect)||t.call(e,u.current)}function f(){c.setState("value",u.current,!0)}if($.useEffect(()=>{let t=n.current;if(!(!t||e.disabled))return t.addEventListener(o6,p),()=>t.removeEventListener(o6,p)},[m,e.onSelect,e.disabled]),!m)return null;let{disabled:g,value:v,onSelect:x,forceMount:w,keywords:b,...y}=e;return $.createElement(oX.div,{ref:hm([n,t]),...y,id:r,"cmdk-item":"",role:"option","aria-disabled":!!g,"aria-selected":!!d,"data-disabled":!!g,"data-selected":!!d,onPointerMove:g||a.getDisablePointerSelection()?void 0:f,onClick:g?void 0:p},e.children)}),hr=$.forwardRef((e,t)=>{let{heading:i,children:s,forceMount:r,...n}=e,l=o0(),a=$.useRef(null),o=$.useRef(null),h=o0(),u=$.useContext(o7),c=hp(e=>!!r||!1===u.filter()||!e.search||e.filtered.groups.has(l));hc(()=>u.group(l),[]),hf(l,a,[e.value,e.heading,o]);let d=$.useMemo(()=>({id:l,forceMount:r}),[r]);return $.createElement(oX.div,{ref:hm([a,t]),...n,"cmdk-group":"",role:"presentation",hidden:!c||void 0},i&&$.createElement("div",{ref:o,"cmdk-group-heading":"","aria-hidden":!0,id:h},i),hv(e,e=>$.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":i?h:void 0},$.createElement(ht.Provider,{value:d},e))))}),hn=$.forwardRef((e,t)=>{let{alwaysRender:i,...s}=e,r=$.useRef(null),n=hp(e=>!e.search);return i||n?$.createElement(oX.div,{ref:hm([r,t]),...s,"cmdk-separator":"",role:"separator"}):null}),hl=$.forwardRef((e,t)=>{let{onValueChange:i,...s}=e,r=null!=e.value,n=$.useContext(he),l=hp(e=>e.search),a=hp(e=>e.value),o=$.useContext(o7),h=$.useMemo(()=>{var e;let t=null==(e=o.listInnerRef.current)?void 0:e.querySelector(`${o5}[${o9}="${encodeURIComponent(a)}"]`);return null==t?void 0:t.getAttribute("id")},[]);return $.useEffect(()=>{null!=e.value&&n.setState("search",e.value)},[e.value]),$.createElement(oX.input,{ref:t,...s,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":o.listId,"aria-labelledby":o.labelId,"aria-activedescendant":h,id:o.inputId,type:"text",value:r?e.value:l,onChange:e=>{r||n.setState("search",e.target.value),null==i||i(e.target.value)}})}),ha=$.forwardRef((e,t)=>{let{children:i,label:s="Suggestions",...r}=e,n=$.useRef(null),l=$.useRef(null),a=$.useContext(o7);return $.useEffect(()=>{if(l.current&&n.current){let e=l.current,t=n.current,i,s=new ResizeObserver(()=>{i=requestAnimationFrame(()=>{let i=e.offsetHeight;t.style.setProperty("--cmdk-list-height",i.toFixed(1)+"px")})});return s.observe(e),()=>{cancelAnimationFrame(i),s.unobserve(e)}}},[]),$.createElement(oX.div,{ref:hm([n,t]),...r,"cmdk-list":"",role:"listbox","aria-label":s,id:a.listId},hv(e,e=>$.createElement("div",{ref:hm([l,a.listInnerRef]),"cmdk-list-sizer":""},e)))}),ho=$.forwardRef((e,t)=>{let{open:i,onOpenChange:s,overlayClassName:r,contentClassName:n,container:l,...a}=e;return $.createElement(ob,{open:i,onOpenChange:s},$.createElement(oC,{container:l},$.createElement(oP,{"cmdk-overlay":"",className:r}),$.createElement(oR,{"aria-label":e.label,"cmdk-dialog":"",className:n},$.createElement(hi,{ref:t,...a}))))}),hh=Object.assign(hi,{List:ha,Item:hs,Input:hl,Group:hr,Separator:hn,Dialog:ho,Empty:$.forwardRef((e,t)=>hp(e=>0===e.filtered.count)?$.createElement(oX.div,{ref:t,...e,"cmdk-empty":"",role:"presentation"}):null),Loading:$.forwardRef((e,t)=>{let{progress:i,children:s,label:r="Loading...",...n}=e;return $.createElement(oX.div,{ref:t,...n,"cmdk-loading":"",role:"progressbar","aria-valuenow":i,"aria-valuemin":0,"aria-valuemax":100,"aria-label":r},hv(e,e=>$.createElement("div",{"aria-hidden":!0},e)))})});function hu(e){let t=$.useRef(e);return hc(()=>{t.current=e}),t}var hc="undefined"==typeof window?$.useEffect:$.useLayoutEffect;function hd(e){let t=$.useRef();return void 0===t.current&&(t.current=e()),t}function hm(e){return t=>{e.forEach(e=>{"function"==typeof e?e(t):null!=e&&(e.current=t)})}}function hp(e){let t=$.useContext(he),i=()=>e(t.snapshot());return(0,o1.useSyncExternalStore)(t.subscribe,i,i)}function hf(e,t,i,s=[]){let r=$.useRef(),n=$.useContext(o7);return hc(()=>{var l;let a=(()=>{var e;for(let t of i){if("string"==typeof t)return t.trim();if("object"==typeof t&&"current"in t)return t.current?null==(e=t.current.textContent)?void 0:e.trim():r.current}})(),o=s.map(e=>e.trim());n.value(e,a,o),null==(l=t.current)||l.setAttribute(o9,a),r.current=a}),r}var hg=()=>{let[e,t]=$.useState(),i=hd(()=>new Map);return hc(()=>{i.current.forEach(e=>e()),i.current=new Map},[e]),(e,s)=>{i.current.set(e,s),t({})}};function hv({asChild:e,children:t},i){let s;return e&&$.isValidElement(t)?$.cloneElement("function"==typeof(s=t.type)?s(t.props):"render"in s?s.render(t.props):t,{ref:t.ref},i(t.props.children)):i(t)}var hx={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};let hw=(0,s3.default)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);var hb=e.i(34853),hb=hb;function hy({...e}){return(0,L.jsx)(ob,{"data-slot":"dialog",...e})}function hS({...e}){return(0,L.jsx)(oC,{"data-slot":"dialog-portal",...e})}function hj({className:e,...t}){return(0,L.jsx)(oP,{"data-slot":"dialog-overlay",className:(0,I.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",e),...t})}function hM({className:e,children:t,showCloseButton:i=!0,...s}){return(0,L.jsxs)(hS,{"data-slot":"dialog-portal",children:[(0,L.jsx)(hj,{}),(0,L.jsxs)(oR,{"data-slot":"dialog-content",className:(0,I.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",e),...s,children:[t,i&&(0,L.jsxs)(oz,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,L.jsx)(hb.default,{}),(0,L.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function hC({className:e,...t}){return(0,L.jsx)(hh,{"data-slot":"command",className:(0,I.cn)("bg-popover text-popover-foreground flex h-full w-full flex-col overflow-hidden rounded-md",e),...t})}function hN({className:e,...t}){return(0,L.jsxs)("div",{"data-slot":"command-input-wrapper",className:"flex h-9 items-center gap-2 border-b px-3",children:[(0,L.jsx)(hw,{className:"size-4 shrink-0 opacity-50"}),(0,L.jsx)(hh.Input,{"data-slot":"command-input",className:(0,I.cn)("placeholder:text-muted-foreground flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-hidden disabled:cursor-not-allowed disabled:opacity-50",e),...t})]})}function hP({className:e,...t}){return(0,L.jsx)(hh.List,{"data-slot":"command-list",className:(0,I.cn)("max-h-[300px] scroll-py-1 overflow-x-hidden overflow-y-auto",e),...t})}function hk({...e}){return(0,L.jsx)(hh.Empty,{"data-slot":"command-empty",className:"py-6 text-center text-sm",...e})}function hE({className:e,...t}){return(0,L.jsx)(hh.Group,{"data-slot":"command-group",className:(0,I.cn)("text-foreground [&_[cmdk-group-heading]]:text-muted-foreground overflow-hidden p-1 [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium",e),...t})}function hR({className:e,...t}){return(0,L.jsx)(hh.Item,{"data-slot":"command-item",className:(0,I.cn)("data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled=true]:pointer-events-none data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...t})}function h_({className:e,type:t,...i}){return(0,L.jsx)("input",{type:t,"data-slot":"input",className:(0,I.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",e),...i})}var hT=$.forwardRef((e,t)=>(0,L.jsx)(rn.label,{...e,ref:t,onMouseDown:t=>{t.target.closest("button, input, select, textarea")||(e.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));function hL({className:e,...t}){return(0,L.jsx)(hT,{"data-slot":"label",className:(0,I.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",e),...t})}hT.displayName="Label";let hI=(0,s3.default)("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),hA=(0,s3.default)("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);var hF=e.i(34290);let hz=[{value:"MA",label:"MA - ç§»åŠ¨å¹³å‡çº¿",description:"è¶‹åŠ¿è·Ÿè¸ª"},{value:"EMA",label:"EMA - æŒ‡æ•°ç§»åŠ¨å¹³å‡çº¿",description:"è¶‹åŠ¿è·Ÿè¸ª"},{value:"MACD",label:"MACD - å¹³æ»‘å¼‚åŒç§»åŠ¨å¹³å‡çº¿",description:"è¶‹åŠ¿åŠ¨èƒ½"},{value:"BOLL",label:"BOLL - å¸ƒæž—çº¿",description:"æ³¢åŠ¨åŒºé—´"}],hD=[{value:"RSI",label:"RSI - ç›¸å¯¹å¼ºå¼±æŒ‡æ•°",description:"è¶…ä¹°è¶…å–"},{value:"KDJ",label:"KDJ - éšæœºæŒ‡æ ‡",description:"çŸ­æœŸåè½¬"}],hO=[{value:"ATR",label:"ATR - çœŸå®žæ³¢å¹…",description:"æ³¢åŠ¨çŽ‡"}],hB=[{value:"VOL",label:"VOL - æˆäº¤é‡",description:"é‡èƒ½"},{value:"VWAP",label:"VWAP - é‡ä»·åŠ æƒå‡ä»·",description:"é‡ä»·ç»“åˆ"},{value:"OBV",label:"OBV - èƒ½é‡æ½®",description:"é‡ä»·ç»“åˆ"},{value:"MFI",label:"MFI - èµ„é‡‘æµé‡æŒ‡æ•°",description:"é‡ä»·ç»“åˆ"},{value:"VPT",label:"VPT - é‡ä»·è¶‹åŠ¿",description:"é‡ä»·ç»“åˆ"}];function h$({onAddIndicator:e,activeIndicators:t,onToggleIndicator:i,onRemoveIndicator:s}){let[r,n]=(0,$.useState)("MA"),[l,a]=(0,$.useState)("20"),[o,h]=(0,$.useState)("12"),[u,c]=(0,$.useState)("12"),[d,m]=(0,$.useState)("26"),[p,f]=(0,$.useState)("9"),[g,v]=(0,$.useState)("20"),[x,w]=(0,$.useState)("2"),[b,y]=(0,$.useState)("14"),[S,j]=(0,$.useState)("9"),[M,C]=(0,$.useState)("3"),[N,P]=(0,$.useState)("3"),[k,E]=(0,$.useState)("14"),[R,_]=(0,$.useState)("14");return(0,L.jsxs)("div",{className:"space-y-3",children:[(0,L.jsxs)("div",{className:"flex items-end gap-2 flex-wrap",children:[(0,L.jsxs)("div",{className:"flex-1 min-w-[200px]",children:[(0,L.jsx)(hL,{className:"text-xs mb-1.5 block",children:"æŒ‡æ ‡ç±»åž‹"}),(0,L.jsxs)(a$,{value:r,onValueChange:e=>n(e),children:[(0,L.jsx)(aV,{className:"h-9",children:(0,L.jsx)(aW,{})}),(0,L.jsxs)(aK,{children:[(0,L.jsx)("div",{className:"px-2 py-1.5 text-xs font-semibold text-muted-foreground",children:"è¶‹åŠ¿ç±»æŒ‡æ ‡"}),hz.map(e=>(0,L.jsx)(aU,{value:e.value,children:(0,L.jsxs)("div",{className:"flex flex-col",children:[(0,L.jsx)("span",{children:e.label}),(0,L.jsx)("span",{className:"text-xs text-muted-foreground",children:e.description})]})},e.value)),(0,L.jsx)("div",{className:"px-2 py-1.5 text-xs font-semibold text-muted-foreground mt-1",children:"æ‘†åŠ¨/åŠ¨èƒ½ç±»"}),hD.map(e=>(0,L.jsx)(aU,{value:e.value,children:(0,L.jsxs)("div",{className:"flex flex-col",children:[(0,L.jsx)("span",{children:e.label}),(0,L.jsx)("span",{className:"text-xs text-muted-foreground",children:e.description})]})},e.value)),(0,L.jsx)("div",{className:"px-2 py-1.5 text-xs font-semibold text-muted-foreground mt-1",children:"æ³¢åŠ¨çŽ‡ç±»"}),hO.map(e=>(0,L.jsx)(aU,{value:e.value,children:(0,L.jsxs)("div",{className:"flex flex-col",children:[(0,L.jsx)("span",{children:e.label}),(0,L.jsx)("span",{className:"text-xs text-muted-foreground",children:e.description})]})},e.value)),(0,L.jsx)("div",{className:"px-2 py-1.5 text-xs font-semibold text-muted-foreground mt-1",children:"æˆäº¤é‡/é‡ä»·ç»“åˆ"}),hB.map(e=>(0,L.jsx)(aU,{value:e.value,children:(0,L.jsxs)("div",{className:"flex flex-col",children:[(0,L.jsx)("span",{children:e.label}),(0,L.jsx)("span",{className:"text-xs text-muted-foreground",children:e.description})]})},e.value))]})]})]}),"MA"===r&&(0,L.jsxs)("div",{className:"flex-1 min-w-[100px]",children:[(0,L.jsx)(hL,{className:"text-xs mb-1.5 block",children:"å‘¨æœŸ"}),(0,L.jsx)(h_,{type:"number",value:l,onChange:e=>a(e.target.value),className:"h-9",placeholder:"20",min:"2"})]}),"EMA"===r&&(0,L.jsxs)("div",{className:"flex-1 min-w-[100px]",children:[(0,L.jsx)(hL,{className:"text-xs mb-1.5 block",children:"å‘¨æœŸ"}),(0,L.jsx)(h_,{type:"number",value:o,onChange:e=>h(e.target.value),className:"h-9",placeholder:"12",min:"2"})]}),"MACD"===r&&(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)("div",{className:"flex-1 min-w-[80px]",children:[(0,L.jsx)(hL,{className:"text-xs mb-1.5 block",children:"å¿«çº¿"}),(0,L.jsx)(h_,{type:"number",value:u,onChange:e=>c(e.target.value),className:"h-9",placeholder:"12",min:"2"})]}),(0,L.jsxs)("div",{className:"flex-1 min-w-[80px]",children:[(0,L.jsx)(hL,{className:"text-xs mb-1.5 block",children:"æ…¢çº¿"}),(0,L.jsx)(h_,{type:"number",value:d,onChange:e=>m(e.target.value),className:"h-9",placeholder:"26",min:"2"})]}),(0,L.jsxs)("div",{className:"flex-1 min-w-[80px]",children:[(0,L.jsx)(hL,{className:"text-xs mb-1.5 block",children:"ä¿¡å·çº¿"}),(0,L.jsx)(h_,{type:"number",value:p,onChange:e=>f(e.target.value),className:"h-9",placeholder:"9",min:"2"})]})]}),"BOLL"===r&&(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)("div",{className:"flex-1 min-w-[100px]",children:[(0,L.jsx)(hL,{className:"text-xs mb-1.5 block",children:"å‘¨æœŸ"}),(0,L.jsx)(h_,{type:"number",value:g,onChange:e=>v(e.target.value),className:"h-9",placeholder:"20",min:"2"})]}),(0,L.jsxs)("div",{className:"flex-1 min-w-[100px]",children:[(0,L.jsx)(hL,{className:"text-xs mb-1.5 block",children:"æ ‡å‡†å·®å€æ•°"}),(0,L.jsx)(h_,{type:"number",value:x,onChange:e=>w(e.target.value),className:"h-9",placeholder:"2",step:"0.1",min:"0.1"})]})]}),"RSI"===r&&(0,L.jsxs)("div",{className:"flex-1 min-w-[100px]",children:[(0,L.jsx)(hL,{className:"text-xs mb-1.5 block",children:"å‘¨æœŸ"}),(0,L.jsx)(h_,{type:"number",value:b,onChange:e=>y(e.target.value),className:"h-9",placeholder:"14",min:"2"})]}),"KDJ"===r&&(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)("div",{className:"flex-1 min-w-[80px]",children:[(0,L.jsx)(hL,{className:"text-xs mb-1.5 block",children:"å‘¨æœŸ"}),(0,L.jsx)(h_,{type:"number",value:S,onChange:e=>j(e.target.value),className:"h-9",placeholder:"9",min:"2"})]}),(0,L.jsxs)("div",{className:"flex-1 min-w-[80px]",children:[(0,L.jsx)(hL,{className:"text-xs mb-1.5 block",children:"Kå¹³æ»‘"}),(0,L.jsx)(h_,{type:"number",value:M,onChange:e=>C(e.target.value),className:"h-9",placeholder:"3",min:"1"})]}),(0,L.jsxs)("div",{className:"flex-1 min-w-[80px]",children:[(0,L.jsx)(hL,{className:"text-xs mb-1.5 block",children:"Då¹³æ»‘"}),(0,L.jsx)(h_,{type:"number",value:N,onChange:e=>P(e.target.value),className:"h-9",placeholder:"3",min:"1"})]})]}),"ATR"===r&&(0,L.jsxs)("div",{className:"flex-1 min-w-[100px]",children:[(0,L.jsx)(hL,{className:"text-xs mb-1.5 block",children:"å‘¨æœŸ"}),(0,L.jsx)(h_,{type:"number",value:k,onChange:e=>E(e.target.value),className:"h-9",placeholder:"14",min:"2"})]}),"MFI"===r&&(0,L.jsxs)("div",{className:"flex-1 min-w-[100px]",children:[(0,L.jsx)(hL,{className:"text-xs mb-1.5 block",children:"å‘¨æœŸ"}),(0,L.jsx)(h_,{type:"number",value:R,onChange:e=>_(e.target.value),className:"h-9",placeholder:"14",min:"2"})]}),(0,L.jsx)(s4.Button,{onClick:()=>{let t={type:r,visible:!0,params:{}};switch(r){case"MA":t.params={period:Number.parseInt(l)||20,color:"#2563eb"};break;case"EMA":t.params={period:Number.parseInt(o)||12,color:"#f59e0b"};break;case"MACD":t.params={fastPeriod:Number.parseInt(u)||12,slowPeriod:Number.parseInt(d)||26,signalPeriod:Number.parseInt(p)||9};break;case"BOLL":t.params={period:Number.parseInt(g)||20,stdDev:Number.parseFloat(x)||2,color:"#8b5cf6"};break;case"RSI":t.params={period:Number.parseInt(b)||14,color:"#ec4899"};break;case"KDJ":t.params={period:Number.parseInt(S)||9,kPeriod:Number.parseInt(M)||3,dPeriod:Number.parseInt(N)||3};break;case"ATR":t.params={period:Number.parseInt(k)||14,color:"#06b6d4"};break;case"MFI":t.params={period:Number.parseInt(R)||14,color:"#84cc16"}}e(t)},size:"sm",className:"h-9",children:"æ·»åŠ æŒ‡æ ‡"})]}),t.length>0&&(0,L.jsx)("div",{className:"flex flex-wrap gap-2",children:t.map((e,t)=>(0,L.jsxs)("div",{className:`flex items-center gap-1.5 px-3 py-1.5 rounded-md text-sm transition-all cursor-pointer ${e.visible?"bg-muted hover:bg-muted/80":"bg-muted/50 opacity-60 hover:opacity-80"}`,onClick:()=>i(t),children:[(0,L.jsx)("span",{className:"select-none",children:(e=>{switch(e.type){case"MA":return`MA(${e.params.period})`;case"EMA":return`EMA(${e.params.period})`;case"MACD":return`MACD(${e.params.fastPeriod},${e.params.slowPeriod},${e.params.signalPeriod})`;case"BOLL":return`BOLL(${e.params.period},${e.params.stdDev})`;case"RSI":return`RSI(${e.params.period})`;case"KDJ":return`KDJ(${e.params.period},${e.params.kPeriod},${e.params.dPeriod})`;case"ATR":return`ATR(${e.params.period})`;case"MFI":return`MFI(${e.params.period})`;case"VOL":return"VOL";case"VWAP":return"VWAP";case"OBV":return"OBV";case"VPT":return"VPT";default:return e.type}})(e)}),(0,L.jsxs)("div",{className:"flex items-center gap-1",children:[e.visible?(0,L.jsx)(hI,{className:"h-4 w-4"}):(0,L.jsx)(hA,{className:"h-4 w-4"}),(0,L.jsx)(s4.Button,{variant:"ghost",size:"sm",className:"h-5 w-5 p-0 hover:bg-destructive/20",onClick:e=>{e.stopPropagation(),s(t)},title:"åˆ é™¤æŒ‡æ ‡",children:(0,L.jsx)(hF.X,{className:"h-3 w-3"})})]})]},t))})]})}function hW(e,t){if(e.length<t)return[];let i=[];for(let s=t-1;s<e.length;s++){let r=0;for(let i=0;i<t;i++)r+=e[s-i].close;i.push({time:e[s].time,value:r/t})}return i}function hV(e,t){if(e.length<t)return[];let i=[],s=2/(t+1),r=0;for(let i=0;i<t;i++)r+=e[i].close;let n=r/t;i.push({time:e[t-1].time,value:n});for(let r=t;r<e.length;r++)n=(e[r].close-n)*s+n,i.push({time:e[r].time,value:n});return i}function hK(e,t=12,i=26,s=9){if(e.length<i)return[];let r=hV(e,t),n=hV(e,i),l=[];for(let e=0;e<n.length;e++){let i=e+(t-1);i<r.length&&l.push({time:n[e].time,value:r[i].value-n[e].value})}if(l.length<s)return[];let a=[],o=2/(s+1),h=0;for(let e=0;e<s;e++)h+=l[e].value;let u=h/s;a.push({time:l[s-1].time,value:u});for(let e=s;e<l.length;e++)u=(l[e].value-u)*o+u,a.push({time:l[e].time,value:u});let c=[];for(let e=0;e<a.length;e++){let t=e+(s-1);c.push({time:a[e].time,macd:l[t].value,signal:a[e].value,histogram:l[t].value-a[e].value})}return c}function hU(e,t=20,i=2){if(e.length<t)return[];let s=[];for(let r=t-1;r<e.length;r++){let n=0;for(let i=0;i<t;i++)n+=e[r-i].close;let l=n/t,a=0;for(let i=0;i<t;i++)a+=Math.pow(e[r-i].close-l,2);let o=Math.sqrt(a/t);s.push({time:e[r].time,upper:l+i*o,middle:l,lower:l-i*o})}return s}function hH(e,t=14){if(e.length<t+1)return[];let i=[],s=0,r=0;for(let i=1;i<=t;i++){let t=e[i].close-e[i-1].close;t>0?s+=t:r+=Math.abs(t)}let n=s/t,l=r/t;i.push({time:e[t].time,value:0===l?100:100-100/(1+n/l)});for(let s=t+1;s<e.length;s++){let r=e[s].close-e[s-1].close,a=r>0?r:0,o=r<0?Math.abs(r):0;n=(n*(t-1)+a)/t,l=(l*(t-1)+o)/t,i.push({time:e[s].time,value:0===l?100:100-100/(1+n/l)})}return i}function hJ(e,t=9,i=3,s=3){if(e.length<t)return[];let r=[],n=[];for(let i=t-1;i<e.length;i++){let s=e[i-t+1].high,r=e[i-t+1].low;for(let n=0;n<t;n++){let t=i-n;e[t].high>s&&(s=e[t].high),e[t].low<r&&(r=e[t].low)}let l=s===r?50:(e[i].close-r)/(s-r)*100;n.push(l)}let l=50,a=50;for(let o=0;o<n.length;o++){a=(a*(s-1)+(l=(l*(i-1)+n[o])/i))/s;let h=3*l-2*a;r.push({time:e[t-1+o].time,k:l,d:a,j:h})}return r}function hq(e,t=14){if(e.length<t+1)return[];let i=[],s=[];for(let t=1;t<e.length;t++){let i=e[t].high,r=e[t].low,n=e[t-1].close,l=Math.max(i-r,Math.abs(i-n),Math.abs(r-n));s.push(l)}let r=0;for(let e=0;e<t;e++)r+=s[e];r/=t,i.push({time:e[t].time,value:r});for(let n=t;n<s.length;n++)r=(r*(t-1)+s[n])/t,i.push({time:e[n+1].time,value:r});return i}function hY(e){if(0===e.length)return[];let t=[],i=0,s=0;for(let r=0;r<e.length;r++){let n=(e[r].high+e[r].low+e[r].close)/3;i+=n*e[r].volume,s+=e[r].volume,t.push({time:e[r].time,value:0===s?n:i/s})}return t}function hX(e){if(0===e.length)return[];let t=[],i=0;t.push({time:e[0].time,value:0});for(let s=1;s<e.length;s++)e[s].close>e[s-1].close?i+=e[s].volume:e[s].close<e[s-1].close&&(i-=e[s].volume),t.push({time:e[s].time,value:i});return t}function hG(e,t=14){if(e.length<t+1)return[];let i=[],s=[];for(let t=1;t<e.length;t++){let i=(e[t].high+e[t].low+e[t].close)/3,r=(e[t-1].high+e[t-1].low+e[t-1].close)/3,n=i*e[t].volume;i>r?s.push({positive:n,negative:0}):i<r?s.push({positive:0,negative:n}):s.push({positive:0,negative:0})}for(let r=t-1;r<s.length;r++){let n=0,l=0;for(let e=0;e<t;e++)n+=s[r-e].positive,l+=s[r-e].negative;let a=0===l?100:100-100/(1+n/l);i.push({time:e[r+1].time,value:a})}return i}function hQ(e){if(e.length<2)return[];let t=[],i=0;t.push({time:e[0].time,value:0});for(let s=1;s<e.length;s++)i+=(e[s].close-e[s-1].close)/e[s-1].close*e[s].volume,t.push({time:e[s].time,value:i});return t}function hZ({data:e,onCandleClick:t,isLoading:i,tradingPair:s,onTradingPairChange:r,klineInterval:n,onIntervalChange:l,popularPairs:a,intervals:o,onTimePointChange:h,endTime:u,limit:c=100,onLimitChange:d,onForceReload:m,markedCandleTime:p,onMarkedCandleTimeChange:f,onIndicatorsChange:g}){let v=(0,$.useRef)(null),x=(0,$.useRef)(null),w=(0,$.useRef)(null),b=(0,$.useRef)(null),y=(0,$.useRef)(new Map),[S,j]=(0,$.useState)(""),[M,C]=(0,$.useState)(()=>{{let e=localStorage.getItem("klineActiveIndicators");if(e)try{return JSON.parse(e)}catch(e){console.error("[v0] Failed to parse saved indicators:",e)}}return[]}),[N,P]=(0,$.useState)(""),[k,E]=(0,$.useState)(!1),[R,_]=(0,$.useState)(()=>localStorage.getItem("klineSelectedDate")||""),[T,I]=(0,$.useState)(()=>localStorage.getItem("klineSelectedTime")||""),[A,F]=(0,$.useState)(()=>{{let e=localStorage.getItem("markedCandleTime");return e?Number.parseInt(e):null}}),z=void 0!==p?p:A,D=f||F,[O,B]=(0,$.useState)(null),W=(0,$.useCallback)(e=>Math.floor(e/1e3),[]);return(0,$.useEffect)(()=>{if(!v.current)return;let e=()=>{var t,i,s,r;let n;if(!v.current)return;let l=v.current.offsetWidth;if(0===l)return void setTimeout(e,100);let a=(t=v.current,i={width:l,height:400,layout:{background:{color:"transparent"},textColor:"#9ca3af"},grid:{vertLines:{color:"rgba(156, 163, 175, 0.1)"},horzLines:{color:"rgba(156, 163, 175, 0.1)"}},timeScale:{timeVisible:!0,borderVisible:!1,tickMarkFormatter:e=>{let t=new Date(new Date(1e3*e).getTime()+288e5),i=String(t.getUTCMonth()+1).padStart(2,"0"),s=String(t.getUTCDate()).padStart(2,"0"),r=String(t.getUTCHours()).padStart(2,"0"),n=String(t.getUTCMinutes()).padStart(2,"0");return`${i}-${s} ${r}:${n}`}},rightPriceScale:{borderVisible:!1},crosshair:{mode:1},localization:{timeFormatter:e=>{let t=new Date(new Date(1e3*e).getTime()+288e5),i=t.getUTCFullYear(),s=String(t.getUTCMonth()+1).padStart(2,"0"),r=String(t.getUTCDate()).padStart(2,"0"),n=String(t.getUTCHours()).padStart(2,"0"),l=String(t.getUTCMinutes()).padStart(2,"0"),a=String(t.getUTCSeconds()).padStart(2,"0");return`${i}-${s}-${r} ${n}:${l}:${a}`}}},s=new iu,r=iu.pf(i),n=new sE(function(e){if(el(e)){let t=document.getElementById(e);return Q(null!==t,`Cannot find element in DOM with id=${e}`),t}return e}(t),s,r),s.setOptions(n.options()),n),o=a.addSeries(sW,{upColor:"#10b981",downColor:"#ef4444",borderVisible:!1,wickUpColor:"#10b981",wickDownColor:"#ef4444"}),h=new s2(o,new s1((void 0)??{}));x.current=a,w.current=o,b.current=h},t=setTimeout(e,50),i=()=>{v.current&&x.current&&x.current.applyOptions({width:v.current.offsetWidth})};return window.addEventListener("resize",i),()=>{clearTimeout(t),window.removeEventListener("resize",i),b.current&&(b.current.detach(),b.current=null),y.current.forEach(e=>{x.current&&x.current.removeSeries(e)}),y.current.clear(),x.current&&(x.current.remove(),x.current=null,w.current=null)}},[]),(0,$.useEffect)(()=>{if(w.current&&e.length>0){let t=e.map(e=>({time:W(e.time),open:e.open,high:e.high,low:e.low,close:e.close}));w.current.setData(t),x.current&&x.current.timeScale().fitContent()}},[e,W]),(0,$.useEffect)(()=>{if(b.current){if(null!==O&&e.some(e=>W(e.time)===O)){let e=[{time:O,position:"aboveBar",color:"#000000",shape:"arrowDown",text:"å·²é€‰"}];b.current.setMarkers(e);return}b.current.setMarkers([])}},[O,e,W]),(0,$.useEffect)(()=>{if(null===z)return void B(null);let t=e.find(e=>e.time===z);t?B(W(t.time)):B(null)},[z,e,W]),(0,$.useEffect)(()=>{if(!x.current||!t)return;let i=i=>{if(!i.time)return;let s=i.time,r=e.findIndex(e=>W(e.time)===s);if(r>=0){let i=e[r],n=e.slice(0,r+1);console.log("[v0] Candle clicked, time:",i.time),D(i.time),B(s),t(n,i)}};return x.current.subscribeClick(i),()=>{x.current&&x.current.unsubscribeClick(i)}},[e,t,W,D]),(0,$.useEffect)(()=>{R?localStorage.setItem("klineSelectedDate",R):localStorage.removeItem("klineSelectedDate")},[R]),(0,$.useEffect)(()=>{T?localStorage.setItem("klineSelectedTime",T):localStorage.removeItem("klineSelectedTime")},[T]),(0,$.useEffect)(()=>{null!==z?localStorage.setItem("markedCandleTime",z.toString()):localStorage.removeItem("markedCandleTime")},[z]),(0,$.useEffect)(()=>{M.length>0?localStorage.setItem("klineActiveIndicators",JSON.stringify(M)):localStorage.removeItem("klineActiveIndicators")},[M]),(0,$.useEffect)(()=>{g?.(M)},[M,g]),(0,$.useEffect)(()=>{x.current&&0!==e.length&&(y.current.forEach(e=>{x.current&&x.current.removeSeries(e)}),y.current.clear(),M.forEach((t,i)=>{if(x.current&&t.visible){if("MA"===t.type&&t.params.period){let s=hW(e,t.params.period),r=x.current.addSeries(sD,{color:t.params.color||"#2563eb",lineWidth:2,title:`MA(${t.params.period})`});r.setData(s.map(e=>({time:e.time/1e3,value:e.value}))),y.current.set(i,r)}else if("EMA"===t.type&&t.params.period){let s=hV(e,t.params.period),r=x.current.addSeries(sD,{color:t.params.color||"#f59e0b",lineWidth:2,title:`EMA(${t.params.period})`});r.setData(s.map(e=>({time:e.time/1e3,value:e.value}))),y.current.set(i,r)}else if("MACD"===t.type&&t.params.fastPeriod&&t.params.slowPeriod&&t.params.signalPeriod){let s=hK(e,t.params.fastPeriod,t.params.slowPeriod,t.params.signalPeriod),r=x.current.addSeries(sD,{color:"#2563eb",lineWidth:2,title:"MACD",priceScaleId:"macd"});r.setData(s.map(e=>({time:e.time/1e3,value:e.macd}))),y.current.set(3*i,r);let n=x.current.addSeries(sD,{color:"#f59e0b",lineWidth:2,title:"Signal",priceScaleId:"macd"});n.setData(s.map(e=>({time:e.time/1e3,value:e.signal}))),y.current.set(3*i+1,n)}else if("BOLL"===t.type&&t.params.period&&t.params.stdDev){let s=hU(e,t.params.period,t.params.stdDev),r=x.current.addSeries(sD,{color:"#8b5cf6",lineWidth:1,lineStyle:2,title:"BOLL Upper"});r.setData(s.map(e=>({time:e.time/1e3,value:e.upper}))),y.current.set(3*i,r);let n=x.current.addSeries(sD,{color:"#8b5cf6",lineWidth:2,title:"BOLL Middle"});n.setData(s.map(e=>({time:e.time/1e3,value:e.middle}))),y.current.set(3*i+1,n);let l=x.current.addSeries(sD,{color:"#8b5cf6",lineWidth:1,lineStyle:2,title:"BOLL Lower"});l.setData(s.map(e=>({time:e.time/1e3,value:e.lower}))),y.current.set(3*i+2,l)}else if("RSI"===t.type&&t.params.period){let s=hH(e,t.params.period),r=x.current.addSeries(sD,{color:t.params.color||"#ec4899",lineWidth:2,title:`RSI(${t.params.period})`,priceScaleId:"rsi"});r.setData(s.map(e=>({time:e.time/1e3,value:e.value}))),y.current.set(i,r)}else if("KDJ"===t.type&&t.params.period){let s=hJ(e,t.params.period,t.params.kPeriod||3,t.params.dPeriod||3),r=x.current.addSeries(sD,{color:"#2563eb",lineWidth:2,title:"K",priceScaleId:"kdj"});r.setData(s.map(e=>({time:e.time/1e3,value:e.k}))),y.current.set(3*i,r);let n=x.current.addSeries(sD,{color:"#f59e0b",lineWidth:2,title:"D",priceScaleId:"kdj"});n.setData(s.map(e=>({time:e.time/1e3,value:e.d}))),y.current.set(3*i+1,n);let l=x.current.addSeries(sD,{color:"#ec4899",lineWidth:2,title:"J",priceScaleId:"kdj"});l.setData(s.map(e=>({time:e.time/1e3,value:e.j}))),y.current.set(3*i+2,l)}else if("ATR"===t.type&&t.params.period){let s=hq(e,t.params.period),r=x.current.addSeries(sD,{color:t.params.color||"#06b6d4",lineWidth:2,title:`ATR(${t.params.period})`,priceScaleId:"atr"});r.setData(s.map(e=>({time:e.time/1e3,value:e.value}))),y.current.set(i,r)}else if("VOL"===t.type){let t=e.map(e=>({time:e.time/1e3,value:e.volume})),s=x.current.addSeries(sD,{color:"#6366f1",lineWidth:2,title:"VOL",priceScaleId:"vol"});s.setData(t),y.current.set(i,s)}else if("VWAP"===t.type){let t=hY(e),s=x.current.addSeries(sD,{color:"#10b981",lineWidth:2,title:"VWAP"});s.setData(t.map(e=>({time:e.time/1e3,value:e.value}))),y.current.set(i,s)}else if("OBV"===t.type){let t=hX(e),s=x.current.addSeries(sD,{color:"#6366f1",lineWidth:2,title:"OBV",priceScaleId:"obv"});s.setData(t.map(e=>({time:e.time/1e3,value:e.value}))),y.current.set(i,s)}else if("MFI"===t.type&&t.params.period){let s=hG(e,t.params.period),r=x.current.addSeries(sD,{color:t.params.color||"#84cc16",lineWidth:2,title:`MFI(${t.params.period})`,priceScaleId:"mfi"});r.setData(s.map(e=>({time:e.time/1e3,value:e.value}))),y.current.set(i,r)}else if("VPT"===t.type){let t=hQ(e),s=x.current.addSeries(sD,{color:"#a855f7",lineWidth:2,title:"VPT",priceScaleId:"vpt"});s.setData(t.map(e=>({time:e.time/1e3,value:e.value}))),y.current.set(i,s)}}}))},[e,M]),(0,L.jsxs)("div",{className:"space-y-4",children:[z&&(0,L.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground bg-muted/50 px-3 py-2 rounded-md",children:[(0,L.jsx)("span",{className:"text-black dark:text-white",children:"â—"}),(0,L.jsxs)("span",{children:["å·²é€‰ä¸­èœ¡çƒ›: ",new Date(z).toLocaleString()]}),(0,L.jsx)(s4.Button,{variant:"ghost",size:"sm",className:"h-6 px-2 ml-auto",onClick:()=>{console.log("[v0] Clear marker button clicked"),D(null)},children:"æ¸…é™¤æ ‡è®°"})]}),(0,L.jsx)(h$,{onAddIndicator:e=>{C(t=>[...t,e])},activeIndicators:M,onToggleIndicator:e=>{C(t=>t.map((t,i)=>i===e?{...t,visible:!t.visible}:t))},onRemoveIndicator:e=>{C(t=>t.filter((t,i)=>i!==e))}}),(0,L.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,L.jsxs)(oa,{children:[(0,L.jsx)(oo,{asChild:!0,children:(0,L.jsx)(s4.Button,{variant:"outline",className:"w-[140px] justify-between bg-transparent",children:(0,L.jsx)("span",{className:"truncate",children:s})})}),(0,L.jsx)(oh,{className:"w-[200px] p-0",align:"start",children:(0,L.jsxs)(hC,{children:[(0,L.jsx)(hN,{placeholder:"æœç´¢äº¤æ˜“å¯¹...",value:S,onValueChange:j}),(0,L.jsxs)(hP,{children:[(0,L.jsx)(hk,{children:"æœªæ‰¾åˆ°äº¤æ˜“å¯¹"}),(0,L.jsx)(hE,{children:a.filter(e=>e.toLowerCase().includes(S.toLowerCase())).map(e=>(0,L.jsx)(hR,{value:e,onSelect:()=>{r(e),j("")},children:e},e))})]})]})})]}),(0,L.jsxs)("div",{className:"flex items-center gap-2",children:[(0,L.jsxs)(a$,{value:k?"custom":n,onValueChange:e=>{"custom"===e?E(!0):(E(!1),l(e))},children:[(0,L.jsx)(aV,{className:"w-[110px]",children:(0,L.jsx)(aW,{children:k?"è‡ªå®šä¹‰":o.find(e=>e.value===n)?.label})}),(0,L.jsxs)(aK,{children:[o.map(e=>(0,L.jsx)(aU,{value:e.value,children:e.label},e.value)),(0,L.jsx)(aU,{value:"custom",children:"è‡ªå®šä¹‰å‘¨æœŸ"})]})]}),k&&(0,L.jsxs)("div",{className:"flex items-center gap-2",children:[(0,L.jsx)(h_,{type:"text",placeholder:"å¦‚: 30m, 2h, 1d",value:N,onChange:e=>P(e.target.value),className:"w-[120px] h-9"}),(0,L.jsx)(s4.Button,{size:"sm",onClick:()=>l(N.trim()),variant:"outline",children:"åº”ç”¨"})]})]}),(0,L.jsxs)(a$,{value:c.toString(),onValueChange:e=>{let t=Number.parseInt(e);d&&d(t)},children:[(0,L.jsx)(aV,{className:"w-[120px]",children:(0,L.jsxs)(aW,{children:[c," ä¸ªå‘¨æœŸ"]})}),(0,L.jsxs)(aK,{children:[(0,L.jsx)(aU,{value:"50",children:"50 ä¸ªå‘¨æœŸ"}),(0,L.jsx)(aU,{value:"100",children:"100 ä¸ªå‘¨æœŸ"}),(0,L.jsx)(aU,{value:"200",children:"200 ä¸ªå‘¨æœŸ"}),(0,L.jsx)(aU,{value:"500",children:"500 ä¸ªå‘¨æœŸ"}),(0,L.jsx)(aU,{value:"1000",children:"1000 ä¸ªå‘¨æœŸ"})]})]}),(0,L.jsxs)("div",{className:"flex items-center gap-2",children:[(0,L.jsx)(h_,{type:"date",value:R,onChange:e=>_(e.target.value),className:"w-[150px] h-9"}),(0,L.jsx)(h_,{type:"time",value:T,onChange:e=>I(e.target.value),className:"w-[120px] h-9"}),(0,L.jsx)(s4.Button,{size:"sm",variant:"outline",onClick:()=>{_(""),I(""),localStorage.removeItem("klineSelectedDate"),localStorage.removeItem("klineSelectedTime")},className:"h-9 px-3 bg-transparent",title:"æ¸…é™¤æ—¥æœŸæ—¶é—´",children:(0,L.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"size-4",children:[(0,L.jsx)("path",{d:"M18 6 6 18"}),(0,L.jsx)("path",{d:"m6 6 12 12"})]})}),(0,L.jsx)(s4.Button,{size:"sm",variant:"outline",onClick:()=>{let e;(e=R||T?R&&T?new Date(`${R}T${T}`).getTime():0:Date.now())>0&&h&&h(e),m&&m()},disabled:i,className:"h-9 px-3 bg-transparent",title:"é‡è½½å›¾è¡¨æ•°æ®",children:(0,L.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"size-4",children:(0,L.jsx)("path",{d:"M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2"})})})]})]}),(0,L.jsxs)("div",{className:"relative w-full min-h-[400px]",children:[i&&(0,L.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-background/80 backdrop-blur-sm z-10",children:(0,L.jsx)(s5,{className:"size-8 animate-spin text-primary"})}),(0,L.jsx)("div",{ref:v,className:"w-full"})]})]})}var h0=e.i(70065);let h1=(0,s3.default)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),h2=(0,s3.default)("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),h3=(0,s3.default)("List",[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]]),h5=(0,s3.default)("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),h4=(0,s3.default)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),h6=(0,s3.default)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),h9=(0,s3.default)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),h8=(0,s3.default)("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]),h7=(0,s3.default)("CircleStop",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{x:"9",y:"9",width:"6",height:"6",rx:"1",key:"1ssd4o"}]]),ue=(0,s3.default)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),ut=(0,s3.default)("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),ui=(0,s3.default)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]),us=(0,s3.default)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),ur=(0,s3.default)("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),un=(0,s3.default)("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]),ul=(0,s3.default)("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),ua=(0,s3.default)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),uo=(0,s3.default)("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);function uh({className:e,...t}){return(0,L.jsx)("textarea",{"data-slot":"textarea",className:(0,I.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),...t})}var uu=["PageUp","PageDown"],uc=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],ud={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},um="Slider",[up,uf,ug]=ri(um),[uv,ux]=s7(um,[ug]),[uw,ub]=uv(um),uy=$.forwardRef((e,t)=>{let{name:i,min:s=0,max:r=100,step:n=1,orientation:l="horizontal",disabled:a=!1,minStepsBetweenThumbs:o=0,defaultValue:h=[s],value:u,onValueChange:c=()=>{},onValueCommit:d=()=>{},inverted:m=!1,form:p,...f}=e,g=$.useRef(new Set),v=$.useRef(0),x="horizontal"===l,[w=[],b]=le({prop:u,defaultProp:h,onChange:e=>{let t=[...g.current];t[v.current]?.focus(),c(e)}}),y=$.useRef(w);function S(e,t,{commit:i}={commit:!1}){let l,a=(String(n).split(".")[1]||"").length,h=s9(Math.round((Math.round((e-s)/n)*n+s)*(l=Math.pow(10,a)))/l,[s,r]);b((e=[])=>{let s=function(e=[],t,i){let s=[...e];return s[i]=t,s.sort((e,t)=>e-t)}(e,h,t);if(!function(e,t){if(t>0)return Math.min(...e.slice(0,-1).map((t,i)=>e[i+1]-t))>=t;return!0}(s,o*n))return e;{v.current=s.indexOf(h);let t=String(s)!==String(e);return t&&i&&d(s),t?s:e}})}return(0,L.jsx)(uw,{scope:e.__scopeSlider,name:i,disabled:a,min:s,max:r,valueIndexToChangeRef:v,thumbs:g.current,values:w,orientation:l,form:p,children:(0,L.jsx)(up.Provider,{scope:e.__scopeSlider,children:(0,L.jsx)(up.Slot,{scope:e.__scopeSlider,children:(0,L.jsx)(x?uM:uC,{"aria-disabled":a,"data-disabled":a?"":void 0,...f,ref:t,onPointerDown:s8(f.onPointerDown,()=>{a||(y.current=w)}),min:s,max:r,inverted:m,onSlideStart:a?void 0:function(e){let t=function(e,t){if(1===e.length)return 0;let i=e.map(e=>Math.abs(e-t)),s=Math.min(...i);return i.indexOf(s)}(w,e);S(e,t)},onSlideMove:a?void 0:function(e){S(e,v.current)},onSlideEnd:a?void 0:function(){let e=y.current[v.current];w[v.current]!==e&&d(w)},onHomeKeyDown:()=>!a&&S(s,0,{commit:!0}),onEndKeyDown:()=>!a&&S(r,w.length-1,{commit:!0}),onStepKeyDown:({event:e,direction:t})=>{if(!a){let i=uu.includes(e.key)||e.shiftKey&&uc.includes(e.key),s=v.current;S(w[s]+n*(i?10:1)*t,s,{commit:!0})}}})})})})});uy.displayName=um;var[uS,uj]=uv(um,{startEdge:"left",endEdge:"right",size:"width",direction:1}),uM=$.forwardRef((e,t)=>{let{min:i,max:s,dir:r,inverted:n,onSlideStart:l,onSlideMove:a,onSlideEnd:o,onStepKeyDown:h,...u}=e,[c,d]=$.useState(null),m=(0,re.useComposedRefs)(t,e=>d(e)),p=$.useRef(void 0),f=rr(r),g="ltr"===f,v=g&&!n||!g&&n;function x(e){let t=p.current||c.getBoundingClientRect(),r=uF([0,t.width],v?[i,s]:[s,i]);return p.current=t,r(e-t.left)}return(0,L.jsx)(uS,{scope:e.__scopeSlider,startEdge:v?"left":"right",endEdge:v?"right":"left",direction:v?1:-1,size:"width",children:(0,L.jsx)(uN,{dir:f,"data-orientation":"horizontal",...u,ref:m,style:{...u.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:e=>{let t=x(e.clientX);l?.(t)},onSlideMove:e=>{let t=x(e.clientX);a?.(t)},onSlideEnd:()=>{p.current=void 0,o?.()},onStepKeyDown:e=>{let t=ud[v?"from-left":"from-right"].includes(e.key);h?.({event:e,direction:t?-1:1})}})})}),uC=$.forwardRef((e,t)=>{let{min:i,max:s,inverted:r,onSlideStart:n,onSlideMove:l,onSlideEnd:a,onStepKeyDown:o,...h}=e,u=$.useRef(null),c=(0,re.useComposedRefs)(t,u),d=$.useRef(void 0),m=!r;function p(e){let t=d.current||u.current.getBoundingClientRect(),r=uF([0,t.height],m?[s,i]:[i,s]);return d.current=t,r(e-t.top)}return(0,L.jsx)(uS,{scope:e.__scopeSlider,startEdge:m?"bottom":"top",endEdge:m?"top":"bottom",size:"height",direction:m?1:-1,children:(0,L.jsx)(uN,{"data-orientation":"vertical",...h,ref:c,style:{...h.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:e=>{let t=p(e.clientY);n?.(t)},onSlideMove:e=>{let t=p(e.clientY);l?.(t)},onSlideEnd:()=>{d.current=void 0,a?.()},onStepKeyDown:e=>{let t=ud[m?"from-bottom":"from-top"].includes(e.key);o?.({event:e,direction:t?-1:1})}})})}),uN=$.forwardRef((e,t)=>{let{__scopeSlider:i,onSlideStart:s,onSlideMove:r,onSlideEnd:n,onHomeKeyDown:l,onEndKeyDown:a,onStepKeyDown:o,...h}=e,u=ub(um,i);return(0,L.jsx)(rn.span,{...h,ref:t,onKeyDown:s8(e.onKeyDown,e=>{"Home"===e.key?(l(e),e.preventDefault()):"End"===e.key?(a(e),e.preventDefault()):uu.concat(uc).includes(e.key)&&(o(e),e.preventDefault())}),onPointerDown:s8(e.onPointerDown,e=>{let t=e.target;t.setPointerCapture(e.pointerId),e.preventDefault(),u.thumbs.has(t)?t.focus():s(e)}),onPointerMove:s8(e.onPointerMove,e=>{e.target.hasPointerCapture(e.pointerId)&&r(e)}),onPointerUp:s8(e.onPointerUp,e=>{let t=e.target;t.hasPointerCapture(e.pointerId)&&(t.releasePointerCapture(e.pointerId),n(e))})})}),uP="SliderTrack",uk=$.forwardRef((e,t)=>{let{__scopeSlider:i,...s}=e,r=ub(uP,i);return(0,L.jsx)(rn.span,{"data-disabled":r.disabled?"":void 0,"data-orientation":r.orientation,...s,ref:t})});uk.displayName=uP;var uE="SliderRange",uR=$.forwardRef((e,t)=>{let{__scopeSlider:i,...s}=e,r=ub(uE,i),n=uj(uE,i),l=$.useRef(null),a=(0,re.useComposedRefs)(t,l),o=r.values.length,h=r.values.map(e=>uA(e,r.min,r.max)),u=o>1?Math.min(...h):0,c=100-Math.max(...h);return(0,L.jsx)(rn.span,{"data-orientation":r.orientation,"data-disabled":r.disabled?"":void 0,...s,ref:a,style:{...e.style,[n.startEdge]:u+"%",[n.endEdge]:c+"%"}})});uR.displayName=uE;var u_="SliderThumb",uT=$.forwardRef((e,t)=>{let i=uf(e.__scopeSlider),[s,r]=$.useState(null),n=(0,re.useComposedRefs)(t,e=>r(e)),l=$.useMemo(()=>s?i().findIndex(e=>e.ref.current===s):-1,[i,s]);return(0,L.jsx)(uL,{...e,ref:n,index:l})}),uL=$.forwardRef((e,t)=>{var i,s,r,n,l;let a,o,{__scopeSlider:h,index:u,name:c,...d}=e,m=ub(u_,h),p=uj(u_,h),[f,g]=$.useState(null),v=(0,re.useComposedRefs)(t,e=>g(e)),x=!f||m.form||!!f.closest("form"),w=nK(f),b=m.values[u],y=void 0===b?0:uA(b,m.min,m.max),S=(i=u,(s=m.values.length)>2?`Value ${i+1} of ${s}`:2===s?["Minimum","Maximum"][i]:void 0),j=w?.[p.size],M=j?(r=j,n=y,l=p.direction,o=uF([0,50],[0,a=r/2]),(a-o(n)*l)*l):0;return $.useEffect(()=>{if(f)return m.thumbs.add(f),()=>{m.thumbs.delete(f)}},[f,m.thumbs]),(0,L.jsxs)("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[p.startEdge]:`calc(${y}% + ${M}px)`},children:[(0,L.jsx)(up.ItemSlot,{scope:e.__scopeSlider,children:(0,L.jsx)(rn.span,{role:"slider","aria-label":e["aria-label"]||S,"aria-valuemin":m.min,"aria-valuenow":b,"aria-valuemax":m.max,"aria-orientation":m.orientation,"data-orientation":m.orientation,"data-disabled":m.disabled?"":void 0,tabIndex:m.disabled?void 0:0,...d,ref:v,style:void 0===b?{display:"none"}:e.style,onFocus:s8(e.onFocus,()=>{m.valueIndexToChangeRef.current=u})})}),x&&(0,L.jsx)(uI,{name:c??(m.name?m.name+(m.values.length>1?"[]":""):void 0),form:m.form,value:b},u)]})});uT.displayName=u_;var uI=e=>{let{value:t,...i}=e,s=$.useRef(null),r=lt(t);return $.useEffect(()=>{let e=s.current,i=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"value").set;if(r!==t&&i){let s=new Event("input",{bubbles:!0});i.call(e,t),e.dispatchEvent(s)}},[r,t]),(0,L.jsx)("input",{style:{display:"none"},...i,ref:s,defaultValue:t})};function uA(e,t,i){return s9(100/(i-t)*(e-t),[0,100])}function uF(e,t){return i=>{if(e[0]===e[1]||t[0]===t[1])return t[0];let s=(t[1]-t[0])/(e[1]-e[0]);return t[0]+s*(i-e[0])}}function uz({className:e,defaultValue:t,value:i,min:s=0,max:r=100,...n}){let l=$.useMemo(()=>Array.isArray(i)?i:Array.isArray(t)?t:[s,r],[i,t,s,r]);return(0,L.jsxs)(uy,{"data-slot":"slider",defaultValue:t,value:i,min:s,max:r,className:(0,I.cn)("relative flex w-full touch-none items-center select-none data-[disabled]:opacity-50 data-[orientation=vertical]:h-full data-[orientation=vertical]:min-h-44 data-[orientation=vertical]:w-auto data-[orientation=vertical]:flex-col",e),...n,children:[(0,L.jsx)(uk,{"data-slot":"slider-track",className:"bg-muted relative grow overflow-hidden rounded-full data-[orientation=horizontal]:h-1.5 data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-1.5",children:(0,L.jsx)(uR,{"data-slot":"slider-range",className:"bg-primary absolute data-[orientation=horizontal]:h-full data-[orientation=vertical]:w-full"})}),Array.from({length:l.length},(e,t)=>(0,L.jsx)(uT,{"data-slot":"slider-thumb",className:"border-primary ring-ring/50 block size-4 shrink-0 rounded-full border bg-white shadow-sm transition-[color,box-shadow] hover:ring-4 focus-visible:ring-4 focus-visible:outline-hidden disabled:pointer-events-none disabled:opacity-50"},t))]})}let uD=0,uO=new Map,uB=e=>{if(uO.has(e))return;let t=setTimeout(()=>{uO.delete(e),uV({type:"REMOVE_TOAST",toastId:e})},1e6);uO.set(e,t)},u$=[],uW={toasts:[]};function uV(e){uW=((e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:i}=t;return i?uB(i):e.toasts.forEach(e=>{uB(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===i||void 0===i?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}})(uW,e),u$.forEach(e=>{e(uW)})}function uK({...e}){let t=(uD=(uD+1)%Number.MAX_SAFE_INTEGER).toString(),i=()=>uV({type:"DISMISS_TOAST",toastId:t});return uV({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:e=>{e||i()}}}),{id:t,dismiss:i,update:e=>uV({type:"UPDATE_TOAST",toast:{...e,id:t}})}}function uU(){let[e,t]=$.useState(uW);return $.useEffect(()=>(u$.push(t),()=>{let e=u$.indexOf(t);e>-1&&u$.splice(e,1)}),[e]),{...e,toast:uK,dismiss:e=>uV({type:"DISMISS_TOAST",toastId:e})}}var uH="ToastProvider",[uJ,uq,uY]=ri("Toast"),[uX,uG]=s7("Toast",[uY]),[uQ,uZ]=uX(uH),u0=e=>{let{__scopeToast:t,label:i="Notification",duration:s=5e3,swipeDirection:r="right",swipeThreshold:n=50,children:l}=e,[a,o]=$.useState(null),[h,u]=$.useState(0),c=$.useRef(!1),d=$.useRef(!1);return i.trim()||console.error(`Invalid prop \`label\` supplied to \`${uH}\`. Expected non-empty \`string\`.`),(0,L.jsx)(uJ.Provider,{scope:t,children:(0,L.jsx)(uQ,{scope:t,label:i,duration:s,swipeDirection:r,swipeThreshold:n,toastCount:h,viewport:a,onViewportChange:o,onToastAdd:$.useCallback(()=>u(e=>e+1),[]),onToastRemove:$.useCallback(()=>u(e=>e-1),[]),isFocusedToastEscapeKeyDownRef:c,isClosePausedRef:d,children:l})})};u0.displayName=uH;var u1="ToastViewport",u2=["F8"],u3="toast.viewportPause",u5="toast.viewportResume",u4=$.forwardRef((e,t)=>{let{__scopeToast:i,hotkey:s=u2,label:r="Notifications ({hotkey})",...n}=e,l=uZ(u1,i),a=uq(i),o=$.useRef(null),h=$.useRef(null),u=$.useRef(null),c=$.useRef(null),d=(0,re.useComposedRefs)(t,c,l.onViewportChange),m=s.join("+").replace(/Key/g,"").replace(/Digit/g,""),p=l.toastCount>0;$.useEffect(()=>{let e=e=>{0!==s.length&&s.every(t=>e[t]||e.code===t)&&c.current?.focus()};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[s]),$.useEffect(()=>{let e=o.current,t=c.current;if(p&&e&&t){let i=()=>{if(!l.isClosePausedRef.current){let e=new CustomEvent(u3);t.dispatchEvent(e),l.isClosePausedRef.current=!0}},s=()=>{if(l.isClosePausedRef.current){let e=new CustomEvent(u5);t.dispatchEvent(e),l.isClosePausedRef.current=!1}},r=t=>{e.contains(t.relatedTarget)||s()},n=()=>{e.contains(document.activeElement)||s()};return e.addEventListener("focusin",i),e.addEventListener("focusout",r),e.addEventListener("pointermove",i),e.addEventListener("pointerleave",n),window.addEventListener("blur",i),window.addEventListener("focus",s),()=>{e.removeEventListener("focusin",i),e.removeEventListener("focusout",r),e.removeEventListener("pointermove",i),e.removeEventListener("pointerleave",n),window.removeEventListener("blur",i),window.removeEventListener("focus",s)}}},[p,l.isClosePausedRef]);let f=$.useCallback(({tabbingDirection:e})=>{let t=a().map(t=>{let i=t.ref.current,s=[i,...function(e){let t=[],i=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:e=>{let t="INPUT"===e.tagName&&"hidden"===e.type;return e.disabled||e.hidden||t?NodeFilter.FILTER_SKIP:e.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;i.nextNode();)t.push(i.currentNode);return t}(i)];return"forwards"===e?s:s.reverse()});return("forwards"===e?t.reverse():t).flat()},[a]);return $.useEffect(()=>{let e=c.current;if(e){let t=t=>{let i=t.altKey||t.ctrlKey||t.metaKey;if("Tab"===t.key&&!i){let i=document.activeElement,s=t.shiftKey;if(t.target===e&&s)return void h.current?.focus();let r=f({tabbingDirection:s?"backwards":"forwards"}),n=r.findIndex(e=>e===i);cm(r.slice(n+1))?t.preventDefault():s?h.current?.focus():u.current?.focus()}};return e.addEventListener("keydown",t),()=>e.removeEventListener("keydown",t)}},[a,f]),(0,L.jsxs)(rc,{ref:o,role:"region","aria-label":r.replace("{hotkey}",m),tabIndex:-1,style:{pointerEvents:p?void 0:"none"},children:[p&&(0,L.jsx)(u9,{ref:h,onFocusFromOutsideViewport:()=>{cm(f({tabbingDirection:"forwards"}))}}),(0,L.jsx)(uJ.Slot,{scope:i,children:(0,L.jsx)(rn.ol,{tabIndex:-1,...n,ref:d})}),p&&(0,L.jsx)(u9,{ref:u,onFocusFromOutsideViewport:()=>{cm(f({tabbingDirection:"backwards"}))}})]})});u4.displayName=u1;var u6="ToastFocusProxy",u9=$.forwardRef((e,t)=>{let{__scopeToast:i,onFocusFromOutsideViewport:s,...r}=e,n=uZ(u6,i);return(0,L.jsx)(li,{"aria-hidden":!0,tabIndex:0,...r,ref:t,style:{position:"fixed"},onFocus:e=>{let t=e.relatedTarget;n.viewport?.contains(t)||s()}})});u9.displayName=u6;var u8="Toast",u7=$.forwardRef((e,t)=>{let{forceMount:i,open:s,defaultOpen:r,onOpenChange:n,...l}=e,[a=!0,o]=le({prop:s,defaultProp:r,onChange:n});return(0,L.jsx)(aq,{present:i||a,children:(0,L.jsx)(ci,{open:a,...l,ref:t,onClose:()=>o(!1),onPause:ra(e.onPause),onResume:ra(e.onResume),onSwipeStart:s8(e.onSwipeStart,e=>{e.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:s8(e.onSwipeMove,e=>{let{x:t,y:i}=e.detail.delta;e.currentTarget.setAttribute("data-swipe","move"),e.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${t}px`),e.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${i}px`)}),onSwipeCancel:s8(e.onSwipeCancel,e=>{e.currentTarget.setAttribute("data-swipe","cancel"),e.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),e.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),e.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),e.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:s8(e.onSwipeEnd,e=>{let{x:t,y:i}=e.detail.delta;e.currentTarget.setAttribute("data-swipe","end"),e.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),e.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),e.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${t}px`),e.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${i}px`),o(!1)})})})});u7.displayName=u8;var[ce,ct]=uX(u8,{onClose(){}}),ci=$.forwardRef((e,t)=>{let{__scopeToast:i,type:s="foreground",duration:r,open:n,onClose:l,onEscapeKeyDown:a,onPause:o,onResume:h,onSwipeStart:u,onSwipeMove:c,onSwipeCancel:d,onSwipeEnd:m,...p}=e,f=uZ(u8,i),[g,v]=$.useState(null),x=(0,re.useComposedRefs)(t,e=>v(e)),w=$.useRef(null),b=$.useRef(null),y=r||f.duration,S=$.useRef(0),j=$.useRef(y),M=$.useRef(0),{onToastAdd:C,onToastRemove:N}=f,P=ra(()=>{g?.contains(document.activeElement)&&f.viewport?.focus(),l()}),k=$.useCallback(e=>{e&&e!==1/0&&(window.clearTimeout(M.current),S.current=new Date().getTime(),M.current=window.setTimeout(P,e))},[P]);$.useEffect(()=>{let e=f.viewport;if(e){let t=()=>{k(j.current),h?.()},i=()=>{let e=new Date().getTime()-S.current;j.current=j.current-e,window.clearTimeout(M.current),o?.()};return e.addEventListener(u3,i),e.addEventListener(u5,t),()=>{e.removeEventListener(u3,i),e.removeEventListener(u5,t)}}},[f.viewport,y,o,h,k]),$.useEffect(()=>{n&&!f.isClosePausedRef.current&&k(y)},[n,y,f.isClosePausedRef,k]),$.useEffect(()=>(C(),()=>N()),[C,N]);let E=$.useMemo(()=>g?function e(t){let i=[];return Array.from(t.childNodes).forEach(t=>{var s;if(t.nodeType===t.TEXT_NODE&&t.textContent&&i.push(t.textContent),(s=t).nodeType===s.ELEMENT_NODE){let s=t.ariaHidden||t.hidden||"none"===t.style.display,r=""===t.dataset.radixToastAnnounceExclude;if(!s)if(r){let e=t.dataset.radixToastAnnounceAlt;e&&i.push(e)}else i.push(...e(t))}}),i}(g):null,[g]);return f.viewport?(0,L.jsxs)(L.Fragment,{children:[E&&(0,L.jsx)(cs,{__scopeToast:i,role:"status","aria-live":"foreground"===s?"assertive":"polite","aria-atomic":!0,children:E}),(0,L.jsx)(ce,{scope:i,onClose:P,children:s6.createPortal((0,L.jsx)(uJ.ItemSlot,{scope:i,children:(0,L.jsx)(ru,{asChild:!0,onEscapeKeyDown:s8(a,()=>{f.isFocusedToastEscapeKeyDownRef.current||P(),f.isFocusedToastEscapeKeyDownRef.current=!1}),children:(0,L.jsx)(rn.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":n?"open":"closed","data-swipe-direction":f.swipeDirection,...p,ref:x,style:{userSelect:"none",touchAction:"none",...e.style},onKeyDown:s8(e.onKeyDown,e=>{"Escape"===e.key&&(a?.(e.nativeEvent),e.nativeEvent.defaultPrevented||(f.isFocusedToastEscapeKeyDownRef.current=!0,P()))}),onPointerDown:s8(e.onPointerDown,e=>{0===e.button&&(w.current={x:e.clientX,y:e.clientY})}),onPointerMove:s8(e.onPointerMove,e=>{if(!w.current)return;let t=e.clientX-w.current.x,i=e.clientY-w.current.y,s=!!b.current,r=["left","right"].includes(f.swipeDirection),n=["left","up"].includes(f.swipeDirection)?Math.min:Math.max,l=r?n(0,t):0,a=r?0:n(0,i),o="touch"===e.pointerType?10:2,h={x:l,y:a},d={originalEvent:e,delta:h};s?(b.current=h,cc("toast.swipeMove",c,d,{discrete:!1})):cd(h,f.swipeDirection,o)?(b.current=h,cc("toast.swipeStart",u,d,{discrete:!1}),e.target.setPointerCapture(e.pointerId)):(Math.abs(t)>o||Math.abs(i)>o)&&(w.current=null)}),onPointerUp:s8(e.onPointerUp,e=>{let t=b.current,i=e.target;if(i.hasPointerCapture(e.pointerId)&&i.releasePointerCapture(e.pointerId),b.current=null,w.current=null,t){let i=e.currentTarget,s={originalEvent:e,delta:t};cd(t,f.swipeDirection,f.swipeThreshold)?cc("toast.swipeEnd",m,s,{discrete:!0}):cc("toast.swipeCancel",d,s,{discrete:!0}),i.addEventListener("click",e=>e.preventDefault(),{once:!0})}})})})}),f.viewport)})]}):null}),cs=e=>{let{__scopeToast:t,children:i,...s}=e,r=uZ(u8,t),[n,l]=$.useState(!1),[a,o]=$.useState(!1);return function(e=()=>{}){let t=ra(e);rN(()=>{let e=0,i=0;return e=window.requestAnimationFrame(()=>i=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(e),window.cancelAnimationFrame(i)}},[t])}(()=>l(!0)),$.useEffect(()=>{let e=window.setTimeout(()=>o(!0),1e3);return()=>window.clearTimeout(e)},[]),a?null:(0,L.jsx)(n7,{asChild:!0,children:(0,L.jsx)(li,{...s,children:n&&(0,L.jsxs)(L.Fragment,{children:[r.label," ",i]})})})},cr=$.forwardRef((e,t)=>{let{__scopeToast:i,...s}=e;return(0,L.jsx)(rn.div,{...s,ref:t})});cr.displayName="ToastTitle";var cn=$.forwardRef((e,t)=>{let{__scopeToast:i,...s}=e;return(0,L.jsx)(rn.div,{...s,ref:t})});cn.displayName="ToastDescription";var cl="ToastAction",ca=$.forwardRef((e,t)=>{let{altText:i,...s}=e;return i.trim()?(0,L.jsx)(cu,{altText:i,asChild:!0,children:(0,L.jsx)(ch,{...s,ref:t})}):(console.error(`Invalid prop \`altText\` supplied to \`${cl}\`. Expected non-empty \`string\`.`),null)});ca.displayName=cl;var co="ToastClose",ch=$.forwardRef((e,t)=>{let{__scopeToast:i,...s}=e,r=ct(co,i);return(0,L.jsx)(cu,{asChild:!0,children:(0,L.jsx)(rn.button,{type:"button",...s,ref:t,onClick:s8(e.onClick,r.onClose)})})});ch.displayName=co;var cu=$.forwardRef((e,t)=>{let{__scopeToast:i,altText:s,...r}=e;return(0,L.jsx)(rn.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":s||void 0,...r,ref:t})});function cc(e,t,i,{discrete:s}){let r=i.originalEvent.currentTarget,n=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:i});t&&r.addEventListener(e,t,{once:!0}),s?rl(r,n):r.dispatchEvent(n)}var cd=(e,t,i=0)=>{let s=Math.abs(e.x),r=Math.abs(e.y),n=s>r;return"left"===t||"right"===t?n&&s>i:!n&&r>i};function cm(e){let t=document.activeElement;return e.some(e=>e===t||(e.focus(),document.activeElement!==t))}var cp=e.i(94237);let cf=$.forwardRef(({className:e,...t},i)=>(0,L.jsx)(u4,{ref:i,className:(0,I.cn)("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...t}));cf.displayName=u4.displayName;let cg=(0,cp.cva)("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),cv=$.forwardRef(({className:e,variant:t,...i},s)=>(0,L.jsx)(u7,{ref:s,className:(0,I.cn)(cg({variant:t}),e),...i}));cv.displayName=u7.displayName,$.forwardRef(({className:e,...t},i)=>(0,L.jsx)(ca,{ref:i,className:(0,I.cn)("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e),...t})).displayName=ca.displayName;let cx=$.forwardRef(({className:e,...t},i)=>(0,L.jsx)(ch,{ref:i,className:(0,I.cn)("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...t,children:(0,L.jsx)(hF.X,{className:"h-4 w-4"})}));cx.displayName=ch.displayName;let cw=$.forwardRef(({className:e,...t},i)=>(0,L.jsx)(cr,{ref:i,className:(0,I.cn)("text-sm font-semibold",e),...t}));cw.displayName=cr.displayName;let cb=$.forwardRef(({className:e,...t},i)=>(0,L.jsx)(cn,{ref:i,className:(0,I.cn)("text-sm opacity-90",e),...t}));function cy(){let{toasts:e}=uU();return(0,L.jsxs)(u0,{children:[e.map(function({id:e,title:t,description:i,action:s,...r}){return(0,L.jsxs)(cv,{...r,children:[(0,L.jsxs)("div",{className:"grid gap-1",children:[t&&(0,L.jsx)(cw,{children:t}),i&&(0,L.jsx)(cb,{children:i})]}),s,(0,L.jsx)(cx,{})]},e)}),(0,L.jsx)(cf,{})]})}cb.displayName=cn.displayName;let cS="history",cj="settings",cM="responseImages",cC=()=>new Promise((e,t)=>{let i=indexedDB.open("llm-api-test-db",2);i.onerror=()=>t(i.error),i.onsuccess=()=>e(i.result),i.onupgradeneeded=e=>{let t=e.target.result;t.objectStoreNames.contains(cS)||t.createObjectStore(cS,{keyPath:"id"}).createIndex("timestamp","timestamp",{unique:!1}),t.objectStoreNames.contains(cj)||t.createObjectStore(cj,{keyPath:"key"}),t.objectStoreNames.contains(cM)||t.createObjectStore(cM,{keyPath:"historyTimestamp"}).createIndex("timestamp","historyTimestamp",{unique:!0})}}),cN=async e=>{let t=await cC(),i=t.transaction([cS],"readwrite").objectStore(cS);for(let t of(await new Promise((e,t)=>{let s=i.clear();s.onsuccess=()=>e(),s.onerror=()=>t(s.error)}),e))await new Promise((e,s)=>{let r=i.add(t);r.onsuccess=()=>e(),r.onerror=()=>s(r.error)});t.close()},cP=async()=>{let e=await cC(),t=e.transaction([cS],"readonly").objectStore(cS);return new Promise((i,s)=>{let r=t.getAll();r.onsuccess=()=>{let t=r.result;t.sort((e,t)=>t.timestamp-e.timestamp),i(t),e.close()},r.onerror=()=>{s(r.error),e.close()}})},ck=async e=>{let t=await cC(),i=t.transaction([cj],"readwrite").objectStore(cj);return new Promise((s,r)=>{let n=i.put({key:"messageImages",value:e});n.onsuccess=()=>{s(),t.close()},n.onerror=()=>{r(n.error),t.close()}})},cE=async()=>{let e=await cC(),t=e.transaction([cj],"readonly").objectStore(cj);return new Promise((i,s)=>{let r=t.get("messageImages");r.onsuccess=()=>{let t=r.result;i(t?.value||[]),e.close()},r.onerror=()=>{s(r.error),e.close()}})},cR=async()=>{try{let e=localStorage.getItem("indexeddb_migration_complete");if("true"===e)return;let t=localStorage.getItem("llm_api_history");if(t){let e=JSON.parse(t);await cN(e),console.log("[v0] Migrated history to IndexedDB")}let i=localStorage.getItem("llm-api-test-settings");if(i){let e=JSON.parse(i);e.messageImages&&Array.isArray(e.messageImages)&&(await ck(e.messageImages),console.log("[v0] Migrated images to IndexedDB"))}localStorage.setItem("indexeddb_migration_complete","true"),localStorage.removeItem("llm_api_history"),console.log("[v0] Migration complete, cleaned up localStorage")}catch(e){console.error("[v0] Error during migration:",e)}},c_=async(e,t)=>{let i=await cC(),s=i.transaction([cM],"readwrite").objectStore(cM);return new Promise((r,n)=>{let l=s.put({historyTimestamp:e,images:t});l.onsuccess=()=>{r(),i.close()},l.onerror=()=>{n(l.error),i.close()}})},cT=async e=>{let t=await cC(),i=t.transaction([cM],"readonly").objectStore(cM);return new Promise((s,r)=>{let n=i.get(e);n.onsuccess=()=>{let e=n.result;s(e?.images||[]),t.close()},n.onerror=()=>{r(n.error),t.close()}})},cL=async e=>{let t=await cC(),i=t.transaction([cM],"readwrite").objectStore(cM);return new Promise((s,r)=>{let n=i.delete(e);n.onsuccess=()=>{s(),t.close()},n.onerror=()=>{r(n.error),t.close()}})},cI=async()=>{let e=await cC(),t=e.transaction([cS],"readwrite").objectStore(cS);await new Promise((e,i)=>{let s=t.clear();s.onsuccess=()=>e(),s.onerror=()=>i(s.error)});let i=e.transaction([cj],"readwrite").objectStore(cj);await new Promise((e,t)=>{let s=i.clear();s.onsuccess=()=>e(),s.onerror=()=>t(s.error)});let s=e.transaction([cM],"readwrite").objectStore(cM);await new Promise((e,t)=>{let i=s.clear();i.onsuccess=()=>e(),i.onerror=()=>t(i.error)}),e.close()},cA="fileHandles",cF=async e=>{try{if(e.queryPermission){let t=await e.queryPermission({mode:"read"});if("granted"===t)return!0;let i=await e.requestPermission({mode:"read"});return"granted"===i}return!0}catch(e){return console.error("[v0] Error checking/requesting file permission:",e),!1}},cz=()=>new Promise((e,t)=>{let i=indexedDB.open("llm-api-tester-db",1);i.onerror=()=>{console.log("[v0] IndexedDB open error:",i.error),t(i.error)},i.onsuccess=()=>{console.log("[v0] IndexedDB opened successfully"),e(i.result)},i.onupgradeneeded=e=>{console.log("[v0] IndexedDB upgrade needed, creating object store");let t=e.target.result;t.objectStoreNames.contains(cA)||t.createObjectStore(cA)}}),cD=async(e,t)=>{console.log("[v0] saveFileHandle called with key:",e,"handle:",t);try{let i=await cz();return console.log("[v0] DB opened for saving, starting transaction..."),new Promise(s=>{let r=i.transaction(cA,"readwrite"),n=r.objectStore(cA);console.log("[v0] Putting handle into store...");let l=n.put(t,e);l.onerror=e=>{console.log("[v0] Put request error:",l.error,e)},l.onsuccess=()=>{console.log("[v0] Put request success for:",e)},r.oncomplete=()=>{console.log("[v0] Transaction completed successfully for:",e),i.close(),s(!0)},r.onerror=e=>{console.log("[v0] Transaction error:",r.error,e),i.close(),s(!1)},r.onabort=e=>{console.log("[v0] Transaction aborted:",r.error,e),i.close(),s(!1)}})}catch(e){return console.log("[v0] Error in saveFileHandle:",e),!1}},cO=async e=>{console.log("[v0] getFileHandle called with key:",e);try{let t=await cz();return new Promise(i=>{let s=t.transaction(cA,"readonly").objectStore(cA).get(e);s.onerror=()=>{console.log("[v0] Failed to get file handle:",s.error),t.close(),i(null)},s.onsuccess=()=>{let r=s.result||null;console.log("[v0] Got file handle from IndexedDB:",e,r?"found":"not found"),t.close(),i(r)}})}catch(e){return console.log("[v0] Error in getFileHandle:",e),null}},cB=async e=>{console.log("[v0] deleteFileHandle called with key:",e);try{let t=await cz();return new Promise(i=>{let s=t.transaction(cA,"readwrite");s.objectStore(cA).delete(e),s.oncomplete=()=>{console.log("[v0] Delete transaction completed for:",e),t.close(),i()},s.onerror=()=>{console.log("[v0] Delete transaction error:",s.error),t.close(),i()}})}catch(e){console.log("[v0] Failed to delete file handle from IndexedDB:",e)}},c$=[{id:"openrouter",name:"OpenRouter",endpoint:"https://openrouter.ai/api/v1/chat/completions"},{id:"deepseek",name:"DeepSeek",endpoint:"https://api.deepseek.com/v1/chat/completions"},{id:"cerebras",name:"Cerebras",endpoint:"https://api.cerebras.ai/v1/chat/completions"},{id:"modelscope",name:"ModelScope",endpoint:"https://api-inference.modelscope.cn/v1/chat/completions"},{id:"custom",name:"è‡ªå®šä¹‰",endpoint:""}],cW=async e=>{let t=new Map;for(let i of e)try{let e=await cT(i.timestamp);if(e.length>0){let s=e.map(e=>e.base64||e.url||"").filter(Boolean);s.length>0&&t.set(i.timestamp,s)}}catch(e){console.warn(`[v0] Failed to load response images for timestamp ${i.timestamp}:`,e)}return t};function cV(){let e,t={provider:"openrouter",model:"",apiKey:"",baseURL:"https://openrouter.ai",apiPath:"/api/v1/chat/completions",systemPrompt:`Role: ä½ æ˜¯ä¸€ä½ç²¾é€šä»·æ ¼è¡Œä¸ºï¼ˆPrice Actionï¼‰ä¸Žé‡åŒ–åˆ†æžçš„åŠ å¯†è´§å¸é¦–å¸­åˆ†æžå¸ˆã€‚ä½ æ“…é•¿ä»ŽåŽŸå§‹ OHLCV æ•°æ®ä¸­å‰¥ç¦»å™ªéŸ³,è¯†åˆ«è¶‹åŠ¿æ‹ç‚¹åŠé«˜ç›ˆäºæ¯”çš„äº¤æ˜“æœºä¼šã€‚
Core Skills:
æ•°æ®æ¸…æ´—ä¸Žè®¡ç®—ï¼š èƒ½å¤Ÿæ ¹æ®æ”¶ç›˜ä»·åºåˆ—è®¡ç®—ç®€å•çš„ç§»åŠ¨å¹³å‡çº¿ (MA)ã€æ³¢åŠ¨çŽ‡ (ATR) åŠå¼ºå¼±æŒ‡æ ‡ (RSI)ã€‚
å½¢æ€è¯†åˆ«ï¼š è¯†åˆ«åžæ²¡å½¢æ€ã€é”¤å¤´çº¿ã€ç©¿å¤´ç ´è„šã€Våž‹åè½¬ç­‰ç»å…¸ K çº¿ç»„åˆã€‚
é‡ä»·åˆ†æžï¼š åˆ†æžæˆäº¤é‡å¯¹ä»·æ ¼å˜åŠ¨çš„æ”¯æ’‘æ€§ï¼ˆå¦‚ï¼šæ”¾é‡çªç ´ vs ç¼©é‡ä¸Šæ¶¨ï¼‰ã€‚
æ”¯æ’‘/åŽ‹åŠ›æŽ¢æµ‹ï¼š ä»ŽåŽ†å²é«˜ä½Žç‚¹ä¸­é”å®šå…³é”®çš„æµåŠ¨æ€§åŒºåŸŸã€‚
ANALYSIS LOGIC (é€»è¾‘åˆ†æžæ­¥éª¤):
å½¢æ€ç‰¹å¾æ‰«æï¼š
åˆ†æžæœ€è¿‘ 3-5 æ ¹ K çº¿ï¼šæ˜¯è¿žç»­é˜³çº¿/é˜´çº¿ï¼Ÿå®žä½“å¤§å°æ˜¯å¦åœ¨è¡°å‡ï¼Ÿ
æ˜¯å¦å­˜åœ¨é•¿å½±çº¿ï¼ˆæ’é’ˆï¼‰ï¼šåˆ¤æ–­å½±çº¿å‡ºçŽ°çš„å…³é”®ä»·æ ¼ä½åŠå…¶ä»£è¡¨çš„ä¾›éœ€åŽ‹åŠ›ã€‚
é‡ä»·é…åˆåº¦ï¼š
ç¡®è®¤å½“å‰çš„ä»·æ ¼æ³¢åŠ¨æ˜¯å¦æœ‰æˆäº¤é‡æ”¯æ’‘ï¼ˆVolume Confirmationï¼‰ã€‚
æ³¢åŠ¨çŽ‡è¯„ä¼°ï¼š
è§‚å¯Ÿé«˜ä½Žç‚¹æ³¢åŠ¨èŒƒå›´ï¼ˆHigh-Low Spreadï¼‰ï¼Œåˆ¤æ–­å¸‚åœºæ˜¯å¤„äºŽ"ä½Žæ³¢åŠ¨è“„åŠ¿"è¿˜æ˜¯"é«˜æ³¢åŠ¨æ´—ç›˜"ã€‚
è¶‹åŠ¿ç»“æž„å®šä¹‰ï¼š
ä½¿ç”¨ Higher Highs/Lower Lows å®šä¹‰å½“å‰æ˜¯ Bullish Trend, Bearish Trend è¿˜æ˜¯ Range-boundã€‚
FORMATTED OUTPUT (æ ¼å¼åŒ–è¾“å‡ºè§„èŒƒ):
ä½ å¿…é¡»ä¸¥æ ¼æŒ‰ç…§ä»¥ä¸‹ Markdown ç»“æž„å›žå¤ï¼Œç¦æ­¢é—²èŠï¼š
markdown
### ðŸ“Š å¸‚åœºç›˜é¢é‡åŒ–åˆ†æžæŠ¥å‘Š
**äº¤æ˜“å¯¹:** [å¸ç§] | **å‘¨æœŸ:** [æ—¶é—´ç»´åº¦] | **åˆ†æžæ—¶åˆ»:** [æ•°æ®æœ€åŽä¸€æ ¹Kçº¿çš„æ—¶é—´]

#### 1. ä»·æ ¼è¡Œä¸ºç»¼è¿° (Price Action)
*   **å½“å‰è¶‹åŠ¿:** [ä¾‹å¦‚ï¼š1h çº§åˆ« Våž‹åè½¬åŽè¿›å…¥é«˜ä½éœ‡è¡]
*   **æœ€è¿‘åŠ¨æ€:** [æè¿°æœ€åŽ 3 æ ¹ K çº¿çš„å®žä½“ä¸Žé‡æ¯”å…³ç³»]
*   **å…³é”®ä½:**
    *   ðŸ”´ é˜»åŠ›ä½: [ä»·æ ¼1], [ä»·æ ¼2]
    *   ðŸŸ¢ æ”¯æ’‘ä½: [ä»·æ ¼1], [ä»·æ ¼2]

#### 2. é‡ä»·å¼‚åŠ¨æ£€æµ‹ (Volume Analysis)
*   [ä¾‹å¦‚ï¼š2025-12-19 03:00 å‡ºçŽ°æ”¾é‡ä¸‹è·Œï¼Œæˆäº¤é‡4102ä¸ºè¿‘æœŸæœ€é«˜ï¼Œæ˜¾ç¤ºå–ç›˜ææ…Œï¼Œä½†éšåŽä»·æ ¼å›žå‡ï¼Œå½¢æˆå–ç›˜æž¯ç«­ã€‚]

#### 3. äº¤æ˜“ç­–ç•¥å»ºè®® (Tactical Advice)

| ç­–ç•¥ç±»åž‹ | è§¦å‘æ¡ä»¶ | å…¥åœºç›®æ ‡ | æ­¢æŸ (SL) | æ­¢ç›ˆ (TP) | ç›ˆäºæ¯”  |
| :-: | :-: | :-: | :-: | :-: | :-: |
| å¤šå• (Long)    | çªç ´å¹¶å›žæµ‹ [ä»·æ ¼]   | [ä»·æ ¼]   | [ä»·æ ¼]    | [ä»·æ ¼]    | [X:1]   |
| ç©ºå• (Short)   | è·Œç ´ [ä»·æ ¼] ç¡®è®¤    | [ä»·æ ¼]   | [ä»·æ ¼]    | [ä»·æ ¼]    | [X:1]   |

#### 4. æžç«¯é£Žé™©æç¤º
[ä¾‹å¦‚ï¼šRSI å¤„äºŽé«˜ä½ä¸”æˆäº¤é‡æŒç»­èŽç¼©ï¼Œå­˜åœ¨äºŒæŽ¢åº•éƒ¨çš„é£Žé™©ã€‚]`,userMessage:"",promptFilePath:"",enablePromptFile:!1,systemPromptFilePath:"",enableSystemPromptFile:!1,autoReloadPrompt:!1,autoReloadSystemPrompt:!1,autoReloadImages:!1,maxTokens:4096,temperature:1,topP:1,frequencyPenalty:0,presencePenalty:0,showRawColumns:!1,expandRequestContent:!1,expandResponseContent:!1,timerEnabled:!1,timerInterval:60,maxTokensLimit:8192,pageSize:3,prompt:""},[i,s]=(0,$.useState)(t.provider),[r,n]=(0,$.useState)(""),[l,a]=(0,$.useState)(t.apiKey),[o,h]=(0,$.useState)(!1),[u,c]=(0,$.useState)(!1),[d,m]=(0,$.useState)(!1),[p,f]=(0,$.useState)(!1),[g,v]=(0,$.useState)(""),[x,w]=(0,$.useState)([]),[b,y]=(0,$.useState)([]),[S,j]=(0,$.useState)([]),[M,C]=(0,$.useState)(!1),[N,P]=(0,$.useState)(!1),[k,E]=(0,$.useState)([]),[R,_]=(0,$.useState)([]),[T,I]=(0,$.useState)(""),[W,V]=(0,$.useState)(""),[K,U]=(0,$.useState)(!1),[H,J]=(0,$.useState)(""),[q,Y]=(0,$.useState)(t.maxTokens),[X,G]=(0,$.useState)(t.temperature),[Q,Z]=(0,$.useState)(t.topP),[ee,et]=(0,$.useState)(t.frequencyPenalty),[ei,es]=(0,$.useState)(t.presencePenalty),[er,en]=(0,$.useState)(!1),[el,ea]=(0,$.useState)(!1),eo=(0,$.useRef)(null),[eh,eu]=(0,$.useState)(""),[ec,ed]=(0,$.useState)(""),[em,ep]=(0,$.useState)(""),[ef,eg]=(0,$.useState)(t.maxTokensLimit),[ev,ex]=(0,$.useState)(t.prompt),[ew,eb]=(0,$.useState)(t.baseURL),[ey,eS]=(0,$.useState)(t.apiPath),[ej,eM]=(0,$.useState)(t.systemPrompt),[eC,eN]=(0,$.useState)(t.userMessage),[eP,ek]=(0,$.useState)(""),[eE,eR]=(0,$.useState)("all"),[e_,eT]=(0,$.useState)([]),[eL,eI]=(0,$.useState)(t.promptFilePath),[eA,eF]=(0,$.useState)(t.enablePromptFile),[ez,eD]=(0,$.useState)(!1),eO=(0,$.useRef)(null),[eB,e$]=(0,$.useState)(""),[eW,eV]=(0,$.useState)(!1),[eK,eU]=(0,$.useState)(t.systemPromptFilePath),[eH,eJ]=(0,$.useState)(t.enableSystemPromptFile),[eq,eY]=(0,$.useState)(!1),eX=(0,$.useRef)(null),[eG,eQ]=(0,$.useState)(""),[eZ,e0]=(0,$.useState)(!1),[e1,e2]=(0,$.useState)(t.autoReloadPrompt),[e3,e5]=(0,$.useState)(t.autoReloadSystemPrompt),[e4,e6]=(0,$.useState)(t.autoReloadImages),[e9,e8]=(0,$.useState)([]),[e7,te]=(0,$.useState)(t.pageSize),[tt,ti]=(0,$.useState)(1),[ts,tr]=(0,$.useState)(new Set),[tn,tl]=(0,$.useState)(new Set),[ta,to]=(0,$.useState)(t.showRawColumns),[th,tu]=(0,$.useState)(!1),[tc,td]=(0,$.useState)(t.expandRequestContent),[tm,tp]=(0,$.useState)(t.expandResponseContent),[tf,tg]=(0,$.useState)(!0),[tv,tx]=(0,$.useState)("idle"),[tw,tb]=(0,$.useState)(null),[ty,tS]=(0,$.useState)(!1),[tj,tM]=(0,$.useState)(t.timerEnabled),[tC,tN]=(0,$.useState)(t.timerInterval),tP=(0,$.useRef)(null),[tk,tE]=(0,$.useState)(!1),tR=(0,$.useRef)(!1),[t_,tT]=(0,$.useState)(null),[tL,tI]=(0,$.useState)(!1),[tA,tF]=(0,$.useState)([]),[tz,tD]=(0,$.useState)(1),[tO,tB]=(0,$.useState)(new Map),[t$,tW]=(0,$.useState)(new Set),[tV,tK]=(0,$.useState)([]),[tU,tH]=(0,$.useState)([]),[tJ,tq]=(0,$.useState)([]),[tY,tX]=(0,$.useState)(""),[tG,tQ]=(0,$.useState)(!1),[tZ,t0]=(0,$.useState)(!1),[t1,t2]=(0,$.useState)(null),[t3,t5]=(0,$.useState)(()=>{{let e=localStorage.getItem("klineLimit");return e?Number.parseInt(e):100}}),[t4,t6]=(0,$.useState)(()=>localStorage.getItem("tradingPair")||"BTCUSDT"),[t9,t8]=(0,$.useState)(()=>localStorage.getItem("klineInterval")||"1h"),[t7,ie]=(0,$.useState)(null),[it,ii]=(0,$.useState)([]),[is,ir]=(0,$.useState)(!1),[il,ia]=(0,$.useState)(""),[io,ih]=(0,$.useState)(()=>{{let e=localStorage.getItem("klineEndTime");return e?Number.parseInt(e):void 0}});(0,$.useEffect)(()=>{localStorage.setItem("tradingPair",t4)},[t4]),(0,$.useEffect)(()=>{localStorage.setItem("klineInterval",t9)},[t9]),(0,$.useEffect)(()=>{localStorage.setItem("klineLimit",t3.toString())},[t3]),(0,$.useEffect)(()=>{void 0!==io?localStorage.setItem("klineEndTime",io.toString()):localStorage.removeItem("klineEndTime")},[io]);let{toast:iu}=uU(),ic=ew.endsWith("/")?ew.slice(0,-1):ew,id=(0,$.useCallback)(async(e,t,i,s)=>{ir(!0),console.log("[v0] Fetching K-line data:",{pair:e,interval:t,limit:i,endTime:s});try{let r=s?`&endTime=${s}`:"",n=await fetch(`https://api.binance.com/api/v3/klines?symbol=${e}&interval=${t}&limit=${i}${r}`);if(!n.ok)throw Error("Failed to fetch kline data");let l=(await n.json()).map(e=>({time:e[0],open:Number.parseFloat(e[1]),high:Number.parseFloat(e[2]),low:Number.parseFloat(e[3]),close:Number.parseFloat(e[4]),volume:Number.parseFloat(e[5])}));return ii(l),l}catch(e){throw console.error("Error fetching kline data:",e),iu({variant:"destructive",title:"èŽ·å–Kçº¿æ•°æ®å¤±è´¥",description:e instanceof Error?e.message:"è¯·æ£€æŸ¥äº¤æ˜“å¯¹æ˜¯å¦æ­£ç¡®"}),e}finally{ir(!1)}},[iu]),im=(0,$.useRef)(t4),ip=(0,$.useRef)(t9),ig=(0,$.useRef)(t3),iv=(0,$.useRef)(io);(0,$.useEffect)(()=>{im.current=t4},[t4]),(0,$.useEffect)(()=>{ip.current=t9},[t9]),(0,$.useEffect)(()=>{ig.current=t3},[t3]),(0,$.useEffect)(()=>{iv.current=io},[io]);let ix=(0,$.useCallback)(async()=>{let e=im.current,t=ip.current,i=ig.current,s=iv.current;return console.log("[v0] Force reloading K-line data with current parameters:",{tradingPair:e,klineInterval:t,klineLimit:i,klineEndTime:s}),await id(e,t,i,s)},[id]);(0,$.useEffect)(()=>{console.log("[v0] K-line chart settings effect triggered"),localStorage.setItem("tradingPair",t4),localStorage.setItem("klineInterval",t9),localStorage.setItem("klineLimit",t3.toString()),void 0!==io?localStorage.setItem("klineEndTime",io.toString()):localStorage.removeItem("klineEndTime")},[t4,t9,t3,io]),(0,$.useEffect)(()=>{console.log("[v0] K-line data fetch effect triggered:",{tradingPair:t4,klineInterval:t9,klineLimit:t3,klineEndTime:io}),t4&&t9&&id(t4,t9,t3,io)},[t4,t9,t3,io,id]);let iw=(0,$.useCallback)(e=>{let t=new Date(new Date(e).getTime()+288e5),i=t.getUTCFullYear(),s=String(t.getUTCMonth()+1).padStart(2,"0"),r=String(t.getUTCDate()).padStart(2,"0"),n=String(t.getUTCHours()).padStart(2,"0"),l=String(t.getUTCMinutes()).padStart(2,"0"),a=String(t.getUTCSeconds()).padStart(2,"0");return`${i}-${s}-${r}T${n}:${l}:${a}+08:00`},[]),ib=(0,$.useCallback)(e=>{switch(e.type){case"MA":return`MA(${e.params.period})`;case"EMA":return`EMA(${e.params.period})`;case"MACD":return`MACD(${e.params.fastPeriod},${e.params.slowPeriod},${e.params.signalPeriod})`;case"BOLL":return`BOLL(${e.params.period},${e.params.stdDev})`;case"RSI":return`RSI(${e.params.period})`;case"KDJ":return`KDJ(${e.params.period},${e.params.kPeriod},${e.params.dPeriod})`;case"ATR":return`ATR(${e.params.period})`;case"MFI":return`MFI(${e.params.period})`;case"VOL":return"VOL";case"VWAP":return"VWAP";case"OBV":return"OBV";case"VPT":return"VPT";default:return e.type}},[]),iy=(0,$.useCallback)(e=>{if(!e||0===e.length)return"";let t=e.map(e=>({time:iw(e.time),open:e.open,high:e.high,low:e.low,close:e.close,volume:e.volume})),i=[];return e_.forEach(t=>{let s=t.params??{},r=[];switch(t.type){case"MA":t.params.period&&(r=hW(e,t.params.period).map(e=>({time:iw(e.time),value:e.value})));break;case"EMA":t.params.period&&(r=hV(e,t.params.period).map(e=>({time:iw(e.time),value:e.value})));break;case"MACD":t.params.fastPeriod&&t.params.slowPeriod&&t.params.signalPeriod&&(r=hK(e,t.params.fastPeriod,t.params.slowPeriod,t.params.signalPeriod).map(e=>({time:iw(e.time),macd:e.macd,signal:e.signal,histogram:e.histogram})));break;case"BOLL":t.params.period&&t.params.stdDev&&(r=hU(e,t.params.period,t.params.stdDev).map(e=>({time:iw(e.time),upper:e.upper,middle:e.middle,lower:e.lower})));break;case"RSI":t.params.period&&(r=hH(e,t.params.period).map(e=>({time:iw(e.time),value:e.value})));break;case"KDJ":t.params.period&&(r=hJ(e,t.params.period,t.params.kPeriod||3,t.params.dPeriod||3).map(e=>({time:iw(e.time),k:e.k,d:e.d,j:e.j})));break;case"ATR":t.params.period&&(r=hq(e,t.params.period).map(e=>({time:iw(e.time),value:e.value})));break;case"VOL":r=e.map(e=>({time:iw(e.time),value:e.volume}));break;case"VWAP":r=hY(e).map(e=>({time:iw(e.time),value:e.value}));break;case"OBV":r=hX(e).map(e=>({time:iw(e.time),value:e.value}));break;case"MFI":t.params.period&&(r=hG(e,t.params.period).map(e=>({time:iw(e.time),value:e.value})));break;case"VPT":r=hQ(e).map(e=>({time:iw(e.time),value:e.value}))}r.length>0&&i.push({type:t.type,params:s,data:r})}),JSON.stringify({tradingPair:t4,interval:t9,dataCount:e.length,klineData:t,indicators:i})},[e_,iw,t4,t9]),iS=(0,$.useMemo)(()=>{if(!eP)return null;try{return JSON.parse(eP)}catch{return null}},[eP]);(0,$.useEffect)(()=>{eP||eR("all")},[eP]),(0,$.useEffect)(()=>{if(eE.startsWith("indicator-")){let e=Number.parseInt(eE.replace("indicator-",""),10);iS?.indicators&&iS.indicators[e]||eR("all")}},[eE,iS]);let ij=[{key:"all",label:"å…¨éƒ¨",disabled:!eP},{key:"kline",label:"Kçº¿",disabled:!((iS?.klineData?.length??0)>0)}],iM=(0,$.useMemo)(()=>(iS?.indicators??[]).map((e,t)=>({key:`indicator-${t}`,label:ib({type:e.type,params:e.params??{}}),disabled:!e.data||0===e.data.length})),[iS,ib]),iC=(0,$.useMemo)(()=>{if(!eP)return"";if("all"===eE||!iS)return eP;if("kline"===eE)return JSON.stringify({tradingPair:iS.tradingPair,interval:iS.interval,dataCount:iS.dataCount,klineData:iS.klineData??[]});if(eE.startsWith("indicator-")){let e=Number.parseInt(eE.replace("indicator-",""),10),t=iS.indicators?.[e];return JSON.stringify({tradingPair:iS.tradingPair,interval:iS.interval,indicators:t?[t]:[]})}return eP},[eP,eE,iS]),iN=(0,$.useCallback)((e,t)=>{ek(iy(e)),ie(t.time),iu({title:"Kçº¿æ•°æ®å·²å¡«å…¥",description:`å·²å°† ${e.length} æ¡Kçº¿æ•°æ®å¡«å…¥ä¸Šä¸‹æ–‡`})},[iy,iu]),iP=(0,$.useMemo)(()=>{if("openrouter"===i&&g){let e=g.endsWith(":free")?g.slice(0,-5):g;return x.find(t=>t.id===e)}return"cerebras"===i&&g?b.find(e=>e.id===g):"modelscope"===i&&g?S.find(e=>e.id===g):null},[i,g,x,b,S]),ik=(0,$.useMemo)(()=>{if("modelscope"===i&&iP){let e=iP.task_types;return(Array.isArray(e)?e.includes("ç”Ÿæˆå›¾ç‰‡"):"string"==typeof e&&e.includes("ç”Ÿæˆå›¾ç‰‡"))?"https://api-inference.modelscope.cn/v1/images/generations":"https://api-inference.modelscope.cn/v1/chat/completions"}return`${ic}${ey}`},[i,iP,ic,ey]);(0,$.useEffect)(()=>{(async()=>{try{await cC(),await cR(),console.log("[v0] IndexedDB initialized")}catch(e){console.error("[v0] Failed to initialize IndexedDB:",e)}})()},[]),(0,$.useEffect)(()=>{(async()=>{try{console.log("[v0] Loading data from storage...");let e=localStorage.getItem("llm-api-test-settings");if(e){let t=JSON.parse(e);t.provider&&s(t.provider),t.model&&v(t.model),t.apiKey&&a(t.apiKey),t.baseURL&&eb(t.baseURL),t.apiPath&&eS(t.apiPath),void 0!==t.systemPrompt&&eM(t.systemPrompt),void 0!==t.userMessage&&eN(t.userMessage),void 0!==t.promptFilePath&&eI(t.promptFilePath),void 0!==t.enablePromptFile&&eF(t.enablePromptFile),void 0!==t.systemPromptFilePath&&eU(t.systemPromptFilePath),void 0!==t.autoReloadPrompt&&e2(t.autoReloadPrompt),void 0!==t.autoReloadSystemPrompt&&e5(t.autoReloadSystemPrompt),void 0!==t.autoReloadImages&&e6(t.autoReloadImages),t.maxTokens&&Y(t.maxTokens),void 0!==t.temperature&&G(t.temperature),void 0!==t.topP&&Z(t.topP),void 0!==t.frequencyPenalty&&et(t.frequencyPenalty),void 0!==t.presencePenalty&&es(t.presencePenalty),void 0!==t.showRawColumns&&to(t.showRawColumns),void 0!==t.showRequestContent&&tu(t.showRequestContent),void 0!==t.expandRequestContent&&td(t.expandRequestContent),void 0!==t.expandResponseContent&&tp(t.expandResponseContent),void 0!==t.timerEnabled&&tM(t.timerEnabled),void 0!==t.timerInterval&&tN(t.timerInterval),void 0!==t.maxTokensLimit&&eg(t.maxTokensLimit),void 0!==t.pageSize&&te(t.pageSize),void 0!==t.prompt&&ex(t.prompt),void 0!==t.isParametersExpanded&&tI(t.isParametersExpanded),void 0!==t.isPromptFromLocalFile&&eD(t.isPromptFromLocalFile),void 0!==t.isSystemPromptFromLocalFile&&eY(t.isSystemPromptFromLocalFile),t.selectedInputModalities&&E(t.selectedInputModalities),t.selectedOutputModalities&&_(t.selectedOutputModalities),void 0!==t.modelSearchQuery&&I(t.modelSearchQuery),t.availableInputModalities&&tK(t.availableInputModalities),t.availableOutputModalities&&tH(t.availableOutputModalities),void 0!==t.imageUrl&&tX(t.imageUrl),void 0!==t.showImageUrlInput&&tQ(t.showImageUrlInput),void 0!==t.isAddingImageUrl&&t0(t.isAddingImageUrl),void 0!==t.klineLimit&&t5(t.klineLimit),void 0!==t.klineEndTime&&ih(t.klineEndTime),void 0!==t.parseResponseMarkdown&&tg(t.parseResponseMarkdown),void 0!==t.markedCandleTime&&ie(t.markedCandleTime)}console.log("[v0] Loading images from IndexedDB...");let t=await cE();console.log("[v0] Loaded images from IndexedDB:",t.length,"images"),t.length>0&&(tq(t),console.log("[v0] Set messageImages state with",t.length,"images")),console.log("[v0] Loading history from IndexedDB...");let i=await cP();if(i.length>0)console.log("[v0] Loaded history from IndexedDB:",i.length,"entries"),e8(i),cW(i).then(e=>{tB(e),console.log("[v0] Loaded response images for",e.size,"history items")}).catch(e=>{console.error("[v0] Failed to load response images:",e)});else{let e=localStorage.getItem("llm_api_history");if(e){let t=JSON.parse(e);e8(t),await cN(t)}}let r=localStorage.getItem("modelHistory");if(r)try{tF(JSON.parse(r))}catch(e){console.error("Failed to load model history:",e)}}catch(e){console.error("[v0] Error loading data:",e)}})()},[]),(0,$.useEffect)(()=>{let e={provider:i,model:g,apiKey:l,baseURL:ew,apiPath:ey,systemPrompt:ej,userMessage:eC,promptFilePath:eL,enablePromptFile:eA,systemPromptFilePath:eK,enableSystemPromptFile:eH,autoReloadPrompt:e1,autoReloadSystemPrompt:e3,autoReloadImages:e4,maxTokens:q,temperature:X,topP:Q,frequencyPenalty:ee,presencePenalty:ei,showRawColumns:ta,showRequestContent:th,expandRequestContent:tc,expandResponseContent:tm,timerEnabled:tj,timerInterval:tC,maxTokensLimit:ef,pageSize:e7,prompt:ev,isParametersExpanded:tL,isPromptFromLocalFile:ez,isSystemPromptFromLocalFile:eq,selectedInputModalities:Array.from(k),selectedOutputModalities:Array.from(R),modelSearchQuery:T,availableInputModalities:tV,availableOutputModalities:tU,imageUrl:tY,showImageUrlInput:tG,isAddingImageUrl:tZ,klineLimit:t3,klineEndTime:io,parseResponseMarkdown:tf,markedCandleTime:t7};localStorage.setItem("llm-api-test-settings",JSON.stringify(e))},[i,g,l,ew,ey,ej,eC,eL,eA,eK,eH,e1,e3,e4,q,X,Q,ee,ei,ta,th,tc,tm,tj,tC,ef,e7,ev,tL,ez,eq,k,R,T,tV,tU,tY,tG,tZ,t3,io,tf,t7]),(0,$.useEffect)(()=>{e9.length>0&&cN(e9).catch(e=>{console.error("[v0] Failed to save history to IndexedDB:",e)})},[e9]),(0,$.useEffect)(()=>{console.log("[v0] Saving images to IndexedDB, count:",tJ.length),ck(tJ).catch(e=>{console.error("[v0] Failed to save images to IndexedDB:",e)})},[tJ]);let iE=(e,t)=>{let s={id:Date.now().toString(),timestamp:Date.now(),provider:i,model:g,apiKey:l,baseURL:ew,apiPath:ey,status:e,duration:t};tF(e=>{let t=e.filter(e=>e.provider!==s.provider||e.model!==s.model||e.apiKey!==s.apiKey);return[s,...t]})},iR=async e=>{try{let t=await fetch(e);if(!t.ok)throw Error(`HTTP ${t.status}: ${t.statusText}`);return await t.text()}catch(t){let e="æ— æ³•è¯»å–æŒ‡å®šçš„æ–‡ä»¶è·¯å¾„";return t instanceof TypeError&&t.message.includes("fetch")?e="è·¨åŸŸè®¿é—®è¢«é˜»æ­¢ï¼ˆCORSï¼‰ã€‚è¯·ç¡®ä¿æ–‡ä»¶æœåŠ¡å™¨æ”¯æŒ CORSï¼Œæˆ–ä½¿ç”¨æ”¯æŒ CORS çš„æ–‡ä»¶æ‰˜ç®¡æœåŠ¡ï¼ˆå¦‚ GitHub Gistã€Pastebin ç­‰ï¼‰ã€‚":t instanceof Error&&(e=t.message),iu({variant:"destructive",title:"æ–‡ä»¶è¯»å–å¤±è´¥",description:e}),null}},i_=async e=>{console.log("[v0] handleLocalFileSelect called with type:",e),console.log("[v0] enablePromptFile:",eA,"enableSystemPromptFile:",eH);let t=window.self!==window.top;try{if("showOpenFilePicker"in window&&!t){console.log("[v0] Using File System Access API");let[t]=await window.showOpenFilePicker({types:[{description:"Text Files",accept:{"text/plain":[".txt"],"text/markdown":[".md"]}}],multiple:!1}),i=await t.getFile(),s=await i.text();if(console.log("[v0] File loaded successfully:",i.name,"Content length:",s.length),"prompt"===e){eO.current=t;let e=await cD("promptFileHandle",t);return console.log("[v0] Prompt file handle save result:",e),eD(!0),e$(s),eI(i.name),iu({title:"æ–‡ä»¶åŠ è½½æˆåŠŸ",description:`å·²åŠ è½½æœ¬åœ°æ–‡ä»¶: ${i.name}`}),s}{eX.current=t;let e=await cD("systemPromptFileHandle",t);return console.log("[v0] System prompt file handle save result:",e),eY(!0),eQ(s),eU(i.name),iu({title:"æ–‡ä»¶åŠ è½½æˆåŠŸ",description:`å·²åŠ è½½æœ¬åœ°æ–‡ä»¶: ${i.name}`}),s}}}catch(e){console.log("[v0] File System Access API failed, falling back to input method:",e)}return console.log("[v0] Using fallback file input method"),new Promise(t=>{let i=document.createElement("input");i.type="file",i.accept=".txt,.md",i.onchange=async i=>{let s=i.target.files?.[0];if(s){console.log("[v0] Fallback file selected:",s.name);let i=await s.text();"prompt"===e?(eO.current=null,eD(!0),e$(i),eI(s.name)):(eX.current=null,eY(!0),eQ(i),eU(s.name)),iu({title:"æ–‡ä»¶åŠ è½½æˆåŠŸ",description:`å·²åŠ è½½æœ¬åœ°æ–‡ä»¶: ${s.name}`}),t(i)}else console.log("[v0] No file selected in fallback method"),t(null)},i.click()})},iT=async e=>{let t="prompt"===e?eO:eX,i="prompt"===e?e$:eQ,s="prompt"===e?"promptFileHandle":"systemPromptFileHandle";console.log(`[v0] reloadLocalFile called for ${e}`),console.log("[v0] Current ref handle:",t.current?"exists":"null");let r=t.current;if(r||(console.log(`[v0] Attempting to restore ${e} handle from IndexedDB`),(r=await cO(s))?(t.current=r,console.log(`[v0] Restored ${e} file handle from IndexedDB successfully`)):console.log(`[v0] No ${e} handle found in IndexedDB`)),r){console.log(`[v0] Have handle for ${e}, verifying permission...`);try{let t=await cF(r);if(console.log(`[v0] Permission result for ${e}:`,t),t){let t=await r.getFile(),s=await t.text();return i(s),console.log(`[v0] Reloaded ${e} from file handle with permission, content length:`,s.length),s}console.log(`[v0] Permission denied for ${e} file handle`)}catch(e){console.log("[v0] Failed to reload from file handle:",e),t.current=null,await cB(s)}}return console.log(`[v0] File handle missing for ${e}, prompting user to re-select`),iu({title:"éœ€è¦é‡æ–°é€‰æ‹©æ–‡ä»¶",description:"è¯·ç‚¹å‡»ç¡®è®¤æŽˆæƒæ–‡ä»¶è®¿é—®ï¼Œæˆ–é‡æ–°é€‰æ‹©æ–‡ä»¶ã€‚"}),await i_(e)},iL=e=>e.startsWith("http://")||e.startsWith("https://");(0,$.useEffect)(()=>{eA&&eL&&iL(eL)&&!ez?iR(eL).then(e=>{e$(e||"")}).catch(e=>{console.error("Failed to load prompt file:",e),e$("")}):eA||(e$(""),eD(!1),eO.current=null,cB("promptFileHandle"))},[eA,eL,ez]),(0,$.useEffect)(()=>{eH&&eK&&iL(eK)&&!eq?iR(eK).then(e=>{eQ(e||"")}).catch(e=>{console.error("Failed to load system prompt file:",e),eQ("")}):eH||(eQ(""),eY(!1),eX.current=null,cB("systemPromptFileHandle"))},[eH,eK,eq]);let iI=async()=>{if(0===tJ.length)return tJ;console.log("[v0] Reloading images and clearing cache...");let e=[];for(let t of tJ)if("url"===t.type&&t.url)try{let i=t.url.includes("?")?`${t.url}&_t=${Date.now()}`:`${t.url}?_t=${Date.now()}`,s=await fetch(i,{cache:"no-store"});if(!s.ok){console.error(`[v0] Failed to reload image from ${t.url}:`,s.statusText),e.push(t);continue}let r=await s.blob(),n=await new Promise((e,t)=>{let i=new FileReader;i.onload=t=>e(t.target?.result),i.onerror=t,i.readAsDataURL(r)});e.push({...t,base64:n,mimeType:r.type}),console.log(`[v0] Reloaded image from ${t.url}`)}catch(i){console.error(`[v0] Error reloading image from ${t.url}:`,i),e.push(t)}else e.push(t);return tq(e),console.log("[v0] Image reload complete"),e},iA=async()=>{if(l&&g&&ik&&!ty){tS(!0),iu({title:"æŽ¢é’ˆæµ‹è¯•å¼€å§‹",description:`æä¾›å•†: ${i}, æ¨¡åž‹: ${g}`,className:"bg-blue-50 border-blue-200",duration:3e3});try{let e,t=performance.now(),s="modelscope"===i&&iP&&(e=iP.task_types,Array.isArray(e)?e.includes("ç”Ÿæˆå›¾ç‰‡"):"string"==typeof e&&e.includes("ç”Ÿæˆå›¾ç‰‡")),r={model:g,max_tokens:100,temperature:1,top_p:1,frequency_penalty:0,presence_penalty:0};s?r.prompt="hello":r.messages=[{role:"system",content:ej},{role:"user",content:"hello"}];let n=await fetch(ik,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`},body:JSON.stringify(r),signal:AbortSignal.timeout(1e4)}),a=Math.round(performance.now()-t);tb(a);let o=n.headers.get("content-type");if(!o?.includes("application/json")){await n.text(),tx("error"),iE("error",a),iu({variant:"destructive",title:"æŽ¢é’ˆæµ‹è¯•å¤±è´¥",description:`æœåŠ¡å™¨è¿”å›žéžJSONå“åº” (çŠ¶æ€ç : ${n.status})`,duration:3e3}),tS(!1);return}let h=await n.json();n.ok&&h.choices?.[0]?.message?(tx("success"),iE("success",a),iu({title:"æŽ¢é’ˆæµ‹è¯•æˆåŠŸ",description:`API é…ç½®æ­£å¸¸ï¼Œå“åº”ç”¨æ—¶: ${a}ms`,className:"bg-green-50 border-green-200",duration:3e3})):(tx("error"),iE("error",a),iu({variant:"destructive",title:"æŽ¢é’ˆæµ‹è¯•å¤±è´¥",description:h.error?.message||"API è¿”å›žå¼‚å¸¸",duration:3e3}))}catch(e){tx("error"),tb(null),iE("error",null),iu({variant:"destructive",title:"æŽ¢é’ˆæµ‹è¯•å¤±è´¥",description:e instanceof Error?e.message:"ç½‘ç»œè¯·æ±‚å¤±è´¥",duration:3e3})}finally{tS(!1)}}};(0,$.useEffect)(()=>{if(l&&g&&ik){let e=setTimeout(()=>{iA()},5e3);return()=>clearTimeout(e)}tx("idle")},[l,g,ik]);let iF=async()=>{C(!0);try{let e=await fetch("https://models.xiechengqi.top/cerebras.json");if(e.ok){let t=await e.json();console.log("[v0] Fetched Cerebras models:",t);let i=Array.isArray(t)?t:t.models||t.data||[];y(i)}else console.error("[v0] Failed to fetch Cerebras models:",e.statusText),y([])}catch(e){console.error("[v0] Error fetching Cerebras models:",e),y([])}finally{C(!1)}},iz=async()=>{C(!0);try{let e=await fetch("https://models.xiechengqi.top/modelscope.json");if(e.ok){let t=await e.json();console.log("[v0] Fetched ModelScope models:",t);let i=Array.isArray(t)?t:t.models||t.data||[];j(i)}else console.error("[v0] Failed to fetch ModelScope models:",e.statusText),j([])}catch(e){console.error("[v0] Error fetching ModelScope models:",e),j([])}finally{C(!1)}},iD=async()=>{C(!0);try{let e=await fetch("https://models.xiechengqi.top/openrouter.json");if(e.ok){let t=await e.json();console.log("[v0] Fetched OpenRouter models:",t);let i=Array.isArray(t)?t:t.models||t.data||[];w(i)}else console.error("[v0] Failed to fetch OpenRouter models:",e.statusText),w([])}catch(e){console.error("[v0] Error fetching OpenRouter models:",e),w([])}finally{C(!1)}};(0,$.useEffect)(()=>{"openrouter"===i?iD():"cerebras"===i?iF():"modelscope"===i?iz():(tK([]),tH([]))},[i]);let iO=async(e,s)=>{let r;console.log("[v0] handleTest called, loading:",el),ea(!0),ep(""),eu(""),ed(""),tT(null),eo.current=new AbortController;let n=tJ;if(e4&&tJ.some(e=>"url"===e.type)){console.log("[v0] Auto-reloading images before test...");let e=iu({title:"æ­£åœ¨é‡è½½å›¾ç‰‡",description:`æ­£åœ¨é‡æ–°åŠ è½½ ${tJ.filter(e=>"url"===e.type).length} å¼ å›¾ç‰‡...`,duration:1/0});n=await iI(),e.dismiss(),iu({title:"å›¾ç‰‡é‡è½½å®Œæˆ",description:"æ‰€æœ‰å›¾ç‰‡å·²æ›´æ–°ï¼Œå¼€å§‹æµ‹è¯•...",className:"bg-green-50 border-green-200",duration:2e3})}if(!l){ep("Please provide an API key"),iu({variant:"destructive",title:"é”™è¯¯",description:"è¯·æä¾› API Key"}),ea(!1);return}let a=g||t.model;console.log("[v0] enablePromptFile:",eA),console.log("[v0] autoReloadPrompt:",e1),console.log("[v0] isPromptFromLocalFile:",ez),console.log("[v0] promptFileHandleRef.current:",eO.current),console.log("[v0] promptFilePath:",eL);let o=ej;if(eH&&eK.trim())if(console.log("[v0] System prompt external loading enabled"),e3)if(console.log("[v0] Auto reload system prompt is ON"),eK.trim().startsWith("http://")||eK.trim().startsWith("https://")){console.log("[v0] Reloading system prompt from HTTP URL");let e=await iR(eK.trim());null!==e?(eQ(e),o=e,console.log("[v0] Reloaded system prompt from URL, length:",e.length)):o=eG||ej}else if(eq){console.log("[v0] Reloading system prompt from local file");let e=await iT("systemPrompt");null!==e?(o=e,console.log("[v0] Reloaded system prompt from local file, length:",e.length)):o=eG||ej}else o=eG||ej;else console.log("[v0] Using cached system prompt content"),o=eG||ej;console.log("[v0] Final system prompt length:",o.length),console.log("[v0] enablePromptFile:",eA),console.log("[v0] autoReloadPrompt:",e1),console.log("[v0] isPromptFromLocalFile:",ez),console.log("[v0] promptFileHandleRef.current:",eO.current),console.log("[v0] promptFilePath:",eL);let h=void 0!==e?e:eC;if(eA&&eL.trim())if(console.log("[v0] User message external loading enabled"),e1)if(console.log("[v0] Auto reload prompt is ON"),eL.trim().startsWith("http://")||eL.trim().startsWith("https://")){console.log("[v0] Reloading user message from HTTP URL");let e=await iR(eL.trim());null!==e?(e$(e),h=e,console.log("[v0] Reloaded user message from URL, length:",e.length)):h=eB||eC}else if(ez){console.log("[v0] Reloading user message from local file");let e=await iT("prompt");null!==e?(h=e,console.log("[v0] Reloaded user message from local file, length:",e.length)):h=eB||eC}else h=eB||eC;else console.log("[v0] Using cached user message content"),h=eB||eC;console.log("[v0] Final user message length:",h.length);let u=void 0!==s?s:eP,c=u;if(u&&u.trim())try{let e=u.trim(),t=JSON.parse(e);c=JSON.stringify(t),console.log("[v0] Context compressed successfully. Original length:",e.length,"Compressed length:",c.length),console.log("[v0] Compressed context preview:",c.substring(0,150))}catch(e){console.log("[v0] Context is not valid JSON, error:",e),console.log("[v0] Context preview:",u.substring(0,150)),c=u}let d=h;if(u&&h)try{let e=JSON.parse(u),t=u.trim(),i=c.trim();if(h.trim()===t||h.trim()===i)d="";else if(h.startsWith(t+"\n\n"))d=h.substring(t.length+2);else if(h.startsWith(i+"\n\n"))d=h.substring(i.length+2);else{let t=h.match(/^(\{[\s\S]*?\})\n\n/);if(t)try{let i=JSON.parse(t[1]);JSON.stringify(i)===JSON.stringify(e)&&(d=h.substring(t[0].length))}catch(e){}}}catch(e){h.trim()===u.trim()?d="":h.startsWith(u+"\n\n")&&(d=h.substring(u.length+2))}let m=c?`${c}

${d}`:d;c&&c!==eP&&(console.log("[v0] Context was compressed. Original length:",eP.length,"Compressed length:",c.length),console.log("[v0] Compressed context preview:",c.substring(0,200)));let p=[{role:"user",content:n.length>0?[{type:"text",text:m},...n.map(e=>({type:"image_url",image_url:{url:e.url}}))]:[{type:"text",text:m}]},{role:"system",content:o}],f="modelscope"===i&&iP&&(Array.isArray(r=iP.task_types)?r.includes("ç”Ÿæˆå›¾ç‰‡"):"string"==typeof r&&r.includes("ç”Ÿæˆå›¾ç‰‡")),v={model:a,max_tokens:q,temperature:X,top_p:Q,frequency_penalty:ee,presence_penalty:ei,stream:er};f?v.prompt=h:v.messages=p,console.log("[v0] Generating request with user message length:",h.length);let x=["Content-Type: application/json",`Authorization: Bearer ${l}`],w=`curl ${ik} \\
  -X POST \\
  ${x.map(e=>`-H "${e}" \\`).join("\n  ")}
  -d '${JSON.stringify(v,null,2).replace(/\n/g,"\n  ")}'`;eu(w),console.log("[v0] Request curl generated, length:",w.length);let b=new AbortController,y=setTimeout(()=>{b.abort()},6e4);try{let e;console.log("[v0] Sending request to:",ik);let t=performance.now(),i=await fetch(ik,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`},body:JSON.stringify(v),signal:eo.current.signal});clearTimeout(y);let s=performance.now(),r=Math.round(s-t);tT(r);let n=await i.text();try{e=JSON.parse(n)}catch{e=n}let o=JSON.stringify({status:i.status,statusText:i.statusText,headers:Object.fromEntries(i.headers.entries()),body:e},null,2);ed(o);let h=JSON.stringify(p),d="",m=[],f=e?.images;if(f&&Array.isArray(f)&&f.length>0){let t=f.map(e=>e.url).filter(e=>e&&(e.startsWith("http://")||e.startsWith("https://")));if(t.length>0){let e=Date.now();m=t.map((t,i)=>({id:`response-${e}-${i}`,type:"url",url:t})),d=t.join("\n")}else d=JSON.stringify(e)}else{let t=e?.choices?.[0]?.message?.content,i=e?.content?.[0]?.text;if(t||e?.choices?.[0]?.message){let i=e?.choices?.[0]?.message?.reasoning_details?.[0]?.text,s=e?.choices?.[0]?.message?.reasoning_content||e?.choices?.[0]?.message?.reasoning;d=i?t?`<Thinking>
${i}
</Thinking>

${t}`:i:s?t?`<Thinking>
${s}
</Thinking>

${t}`:s:t||JSON.stringify(e?.choices?.[0]?.message)}else d=i||JSON.stringify(e)}let g=Date.now(),x=[];try{let e=JSON.parse(c||u||"null");e&&"object"==typeof e&&(e.klineData&&Array.isArray(e.klineData)&&e.klineData.length>0&&x.push("Kçº¿"),e.indicators&&Array.isArray(e.indicators)&&e.indicators.forEach(e=>{let t=e?.type,i=e?.params||{};switch(t){case"MA":case"EMA":case"ATR":case"RSI":case"MFI":x.push(`${t}(${i.period??"?"})`);break;case"MACD":x.push(`MACD(${i.fastPeriod??"?"},${i.slowPeriod??"?"},${i.signalPeriod??"?"})`);break;case"BOLL":x.push(`BOLL(${i.period??"?"},${i.stdDev??"?"})`);break;case"KDJ":x.push(`KDJ(${i.period??"?"},${i.kPeriod??"?"},${i.dPeriod??"?"})`);break;case"VOL":case"VWAP":case"OBV":case"VPT":x.push(t);break;default:"string"==typeof t&&x.push(t)}}))}catch(e){console.warn("[v0] Failed to parse context for tags:",e)}let b={id:g.toString(),timestamp:g,model:a,tradingPair:t4,requestContent:h,requestRaw:w,responseContent:d,responseRaw:o,duration:r,contextTags:x};if(m.length>0&&c_(g,m).then(()=>{let e=m.map(e=>e.base64||e.url||"").filter(Boolean);e.length>0&&tB(t=>{let i=new Map(t);return i.set(g,e),i})}).catch(e=>{console.error("[v0] Failed to save response images to IndexedDB:",e)}),e8(e=>{let t=[b,...e];return cN(t).catch(e=>{console.error("[v0] Failed to save history to IndexedDB:",e)}),t}),i.ok)iu({title:"è¯·æ±‚æˆåŠŸ",description:`API å“åº”çŠ¶æ€: ${i.status}`});else{let t=`API Error: ${i.status} - ${e.error?.message||i.statusText}`;ep(t),iu({variant:"destructive",title:"è¯·æ±‚å¤±è´¥",description:`çŠ¶æ€ç  ${i.status}: ${e.error?.message||i.statusText}`})}}catch(i){clearTimeout(y),console.error("[v0] Error during test:",i),"AbortError"===i.name?(ep("æµ‹è¯•å·²ä¸­æ–­"),iu({title:"æµ‹è¯•å·²ä¸­æ–­",description:"æµ‹è¯•å·²è¢«ç”¨æˆ·ä¸­æ–­",duration:2e3})):i.message.includes("API key")?(ep(i.message),iu({variant:"destructive",title:"é”™è¯¯",description:i.message})):(ep(i.message||"An error occurred"),iu({variant:"destructive",title:"é”™è¯¯",description:i.message||"å‘ç”ŸæœªçŸ¥é”™è¯¯"}));let e=JSON.stringify({error:i.message||"Unknown error"});ed(e),tT(null);let t={id:Date.now().toString(),timestamp:Date.now(),model:a,tradingPair:t4,requestContent:"",requestRaw:"",responseContent:"",responseRaw:e,duration:null,contextTags:[]};e8(e=>{let i=[t,...e];return cN(i).catch(e=>{console.error("[v0] Failed to save history to IndexedDB:",e)}),i})}finally{ea(!1),eo.current=null,tR.current&&iB()}},iB=async()=>{tR.current&&(tP.current&&clearTimeout(tP.current),tP.current=setTimeout(async()=>{if(tR.current)if(null===t7){console.log("[v0] Timer tick: No selected candle, reloading K-line data...");try{let e=await ix();if(e&&e.length>0){let t=iy(e);t&&(ek(t),console.log("[v0] Timer tick: Updated user message with fresh K-line data")),iO(void 0,t)}else iO()}catch(e){console.error("[v0] Timer tick: Error reloading K-line data:",e),iO()}}else console.log("[v0] Timer tick: Selected candle exists, using existing message"),iO()},1e3*tC))},i$=(e,t)=>{tP.current&&clearTimeout(tP.current),tR.current=!0,tE(!0),iO(e,t)},iW=()=>{tP.current&&(clearTimeout(tP.current),tP.current=null),tR.current=!1,tE(!1)},iV=async()=>{if(console.log("[v0] handleStartTest called, checking for selected candle..."),null!==t7)console.log("[v0] Selected candle exists, proceeding without reload");else{console.log("[v0] No selected candle, clearing context and reloading K-line data..."),ek(""),iu({title:"æ­£åœ¨é‡è½½Kçº¿æ•°æ®",description:"è¯·ç¨ç­‰...",duration:2e3});try{let e=await ix();if(console.log("[v0] K-line data reload completed, data length:",e?.length||0),!e||!(e.length>0))return void iu({variant:"destructive",title:"Kçº¿æ•°æ®ä¸ºç©º",description:"æ— æ³•èŽ·å–Kçº¿æ•°æ®ï¼Œè¯·æ£€æŸ¥å‚æ•°è®¾ç½®"});{let t=iy(e);ek(t),console.log("[v0] Overwrote user message with K-line data, length:",t.length),iu({title:"Kçº¿æ•°æ®å·²æ·»åŠ ",description:`å·²å°† ${e.length} æ¡Kçº¿æ•°æ®æ·»åŠ åˆ°ä¸Šä¸‹æ–‡ä¸­`,className:"bg-green-50 border-green-200",duration:2e3}),tj?i$(void 0,t):iO(void 0,t);return}}catch(e){console.error("[v0] Error reloading K-line data:",e),iu({variant:"destructive",title:"Kçº¿æ•°æ®åŠ è½½å¤±è´¥",description:"è¯·é‡è¯•æˆ–æ£€æŸ¥ç½‘ç»œè¿žæŽ¥"});return}}tj?i$():iO()},iK=()=>{ex(t.prompt),Y(t.maxTokens),G(t.temperature),Z(t.topP),et(t.frequencyPenalty),es(t.presencePenalty),en(!1),tM(t.timerEnabled),tN(t.timerInterval),iW(),to(t.showRawColumns),td(t.expandRequestContent),tp(t.expandResponseContent),eM(t.systemPrompt),eN(t.userMessage),eI(t.promptFilePath),eF(t.enablePromptFile),e2(t.autoReloadPrompt),e5(t.autoReloadSystemPrompt),e6(t.autoReloadImages),tq([]),tX(""),tQ(!1),t0(!1),ii([]),ih(void 0),t5(100),ie(null),localStorage.removeItem("llm-api-test-settings")},iU=async e=>{if(!e.apiKey||!e.model)return;let t=e.baseURL?`${e.baseURL}${e.apiPath}`:e.apiPath;iu({title:"æŽ¢é’ˆæµ‹è¯•å¼€å§‹",description:`æä¾›å•†: ${e.provider}, æ¨¡åž‹: ${e.model}`,className:"bg-blue-50 border-blue-200",duration:3e3});try{let i=performance.now(),s={model:e.model,messages:[{role:"system",content:ej},{role:"user",content:"hello"}],max_tokens:100,temperature:1,top_p:1,frequency_penalty:0,presence_penalty:0},r=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e.apiKey}`},body:JSON.stringify(s),signal:AbortSignal.timeout(1e4)}),n=Math.round(performance.now()-i),l=r.headers.get("content-type");if(!l?.includes("application/json")){tF(t=>t.map(t=>t.id===e.id?{...t,status:"error",duration:n}:t)),iu({variant:"destructive",title:"æŽ¢é’ˆæµ‹è¯•å¤±è´¥",description:`æœåŠ¡å™¨è¿”å›žéžJSONå“åº” (çŠ¶æ€ç : ${r.status})`,duration:3e3});return}let a=await r.json();r.ok&&a.choices?.[0]?.message?(tF(t=>t.map(t=>t.id===e.id?{...t,status:"success",duration:n}:t)),iu({title:"æŽ¢é’ˆæµ‹è¯•æˆåŠŸ",description:`API é…ç½®æ­£å¸¸ï¼Œå“åº”ç”¨æ—¶: ${n}ms`,className:"bg-green-50 border-green-200",duration:3e3})):(tF(t=>t.map(t=>t.id===e.id?{...t,status:"error",duration:n}:t)),iu({variant:"destructive",title:"æŽ¢é’ˆæµ‹è¯•å¤±è´¥",description:a.error?.message||"API è¿”å›žå¼‚å¸¸",duration:3e3}))}catch(t){tF(t=>t.map(t=>t.id===e.id?{...t,status:"error",duration:null}:t)),iu({variant:"destructive",title:"æŽ¢é’ˆæµ‹è¯•å¤±è´¥",description:t instanceof Error?t.message:"æœªçŸ¥é”™è¯¯",duration:3e3})}},iH=e=>{tr(t=>{let i=new Set(t);return i.has(e)?i.delete(e):i.add(e),i})},iJ=e=>{tl(t=>{let i=new Set(t);return i.has(e)?i.delete(e):i.add(e),i})},iq=Math.ceil(e9.length/e7),iY=e9.slice((tt-1)*e7,tt*e7),[iX,iG]=(0,$.useState)("å¤åˆ¶"),[iQ,iZ]=(0,$.useState)("å¤åˆ¶"),i0=async(e,t)=>{let i="request"===t?iG:iZ;try{await navigator.clipboard.writeText(e),i("å·²å¤åˆ¶!"),setTimeout(()=>i("å¤åˆ¶"),2e3)}catch(s){let t=document.createElement("textarea");t.value=e,t.style.position="fixed",t.style.left="-999999px",document.body.appendChild(t),t.select();try{document.execCommand("copy"),i("å·²å¤åˆ¶!"),setTimeout(()=>i("å¤åˆ¶"),2e3)}catch(e){iu({title:"å¤åˆ¶å¤±è´¥",description:"æ— æ³•è®¿é—®å‰ªè´´æ¿ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶",variant:"destructive"})}document.body.removeChild(t)}},i1=e=>{let t=[],i=e,s=0,r=(i=(i=(i=(i=i.replace(/\*\*([^*]+?)\*\*/g,(e,i)=>{let r=`bold-${s++}`;return t.push({key:r,element:(0,L.jsx)("strong",{children:i},r)}),`<<${r}>>`})).replace(/(?<!\*)\*([^*\n]+?)\*(?!\*)/g,(e,i)=>{let r=`italic-${s++}`;return t.push({key:r,element:(0,L.jsx)("em",{children:i},r)}),`<<${r}>>`})).replace(/`([^`]+?)`/g,(e,i)=>{let r=`code-${s++}`;return t.push({key:r,element:(0,L.jsx)("code",{className:"bg-muted px-1 py-0.5 rounded text-xs",children:i},r)}),`<<${r}>>`})).replace(/\[([^\]]+?)\]\(([^)]+?)\)/g,(e,i,r)=>{let n=`link-${s++}`;return t.push({key:n,element:(0,L.jsx)("a",{href:r,className:"text-primary underline",target:"_blank",rel:"noopener noreferrer",children:i},n)}),`<<${n}>>`})).split(/(<<[^>]+>>)/),n=[];return r.forEach(e=>{if(e.startsWith("<<")&&e.endsWith(">>")){let i=e.slice(2,-2),s=t.find(e=>e.key===i);s?n.push(s.element):n.push(e)}else e&&n.push(e)}),n.length>0?n:e};(0,$.useEffect)(()=>{if(tA.length>0)try{localStorage.setItem("modelHistory",JSON.stringify(tA))}catch(e){console.error("[v0] Failed to save model history to localStorage:",e)}},[tA]);let i2=Math.ceil(tA.length/5),i3=tA.slice((tz-1)*5,5*tz),i5=(0,$.useMemo)(()=>{let e=x;if(T.trim()){let t=T.toLowerCase();e=e.filter(e=>{let i=e.id.toLowerCase().includes(t),s=e.name?.toLowerCase().includes(t)||!1;return i||s})}return e},[x,T]),i4=(0,$.useMemo)(()=>{let e=b;if(T.trim()){let t=T.toLowerCase();e=e.filter(e=>{let i=e.id.toLowerCase().includes(t),s=e.name?.toLowerCase().includes(t)||!1;return i||s})}return e},[b,T]),i6=(0,$.useMemo)(()=>{let e=S;if(T.trim()){let t=T.toLowerCase();e=e.filter(e=>{let i=e.id.toLowerCase().includes(t),s=e.name?.toLowerCase().includes(t)||!1;return i||s})}return e},[S,T]),i9=(0,$.useMemo)(()=>"openrouter"===i&&g&&iP||"cerebras"===i&&g&&iP||"modelscope"===i&&g&&iP?iP.name||iP.id:g||"",[i,g,iP]),i8=async e=>{try{let t=await fetch("https://libretranslate.de/translate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({q:e,source:"en",target:"zh",format:"text"})});if(t.ok){let e=await t.json();if(e.translatedText)return console.log("[v0] LibreTranslate ç¿»è¯‘æˆåŠŸ"),e.translatedText}}catch(e){console.warn("[v0] LibreTranslate ç¿»è¯‘å¤±è´¥:",e)}return null},i7=async e=>{try{let t=await fetch(`https://translate.googleapis.com/translate_a/single?client=gtx&sl=en&tl=zh-CN&dt=t&q=${encodeURIComponent(e)}`);if(t.ok){let e=await t.json();if(e&&e[0]&&Array.isArray(e[0])){let t=e[0].map(e=>e[0]).join("");if(t)return console.log("[v0] Google Translate ç¿»è¯‘æˆåŠŸ"),t}}}catch(e){console.warn("[v0] Google Translate ç¿»è¯‘å¤±è´¥:",e)}return null},se=async e=>{try{let t=await fetch(`https://api.mymemory.translated.net/get?q=${encodeURIComponent(e)}&langpair=en|zh-CN`);if(t.ok){let e=await t.json();if(console.log("[v0] MyMemory API å“åº”:",e),429===e.responseStatus||e.responseData?.translatedText&&e.responseData.translatedText.includes("MYMEMORY WARNING"))return console.warn("[v0] MyMemory API é…é¢å·²ç”¨å°½"),null;if(e.responseData&&e.responseData.translatedText)return console.log("[v0] MyMemory ç¿»è¯‘æˆåŠŸ"),e.responseData.translatedText}else 429===t.status&&console.warn("[v0] MyMemory API é…é¢å·²ç”¨å°½ (HTTP 429)")}catch(e){console.warn("[v0] MyMemory API ç¿»è¯‘å¤±è´¥:",e)}return null},st=(0,$.useCallback)(async e=>{if(!e)return void console.log("[v0] translateDescription: æ–‡æœ¬ä¸ºç©ºï¼Œè·³è¿‡ç¿»è¯‘");console.log("[v0] translateDescription: å¼€å§‹ç¿»è¯‘ï¼Œæ–‡æœ¬é•¿åº¦:",e.length),U(!0),V(""),J("");try{if(e.length<=500){let t=null;(t=await se(e))||(console.log("[v0] åˆ‡æ¢åˆ°å¤‡ç”¨ç¿»è¯‘ API: LibreTranslate"),t=await i8(e)),t||(console.log("[v0] åˆ‡æ¢åˆ°å¤‡ç”¨ç¿»è¯‘ API: Google Translate"),t=await i7(e)),t?(console.log("[v0] ç¿»è¯‘æˆåŠŸ:",t.substring(0,100)),V(t)):(console.warn("[v0] æ‰€æœ‰ç¿»è¯‘ API éƒ½å¤±è´¥äº†"),V(""),J("ç¿»è¯‘å¤±è´¥ï¼šæ‰€æœ‰ç¿»è¯‘æœåŠ¡æš‚æ—¶ä¸å¯ç”¨ï¼Œè¯·ç¨åŽé‡è¯•"))}else{let t=[];for(let i=0;i<e.length;i+=500){let s=e.substring(i,i+500);t.push(s)}let i=[],s=!1,r="mymemory";for(let e of t){let t=null;"mymemory"===r&&((t=await se(e))||(console.log("[v0] MyMemory å¤±è´¥ï¼Œåˆ‡æ¢åˆ° LibreTranslate"),r="libretranslate")),!t&&"libretranslate"===r&&((t=await i8(e))||(console.log("[v0] LibreTranslate å¤±è´¥ï¼Œåˆ‡æ¢åˆ° Google Translate"),r="google")),t||"google"!==r||(t=await i7(e)),t?i.push(t):(i.push(e),s=!0),await new Promise(e=>setTimeout(e,100))}s&&J("ç¿»è¯‘å¤±è´¥ï¼šéƒ¨åˆ†å†…å®¹æ— æ³•ç¿»è¯‘"),V(i.join(""))}}catch(e){console.error("[v0] Error translating description:",e),V(""),J(`ç¿»è¯‘å¤±è´¥ï¼š${e instanceof Error?e.message:"ç½‘ç»œè¯·æ±‚å¤±è´¥"}`)}finally{U(!1)}},[]);(0,$.useEffect)(()=>{if(console.log("[v0] Translation useEffect è§¦å‘:",{provider:i,hasDescription:!!iP?.description,descriptionLength:iP?.description?.length,modelId:iP?.id}),V(""),U(!1),J(""),"openrouter"===i&&iP?.description){let e=iP.description.trim();if(!e)return void console.log("[v0] Translation: description ä¸ºç©ºï¼Œè·³è¿‡ç¿»è¯‘");let t=/[\u4e00-\u9fa5]/.test(e);if(console.log("[v0] Translation: æ£€æŸ¥ä¸­æ–‡",{hasChinese:t,descriptionPreview:e.substring(0,50)}),t)console.log("[v0] Translation: æ–‡æœ¬å·²åŒ…å«ä¸­æ–‡ï¼Œè·³è¿‡ç¿»è¯‘");else{console.log("[v0] Translation: å‡†å¤‡ç¿»è¯‘ï¼Œå»¶è¿Ÿ 100ms");let t=setTimeout(()=>{console.log("[v0] Translation: å¼€å§‹è°ƒç”¨ translateDescription"),st(e)},100);return()=>{console.log("[v0] Translation: æ¸…ç†å®šæ—¶å™¨"),clearTimeout(t)}}}else console.log("[v0] Translation: æ¡ä»¶ä¸æ»¡è¶³",{provider:i,hasDescription:!!iP?.description})},[i,iP?.description,iP?.id,st]);let si=async()=>{if(!tY.trim())return void iu({variant:"destructive",title:"é”™è¯¯",description:"è¯·è¾“å…¥å›¾ç‰‡é“¾æŽ¥"});t0(!0);try{let e=tY.trim().includes("?")?`${tY.trim()}&_t=${Date.now()}`:`${tY.trim()}?_t=${Date.now()}`,t=await fetch(e,{cache:"no-store"});if(!t.ok)throw Error(`HTTP ${t.status}: ${t.statusText}`);let i=await t.blob();if(!i.type.startsWith("image/")){iu({variant:"destructive",title:"é”™è¯¯",description:"URL ä¸æ˜¯æœ‰æ•ˆçš„å›¾ç‰‡"}),t0(!1);return}let s=new FileReader;s.onload=e=>{let t=e.target?.result,s={id:Date.now().toString(),type:"url",url:tY.trim(),base64:t,mimeType:i.type};tq(e=>[...e,s]),tX(""),tQ(!1),t0(!1),iu({title:"æˆåŠŸ",description:"å›¾ç‰‡å·²åŠ è½½å¹¶æ·»åŠ "})},s.onerror=()=>{iu({variant:"destructive",title:"é”™è¯¯",description:"è½¬æ¢å›¾ç‰‡å¤±è´¥"}),t0(!1)},s.readAsDataURL(i)}catch(e){console.error("[v0] Error loading image from URL:",e),t0(!1),iu({variant:"destructive",title:"åŠ è½½å¤±è´¥",description:e instanceof Error?e.message:"æ— æ³•åŠ è½½å›¾ç‰‡"})}},ss=async()=>{let e=document.createElement("input");e.type="file",e.accept="image/*",e.onchange=async e=>{let t=e.target.files?.[0];if(t){if(!t.type.startsWith("image/"))return void iu({variant:"destructive",title:"é”™è¯¯",description:"è¯·é€‰æ‹©å›¾ç‰‡æ–‡ä»¶"});try{let e=new FileReader;e.onload=e=>{let i=e.target?.result,s={id:Date.now().toString(),type:"file",base64:i,mimeType:t.type,name:t.name};tq(e=>[...e,s]),iu({title:"æˆåŠŸ",description:`å›¾ç‰‡ ${t.name} å·²æ·»åŠ `}),e4&&(console.log("[v0] Auto-reloading images after upload..."),iO())},e.onerror=()=>{iu({variant:"destructive",title:"é”™è¯¯",description:"è¯»å–å›¾ç‰‡æ–‡ä»¶å¤±è´¥"})},e.readAsDataURL(t)}catch(e){console.error("[v0] Error reading image file:",e),iu({variant:"destructive",title:"é”™è¯¯",description:"è¯»å–å›¾ç‰‡æ–‡ä»¶å¤±è´¥"})}}},e.click()};return(0,$.useEffect)(()=>{e4&&tJ.some(e=>"url"===e.type)&&console.log("[v0] Auto-reload images is enabled, images will be reloaded before next test")},[e4,tJ]),(0,L.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,L.jsx)(cy,{}),(0,L.jsxs)("nav",{className:"border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:[(0,L.jsxs)("div",{className:"flex h-16 items-center gap-4 px-4 md:px-8",children:[(0,L.jsxs)("div",{className:"flex items-center gap-2",children:[(0,L.jsx)(ut,{className:"size-6 text-primary"}),"idle"!==tv&&(0,L.jsxs)("div",{className:"ml-2 flex items-center gap-1.5",children:[(0,L.jsx)("div",{className:`size-2 rounded-full ${"success"===tv?"bg-green-500":"bg-red-500"}`,title:"success"===tv?"API é…ç½®æ­£å¸¸":"API é…ç½®å¼‚å¸¸"}),"success"===tv&&tw&&(0,L.jsxs)("span",{className:"text-xs text-muted-foreground",children:[tw,"ms"]}),(0,L.jsx)(s4.Button,{variant:"ghost",size:"sm",onClick:iA,disabled:ty||!l||!g||!ik,className:"h-6 px-2",title:"é‡æ–°æµ‹è¯•",children:ty?(0,L.jsx)(s5,{className:"size-3 animate-spin"}):(0,L.jsx)(ua,{className:"size-3"})})]})]}),(0,L.jsxs)("div",{className:"ml-auto flex items-center gap-3",children:[(0,L.jsxs)(a$,{value:i,onValueChange:e=>{s(e);let t=c$.find(t=>t.id===e);if(t)if(t.endpoint)try{let e=new URL(t.endpoint);eb(e.origin),eS(e.pathname)}catch(e){console.error("Invalid endpoint format:",t.endpoint,e),eb(""),eS(t.endpoint)}else eb(""),eS("/v1/chat/completions");"openrouter"===e?iD():"cerebras"===e?iF():"modelscope"===e&&(iz(),eb("https://api-inference.modelscope.cn"),eS("/v1/chat/completions"))},children:[(0,L.jsx)(aV,{className:"w-[180px]",children:(0,L.jsx)(aW,{placeholder:"æä¾›å•†",children:c$.find(e=>e.id===i)?.name})}),(0,L.jsx)(aK,{children:c$.map(e=>(0,L.jsx)(aU,{value:e.id,children:(0,L.jsxs)("div",{className:"flex flex-col gap-0.5",children:[(0,L.jsx)("span",{className:"font-medium",children:e.name}),e.endpoint&&(0,L.jsx)("span",{className:"text-xs text-muted-foreground",children:e.endpoint})]})},e.id))})]}),"openrouter"===i||"cerebras"===i||"modelscope"===i?(0,L.jsx)("div",{className:"flex items-center gap-2",children:N?(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(h_,{value:g,onChange:e=>v(e.target.value),placeholder:"è¾“å…¥è‡ªå®šä¹‰æ¨¡åž‹ ID",className:"w-[280px]"}),(0,L.jsx)(s4.Button,{variant:"ghost",size:"sm",onClick:()=>P(!1),title:"è¿”å›žä¸‹æ‹‰é€‰æ‹©",children:(0,L.jsx)(h3,{className:"size-4"})})]}):(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)(oa,{children:[(0,L.jsx)(oo,{asChild:!0,children:(0,L.jsx)(s4.Button,{variant:"outline",role:"combobox",disabled:M,className:"w-[280px] justify-between bg-transparent",children:(0,L.jsx)("span",{className:"truncate",children:i9||(M?"åŠ è½½ä¸­...":"é€‰æ‹©æ¨¡åž‹")})})}),(0,L.jsx)(oh,{className:"w-[280px] p-0",align:"start",children:(0,L.jsxs)(hC,{children:[(0,L.jsx)(hN,{placeholder:"æœç´¢æ¨¡åž‹...",value:T,onValueChange:I}),(0,L.jsxs)(hP,{children:[(0,L.jsx)(hk,{children:"æœªæ‰¾åˆ°æ¨¡åž‹"}),(0,L.jsx)(hE,{children:"openrouter"===i?i5.map(e=>{let t=e.name?.includes("(free)")?`${e.id}:free`:e.id,i=[e.id,e.name].filter(Boolean).join(" ");return(0,L.jsx)(hR,{value:i,onSelect:()=>{v(t)},children:(0,L.jsxs)("div",{className:"flex flex-col gap-0.5",children:[(0,L.jsx)("span",{className:"font-medium",children:e.name||e.id}),e.context_length&&(0,L.jsxs)("span",{className:"text-xs text-muted-foreground",children:[e.context_length," tokens"]})]})},e.id)}):"cerebras"===i?i4.map(e=>{let t=[e.id,e.name].filter(Boolean).join(" ");return(0,L.jsx)(hR,{value:t,onSelect:()=>{v(e.id)},children:(0,L.jsxs)("div",{className:"flex flex-col gap-0.5",children:[(0,L.jsx)("span",{className:"font-medium",children:e.name||e.id}),e.context_length&&(0,L.jsxs)("span",{className:"text-xs text-muted-foreground",children:[e.context_length," tokens"]})]})},e.id)}):i6.map(e=>{let t=[e.id,e.name].filter(Boolean).join(" ");return(0,L.jsx)(hR,{value:t,onSelect:()=>{v(e.id)},children:(0,L.jsxs)("div",{className:"flex flex-col gap-0.5",children:[(0,L.jsx)("span",{className:"font-medium",children:e.name||e.id}),e.context_length&&(0,L.jsxs)("span",{className:"text-xs text-muted-foreground",children:[e.context_length," tokens"]}),e.task_types&&(0,L.jsx)("span",{className:"text-xs text-muted-foreground",children:Array.isArray(e.task_types)?e.task_types.join(", "):e.task_types})]})},e.id)})})]})]})})]}),(0,L.jsx)(s4.Button,{variant:"ghost",size:"sm",onClick:()=>P(!0),title:"è‡ªå®šä¹‰æ¨¡åž‹",children:(0,L.jsx)(h2,{className:"size-4"})})]})}):(0,L.jsx)(h_,{value:g,onChange:e=>v(e.target.value),placeholder:"eg: gpt-3.5-turbo",className:"w-[200px]"}),(0,L.jsxs)("div",{className:"relative flex items-center",children:[(0,L.jsx)(h_,{type:o?"text":"password",value:l,onChange:e=>a(e.target.value),placeholder:"API Key",className:"w-[200px] pr-10"}),(0,L.jsx)(s4.Button,{variant:"ghost",size:"sm",onClick:()=>h(!o),className:"absolute right-0 h-full px-3 hover:bg-transparent",title:o?"éšè— API Key":"æ˜¾ç¤º API Key",children:o?(0,L.jsx)(hA,{className:"size-4"}):(0,L.jsx)(hI,{className:"size-4"})})]}),(0,L.jsxs)(s4.Button,{variant:"outline",size:"sm",onClick:()=>{s(t.provider),eb(t.baseURL),eS(t.apiPath),a(""),v(""),ep(""),h(!1),tx("idle"),eM(t.systemPrompt),eN(t.userMessage),ek(""),m(!1),eI(t.promptFilePath),eF(t.enablePromptFile),eU(t.systemPromptFilePath),eJ(t.enableSystemPromptFile),eQ(""),eD(!1),eO.current=null,eY(!1),eX.current=null,cB("promptFileHandle"),cB("systemPromptFileHandle"),E([]),_([]),I(""),tK([]),tH([]),tq([]),tX(""),tQ(!1),t0(!1),e6(t.autoReloadImages),ii([]),ih(void 0),t5(100),ie(null),localStorage.removeItem("llm-api-test-settings"),iK()},children:[(0,L.jsx)(h5,{className:"mr-2 size-4"}),"é‡ç½®"]})]})]}),("custom"===i||!c$.find(e=>e.id===i)?.endpoint)&&(0,L.jsxs)("div",{className:"border-t px-4 py-3 md:px-8",children:[(0,L.jsxs)("div",{className:"flex items-center gap-2",children:[(0,L.jsx)(hL,{htmlFor:"baseURL",className:"text-sm font-medium whitespace-nowrap",children:"Base URL"}),(0,L.jsx)(h_,{id:"baseURL",value:ew,onChange:e=>eb(e.target.value),placeholder:"https://api.example.com",className:"max-w-2xl"})]}),(0,L.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,L.jsx)(hL,{htmlFor:"apiPath",className:"text-sm font-medium whitespace-nowrap",children:"API Path"}),(0,L.jsx)(h_,{id:"apiPath",value:ey,onChange:e=>eS(e.target.value),placeholder:"/v1/chat/completions",className:"max-w-2xl"})]})]})]}),("openrouter"===i||"cerebras"===i||"modelscope"===i)&&iP&&(0,L.jsx)("div",{className:"border-b bg-muted/30 px-4 py-3 md:px-8",children:(0,L.jsxs)("div",{className:"max-w-7xl mx-auto space-y-2",children:[iP.description&&(0,L.jsx)("div",{className:"space-y-2",children:K?(0,L.jsxs)("p",{className:"text-sm text-muted-foreground leading-relaxed",children:[iP.description,(0,L.jsx)("span",{className:"ml-2 text-xs opacity-60",children:"ç¿»è¯‘ä¸­..."})]}):W?(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)("p",{className:"text-sm text-muted-foreground leading-relaxed",children:W}),(0,L.jsxs)("details",{className:"text-xs",children:[(0,L.jsx)("summary",{className:"cursor-pointer text-muted-foreground hover:text-foreground",children:"æŸ¥çœ‹åŽŸæ–‡"}),(0,L.jsx)("p",{className:"mt-2 text-muted-foreground leading-relaxed",children:iP.description})]})]}):H?(0,L.jsxs)("div",{className:"space-y-1",children:[(0,L.jsx)("p",{className:"text-sm text-destructive leading-relaxed",children:H}),(0,L.jsxs)("details",{className:"text-xs",children:[(0,L.jsx)("summary",{className:"cursor-pointer text-muted-foreground hover:text-foreground",children:"æŸ¥çœ‹åŽŸæ–‡"}),(0,L.jsx)("p",{className:"mt-2 text-muted-foreground leading-relaxed",children:iP.description})]})]}):(0,L.jsx)("p",{className:"text-sm text-muted-foreground leading-relaxed",children:iP.description})}),(0,L.jsxs)("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[iP.link&&(e=iP.name?.includes("(free)")?`${iP.link}:free`:iP.link,(0,L.jsxs)("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 hover:text-primary transition-colors",children:[(0,L.jsx)(un,{className:"size-3"}),"æŸ¥çœ‹æ¨¡åž‹è¯¦æƒ…"]})),iP.pub_date&&(0,L.jsx)("span",{className:"flex items-center gap-1",children:(0,L.jsxs)("span",{children:["å‘å¸ƒæ—¥æœŸ: ",iP.pub_date]})}),"modelscope"===i&&(0,L.jsxs)(L.Fragment,{children:[iP.time&&(0,L.jsx)("span",{className:"flex items-center gap-1",children:(0,L.jsx)("span",{children:iP.time})}),iP.task_types&&(0,L.jsx)("span",{className:"flex items-center gap-1",children:(0,L.jsx)("span",{children:Array.isArray(iP.task_types)?iP.task_types.join(", "):iP.task_types})}),void 0!==iP.downloads&&(0,L.jsxs)("span",{className:"flex items-center gap-1",children:[(0,L.jsx)(ue,{className:"size-3"}),(0,L.jsx)("span",{children:iP.downloads.toLocaleString()})]}),void 0!==iP.stars&&(0,L.jsxs)("span",{className:"flex items-center gap-1",children:[(0,L.jsx)(uo,{className:"size-3 fill-current"}),(0,L.jsx)("span",{children:iP.stars.toLocaleString()})]})]})]})]})}),(0,L.jsxs)("main",{className:"container mx-auto p-4 md:p-8 space-y-6",children:[(0,L.jsxs)(h0.Card,{children:[(0,L.jsx)(h0.CardHeader,{children:(0,L.jsxs)("div",{className:"flex items-center justify-between",children:[(0,L.jsxs)("div",{children:[(0,L.jsx)(h0.CardTitle,{children:"åŽ†å²æ¨¡åž‹"}),(0,L.jsxs)(h0.CardDescription,{children:["å·²æµ‹è¯•çš„æ¨¡åž‹é…ç½®åŽ†å² (å…± ",tA.length," æ¡)"]})]}),(0,L.jsxs)("div",{className:"flex items-center gap-2",children:[(0,L.jsxs)(s4.Button,{variant:"outline",size:"sm",onClick:()=>{tF([]),tD(1);try{localStorage.removeItem("modelHistory")}catch(e){console.error("[v0] Failed to clear model history from localStorage:",e)}iu({title:"åŽ†å²è®°å½•å·²æ¸…ç©º",duration:2e3})},disabled:0===tA.length,children:[(0,L.jsx)(h5,{className:"mr-2 size-4"}),"æ¸…ç©º"]}),(0,L.jsxs)(s4.Button,{variant:"outline",size:"sm",onClick:()=>{if(0===tA.length)return void iu({variant:"destructive",title:"æ— æ•°æ®å¯¼å‡º",description:"åŽ†å²è®°å½•ä¸ºç©º",duration:2e3});let e=new Blob(["\uFEFF"+["æ—¶é—´,æä¾›å•†,æ¨¡åž‹å,API Key,çŠ¶æ€,å“åº”å»¶è¿Ÿ(ms)",...tA.map(e=>[new Date(e.timestamp).toLocaleString("zh-CN"),e.provider,e.model,e.apiKey.substring(0,10)+"...","success"===e.status?"æˆåŠŸ":"error"===e.status?"å¤±è´¥":"æœªæµ‹è¯•",e.duration?e.duration.toString():"N/A"]).map(e=>e.map(e=>`"${e}"`).join(","))].join("\n")],{type:"text/csv;charset=utf-8;"}),t=document.createElement("a");t.href=URL.createObjectURL(e),t.download=`model-history-${Date.now()}.csv`,t.click(),iu({title:"å¯¼å‡ºæˆåŠŸ",description:`å·²å¯¼å‡º ${tA.length} æ¡è®°å½•`,className:"bg-green-50 border-green-200",duration:2e3})},disabled:0===tA.length,children:[(0,L.jsx)(ue,{className:"mr-2 size-4"}),"å¯¼å‡º"]})]})]})}),(0,L.jsx)(h0.CardContent,{children:0===tA.length?(0,L.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"æš‚æ— åŽ†å²è®°å½•"}):(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)("div",{className:"border rounded-lg overflow-hidden",children:(0,L.jsx)("div",{className:"overflow-x-auto",children:(0,L.jsxs)(A,{children:[(0,L.jsx)(F,{children:(0,L.jsxs)(D,{children:[(0,L.jsx)(O,{className:"w-[140px]",children:"æ—¶é—´"}),(0,L.jsx)(O,{className:"w-[120px]",children:"æä¾›å•†"}),(0,L.jsx)(O,{children:"æ¨¡åž‹"}),(0,L.jsx)(O,{className:"w-[150px]",children:"API Key"}),(0,L.jsx)(O,{className:"w-[100px]",children:"çŠ¶æ€"}),(0,L.jsx)(O,{className:"w-[100px]",children:"å»¶è¿Ÿ"}),(0,L.jsx)(O,{className:"w-[160px] text-center",children:"æ“ä½œ"})]})}),(0,L.jsx)(z,{children:i3.map(e=>(0,L.jsxs)(D,{children:[(0,L.jsx)(B,{className:"text-xs",children:new Date(e.timestamp).toLocaleString("zh-CN",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}),(0,L.jsx)(B,{className:"text-xs",children:e.provider}),(0,L.jsx)(B,{className:"text-xs font-mono",children:e.model}),(0,L.jsx)(B,{className:"text-xs",children:(0,L.jsxs)("div",{className:"flex items-center gap-1",children:[(0,L.jsx)("span",{className:"font-mono",children:t$.has(e.id)?e.apiKey:`${e.apiKey.substring(0,10)}...`}),(0,L.jsx)(s4.Button,{variant:"ghost",size:"sm",onClick:()=>{var t;return t=e.id,void tW(e=>{let i=new Set(e);return i.has(t)?i.delete(t):i.add(t),i})},className:"h-6 w-6 p-0",children:t$.has(e.id)?(0,L.jsx)(hA,{className:"size-3"}):(0,L.jsx)(hI,{className:"size-3"})})]})}),(0,L.jsx)(B,{children:(0,L.jsx)("span",{className:`text-xs px-2 py-1 rounded ${"success"===e.status?"bg-green-100 text-green-700":"error"===e.status?"bg-red-100 text-red-700":"bg-gray-100 text-gray-700"}`,children:"success"===e.status?"æˆåŠŸ":"error"===e.status?"å¤±è´¥":"æœªæµ‹è¯•"})}),(0,L.jsx)(B,{className:"text-xs",children:null!==e.duration?`${e.duration}ms`:"-"}),(0,L.jsx)(B,{className:"text-center",children:(0,L.jsxs)("div",{className:"flex items-center justify-center gap-1",children:[(0,L.jsx)(s4.Button,{variant:"outline",size:"sm",onClick:()=>{s(e.provider),v(e.model),a(e.apiKey),eb(e.baseURL),eS(e.apiPath),eD(!1),eO.current=null,eY(!1),eX.current=null,iu({title:"é…ç½®å·²åº”ç”¨",description:`å·²åº”ç”¨ ${e.provider} - ${e.model} çš„é…ç½®`,className:"bg-blue-50 border-blue-200",duration:2e3})},className:"h-7 text-xs",children:"åº”ç”¨"}),(0,L.jsx)(s4.Button,{variant:"outline",size:"sm",onClick:()=>iU(e),className:"h-7 text-xs",children:"æµ‹è¯•"}),(0,L.jsx)(s4.Button,{variant:"ghost",size:"sm",onClick:()=>{var t;return t=e.id,void(tF(e=>e.filter(e=>e.id!==t)),iu({title:"è®°å½•å·²åˆ é™¤",duration:2e3}))},className:"h-7 w-7 p-0",children:(0,L.jsx)(h4,{className:"size-4"})})]})})]},e.id))})]})})}),i2>1&&(0,L.jsxs)("div",{className:"flex items-center justify-between mt-4",children:[(0,L.jsxs)("div",{className:"text-sm text-muted-foreground",children:["ç¬¬ ",tz," / ",i2," é¡µ"]}),(0,L.jsxs)("div",{className:"flex items-center gap-2",children:[(0,L.jsxs)(s4.Button,{variant:"outline",size:"sm",onClick:()=>tD(e=>Math.max(1,e-1)),disabled:1===tz,children:[(0,L.jsx)(h6,{className:"size-4"}),"ä¸Šä¸€é¡µ"]}),(0,L.jsxs)(s4.Button,{variant:"outline",size:"sm",onClick:()=>tD(e=>Math.min(i2,e+1)),disabled:tz===i2,children:["ä¸‹ä¸€é¡µ",(0,L.jsx)(h9,{className:"size-4"})]})]})]})]})})]}),(0,L.jsxs)(h0.Card,{children:[(0,L.jsx)(h0.CardHeader,{children:(0,L.jsx)("div",{className:"flex items-center justify-between",children:(0,L.jsxs)("div",{children:[(0,L.jsx)(h0.CardTitle,{children:"Kçº¿å›¾"}),(0,L.jsx)(h0.CardDescription,{children:"ç‚¹å‡»Kçº¿æ—¶é—´ç‚¹å°†æ•°æ®å¡«å…¥ä¸Šä¸‹æ–‡ï¼Œæˆ–é€‰æ‹©æ—¶é—´ç‚¹åŠ è½½åŽ†å²æ•°æ®"})]})})}),(0,L.jsx)(h0.CardContent,{className:"p-6",children:(0,L.jsx)(hZ,{data:it,onCandleClick:iN,isLoading:is,tradingPair:t4,onTradingPairChange:t6,klineInterval:t9,onIntervalChange:t8,popularPairs:["BTCUSDT","ETHUSDT","BNBUSDT","SOLUSDT","XRPUSDT","ADAUSDT","DOGEUSDT","MATICUSDT","DOTUSDT","AVAXUSDT"],intervals:[{value:"1m",label:"1åˆ†é’Ÿ"},{value:"5m",label:"5åˆ†é’Ÿ"},{value:"15m",label:"15åˆ†é’Ÿ"},{value:"30m",label:"30åˆ†é’Ÿ"},{value:"1h",label:"1å°æ—¶"},{value:"4h",label:"4å°æ—¶"},{value:"1d",label:"1å¤©"},{value:"1w",label:"1å‘¨"}],onTimePointChange:ih,endTime:io,limit:t3,onLimitChange:t5,onForceReload:ix,markedCandleTime:t7,onMarkedCandleTimeChange:ie,onIndicatorsChange:eT})})]}),(0,L.jsxs)(h0.Card,{children:[(0,L.jsx)(h0.CardHeader,{children:(0,L.jsxs)("div",{className:"flex items-center justify-between",children:[(0,L.jsxs)("div",{className:"flex items-center gap-2",children:[(0,L.jsx)(s4.Button,{variant:"ghost",size:"sm",onClick:()=>tI(!tL),children:tL?(0,L.jsx)(aB,{className:"size-4"}):(0,L.jsx)(aO,{className:"size-4"})}),(0,L.jsxs)("div",{children:[(0,L.jsx)(h0.CardTitle,{children:"å‚æ•°é…ç½®"}),(0,L.jsx)(h0.CardDescription,{children:"è°ƒæ•´ Chat Completion å‚æ•°"})]})]}),(0,L.jsxs)("div",{className:"flex items-center gap-2",children:[(0,L.jsxs)(s4.Button,{variant:"outline",size:"sm",onClick:iK,children:[(0,L.jsx)(h5,{className:"mr-2 size-4"}),"é‡ç½®å‚æ•°"]}),tk?(0,L.jsxs)(s4.Button,{onClick:iW,variant:"destructive",size:"sm",children:[(0,L.jsx)(h7,{className:"mr-2 size-4"}),"åœæ­¢å®šæ—¶"]}):el?(0,L.jsxs)(s4.Button,{onClick:()=>{console.log("[v0] handleInterruptTest called"),eo.current&&(eo.current.abort(),ea(!1),eo.current=null,iu({title:"æµ‹è¯•å·²ä¸­æ–­",description:"æµ‹è¯•å·²è¢«ç”¨æˆ·ä¸­æ–­",duration:2e3}))},variant:"destructive",size:"sm",children:[(0,L.jsx)(hF.X,{className:"mr-2 size-4"}),"ä¸­æ–­"]}):(0,L.jsxs)(s4.Button,{onClick:iV,disabled:el,size:"sm",children:[(0,L.jsx)(h8,{className:"mr-2 size-4"}),"å¼€å§‹æµ‹è¯•"]})]})]})}),tL&&(0,L.jsx)(h0.CardContent,{className:"space-y-4",children:(0,L.jsxs)("div",{className:"space-y-4",children:[(0,L.jsxs)("div",{children:[(0,L.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,L.jsxs)("div",{children:[(0,L.jsx)(hL,{htmlFor:"context",children:"ä¸Šä¸‹æ–‡"}),(0,L.jsx)("p",{className:"text-xs text-muted-foreground",children:"Kçº¿æ•°æ®ç­‰ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼ˆåªè¯»ï¼‰"}),eP&&(0,L.jsx)("div",{className:"flex flex-wrap items-center gap-2 mt-2",children:[...ij,...iM].map(e=>(0,L.jsx)(s4.Button,{type:"button",variant:eE===e.key?"default":"outline",size:"sm",disabled:e.disabled,onClick:()=>eR(e.key),className:"h-7 px-2 text-xs",children:e.label},e.key))})]}),(0,L.jsxs)("div",{className:"flex items-center gap-2",children:[eP&&(0,L.jsx)(s4.Button,{type:"button",variant:"ghost",size:"sm",onClick:()=>m(!d),className:"h-7 px-2 text-xs",children:d?(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(aB,{className:"mr-1 h-3.5 w-3.5"}),"æ”¶èµ·"]}):(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(aO,{className:"mr-1 h-3.5 w-3.5"}),"å±•å¼€"]})}),eP&&(0,L.jsx)(s4.Button,{type:"button",variant:"ghost",size:"sm",onClick:()=>ek(""),className:"h-7 px-2 text-xs",children:"æ¸…é™¤"})]})]}),(0,L.jsx)(uh,{id:"context",value:iC,readOnly:!0,placeholder:"ç‚¹å‡»Kçº¿æ—¶é—´ç‚¹å°†æ•°æ®å¡«å…¥æ­¤å¤„...",rows:4,className:`bg-muted/50 cursor-not-allowed resize-none ${d?"":"max-h-32 overflow-y-auto"}`})]}),!eA&&(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)("div",{className:"flex items-center justify-between",children:[(0,L.jsxs)("div",{children:[(0,L.jsx)(hL,{htmlFor:"userMessage",children:"ç”¨æˆ·æ¶ˆæ¯"}),(0,L.jsx)("p",{className:"text-xs text-muted-foreground",children:"è¾“å…¥æµ‹è¯•ç”¨çš„æ¶ˆæ¯å†…å®¹"})]}),(0,L.jsx)(s4.Button,{type:"button",variant:"ghost",size:"sm",onClick:()=>c(!u),children:u?(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(aB,{className:"mr-1 h-4 w-4"}),"æ”¶èµ·"]}):(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(aO,{className:"mr-1 h-4 w-4"}),"å±•å¼€"]})})]}),(0,L.jsx)(uh,{id:"userMessage",value:eC,onChange:e=>eN(e.target.value),placeholder:"è¾“å…¥ä½ çš„æç¤ºè¯...",rows:3,className:u?"":"max-h-32 overflow-y-auto"})]}),(0,L.jsxs)("div",{className:"space-y-2 pt-2",children:[(0,L.jsxs)("div",{className:"flex items-center justify-between",children:[(0,L.jsxs)(hL,{className:"flex items-center gap-1.5",children:[(0,L.jsx)(ur,{className:"h-3.5 w-3.5"}),"å›¾ç‰‡é™„ä»¶"]}),(0,L.jsxs)("div",{className:"flex items-center gap-2",children:[(0,L.jsxs)(s4.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>tQ(!tG),children:[(0,L.jsx)(un,{className:"mr-1 h-3.5 w-3.5"}),"æ·»åŠ é“¾æŽ¥"]}),(0,L.jsxs)(s4.Button,{type:"button",variant:"outline",size:"sm",onClick:ss,children:[(0,L.jsx)(us,{className:"h-4 w-4 mr-1"}),"ä¸Šä¼ æ–‡ä»¶"]}),(0,L.jsxs)("div",{className:"flex items-center gap-2 ml-auto",children:[(0,L.jsx)("input",{type:"checkbox",id:"autoReloadImages",checked:e4,onChange:e=>e6(e.target.checked),className:"h-4 w-4 rounded border-input bg-background accent-primary cursor-pointer"}),(0,L.jsx)(hL,{htmlFor:"autoReloadImages",className:"cursor-pointer font-normal text-sm",children:"è‡ªåŠ¨é‡è½½"})]})]})]}),tG&&(0,L.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,L.jsxs)("div",{className:"flex gap-2",children:[(0,L.jsx)(h_,{placeholder:"è¾“å…¥å›¾ç‰‡é“¾æŽ¥ (https://...)",value:tY,onChange:e=>tX(e.target.value),onKeyDown:e=>{"Enter"===e.key&&si()},disabled:tZ}),(0,L.jsx)(s4.Button,{onClick:si,size:"sm",disabled:tZ,children:tZ?(0,L.jsx)(L.Fragment,{children:(0,L.jsx)(s5,{className:"h-4 w-4 animate-spin"})}):"æ·»åŠ "}),(0,L.jsx)(s4.Button,{onClick:()=>{tQ(!1),tX("")},variant:"ghost",size:"sm",disabled:tZ,children:"å–æ¶ˆ"})]}),(0,L.jsx)("p",{className:"text-xs text-muted-foreground",children:"ç¤ºä¾‹: https://api.btstu.cn/sjbz/api.php?lx=dongman&format=images"})]}),tJ.length>0&&(0,L.jsx)("div",{className:"grid grid-cols-2 gap-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5",children:tJ.map(e=>(0,L.jsxs)("div",{className:"relative group rounded-md border overflow-hidden",children:[(0,L.jsx)("img",{src:e.base64||e.url,alt:e.name||"Image",className:"w-full h-24 object-cover cursor-pointer hover:opacity-80 transition-opacity",onClick:()=>t2(e)}),(0,L.jsxs)("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-2",children:[(0,L.jsx)(s4.Button,{type:"button",variant:"secondary",size:"sm",onClick:()=>t2(e),title:"æ”¾å¤§æŸ¥çœ‹",children:(0,L.jsx)(ul,{className:"h-4 w-4"})}),(0,L.jsx)(s4.Button,{type:"button",variant:"destructive",size:"sm",onClick:()=>{var t;return t=e.id,void tq(e=>e.filter(e=>e.id!==t))},title:"åˆ é™¤å›¾ç‰‡",children:(0,L.jsx)(hF.X,{className:"h-4 w-4"})})]})]},e.id))})]}),(0,L.jsxs)("div",{className:"space-y-1.5 pt-2",children:[(0,L.jsxs)("div",{className:"flex items-center justify-between",children:[(0,L.jsxs)(hL,{className:"flex items-center gap-1.5",children:[(0,L.jsx)(ui,{className:"h-3.5 w-3.5"}),"ä»Žå¤–éƒ¨åŠ è½½ç”¨æˆ·æ¶ˆæ¯"]}),(0,L.jsxs)("div",{className:"flex items-center gap-2",children:[(0,L.jsx)("input",{type:"checkbox",id:"enablePromptFile",checked:eA,onChange:e=>eF(e.target.checked),className:"h-4 w-4 rounded border-input bg-background accent-primary cursor-pointer"}),(0,L.jsx)(hL,{htmlFor:"enablePromptFile",className:"cursor-pointer font-normal text-sm",children:"å¯ç”¨"}),(0,L.jsx)("input",{type:"checkbox",id:"autoReloadPrompt",checked:e1,onChange:e=>e2(e.target.checked),disabled:!eA,className:"h-4 w-4 rounded border-input bg-background accent-primary cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed"}),(0,L.jsx)(hL,{htmlFor:"autoReloadPrompt",className:"cursor-pointer font-normal text-sm",children:"è‡ªåŠ¨é‡è½½"})]})]}),eA&&(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)("div",{className:"flex gap-2",children:[(0,L.jsx)(h_,{id:"promptFilePath",value:eL,onChange:e=>{eI(e.target.value),eD(!1),eO.current=null,e$("")},placeholder:"https://example.com/prompt.txt æˆ–ç‚¹å‡»é€‰æ‹©æœ¬åœ°æ–‡ä»¶",className:"text-sm flex-1"}),(0,L.jsxs)(s4.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>i_("prompt"),className:"shrink-0",children:[(0,L.jsx)(us,{className:"h-4 w-4 mr-1"}),"é€‰æ‹©æ–‡ä»¶"]})]}),(0,L.jsx)("p",{className:"text-xs text-muted-foreground",children:'æ”¯æŒ HTTP/HTTPS é“¾æŽ¥æˆ–æœ¬åœ°æ–‡ä»¶ã€‚ç‚¹å‡»"é€‰æ‹©æ–‡ä»¶"æŒ‰é’®å¯ç›´æŽ¥é€‰æ‹©æœ¬åœ° .txt æˆ– .md æ–‡ä»¶ã€‚'})]}),eA&&eB&&(0,L.jsxs)("div",{className:"space-y-1.5 pt-2",children:[(0,L.jsxs)("div",{className:"flex items-center justify-between",children:[(0,L.jsxs)(hL,{className:"text-xs text-muted-foreground flex items-center gap-1.5",children:["å¤–éƒ¨åŠ è½½çš„æ¶ˆæ¯é¢„è§ˆ",ez&&(0,L.jsx)("span",{className:"bg-blue-100 text-blue-700 px-1.5 py-0.5 rounded text-[10px]",children:"æœ¬åœ°æ–‡ä»¶"})]}),(0,L.jsxs)("div",{className:"flex items-center gap-1",children:[ez&&eO.current&&(0,L.jsx)(s4.Button,{type:"button",variant:"ghost",size:"sm",onClick:()=>iT("prompt"),title:"é‡æ–°åŠ è½½æ–‡ä»¶",children:(0,L.jsx)(h5,{className:"h-4 w-4"})}),(0,L.jsx)(s4.Button,{type:"button",variant:"ghost",size:"sm",onClick:()=>eV(!eW),children:eW?(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(aB,{className:"mr-1 h-4 w-4"}),"æ”¶èµ·"]}):(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(aO,{className:"mr-1 h-4 w-4"}),"å±•å¼€"]})})]})]}),(0,L.jsx)(uh,{value:eB,readOnly:!0,className:`bg-muted/50 text-sm font-mono cursor-default overflow-y-auto transition-all duration-200 ${eW?"h-60":"h-20"}`})]})]}),(0,L.jsxs)("div",{className:"space-y-4",children:[!eH&&(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)("div",{className:"flex items-center justify-between",children:[(0,L.jsxs)("div",{children:[(0,L.jsx)(hL,{htmlFor:"systemPrompt",children:"ç³»ç»Ÿæç¤ºè¯"}),(0,L.jsx)("p",{className:"text-xs text-muted-foreground",children:"ä¸ºAIè®¾ç½®è§’è‰²æˆ–è¡Œä¸ºæŒ‡ä»¤"})]}),(0,L.jsx)(s4.Button,{type:"button",variant:"ghost",size:"sm",onClick:()=>f(!p),children:p?(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(aB,{className:"mr-1 h-4 w-4"}),"æ”¶èµ·"]}):(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(aO,{className:"mr-1 h-4 w-4"}),"å±•å¼€"]})})]}),(0,L.jsx)(uh,{id:"systemPrompt",value:ej,onChange:e=>eM(e.target.value),placeholder:"ä¾‹å¦‚: ä½ æ˜¯ä¸€ä¸ªä¹äºŽåŠ©äººçš„åŠ©æ‰‹ã€‚",rows:2,className:p?"":"max-h-32 overflow-y-auto"})]}),(0,L.jsxs)("div",{className:"space-y-1.5 pt-2",children:[(0,L.jsxs)("div",{className:"flex items-center justify-between",children:[(0,L.jsxs)(hL,{htmlFor:"systemPromptFilePath",className:"flex items-center gap-1.5",children:[(0,L.jsx)(ui,{className:"h-3.5 w-3.5"}),"ä»Žå¤–éƒ¨åŠ è½½ç³»ç»Ÿæç¤ºè¯"]}),(0,L.jsxs)("div",{className:"flex items-center gap-2",children:[(0,L.jsx)("input",{type:"checkbox",id:"enableSystemPromptFile",checked:eH,onChange:e=>eJ(e.target.checked),className:"h-4 w-4 rounded border-input bg-background accent-primary cursor-pointer"}),(0,L.jsx)(hL,{htmlFor:"enableSystemPromptFile",className:"cursor-pointer font-normal text-sm",children:"å¯ç”¨"}),(0,L.jsx)("input",{type:"checkbox",id:"autoReloadSystemPrompt",checked:e3,onChange:e=>e5(e.target.checked),disabled:!eH,className:"h-4 w-4 rounded border-input bg-background accent-primary cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed"}),(0,L.jsx)(hL,{htmlFor:"autoReloadSystemPrompt",className:"cursor-pointer font-normal text-sm",children:"è‡ªåŠ¨é‡è½½"})]})]}),eH&&(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)("div",{className:"flex gap-2",children:[(0,L.jsx)(h_,{id:"systemPromptFilePath",value:eK,onChange:e=>{eU(e.target.value),eY(!1),eX.current=null,eQ("")},placeholder:"https://example.com/system-prompt.txt æˆ–ç‚¹å‡»é€‰æ‹©æœ¬åœ°æ–‡ä»¶",className:"text-sm flex-1"}),(0,L.jsxs)(s4.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>i_("systemPrompt"),className:"shrink-0",children:[(0,L.jsx)(us,{className:"h-4 w-4 mr-1"}),"é€‰æ‹©æ–‡ä»¶"]})]}),(0,L.jsx)("p",{className:"text-xs text-muted-foreground",children:'æ”¯æŒ HTTP/HTTPS é“¾æŽ¥æˆ–æœ¬åœ°æ–‡ä»¶ã€‚ç‚¹å‡»"é€‰æ‹©æ–‡ä»¶"æŒ‰é’®å¯ç›´æŽ¥é€‰æ‹©æœ¬åœ° .txt æˆ– .md æ–‡ä»¶ã€‚'})]}),eH&&eG&&(0,L.jsxs)("div",{className:"space-y-1.5 pt-2",children:[(0,L.jsxs)("div",{className:"flex items-center justify-between",children:[(0,L.jsxs)(hL,{className:"text-xs text-muted-foreground flex items-center gap-1.5",children:["å¤–éƒ¨åŠ è½½çš„ç³»ç»Ÿæç¤ºè¯é¢„è§ˆ",eq&&(0,L.jsx)("span",{className:"bg-blue-100 text-blue-700 px-1.5 py-0.5 rounded text-[10px]",children:"æœ¬åœ°æ–‡ä»¶"})]}),(0,L.jsxs)("div",{className:"flex items-center gap-1",children:[eq&&eX.current&&(0,L.jsx)(s4.Button,{type:"button",variant:"ghost",size:"sm",onClick:()=>iT("systemPrompt"),title:"é‡æ–°åŠ è½½æ–‡ä»¶",children:(0,L.jsx)(h5,{className:"h-4 w-4"})}),(0,L.jsx)(s4.Button,{type:"button",variant:"ghost",size:"sm",onClick:()=>e0(!eZ),children:eZ?(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(aB,{className:"mr-1 h-4 w-4"}),"æ”¶èµ·"]}):(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(aO,{className:"mr-1 h-4 w-4"}),"å±•å¼€"]})})]})]}),(0,L.jsx)(uh,{value:eG,readOnly:!0,className:`bg-muted/50 text-sm font-mono cursor-default overflow-y-auto transition-all duration-200 ${eZ?"h-60":"h-20"}`})]})]})]}),(0,L.jsxs)("div",{className:"space-y-2",children:[(0,L.jsx)("div",{className:"flex items-center justify-between",children:(0,L.jsxs)("div",{className:"space-y-0.5",children:[(0,L.jsx)(hL,{children:"å®šæ—¶é…ç½®"}),(0,L.jsx)("p",{className:"text-xs text-muted-foreground",children:"è®¾ç½®è‡ªåŠ¨å®šæ—¶æ‰§è¡Œæµ‹è¯•"})]})}),(0,L.jsxs)("div",{className:"flex items-center gap-6",children:[(0,L.jsxs)("div",{className:"flex items-center gap-2",children:[(0,L.jsx)("input",{type:"checkbox",id:"timerEnabled",checked:tj,onChange:e=>{tM(e.target.checked),!e.target.checked&&tk&&iW()},className:"h-4 w-4 rounded border-input bg-background accent-primary cursor-pointer"}),(0,L.jsx)(hL,{htmlFor:"timerEnabled",className:"cursor-pointer font-normal",children:"å¯ç”¨å®šæ—¶æ‰§è¡Œ"})]}),(0,L.jsxs)("div",{className:"flex items-center gap-2",children:[(0,L.jsx)(hL,{htmlFor:"timerInterval",className:"text-sm text-muted-foreground whitespace-nowrap",children:"é—´éš”æ—¶é—´"}),(0,L.jsx)(h_,{id:"timerInterval",type:"number",value:tC,onChange:e=>tN(Math.max(1,Number(e.target.value))),className:"w-20 h-8",min:1,disabled:!tj}),(0,L.jsx)("span",{className:"text-sm text-muted-foreground",children:"ç§’"})]}),tk&&(0,L.jsxs)("span",{className:"text-xs text-muted-foreground bg-primary/10 px-2 py-1 rounded",children:["å®šæ—¶è¿è¡Œä¸­ (æ¯ ",tC," ç§’)"]})]})]}),(0,L.jsxs)("div",{className:"space-y-2",children:[(0,L.jsxs)("div",{className:"flex items-center justify-between",children:[(0,L.jsxs)("div",{className:"space-y-0.5",children:[(0,L.jsx)(hL,{htmlFor:"maxTokens",children:"Max Tokens"}),(0,L.jsxs)("p",{className:"text-xs text-muted-foreground",children:["æœ€å¤§ç”Ÿæˆä»¤ç‰Œæ•°é‡ï¼ˆèŒƒå›´: 1 - ",ef,"ï¼‰"]})]}),(0,L.jsxs)("div",{className:"flex items-center gap-2",children:[(0,L.jsx)("span",{className:"text-sm font-medium",children:q}),(0,L.jsx)("span",{className:"text-sm font-medium",children:"/"}),(0,L.jsx)(h_,{type:"number",value:ef,onChange:e=>{let t=Math.max(1,Number(e.target.value));eg(t),q>t&&Y(t)},className:"w-20 h-8",min:1})]})]}),(0,L.jsx)(uz,{id:"maxTokens",min:1,max:ef,step:1,value:[q],onValueChange:e=>Y(e[0])})]}),(0,L.jsxs)("div",{className:"space-y-2",children:[(0,L.jsxs)("div",{className:"flex items-center justify-between",children:[(0,L.jsxs)("div",{className:"space-y-0.5",children:[(0,L.jsx)(hL,{htmlFor:"temperature",children:"Temperature"}),(0,L.jsx)("p",{className:"text-xs text-muted-foreground",children:"æŽ§åˆ¶è¾“å‡ºéšæœºæ€§ï¼Œå€¼è¶Šé«˜è¶Šéšæœºï¼ˆèŒƒå›´: 0.0 - 2.0ï¼‰"})]}),(0,L.jsx)("span",{className:"text-sm font-medium",children:X?.toFixed(2)??"1.00"})]}),(0,L.jsx)(uz,{id:"temperature",min:0,max:2,step:.01,value:[X],onValueChange:e=>G(e[0])})]}),(0,L.jsxs)("div",{className:"space-y-2",children:[(0,L.jsxs)("div",{className:"flex items-center justify-between",children:[(0,L.jsxs)("div",{className:"space-y-0.5",children:[(0,L.jsx)(hL,{htmlFor:"topP",children:"Top P"}),(0,L.jsx)("p",{className:"text-xs text-muted-foreground",children:"æ ¸é‡‡æ ·ï¼ŒæŽ§åˆ¶è¾“å‡ºå¤šæ ·æ€§ï¼ˆèŒƒå›´: 0.0 - 1.0ï¼‰"})]}),(0,L.jsx)("span",{className:"text-sm font-medium",children:Q?.toFixed(2)??"1.00"})]}),(0,L.jsx)(uz,{id:"topP",min:0,max:1,step:.01,value:[Q],onValueChange:e=>Z(e[0])})]}),(0,L.jsxs)("div",{className:"space-y-2",children:[(0,L.jsxs)("div",{className:"flex items-center justify-between",children:[(0,L.jsxs)("div",{className:"space-y-0.5",children:[(0,L.jsx)(hL,{htmlFor:"frequencyPenalty",children:"Frequency Penalty"}),(0,L.jsx)("p",{className:"text-xs text-muted-foreground",children:"é™ä½Žé‡å¤è¯é¢‘çŽ‡ï¼Œå€¼è¶Šå¤§æƒ©ç½šè¶Šå¼ºï¼ˆèŒƒå›´: -2.0 - 2.0ï¼‰"})]}),(0,L.jsx)("span",{className:"text-sm font-medium",children:ee?.toFixed(2)??"0.00"})]}),(0,L.jsx)(uz,{id:"frequencyPenalty",min:-2,max:2,step:.01,value:[ee],onValueChange:e=>et(e[0])})]}),(0,L.jsxs)("div",{className:"space-y-2",children:[(0,L.jsxs)("div",{className:"flex items-center justify-between",children:[(0,L.jsxs)("div",{className:"space-y-0.5",children:[(0,L.jsx)(hL,{htmlFor:"presencePenalty",children:"Presence Penalty"}),(0,L.jsx)("p",{className:"text-xs text-muted-foreground",children:"é¼“åŠ±è°ˆè®ºæ–°è¯é¢˜ï¼Œå€¼è¶Šå¤§è¶Šå€¾å‘æ–°å†…å®¹ï¼ˆèŒƒå›´: -2.0 - 2.0ï¼‰"})]}),(0,L.jsx)("span",{className:"text-sm font-medium",children:ei?.toFixed(2)??"0.00"})]}),(0,L.jsx)(uz,{id:"presencePenalty",min:-2,max:2,step:.01,value:[ei],onValueChange:e=>es(e[0])})]}),em&&(0,L.jsx)("div",{className:"rounded-lg bg-destructive/10 p-3 text-sm text-destructive",children:em})]})})]}),(0,L.jsxs)(h0.Card,{children:[(0,L.jsx)(h0.CardHeader,{children:(0,L.jsxs)("div",{className:"flex items-center justify-between",children:[(0,L.jsxs)("div",{children:[(0,L.jsx)(h0.CardTitle,{children:"åŽ†å²å¯¹è¯"}),(0,L.jsxs)(h0.CardDescription,{children:["å…± ",e9.length," æ¡è®°å½•"]})]}),(0,L.jsxs)("div",{className:"flex items-center gap-2",children:[(0,L.jsxs)("label",{className:"flex items-center gap-2 text-sm cursor-pointer",children:[(0,L.jsx)("input",{type:"checkbox",checked:ta,onChange:e=>to(e.target.checked),className:"size-3 cursor-pointer"}),(0,L.jsx)("span",{children:"æ˜¾ç¤º Raw"})]}),(0,L.jsxs)("label",{className:"flex items-center gap-2 text-sm cursor-pointer",children:[(0,L.jsx)("input",{type:"checkbox",checked:th,onChange:e=>tu(e.target.checked),className:"size-3 cursor-pointer"}),(0,L.jsx)("span",{children:"æ˜¾ç¤ºè¯·æ±‚å†…å®¹"})]}),(0,L.jsxs)("label",{className:"flex items-center gap-2 text-sm cursor-pointer",children:[(0,L.jsx)("input",{type:"checkbox",checked:tf,onChange:e=>tg(e.target.checked),className:"size-3 cursor-pointer"}),(0,L.jsx)("span",{children:"è§£æžå“åº”markdown"})]}),(0,L.jsxs)(a$,{value:String(e7),onValueChange:e=>te(Number(e)),children:[(0,L.jsx)(aV,{className:"w-[120px]",children:(0,L.jsx)(aW,{})}),(0,L.jsxs)(aK,{children:[(0,L.jsx)(aU,{value:"3",children:"3 æ¡/é¡µ"}),(0,L.jsx)(aU,{value:"10",children:"10 æ¡/é¡µ"}),(0,L.jsx)(aU,{value:"50",children:"50 æ¡/é¡µ"}),(0,L.jsx)(aU,{value:"100",children:"100 æ¡/é¡µ"})]})]}),(0,L.jsxs)(s4.Button,{variant:"outline",size:"sm",onClick:()=>{e8([]),tB(new Map),cI().catch(e=>{console.error("[v0] Failed to clear IndexedDB:",e)}),ti(1),iu({title:"åŽ†å²è®°å½•å·²æ¸…ç©º",description:"æ‰€æœ‰åŽ†å²æµ‹è¯•æ•°æ®å·²è¢«åˆ é™¤"})},disabled:0===e9.length,children:[(0,L.jsx)(h5,{className:"mr-2 size-4"}),"æ¸…ç©º"]}),(0,L.jsxs)(s4.Button,{variant:"outline",size:"sm",onClick:()=>{let e;if(0===e9.length)return;let t=(e=["æ—¶é—´","æ¨¡åž‹","ç”¨æ—¶(ms)"],th&&e.push("è¯·æ±‚ Content"),ta&&e.push("è¯·æ±‚ Raw"),e.push("å“åº” Content"),ta&&e.push("å“åº” Raw"),t),i=e9.map(e=>{let t=new Date(e.timestamp).toLocaleString("zh-CN",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}),i=void 0!==e.duration&&null!==e.duration?e.duration:"-",s=e=>null==e?'""':`"${String(e).replace(/"/g,'""')}"`,r=[s(t),s(e.model),s(String(i))];return th&&r.push(s(e.requestContent)),ta&&r.push(s(e.requestRaw)),r.push(s(e.responseContent)),ta&&r.push(s(e.responseRaw)),r.join(",")}),s=new Blob(["\uFEFF"+[t.join(","),...i].join("\n")],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a"),n=URL.createObjectURL(s);r.setAttribute("href",n),r.setAttribute("download",`llm_api_history_${Date.now()}.csv`),r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r)},disabled:0===e9.length,children:[(0,L.jsx)(ue,{className:"mr-2 size-4"}),"å¯¼å‡º CSV"]})]})]})}),(0,L.jsx)(h0.CardContent,{children:0===e9.length?(0,L.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"æš‚æ— åŽ†å²è®°å½•"}):(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)("div",{className:"border rounded-lg overflow-hidden",children:(0,L.jsx)("div",{className:"overflow-x-auto",children:(0,L.jsxs)(A,{children:[(0,L.jsx)(F,{children:(0,L.jsxs)(D,{children:[(0,L.jsx)(O,{className:"w-[160px]",children:"æ—¶é—´/æ¨¡åž‹/ç”¨æ—¶/ä¸Šä¸‹æ–‡"}),th&&(0,L.jsx)(O,{children:(0,L.jsxs)("div",{className:"flex items-center gap-2",children:[(0,L.jsx)("span",{children:"è¯·æ±‚ Content"}),(0,L.jsx)("label",{className:"flex items-center gap-1 cursor-pointer",title:"å±•å¼€æ‰€æœ‰è¯·æ±‚å†…å®¹",children:(0,L.jsx)("input",{type:"checkbox",checked:tc,onChange:e=>td(e.target.checked),className:"size-3 cursor-pointer"})})]})}),ta&&(0,L.jsx)(O,{className:"w-[100px]",children:"è¯·æ±‚ Raw"}),(0,L.jsx)(O,{children:(0,L.jsxs)("div",{className:"flex items-center gap-2",children:[(0,L.jsx)("span",{children:"å“åº” Content"}),(0,L.jsx)("label",{className:"flex items-center gap-1 cursor-pointer",title:"å±•å¼€æ‰€æœ‰å“åº”å†…å®¹",children:(0,L.jsx)("input",{type:"checkbox",checked:tm,onChange:e=>tp(e.target.checked),className:"size-3 cursor-pointer"})})]})}),ta&&(0,L.jsx)(O,{className:"w-[100px]",children:"å“åº” Raw"}),(0,L.jsx)(O,{className:"px-4 py-3 text-center font-medium w-[80px]",children:"æ“ä½œ"})]})}),(0,L.jsx)(z,{className:"divide-y",children:iY.map(e=>{let t,i,s,r,n=`request-${e.timestamp}`,l=`response-${e.timestamp}`,a=((e,t,i,s)=>{if(!e||""===e.trim())return[];if(void 0!==s&&i){let e=i.get(s);if(e&&e.length>0)return e}if(e.startsWith("data:image"))return[e];if(e.includes("\n")&&e.split("\n").every(e=>e.startsWith("data:image")))return e.split("\n").filter(Boolean);try{let e=JSON.parse(t),i=[],s=e;return e.body&&"object"==typeof e.body&&(s=e.body),s.images&&Array.isArray(s.images)&&s.images.forEach(e=>{e.url&&(e.url.startsWith("http://")||e.url.startsWith("https://"))&&i.push(e.url)}),s.choices&&Array.isArray(s.choices)&&s.choices.forEach(e=>{e.message&&e.message.images&&Array.isArray(e.message.images)&&e.message.images.forEach(e=>{if(e.image_url&&e.image_url.url){let t=e.image_url.url;(t.startsWith("data:image")||t.startsWith("http://")||t.startsWith("https://"))&&i.push(t)}})}),i}catch(e){return console.error("[v0] Error extracting images from response:",e),[]}})(e.responseContent,e.responseRaw,tO,e.timestamp),o=[];return e.tradingPair&&o.push(e.tradingPair),e.contextTags&&e.contextTags.length>0&&o.push(...e.contextTags),(0,L.jsxs)(D,{className:"hover:bg-muted/50",children:[(0,L.jsx)(B,{className:"px-4 py-3 text-xs text-muted-foreground whitespace-nowrap align-top",children:(0,L.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,L.jsxs)("div",{children:[(0,L.jsx)("span",{children:new Date(e.timestamp).toLocaleString("zh-CN",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}),(0,L.jsx)("span",{className:"font-mono text-[10px] text-foreground block truncate",title:e.model,children:e.model}),(0,L.jsx)("span",{className:"font-mono text-[10px]",children:void 0!==e.duration&&null!==e.duration?(0,L.jsxs)(L.Fragment,{children:[e.duration,"ms"]}):(0,L.jsx)("span",{className:"text-muted-foreground/50",children:"-"})})]}),o.length>0&&(0,L.jsx)("div",{className:"flex flex-wrap gap-1 pt-1",children:o.map((t,i)=>(0,L.jsx)("span",{className:"inline-flex items-center rounded-full bg-primary/10 px-2 py-0.5 text-[10px] font-medium text-primary",children:t},`${e.id}-tag-${i}`))})]})}),th&&(0,L.jsx)(B,{children:(0,L.jsxs)("div",{className:"max-w-xl space-y-2",children:[(t=(e=>{if(!e||""===e.trim())return[];try{let t=JSON.parse(e),i=[];return Array.isArray(t)&&t.forEach(e=>{e.content&&Array.isArray(e.content)?e.content.forEach(e=>{if("image_url"===e.type&&e.image_url?.url){let t=e.image_url.url;(t.startsWith("data:image/")||t.startsWith("http://")||t.startsWith("https://"))&&i.push(t)}}):e.content&&e.content}),i}catch(e){return[]}})(e.requestContent)).length>0?(0,L.jsx)("div",{className:"grid grid-cols-3 gap-1 mb-2",children:t.map((t,i)=>(0,L.jsxs)("div",{className:"relative group rounded border overflow-hidden bg-muted",children:[(0,L.jsx)("img",{src:t||"/placeholder.svg",alt:`Request image ${i+1}`,className:"w-full h-16 object-cover cursor-pointer hover:opacity-80 transition-opacity",onClick:()=>t2({id:`history-${e.timestamp}-${i}`,type:"url",base64:t})}),(0,L.jsx)("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:(0,L.jsx)(s4.Button,{type:"button",variant:"secondary",size:"sm",onClick:()=>t2({id:`history-${e.timestamp}-${i}`,type:"url",base64:t}),title:"æ”¾å¤§æŸ¥çœ‹",children:(0,L.jsx)(ul,{className:"h-3 w-3"})})})]},i))}):null,(0,L.jsx)("pre",{className:`text-xs whitespace-pre-wrap break-words ${!tc&&!ts.has(n)?"line-clamp-2":""}`,children:(e=>{try{let t=JSON.parse(e);if(Array.isArray(t)){let e=[];return t.forEach(t=>{if(t.content){if("string"==typeof t.content)e.push(t.content);else if(Array.isArray(t.content)){let i=t.content.filter(e=>"text"===e.type).map(e=>e.text);e=e.concat(i)}}}),e.join("\n")}return e}catch(t){return e}})(e.requestContent)}),!tc&&e.requestContent.length>100&&(0,L.jsx)("button",{onClick:()=>iH(n),className:"text-xs text-primary hover:underline flex items-center gap-1",children:ts.has(n)?(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(aB,{className:"size-3"}),"æ”¶èµ·"]}):(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(aO,{className:"size-3"}),"å±•å¼€"]})})]})}),ta&&(0,L.jsxs)(B,{className:"px-4 py-3 align-top",children:[(0,L.jsx)(s4.Button,{variant:"outline",size:"sm",onClick:()=>iJ(`request-raw-${e.timestamp}`),className:"h-7 text-xs",children:tn.has(`request-raw-${e.timestamp}`)?"éšè—":"æ˜¾ç¤º"}),tn.has(`request-raw-${e.timestamp}`)&&(0,L.jsxs)("div",{className:"mt-2 space-y-1",children:[(0,L.jsx)("pre",{className:`text-xs bg-muted p-2 rounded whitespace-pre-wrap break-words ${!ts.has(`request-raw-${e.timestamp}`)?"line-clamp-2":""}`,children:e.requestRaw}),e.requestRaw.length>100&&(0,L.jsx)("button",{onClick:()=>iH(`request-raw-${e.timestamp}`),className:"text-xs text-primary hover:underline flex items-center gap-1",children:ts.has(`request-raw-${e.timestamp}`)?(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(aB,{className:"size-3"}),"æ”¶èµ·"]}):(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(aO,{className:"size-3"}),"å±•å¼€"]})})]})]}),(0,L.jsx)(B,{children:(0,L.jsxs)("div",{className:"max-w-xl",children:[(0,L.jsx)("div",{className:"text-xs whitespace-pre-wrap break-words relative",children:((e,t,i,s)=>{let r=e;if(tf&&!e.includes("```"))return(0,L.jsxs)(L.Fragment,{children:[s&&s.length>0&&(0,L.jsx)("div",{className:"flex flex-wrap gap-2 mb-2",children:s.map((e,i)=>(0,L.jsxs)("div",{className:"relative group rounded border overflow-hidden bg-muted",children:[(0,L.jsx)("img",{src:e||"/placeholder.svg",alt:`Generated image ${i+1}`,className:"size-20 object-cover cursor-pointer hover:opacity-80 transition-opacity",onClick:()=>t2({id:`response-${t}-${i}`,type:"url",base64:e}),title:"ç‚¹å‡»æŸ¥çœ‹å¤§å›¾"}),(0,L.jsx)("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:(0,L.jsx)(s4.Button,{type:"button",variant:"secondary",size:"sm",onClick:()=>t2({id:`response-${t}-${i}`,type:"url",base64:e}),title:"æ”¾å¤§æŸ¥çœ‹",children:(0,L.jsx)(ul,{className:"h-3 w-3"})})})]},i))}),(e=>{let t=e.split("\n"),i=[],s=0;for(;s<t.length;){let e=t[s];if(e.startsWith("# ")){i.push((0,L.jsx)("h1",{className:"text-xl font-bold mt-4 mb-2",children:e.slice(2)},s)),s++;continue}if(e.startsWith("## ")){i.push((0,L.jsx)("h2",{className:"text-lg font-bold mt-3 mb-2",children:e.slice(3)},s)),s++;continue}if(e.startsWith("### ")){i.push((0,L.jsx)("h3",{className:"text-base font-bold mt-2 mb-1",children:e.slice(4)},s)),s++;continue}if(e.startsWith("#### ")){i.push((0,L.jsx)("h4",{className:"text-sm font-bold mt-2 mb-1",children:e.slice(5)},s)),s++;continue}if(e.startsWith("##### ")){i.push((0,L.jsx)("h5",{className:"text-xs font-bold mt-1 mb-1",children:e.slice(6)},s)),s++;continue}if(e.startsWith("###### ")){i.push((0,L.jsx)("h6",{className:"text-xs font-semibold mt-1 mb-1",children:e.slice(7)},s)),s++;continue}if(e.includes("|")&&e.trim().startsWith("|")&&e.trim().endsWith("|")){let e=[],r=[];for(s<t.length&&(r=t[s].trim().split("|").map(e=>e.trim()).filter(e=>e.length>0),++s<t.length&&t[s].trim().match(/^\|[\s\-:]+\|/)&&s++,r.length>0&&e.push((0,L.jsx)("tr",{children:r.map((e,t)=>(0,L.jsx)("th",{className:"border border-border px-2 py-1 text-left font-semibold bg-muted",children:i1(e)},t))},"header")));s<t.length;){let i=t[s].trim();if(i.includes("|")&&i.startsWith("|")&&i.endsWith("|")){if(i.match(/^\|[\s\-:]+\|$/)){s++;continue}let t=i.split("|").map(e=>e.trim()).filter(e=>e.length>0);for(;t.length<r.length;)t.push("");e.push((0,L.jsx)("tr",{children:t.slice(0,r.length).map((e,t)=>(0,L.jsx)("td",{className:"border border-border px-2 py-1",children:i1(e)},t))},s)),s++}else break}e.length>0&&i.push((0,L.jsx)("div",{className:"my-4 overflow-x-auto",children:(0,L.jsxs)("table",{className:"border-collapse border border-border w-full text-sm",children:[(0,L.jsx)("thead",{children:e[0]}),(0,L.jsx)("tbody",{children:e.slice(1)})]})},`table-${s}`));continue}if(e.trim().startsWith("- ")||e.trim().startsWith("* ")){let e=[];for(;s<t.length&&(t[s].trim().startsWith("- ")||t[s].trim().startsWith("* "));){let i=t[s].trim().slice(2);e.push((0,L.jsx)("li",{className:"ml-4",children:i1(i)},s)),s++}i.push((0,L.jsx)("ul",{className:"list-disc my-2",children:e},`ul-${s}`));continue}if(/^\d+\.\s/.test(e.trim())){let e=[];for(;s<t.length&&/^\d+\.\s/.test(t[s].trim());){let i=t[s].trim().replace(/^\d+\.\s/,"");e.push((0,L.jsx)("li",{className:"ml-4",children:i1(i)},s)),s++}i.push((0,L.jsx)("ol",{className:"list-decimal my-2",children:e},`ol-${s}`));continue}if(e.startsWith("> ")){let e=[];for(;s<t.length&&t[s].startsWith("> ");)e.push(t[s].slice(2)),s++;i.push((0,L.jsx)("blockquote",{className:"border-l-4 border-muted pl-4 my-2 italic text-muted-foreground",children:e.join("\n")},`quote-${s}`));continue}if("---"===e.trim()||"***"===e.trim()){i.push((0,L.jsx)("hr",{className:"my-4 border-t border-border"},s)),s++;continue}if(""===e.trim()){i.push((0,L.jsx)("br",{},s)),s++;continue}i.push((0,L.jsx)("p",{className:"my-1",children:i1(e)},s)),s++}return(0,L.jsx)("div",{children:i})})(e)]});try{let t=e.trim();(t.startsWith("{")&&t.endsWith("}")||t.startsWith("[")&&t.endsWith("]"))&&(JSON.parse(t),r="```json\n"+t+"\n```")}catch(e){}let n=r.split(/(```[\s\S]*?```)/g);return(0,L.jsxs)(L.Fragment,{children:[s&&s.length>0&&(0,L.jsx)("div",{className:"flex flex-wrap gap-2 mb-2",children:s.map((e,i)=>(0,L.jsxs)("div",{className:"relative group rounded border overflow-hidden bg-muted",children:[(0,L.jsx)("img",{src:e||"/placeholder.svg",alt:`Generated image ${i+1}`,className:"size-20 object-cover cursor-pointer hover:opacity-80 transition-opacity",onClick:()=>t2({id:`response-${t}-${i}`,type:"url",base64:e}),title:"ç‚¹å‡»æŸ¥çœ‹å¤§å›¾"}),(0,L.jsx)("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:(0,L.jsx)(s4.Button,{type:"button",variant:"secondary",size:"sm",onClick:()=>t2({id:`response-${t}-${i}`,type:"url",base64:e}),title:"æ”¾å¤§æŸ¥çœ‹",children:(0,L.jsx)(ul,{className:"h-3 w-3"})})})]},i))}),n.map((e,t)=>{if(e.startsWith("```")&&e.endsWith("```")){let s=e.split("\n"),r=s[0].replace("```","").trim(),n=s.slice(1,-1),l=n.join("\n"),a=n.length;return(0,L.jsxs)("div",{className:"my-2 rounded-md bg-muted overflow-hidden border relative",children:[r&&(0,L.jsx)("div",{className:"px-3 py-1 text-xs text-muted-foreground bg-muted/50 border-b",children:r}),(0,L.jsx)("pre",{className:`p-3 overflow-x-auto text-xs ${!i&&a>3?"max-h-24 overflow-y-hidden":""}`,children:(0,L.jsx)("code",{className:"block",children:l})}),!i&&a>3&&(0,L.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-8 bg-gradient-to-t from-muted to-transparent pointer-events-none"})]},t)}return(0,L.jsx)("span",{className:`${!i&&e.trim().length>100?"line-clamp-2":""}`,children:e},t)})]})})(e.responseContent,l,tm||ts.has(l),a)}),(s=(i=e.responseContent.includes("```"))?e.responseContent.split("```").filter((e,t)=>t%2==1)[0]?.split("\n")?.length??0:0,r=e.responseContent.length>100||i&&s>3,!tm&&r&&(0,L.jsx)("button",{onClick:()=>iH(l),className:"text-xs text-primary hover:underline flex items-center gap-1",children:ts.has(l)?(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(aB,{className:"size-3"}),"æ”¶èµ·"]}):(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(aO,{className:"size-3"}),"å±•å¼€"]})}))]})}),ta&&(0,L.jsxs)(B,{className:"px-4 py-3 align-top",children:[(0,L.jsx)(s4.Button,{variant:"outline",size:"sm",onClick:()=>iJ(`response-raw-${e.timestamp}`),className:"h-7 text-xs",children:tn.has(`response-raw-${e.timestamp}`)?"éšè—":"æ˜¾ç¤º"}),tn.has(`response-raw-${e.timestamp}`)&&(0,L.jsxs)("div",{className:"mt-2 space-y-1",children:[(0,L.jsx)("pre",{className:`text-xs bg-muted p-2 rounded whitespace-pre-wrap break-words ${!ts.has(`response-raw-${e.timestamp}`)?"line-clamp-2":""}`,children:e.responseRaw}),e.responseRaw.length>100&&(0,L.jsx)("button",{onClick:()=>iH(`response-raw-${e.timestamp}`),className:"text-xs text-primary hover:underline flex items-center gap-1",children:ts.has(`response-raw-${e.timestamp}`)?(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(aB,{className:"size-3"}),"æ”¶èµ·"]}):(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(aO,{className:"size-3"}),"å±•å¼€"]})})]})]}),(0,L.jsx)(B,{className:"px-4 py-3 text-center align-top",children:(0,L.jsx)(s4.Button,{variant:"ghost",size:"sm",onClick:()=>{var t;let i,s;return t=e.id,i=e9.find(e=>e.id===t),void(e8(s=e9.filter(e=>e.id!==t)),i&&(cL(i.timestamp).catch(e=>{console.error("[v0] Failed to delete response images:",e)}),tB(e=>{let t=new Map(e);return t.delete(i.timestamp),t})),cN(s).catch(e=>{console.error("[v0] Failed to update history in IndexedDB:",e)}),iu({title:"è®°å½•å·²åˆ é™¤",description:"åŽ†å²è®°å½•é¡¹å·²è¢«åˆ é™¤"}))},className:"h-8 w-8 p-0",children:(0,L.jsx)(h4,{className:"size-4"})})})]},e.timestamp)})})]})})}),iq>1&&(0,L.jsxs)("div",{className:"flex items-center justify-center gap-2 mt-4",children:[(0,L.jsx)(s4.Button,{variant:"outline",size:"sm",onClick:()=>ti(e=>Math.max(1,e-1)),disabled:1===tt,children:(0,L.jsx)(h6,{className:"size-4"})}),(0,L.jsxs)("span",{className:"text-sm text-muted-foreground",children:[tt," / ",iq]}),(0,L.jsxs)(s4.Button,{variant:"outline",size:"sm",onClick:()=>ti(e=>Math.min(iq,e+1)),disabled:tt===iq,children:["ä¸‹ä¸€é¡µ",(0,L.jsx)(h9,{className:"size-4"})]})]})]})})]}),(0,L.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,L.jsxs)(h0.Card,{className:"flex flex-col h-[600px]",children:[(0,L.jsx)(h0.CardHeader,{className:"pb-3",children:(0,L.jsxs)("div",{className:"flex items-center justify-between",children:[(0,L.jsxs)("div",{children:[(0,L.jsx)(h0.CardTitle,{children:"è¯·æ±‚è¯¦æƒ…"}),(0,L.jsx)(h0.CardDescription,{children:"å®Œæ•´çš„ cURL å‘½ä»¤ï¼ˆåŒ…å«æ˜Žæ–‡ API Keyï¼‰"})]}),(0,L.jsxs)(s4.Button,{variant:"outline",size:"sm",onClick:()=>eh&&i0(eh,"request"),disabled:!eh,children:[(0,L.jsx)(h1,{className:"h-4 w-4 mr-1"}),iX]})]})}),(0,L.jsx)(h0.CardContent,{className:"flex-1 overflow-hidden",children:(0,L.jsx)("div",{className:"h-full overflow-auto rounded-lg bg-muted p-4",children:(0,L.jsx)("pre",{className:"text-xs font-mono leading-relaxed whitespace-pre-wrap break-words",children:eh||'ç‚¹å‡»"å¼€å§‹æµ‹è¯•"æŸ¥çœ‹ cURL å‘½ä»¤...'})})})]}),(0,L.jsxs)(h0.Card,{className:"flex flex-col h-[600px]",children:[(0,L.jsx)(h0.CardHeader,{className:"pb-3",children:(0,L.jsxs)("div",{className:"flex items-center justify-between",children:[(0,L.jsxs)("div",{children:[(0,L.jsx)(h0.CardTitle,{children:"å“åº”è¯¦æƒ…"}),(0,L.jsx)(h0.CardDescription,{children:"API è¿”å›žçš„å®Œæ•´å“åº”"})]}),(0,L.jsxs)("div",{className:"flex items-center gap-2",children:[null!==t_&&(0,L.jsxs)("div",{className:"text-xs text-muted-foreground font-mono",children:["ç”¨æ—¶: ",t_,"ms"]}),(0,L.jsxs)(s4.Button,{variant:"outline",size:"sm",onClick:()=>{ec&&i0(ec.split("\n").filter(e=>""!==e.trim()).join("\n"),"response")},disabled:!ec,children:[(0,L.jsx)(h1,{className:"h-4 w-4 mr-1"}),iQ]})]})]})}),(0,L.jsx)(h0.CardContent,{className:"flex-1 overflow-hidden",children:(0,L.jsx)("div",{className:"h-full overflow-auto rounded-lg bg-muted p-4",children:(0,L.jsx)("pre",{className:"text-xs font-mono leading-relaxed whitespace-pre-wrap break-words",children:ec?ec.split("\n").filter(e=>""!==e.trim()).join("\n"):"ç­‰å¾…å“åº”..."})})})]})]})]}),(0,L.jsx)(hy,{open:!!t1,onOpenChange:e=>!e&&t2(null),children:(0,L.jsx)(hM,{className:"max-w-5xl w-full p-0 overflow-hidden",children:t1&&(0,L.jsxs)("div",{className:"relative w-full flex flex-col",children:[(0,L.jsx)("div",{className:"flex-1 flex items-center justify-center bg-black/90 p-4",children:(0,L.jsx)("img",{src:t1.base64||t1.url,alt:t1.name||"Zoomed Image",className:"max-w-full max-h-[80vh] object-contain"})}),(0,L.jsxs)("div",{className:"bg-background border-t p-3 flex items-center justify-between",children:[(0,L.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,L.jsx)("p",{className:"text-sm font-medium truncate",children:t1.name||"æœªå‘½åå›¾ç‰‡"}),"url"===t1.type&&t1.url&&(0,L.jsx)("p",{className:"text-xs text-muted-foreground truncate",children:t1.url}),"file"===t1.type&&(0,L.jsx)("p",{className:"text-xs text-muted-foreground",children:"æœ¬åœ°ä¸Šä¼ å›¾ç‰‡"})]}),(0,L.jsx)(s4.Button,{variant:"outline",size:"sm",onClick:()=>t2(null),children:"å…³é—­"})]})]})})}),(0,L.jsx)(cy,{})]})}e.s(["default",()=>cV],31713)}]);