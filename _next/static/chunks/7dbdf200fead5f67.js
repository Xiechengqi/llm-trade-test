(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,70305,(t,e,i)=>{"use strict";var s=t.r(58138),r="function"==typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t==1/e)||t!=t&&e!=e},n=s.useState,l=s.useEffect,o=s.useLayoutEffect,a=s.useDebugValue;function h(t){var e=t.getSnapshot;t=t.value;try{var i=e();return!r(t,i)}catch(t){return!0}}var u="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(t,e){return e()}:function(t,e){var i=e(),s=n({inst:{value:i,getSnapshot:e}}),r=s[0].inst,u=s[1];return o(function(){r.value=i,r.getSnapshot=e,h(r)&&u({inst:r})},[t,i,e]),l(function(){return h(r)&&u({inst:r}),t(function(){h(r)&&u({inst:r})})},[t]),a(i),i};i.useSyncExternalStore=void 0!==s.useSyncExternalStore?s.useSyncExternalStore:u},34960,(t,e,i)=>{"use strict";e.exports=t.r(70305)},31713,t=>{"use strict";let e,i,s;t.i(68519);var r,n,l,o,a,h,u,c,d,m,p,f,g,v,x,w,y,b,S,j,M,C,N,E,P,k,_,R,T,L=t.i(29511),I=t.i(47163);function F({className:t,...e}){return(0,L.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,L.jsx)("table",{"data-slot":"table",className:(0,I.cn)("w-full caption-bottom text-sm",t),...e})})}function z({className:t,...e}){return(0,L.jsx)("thead",{"data-slot":"table-header",className:(0,I.cn)("[&_tr]:border-b",t),...e})}function A({className:t,...e}){return(0,L.jsx)("tbody",{"data-slot":"table-body",className:(0,I.cn)("[&_tr:last-child]:border-0",t),...e})}function D({className:t,...e}){return(0,L.jsx)("tr",{"data-slot":"table-row",className:(0,I.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",t),...e})}function O({className:t,...e}){return(0,L.jsx)("th",{"data-slot":"table-head",className:(0,I.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...e})}function B({className:t,...e}){return(0,L.jsx)("td",{"data-slot":"table-cell",className:(0,I.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...e})}var $=t.i(58138);function W(t){var e=t.width,i=t.height;if(e<0)throw Error("Negative width is not allowed for Size");if(i<0)throw Error("Negative height is not allowed for Size");return{width:e,height:i}}function K(t,e){return t.width===e.width&&t.height===e.height}var V=function(){function t(t){var e=this;this._resolutionListener=function(){return e._onResolutionChanged()},this._resolutionMediaQueryList=null,this._observers=[],this._window=t,this._installResolutionListener()}return t.prototype.dispose=function(){this._uninstallResolutionListener(),this._window=null},Object.defineProperty(t.prototype,"value",{get:function(){return this._window.devicePixelRatio},enumerable:!1,configurable:!0}),t.prototype.subscribe=function(t){var e=this,i={next:t};return this._observers.push(i),{unsubscribe:function(){e._observers=e._observers.filter(function(t){return t!==i})}}},t.prototype._installResolutionListener=function(){if(null!==this._resolutionMediaQueryList)throw Error("Resolution listener is already installed");var t=this._window.devicePixelRatio;this._resolutionMediaQueryList=this._window.matchMedia("all and (resolution: ".concat(t,"dppx)")),this._resolutionMediaQueryList.addListener(this._resolutionListener)},t.prototype._uninstallResolutionListener=function(){null!==this._resolutionMediaQueryList&&(this._resolutionMediaQueryList.removeListener(this._resolutionListener),this._resolutionMediaQueryList=null)},t.prototype._reinstallResolutionListener=function(){this._uninstallResolutionListener(),this._installResolutionListener()},t.prototype._onResolutionChanged=function(){var t=this;this._observers.forEach(function(e){return e.next(t._window.devicePixelRatio)}),this._reinstallResolutionListener()},t}(),U=function(){function t(t,e,i){var s;this._canvasElement=null,this._bitmapSizeChangedListeners=[],this._suggestedBitmapSize=null,this._suggestedBitmapSizeChangedListeners=[],this._devicePixelRatioObservable=null,this._canvasElementResizeObserver=null,this._canvasElement=t,this._canvasElementClientSize=W({width:this._canvasElement.clientWidth,height:this._canvasElement.clientHeight}),this._transformBitmapSize=null!=e?e:function(t){return t},this._allowResizeObserver=null==(s=null==i?void 0:i.allowResizeObserver)||s,this._chooseAndInitObserver()}return t.prototype.dispose=function(){var t,e;if(null===this._canvasElement)throw Error("Object is disposed");null==(t=this._canvasElementResizeObserver)||t.disconnect(),this._canvasElementResizeObserver=null,null==(e=this._devicePixelRatioObservable)||e.dispose(),this._devicePixelRatioObservable=null,this._suggestedBitmapSizeChangedListeners.length=0,this._bitmapSizeChangedListeners.length=0,this._canvasElement=null},Object.defineProperty(t.prototype,"canvasElement",{get:function(){if(null===this._canvasElement)throw Error("Object is disposed");return this._canvasElement},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canvasElementClientSize",{get:function(){return this._canvasElementClientSize},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bitmapSize",{get:function(){return W({width:this.canvasElement.width,height:this.canvasElement.height})},enumerable:!1,configurable:!0}),t.prototype.resizeCanvasElement=function(t){this._canvasElementClientSize=W(t),this.canvasElement.style.width="".concat(this._canvasElementClientSize.width,"px"),this.canvasElement.style.height="".concat(this._canvasElementClientSize.height,"px"),this._invalidateBitmapSize()},t.prototype.subscribeBitmapSizeChanged=function(t){this._bitmapSizeChangedListeners.push(t)},t.prototype.unsubscribeBitmapSizeChanged=function(t){this._bitmapSizeChangedListeners=this._bitmapSizeChangedListeners.filter(function(e){return e!==t})},Object.defineProperty(t.prototype,"suggestedBitmapSize",{get:function(){return this._suggestedBitmapSize},enumerable:!1,configurable:!0}),t.prototype.subscribeSuggestedBitmapSizeChanged=function(t){this._suggestedBitmapSizeChangedListeners.push(t)},t.prototype.unsubscribeSuggestedBitmapSizeChanged=function(t){this._suggestedBitmapSizeChangedListeners=this._suggestedBitmapSizeChangedListeners.filter(function(e){return e!==t})},t.prototype.applySuggestedBitmapSize=function(){if(null!==this._suggestedBitmapSize){var t=this._suggestedBitmapSize;this._suggestedBitmapSize=null,this._resizeBitmap(t),this._emitSuggestedBitmapSizeChanged(t,this._suggestedBitmapSize)}},t.prototype._resizeBitmap=function(t){var e=this.bitmapSize;K(e,t)||(this.canvasElement.width=t.width,this.canvasElement.height=t.height,this._emitBitmapSizeChanged(e,t))},t.prototype._emitBitmapSizeChanged=function(t,e){var i=this;this._bitmapSizeChangedListeners.forEach(function(s){return s.call(i,t,e)})},t.prototype._suggestNewBitmapSize=function(t){var e=this._suggestedBitmapSize,i=W(this._transformBitmapSize(t,this._canvasElementClientSize)),s=K(this.bitmapSize,i)?null:i;null===e&&null===s||null!==e&&null!==s&&K(e,s)||(this._suggestedBitmapSize=s,this._emitSuggestedBitmapSizeChanged(e,s))},t.prototype._emitSuggestedBitmapSizeChanged=function(t,e){var i=this;this._suggestedBitmapSizeChangedListeners.forEach(function(s){return s.call(i,t,e)})},t.prototype._chooseAndInitObserver=function(){var t=this;this._allowResizeObserver?new Promise(function(t){var e=new ResizeObserver(function(i){t(i.every(function(t){return"devicePixelContentBoxSize"in t})),e.disconnect()});e.observe(document.body,{box:"device-pixel-content-box"})}).catch(function(){return!1}).then(function(e){return e?t._initResizeObserver():t._initDevicePixelRatioObservable()}):this._initDevicePixelRatioObservable()},t.prototype._initDevicePixelRatioObservable=function(){var t=this;if(null!==this._canvasElement){var e=H(this._canvasElement);if(null===e)throw Error("No window is associated with the canvas");this._devicePixelRatioObservable=new V(e),this._devicePixelRatioObservable.subscribe(function(){return t._invalidateBitmapSize()}),this._invalidateBitmapSize()}},t.prototype._invalidateBitmapSize=function(){if(null!==this._canvasElement){var t,e,i=H(this._canvasElement);if(null!==i){var s,r,n=null!=(e=null==(t=this._devicePixelRatioObservable)?void 0:t.value)?e:i.devicePixelRatio,l=this._canvasElement.getClientRects(),o=void 0!==l[0]?(s=l[0],r=n,W({width:Math.round(s.left*r+s.width*r)-Math.round(s.left*r),height:Math.round(s.top*r+s.height*r)-Math.round(s.top*r)})):W({width:this._canvasElementClientSize.width*n,height:this._canvasElementClientSize.height*n});this._suggestNewBitmapSize(o)}}},t.prototype._initResizeObserver=function(){var t=this;null!==this._canvasElement&&(this._canvasElementResizeObserver=new ResizeObserver(function(e){var i=e.find(function(e){return e.target===t._canvasElement});if(i&&i.devicePixelContentBoxSize&&i.devicePixelContentBoxSize[0]){var s=i.devicePixelContentBoxSize[0],r=W({width:s.inlineSize,height:s.blockSize});t._suggestNewBitmapSize(r)}}),this._canvasElementResizeObserver.observe(this._canvasElement,{box:"device-pixel-content-box"}))},t}();function H(t){return t.ownerDocument.defaultView}var J=function(){function t(t,e,i){if(0===e.width||0===e.height)throw TypeError("Rendering target could only be created on a media with positive width and height");if(this._mediaSize=e,0===i.width||0===i.height)throw TypeError("Rendering target could only be created using a bitmap with positive integer width and height");this._bitmapSize=i,this._context=t}return t.prototype.useMediaCoordinateSpace=function(t){try{return this._context.save(),this._context.setTransform(1,0,0,1,0,0),this._context.scale(this._horizontalPixelRatio,this._verticalPixelRatio),t({context:this._context,mediaSize:this._mediaSize})}finally{this._context.restore()}},t.prototype.useBitmapCoordinateSpace=function(t){try{return this._context.save(),this._context.setTransform(1,0,0,1,0,0),t({context:this._context,mediaSize:this._mediaSize,bitmapSize:this._bitmapSize,horizontalPixelRatio:this._horizontalPixelRatio,verticalPixelRatio:this._verticalPixelRatio})}finally{this._context.restore()}},Object.defineProperty(t.prototype,"_horizontalPixelRatio",{get:function(){return this._bitmapSize.width/this._mediaSize.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_verticalPixelRatio",{get:function(){return this._bitmapSize.height/this._mediaSize.height},enumerable:!1,configurable:!0}),t}();function q(t,e){var i=t.canvasElementClientSize;if(0===i.width||0===i.height)return null;var s=t.bitmapSize;if(0===s.width||0===s.height)return null;var r=t.canvasElement.getContext("2d",e);return null===r?null:new J(r,i,s)}let Y={title:"",visible:!0,lastValueVisible:!0,priceLineVisible:!0,priceLineSource:0,priceLineWidth:1,priceLineColor:"",priceLineStyle:2,baseLineVisible:!0,baseLineWidth:1,baseLineColor:"#B2B5BE",baseLineStyle:0,priceFormat:{type:"price",precision:2,minMove:.01}};function X(t,e){let i={0:[],1:[t.lineWidth,t.lineWidth],2:[2*t.lineWidth,2*t.lineWidth],3:[6*t.lineWidth,6*t.lineWidth],4:[t.lineWidth,4*t.lineWidth]}[e];t.setLineDash(i)}function G(t,e,i,s){t.beginPath();let r=t.lineWidth%2?.5:0;t.moveTo(i,e+r),t.lineTo(s,e+r),t.stroke()}function Q(t,e){if(!t)throw Error("Assertion failed"+(e?": "+e:""))}function Z(t){if(void 0===t)throw Error("Value is undefined");return t}function tt(t){if(null===t)throw Error("Value is null");return t}function te(t){return tt(Z(t))}(r=b||(b={}))[r.Simple=0]="Simple",r[r.WithSteps=1]="WithSteps",r[r.Curved=2]="Curved",(n=S||(S={}))[n.Solid=0]="Solid",n[n.Dotted=1]="Dotted",n[n.Dashed=2]="Dashed",n[n.LargeDashed=3]="LargeDashed",n[n.SparseDotted=4]="SparseDotted";class ti{constructor(){this.t=[]}i(t,e,i){this.t.push({h:t,l:e,o:!0===i})}_(t){let e=this.t.findIndex(e=>t===e.h);e>-1&&this.t.splice(e,1)}u(t){this.t=this.t.filter(e=>e.l!==t)}p(t,e,i){let s=[...this.t];this.t=this.t.filter(t=>!t.o),s.forEach(s=>s.h(t,e,i))}v(){return this.t.length>0}m(){this.t=[]}}function ts(t,...e){for(let i of e)for(let e in i)void 0!==i[e]&&Object.prototype.hasOwnProperty.call(i,e)&&!["__proto__","constructor","prototype"].includes(e)&&("object"!=typeof i[e]||void 0===t[e]||Array.isArray(i[e])?t[e]=i[e]:ts(t[e],i[e]));return t}function tr(t){return"number"==typeof t&&isFinite(t)}function tn(t){return"number"==typeof t&&t%1==0}function tl(t){return"string"==typeof t}function to(t){return"boolean"==typeof t}function ta(t){let e,i,s;if(!t||"object"!=typeof t)return t;for(i in e=Array.isArray(t)?[]:{},t)t.hasOwnProperty(i)&&(s=t[i],e[i]=s&&"object"==typeof s?ta(s):s);return e}function th(t){return null!==t}function tu(t){return null===t?void 0:t}let tc="-apple-system, BlinkMacSystemFont, 'Trebuchet MS', Roboto, Ubuntu, sans-serif";function td(t,e,i){return void 0===e&&(e=tc),`${i=void 0!==i?`${i} `:""}${t}px ${e}`}class tm{constructor(t){this.M={S:1,C:5,k:NaN,P:"",T:"",R:"",D:"",I:0,V:0,B:0,A:0,L:0},this.O=t}N(){let t=this.M,e=this.F(),i=this.W();return t.k===e&&t.T===i||(t.k=e,t.T=i,t.P=td(e,i),t.A=2.5/12*e,t.I=t.A,t.V=e/12*t.C,t.B=e/12*t.C,t.L=0),t.R=this.H(),t.D=this.U(),this.M}H(){return this.O.N().layout.textColor}U(){return this.O.$()}F(){return this.O.N().layout.fontSize}W(){return this.O.N().layout.fontFamily}}function tp(t){return t<0?0:t>255?255:Math.round(t)||0}function tf(t){return .199*t[0]+.687*t[1]+.114*t[2]}class tg{constructor(t,e){this.q=new Map,this.j=t,e&&(this.q=e)}Y(t,e){if("transparent"===t)return t;let i=this.K(t),s=i[3];return`rgba(${i[0]}, ${i[1]}, ${i[2]}, ${e*s})`}Z(t){let e=this.K(t);return{G:`rgb(${e[0]}, ${e[1]}, ${e[2]})`,X:tf(e)>160?"black":"white"}}J(t){return tf(this.K(t))}tt(t,e,i){var s;let[r,n,l,o]=this.K(t),[a,h,u,c]=this.K(e),d=[tp(r+i*(a-r)),tp(n+i*(h-n)),tp(l+i*(u-l)),(s=o+i*(c-o))<=0||s>1?Math.min(Math.max(s,0),1):Math.round(1e4*s)/1e4];return`rgba(${d[0]}, ${d[1]}, ${d[2]}, ${d[3]})`}K(t){let e,i,s=this.q.get(t);if(s)return s;let r=((e=document.createElement("div")).style.display="none",document.body.appendChild(e),e.style.color=t,i=window.getComputedStyle(e).color,document.body.removeChild(e),i).match(/^rgba?\s*\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d+))?\)$/);if(!r){if(this.j.length)for(let e of this.j){let i=e(t);if(i)return this.q.set(t,i),i}throw Error(`Failed to parse color: ${t}`)}let n=[parseInt(r[1],10),parseInt(r[2],10),parseInt(r[3],10),r[4]?parseFloat(r[4]):1];return this.q.set(t,n),n}}class tv{constructor(){this.it=[]}st(t){this.it=t}nt(t,e,i){this.it.forEach(s=>{s.nt(t,e,i)})}}class tx{nt(t,e,i){t.useBitmapCoordinateSpace(t=>this.et(t,e,i))}}class tw extends tx{constructor(){super(...arguments),this.rt=null}ht(t){this.rt=t}et({context:t,horizontalPixelRatio:e,verticalPixelRatio:i}){if(null===this.rt||null===this.rt.lt)return;let s=this.rt.lt,r=this.rt,n=Math.max(1,Math.floor(e))%2/2,l=l=>{t.beginPath();for(let o=s.to-1;o>=s.from;--o){let s=r.ot[o],a=Math.round(s._t*e)+n,h=s.ut*i,u=l*i+n;t.moveTo(a,h),t.arc(a,h,u,0,2*Math.PI)}t.fill()};r.ct>0&&(t.fillStyle=r.dt,l(r.ft+r.ct)),t.fillStyle=r.vt,l(r.ft)}}function ty(){return{ot:[{_t:0,ut:0,wt:0,gt:0}],vt:"",dt:"",ft:0,ct:0,lt:null}}let tb={from:0,to:1};class tS{constructor(t,e,i){this.Mt=new tv,this.bt=[],this.St=[],this.xt=!0,this.O=t,this.Ct=e,this.yt=i,this.Mt.st(this.bt)}kt(t){this.Pt(),this.xt=!0}Tt(){return this.xt&&(this.Rt(),this.xt=!1),this.Mt}Pt(){let t=this.yt.Dt();t.length!==this.bt.length&&(this.St=t.map(ty),this.bt=this.St.map(t=>{let e=new tw;return e.ht(t),e}),this.Mt.st(this.bt))}Rt(){let t=2===this.Ct.N().mode||!this.Ct.It(),e=this.yt.Vt(),i=this.Ct.Bt(),s=this.O.Et();this.Pt(),e.forEach((e,r)=>{let n=this.St[r],l=e.At(i),o=e.Lt();!t&&null!==l&&e.It()&&null!==o?(n.vt=l.zt,n.ft=l.ft,n.ct=l.Ot,n.ot[0].gt=l.gt,n.ot[0].ut=e.Ft().Nt(l.gt,o.Wt),n.dt=l.Ht??this.O.Ut(n.ot[0].ut/e.Ft().$t()),n.ot[0].wt=i,n.ot[0]._t=s.qt(i),n.lt=tb):n.lt=null})}}class tj extends tx{constructor(t){super(),this.jt=t}et({context:t,bitmapSize:e,horizontalPixelRatio:i,verticalPixelRatio:s}){var r;let n;if(null===this.jt)return;let l=this.jt.Yt.It,o=this.jt.Kt.It;if(!l&&!o)return;let a=Math.round(this.jt._t*i),h=Math.round(this.jt.ut*s);t.lineCap="butt",l&&a>=0&&(t.lineWidth=Math.floor(this.jt.Yt.ct*i),t.strokeStyle=this.jt.Yt.R,t.fillStyle=this.jt.Yt.R,X(t,this.jt.Yt.Zt),r=e.height,t.beginPath(),n=t.lineWidth%2?.5:0,t.moveTo(a+n,0),t.lineTo(a+n,r),t.stroke()),o&&h>=0&&(t.lineWidth=Math.floor(this.jt.Kt.ct*s),t.strokeStyle=this.jt.Kt.R,t.fillStyle=this.jt.Kt.R,X(t,this.jt.Kt.Zt),G(t,h,0,e.width))}}class tM{constructor(t,e){this.xt=!0,this.Gt={Yt:{ct:1,Zt:0,R:"",It:!1},Kt:{ct:1,Zt:0,R:"",It:!1},_t:0,ut:0},this.Xt=new tj(this.Gt),this.Jt=t,this.yt=e}kt(){this.xt=!0}Tt(t){return this.xt&&(this.Rt(),this.xt=!1),this.Xt}Rt(){let t=this.Jt.It(),e=this.yt.Qt().N().crosshair,i=this.Gt;2===e.mode?(i.Kt.It=!1,i.Yt.It=!1):(i.Kt.It=t&&this.Jt.ti(this.yt),i.Yt.It=t&&this.Jt.ii(),i.Kt.ct=e.horzLine.width,i.Kt.Zt=e.horzLine.style,i.Kt.R=e.horzLine.color,i.Yt.ct=e.vertLine.width,i.Yt.Zt=e.vertLine.style,i.Yt.R=e.vertLine.color,i._t=this.Jt.si(),i.ut=this.Jt.ni())}}function tC(t,e,i,s,r,n){t.save(),t.globalCompositeOperation="copy",t.fillStyle=n,t.fillRect(e,i,s,r),t.restore()}function tN(t,e,i,s,r,n){t.beginPath(),t.roundRect?t.roundRect(e,i,s,r,n):(t.lineTo(e+s-n[1],i),0!==n[1]&&t.arcTo(e+s,i,e+s,i+n[1],n[1]),t.lineTo(e+s,i+r-n[2]),0!==n[2]&&t.arcTo(e+s,i+r,e+s-n[2],i+r,n[2]),t.lineTo(e+n[3],i+r),0!==n[3]&&t.arcTo(e,i+r,e,i+r-n[3],n[3]),t.lineTo(e,i+n[0]),0!==n[0]&&t.arcTo(e,i,e+n[0],i,n[0]))}function tE(t,e,i,s,r,n,l=0,o=[0,0,0,0],a=""){var h;if(t.save(),!l||!a||a===n)return tN(t,e,i,s,r,o),t.fillStyle=n,t.fill(),void t.restore();let u=l/2;tN(t,e+u,i+u,s-l,r-l,(h=-u,o.map(t=>0===t?t:t+h))),"transparent"!==n&&(t.fillStyle=n,t.fill()),"transparent"!==a&&(t.lineWidth=l,t.strokeStyle=a,t.closePath(),t.stroke()),t.restore()}function tP(t,e,i,s,r,n,l){t.save(),t.globalCompositeOperation="copy";let o=t.createLinearGradient(0,0,0,r);o.addColorStop(0,n),o.addColorStop(1,l),t.fillStyle=o,t.fillRect(e,i,s,r),t.restore()}class tk{constructor(t,e){this.ht(t,e)}ht(t,e){this.jt=t,this.ei=e}$t(t,e){return this.jt.It?t.k+t.A+t.I:0}nt(t,e,i,s){if(!this.jt.It||0===this.jt.ri.length)return;let r=this.jt.R,n=this.ei.G,l=t.useBitmapCoordinateSpace(t=>{let l=t.context;l.font=e.P;let o=this.hi(t,e,i,s),a=o.ai;return o.li?tE(l,a.oi,a._i,a.ui,a.ci,n,a.di,[a.ft,0,0,a.ft],n):tE(l,a.fi,a._i,a.ui,a.ci,n,a.di,[0,a.ft,a.ft,0],n),this.jt.pi&&(l.fillStyle=r,l.fillRect(a.fi,a.mi,a.wi-a.fi,a.gi)),this.jt.Mi&&(l.fillStyle=e.D,l.fillRect(o.li?a.bi-a.di:0,a._i,a.di,a.Si-a._i)),o});t.useMediaCoordinateSpace(({context:t})=>{let i=l.xi;t.font=e.P,t.textAlign=l.li?"right":"left",t.textBaseline="middle",t.fillStyle=r,t.fillText(this.jt.ri,i.Ci,(i._i+i.Si)/2+i.yi)})}hi(t,e,i,s){let r,n,l,{context:o,bitmapSize:a,mediaSize:h,horizontalPixelRatio:u,verticalPixelRatio:c}=t,d=this.jt.pi||!this.jt.ki?e.C:0,m=this.jt.Pi?e.S:0,p=e.A+this.ei.Ti,f=e.I+this.ei.Ri,g=e.V,v=e.B,x=this.jt.ri,w=e.k,y=i.Di(o,x),b=Math.ceil(i.Ii(o,x)),S=e.S+g+v+b+d,j=Math.max(1,Math.floor(c)),M=Math.round((w+p+f)*c);M%2!=j%2&&(M+=1);let C=m>0?Math.max(1,Math.floor(m*u)):0,N=Math.round(S*u),E=Math.round(d*u),P=Math.round((this.ei.Vi??this.ei.Bi??this.ei.Ei)*c)-Math.floor(.5*c),k=Math.floor(P+j/2-M/2),_=k+M,R="right"===s,T=R?h.width-m:m,L=R?a.width-C:C;return R?(r=L-N,n=L-E,l=T-d-g-m):(r=L+N,n=L+E,l=T+d+g),{li:R,ai:{_i:k,mi:P,Si:_,ui:N,ci:M,ft:2*u,di:C,oi:r,fi:L,wi:n,gi:j,bi:a.width},xi:{_i:k/c,Si:_/c,Ci:l,yi:y}}}}class t_{constructor(t){this.Ai={Ei:0,G:"#000",Ri:0,Ti:0},this.Li={ri:"",It:!1,pi:!0,ki:!1,Ht:"",R:"#FFF",Mi:!1,Pi:!1},this.zi={ri:"",It:!1,pi:!1,ki:!0,Ht:"",R:"#FFF",Mi:!0,Pi:!0},this.xt=!0,this.Oi=new(t||tk)(this.Li,this.Ai),this.Ni=new(t||tk)(this.zi,this.Ai)}ri(){return this.Fi(),this.Li.ri}Ei(){return this.Fi(),this.Ai.Ei}kt(){this.xt=!0}$t(t,e=!1){return Math.max(this.Oi.$t(t,e),this.Ni.$t(t,e))}Wi(){return this.Ai.Vi??null}Hi(){return this.Ai.Vi??this.Ai.Bi??this.Ei()}Ui(t){this.Ai.Bi=t??void 0}$i(){return this.Fi(),this.Li.It||this.zi.It}qi(){return this.Fi(),this.Li.It}Tt(t){return this.Fi(),this.Li.pi=this.Li.pi&&t.N().ticksVisible,this.zi.pi=this.zi.pi&&t.N().ticksVisible,this.Oi.ht(this.Li,this.Ai),this.Ni.ht(this.zi,this.Ai),this.Oi}ji(){return this.Fi(),this.Oi.ht(this.Li,this.Ai),this.Ni.ht(this.zi,this.Ai),this.Ni}Fi(){this.xt&&(this.Li.pi=!0,this.zi.pi=!1,this.Yi(this.Li,this.zi,this.Ai))}}class tR extends t_{constructor(t,e,i){super(),this.Jt=t,this.Ki=e,this.Zi=i}Yi(t,e,i){if(t.It=!1,2===this.Jt.N().mode)return;let s=this.Jt.N().horzLine;if(!s.labelVisible)return;let r=this.Ki.Lt();if(!this.Jt.It()||this.Ki.Gi()||null===r)return;let n=this.Ki.Xi().Z(s.labelBackgroundColor);i.G=n.G,t.R=n.X;let l=2/12*this.Ki.k();i.Ti=l,i.Ri=l;let o=this.Zi(this.Ki);i.Ei=o.Ei,t.ri=this.Ki.Ji(o.gt,r),t.It=!0}}let tT=/[1-9]/g;class tL{constructor(){this.jt=null}ht(t){this.jt=t}nt(t,e){if(null===this.jt||!1===this.jt.It||0===this.jt.ri.length)return;let i=t.useMediaCoordinateSpace(({context:t})=>(t.font=e.P,Math.round(e.Qi.Ii(t,tt(this.jt).ri,tT))));if(i<=0)return;let s=e.ts,r=i+2*s,n=r/2,l=this.jt.ss,o=this.jt.Ei,a=Math.floor(o-n)+.5;a<0?(o+=Math.abs(0-a),a=Math.floor(o-n)+.5):a+r>l&&(o-=Math.abs(l-(a+r)),a=Math.floor(o-n)+.5);let h=a+r,u=Math.ceil(0+e.S+e.C+e.A+e.k+e.I);t.useBitmapCoordinateSpace(({context:t,horizontalPixelRatio:i,verticalPixelRatio:s})=>{let r=tt(this.jt);t.fillStyle=r.G;let n=Math.round(a*i),l=Math.round(0*s),o=Math.round(h*i),c=Math.round(u*s),d=Math.round(2*i);if(t.beginPath(),t.moveTo(n,l),t.lineTo(n,c-d),t.arcTo(n,c,n+d,c,d),t.lineTo(o-d,c),t.arcTo(o,c,o,c-d,d),t.lineTo(o,l),t.fill(),r.pi){let n=Math.round(r.Ei*i),o=Math.round((l+e.C)*s);t.fillStyle=r.R;let a=Math.max(1,Math.floor(i)),h=Math.floor(.5*i);t.fillRect(n-h,l,a,o-l)}}),t.useMediaCoordinateSpace(({context:t})=>{let i=tt(this.jt),r=0+e.S+e.C+e.A+e.k/2;t.font=e.P,t.textAlign="left",t.textBaseline="middle",t.fillStyle=i.R;let n=e.Qi.Di(t,"Apr0");t.translate(a+s,r+n),t.fillText(i.ri,0,0)})}}class tI{constructor(t,e,i){this.xt=!0,this.Xt=new tL,this.Gt={It:!1,G:"#4c525e",R:"white",ri:"",ss:0,Ei:NaN,pi:!0},this.Ct=t,this.ns=e,this.Zi=i}kt(){this.xt=!0}Tt(){return this.xt&&(this.Rt(),this.xt=!1),this.Xt.ht(this.Gt),this.Xt}Rt(){let t=this.Gt;if(t.It=!1,2===this.Ct.N().mode)return;let e=this.Ct.N().vertLine;if(!e.labelVisible)return;let i=this.ns.Et();if(i.Gi())return;t.ss=i.ss();let s=this.Zi();if(null===s)return;t.Ei=s.Ei;let r=i.es(this.Ct.Bt());t.ri=i.rs(tt(r)),t.It=!0;let n=this.ns.Xi().Z(e.labelBackgroundColor);t.G=n.G,t.R=n.X,t.pi=i.N().ticksVisible}}class tF{constructor(){this.hs=null,this.ls=0}_s(){return this.ls}us(t){this.ls=t}Ft(){return this.hs}cs(t){this.hs=t}ds(t){return[]}fs(){return[]}It(){return!0}}(l=j||(j={}))[l.Normal=0]="Normal",l[l.Magnet=1]="Magnet",l[l.Hidden=2]="Hidden",l[l.MagnetOHLC=3]="MagnetOHLC";class tz extends tF{constructor(t,e){let i,s,r,n;super(),this.yt=null,this.ps=NaN,this.vs=0,this.ws=!1,this.gs=new Map,this.Ms=!1,this.bs=new WeakMap,this.Ss=new WeakMap,this.xs=NaN,this.Cs=NaN,this.ys=NaN,this.ks=NaN,this.ns=t,this.Ps=e,this.Ts=(i=()=>this.ps,s=()=>this.Cs,t=>{let e=s(),r=i();if(t===tt(this.yt).Rs())return{gt:r,Ei:e};{let i=tt(t.Lt());return{gt:t.Ds(e,i),Ei:e}}});const l=(r=()=>this.vs,n=()=>this.si(),()=>{let t=this.ns.Et().Is(r()),e=n();return t&&Number.isFinite(e)?{wt:t,Ei:e}:null});this.Vs=new tI(this,t,l)}N(){return this.Ps}Bs(t,e){this.ys=t,this.ks=e}Es(){this.ys=NaN,this.ks=NaN}As(){return this.ys}Ls(){return this.ks}zs(t,e,i){this.Ms||(this.Ms=!0),this.ws=!0,this.Os(t,e,i)}Bt(){return this.vs}si(){return this.xs}ni(){return this.Cs}It(){return this.ws}Ns(){this.ws=!1,this.Fs(),this.ps=NaN,this.xs=NaN,this.Cs=NaN,this.yt=null,this.Es(),this.Ws()}Hs(t){if(!this.Ps.doNotSnapToHiddenSeriesIndices)return t;let e=this.ns,i=e.Et(),s=null,r=null;for(let i of e.Us()){let e=i.qs().$s(t,-1);if(e){if(e.js===t)return t;(null===s||e.js>s)&&(s=e.js)}let n=i.qs().$s(t,1);if(n){if(n.js===t)return t;(null===r||n.js<r)&&(r=n.js)}}let n=[s,r].filter(th);if(0===n.length)return t;let l=i.qt(t),o=n.map(t=>Math.abs(l-i.qt(t)));return n[o.indexOf(Math.min(...o))]}Ys(t){let e=this.bs.get(t);e||(e=new tM(this,t),this.bs.set(t,e));let i=this.Ss.get(t);return i||(i=new tS(this.ns,this,t),this.Ss.set(t,i)),[e,i]}ti(t){return t===this.yt&&this.Ps.horzLine.visible}ii(){return this.Ps.vertLine.visible}Ks(t,e){this.ws&&this.yt===t||this.gs.clear();let i=[];return this.yt===t&&i.push(this.Zs(this.gs,e,this.Ts)),i}fs(){return this.ws?[this.Vs]:[]}Gs(){return this.yt}Ws(){this.ns.Xs().forEach(t=>{this.bs.get(t)?.kt(),this.Ss.get(t)?.kt()}),this.gs.forEach(t=>t.kt()),this.Vs.kt()}Js(t){return t&&!t.Rs().Gi()?t.Rs():null}Os(t,e,i){this.Qs(t,e,i)&&this.Ws()}Qs(t,e,i){let s=this.xs,r=this.Cs,n=this.ps,l=this.vs,o=this.yt,a=this.Js(i);this.vs=t,this.xs=isNaN(t)?NaN:this.ns.Et().qt(t),this.yt=i;let h=null!==a?a.Lt():null;return null!==a&&null!==h?(this.ps=e,this.Cs=a.Nt(e,h)):(this.ps=NaN,this.Cs=NaN),s!==this.xs||r!==this.Cs||l!==this.vs||n!==this.ps||o!==this.yt}Fs(){let t=this.ns.tn().map(t=>t.qs().sn()).filter(th),e=0===t.length?null:Math.max(...t);this.vs=null!==e?e:NaN}Zs(t,e,i){let s=t.get(e);return void 0===s&&(s=new tR(this,e,i),t.set(e,s)),s}}function tA(t){return"left"===t||"right"===t}class tD{constructor(t){this.nn=new Map,this.en=[],this.rn=t}hn(t,e){var i;let s=(i=this.nn.get(t),void 0===i?e:{an:Math.max(i.an,e.an),ln:i.ln||e.ln});this.nn.set(t,s)}_n(){return this.rn}un(t){let e=this.nn.get(t);return void 0===e?{an:this.rn}:{an:Math.max(this.rn,e.an),ln:e.ln}}cn(){this.dn(),this.en=[{fn:0}]}pn(t){this.dn(),this.en=[{fn:1,Wt:t}]}vn(t){this.mn(),this.en.push({fn:5,Wt:t})}dn(){this.mn(),this.en.push({fn:6})}wn(){this.dn(),this.en=[{fn:4}]}gn(t){this.dn(),this.en.push({fn:2,Wt:t})}Mn(t){this.dn(),this.en.push({fn:3,Wt:t})}bn(){return this.en}Sn(t){for(let e of t.en)this.xn(e);this.rn=Math.max(this.rn,t.rn),t.nn.forEach((t,e)=>{this.hn(e,t)})}static Cn(){return new tD(2)}static yn(){return new tD(3)}xn(t){switch(t.fn){case 0:this.cn();break;case 1:this.pn(t.Wt);break;case 2:this.gn(t.Wt);break;case 3:this.Mn(t.Wt);break;case 4:this.wn();break;case 5:this.vn(t.Wt);break;case 6:this.mn()}}mn(){let t=this.en.findIndex(t=>5===t.fn);-1!==t&&this.en.splice(t,1)}}class tO{formatTickmarks(t){return t.map(t=>this.format(t))}}function tB(t,e){if(!tr(t))return"n/a";if(!tn(e)||e<0||e>16)throw TypeError("invalid length");return 0===e?t.toString():("0000000000000000"+t.toString()).slice(-e)}class t$ extends tO{constructor(t,e){if(super(),e||(e=1),tr(t)&&tn(t)||(t=100),t<0)throw TypeError("invalid base");this.Ki=t,this.kn=e,this.Pn()}format(t){let e=t<0?"âˆ’":"";return t=Math.abs(t),e+this.Tn(t)}Pn(){if(this.Rn=0,this.Ki>0&&this.kn>0){let t=this.Ki;for(;t>1;)t/=10,this.Rn++}}Tn(t){let e=this.Ki/this.kn,i=Math.floor(t),s="",r=void 0!==this.Rn?this.Rn:NaN;if(e>1){let n=+(Math.round(t*e)-i*e).toFixed(this.Rn);n>=e&&(n-=e,i+=1),s="."+tB(n.toFixed(this.Rn)*this.kn,r)}else i=Math.round(i*e)/e,r>0&&(s="."+tB(0,r));return i.toFixed(0)+s}}class tW extends t${constructor(t=100){super(t)}format(t){return`${super.format(t)}%`}}class tK extends tO{constructor(t){super(),this.Dn=t}format(t){let e="";return t<0&&(e="-",t=-t),t<995?e+this.In(t):t<999995?e+this.In(t/1e3)+"K":t<0x3b9ac9fb?(t=1e3*Math.round(t/1e3),e+this.In(t/1e6)+"M"):(t=1e6*Math.round(t/1e6),e+this.In(t/1e9)+"B")}In(t){let e=Math.pow(10,this.Dn);return((t=Math.round(t*e)/e)>=1e-15&&t<1?t.toFixed(this.Dn).replace(/\.?0+$/,""):String(t)).replace(/(\.[1-9]*)0+$/,(t,e)=>e)}}let tV=/[2-9]/g;class tU{constructor(t=50){this.Vn=0,this.Bn=1,this.En=1,this.An={},this.Ln=new Map,this.zn=t}On(){this.Vn=0,this.Ln.clear(),this.Bn=1,this.En=1,this.An={}}Ii(t,e,i){return this.Nn(t,e,i).width}Di(t,e,i){let s=this.Nn(t,e,i);return((s.actualBoundingBoxAscent||0)-(s.actualBoundingBoxDescent||0))/2}Nn(t,e,i){let s=String(e).replace(i||tV,"0");if(this.Ln.has(s))return Z(this.Ln.get(s)).Fn;if(this.Vn===this.zn){let t=this.An[this.En];delete this.An[this.En],this.Ln.delete(t),this.En++,this.Vn--}t.save(),t.textBaseline="middle";let r=t.measureText(s);return t.restore(),0===r.width&&e.length||(this.Ln.set(s,{Fn:r,Wn:this.Bn}),this.An[this.Bn]=s,this.Vn++,this.Bn++),r}}class tH{constructor(t){this.Hn=null,this.M=null,this.Un="right",this.$n=t}qn(t,e,i){this.Hn=t,this.M=e,this.Un=i}nt(t){null!==this.M&&null!==this.Hn&&this.Hn.nt(t,this.M,this.$n,this.Un)}}class tJ{constructor(t,e,i){this.jn=t,this.$n=new tU(50),this.Yn=e,this.O=i,this.F=-1,this.Xt=new tH(this.$n)}Tt(){let t=this.O.Kn(this.Yn);if(null===t)return null;let e=t.Zn(this.Yn)?t.Gn():this.Yn.Ft();if(null===e)return null;let i=t.Xn(e);if("overlay"===i)return null;let s=this.O.Jn();return s.k!==this.F&&(this.F=s.k,this.$n.On()),this.Xt.qn(this.jn.ji(),s,i),this.Xt}}class tq extends tx{constructor(){super(...arguments),this.jt=null}ht(t){this.jt=t}Qn(t,e){if(!this.jt?.It)return null;let{ut:i,ct:s,te:r}=this.jt;return e>=i-s-7&&e<=i+s+7?{ie:this.jt,te:r}:null}et({context:t,bitmapSize:e,horizontalPixelRatio:i,verticalPixelRatio:s}){if(null===this.jt||!1===this.jt.It)return;let r=Math.round(this.jt.ut*s);r<0||r>e.height||(t.lineCap="butt",t.strokeStyle=this.jt.R,t.lineWidth=Math.floor(this.jt.ct*i),X(t,this.jt.Zt),G(t,r,0,e.width))}}class tY{constructor(t){this.se={ut:0,R:"rgba(0, 0, 0, 0)",ct:1,Zt:0,It:!1},this.ne=new tq,this.xt=!0,this.ee=t,this.re=t.Qt(),this.ne.ht(this.se)}kt(){this.xt=!0}Tt(){return this.ee.It()?(this.xt&&(this.he(),this.xt=!1),this.ne):null}}class tX extends tY{constructor(t){super(t)}he(){this.se.It=!1;let t=this.ee.Ft(),e=t.ae().ae;if(2!==e&&3!==e)return;let i=this.ee.N();if(!i.baseLineVisible||!this.ee.It())return;let s=this.ee.Lt();null!==s&&(this.se.It=!0,this.se.ut=t.Nt(s.Wt,s.Wt),this.se.R=i.baseLineColor,this.se.ct=i.baseLineWidth,this.se.Zt=i.baseLineStyle)}}class tG extends tx{constructor(){super(...arguments),this.jt=null}ht(t){this.jt=t}le(){return this.jt}et({context:t,horizontalPixelRatio:e,verticalPixelRatio:i}){let s=this.jt;if(null===s)return;let r=Math.max(1,Math.floor(e)),n=r%2/2,l=Math.round(s.oe.x*e)+n,o=s.oe.y*i;t.fillStyle=s._e,t.beginPath();let a=Math.max(2,1.5*s.ue)*e;t.arc(l,o,a,0,2*Math.PI,!1),t.fill(),t.fillStyle=s.ce,t.beginPath(),t.arc(l,o,s.ft*e,0,2*Math.PI,!1),t.fill(),t.lineWidth=r,t.strokeStyle=s.de,t.beginPath(),t.arc(l,o,s.ft*e+r/2,0,2*Math.PI,!1),t.stroke()}}let tQ=[{fe:0,pe:.25,ve:4,me:10,we:.25,ge:0,Me:.4,be:.8},{fe:.25,pe:.525,ve:10,me:14,we:0,ge:0,Me:.8,be:0},{fe:.525,pe:1,ve:14,me:14,we:0,ge:0,Me:0,be:0}];class tZ{constructor(t){this.Xt=new tG,this.xt=!0,this.Se=!0,this.xe=performance.now(),this.Ce=this.xe-1,this.ye=t}ke(){this.Ce=this.xe-1,this.kt()}Pe(){if(this.kt(),2===this.ye.N().lastPriceAnimation){let t=performance.now(),e=this.Ce-t;if(e>0)return void(e<650&&(this.Ce+=2600));this.xe=t,this.Ce=t+2600}}kt(){this.xt=!0}Te(){this.Se=!0}It(){return 0!==this.ye.N().lastPriceAnimation}Re(){switch(this.ye.N().lastPriceAnimation){case 0:return!1;case 1:return!0;case 2:return performance.now()<=this.Ce}}Tt(){return this.xt?(this.Rt(),this.xt=!1,this.Se=!1):this.Se&&(this.De(),this.Se=!1),this.Xt}Rt(){this.Xt.ht(null);let t=this.ye.Qt().Et(),e=t.Ie(),i=this.ye.Lt();if(null===e||null===i)return;let s=this.ye.Ve(!0);if(s.Be||!e.Ee(s.js))return;let r={x:t.qt(s.js),y:this.ye.Ft().Nt(s.gt,i.Wt)},n=s.R,l=this.ye.N().lineWidth,o=this.Ae(this.Le(),n);this.Xt.ht({_e:n,ue:l,ce:o.ce,de:o.de,ft:o.ft,oe:r})}De(){let t=this.Xt.le();if(null!==t){let e=this.Ae(this.Le(),t._e);t.ce=e.ce,t.de=e.de,t.ft=e.ft}}Le(){return this.Re()?performance.now()-this.xe:2599}ze(t,e,i,s){return this.ye.Qt().Xi().Y(t,i+(s-i)*e)}Ae(t,e){var i;let s,r=t%2600/2600;for(let t of tQ)if(r>=t.fe&&r<=t.pe){s=t;break}Q(void 0!==s,"Last price animation internal logic error");let n=(r-s.fe)/(s.pe-s.fe);return{ce:this.ze(e,n,s.we,s.ge),de:this.ze(e,n,s.Me,s.be),ft:(i=s.ve)+(s.me-i)*n}}}class t0 extends tY{constructor(t){super(t)}he(){let t=this.se;t.It=!1;let e=this.ee.N();if(!e.priceLineVisible||!this.ee.It())return;let i=this.ee.Ve(0===e.priceLineSource);i.Be||(t.It=!0,t.ut=i.Ei,t.R=this.ee.Oe(i.R),t.ct=e.priceLineWidth,t.Zt=e.priceLineStyle)}}class t1 extends t_{constructor(t){super(),this.Jt=t}Yi(t,e,i){t.It=!1,e.It=!1;let s=this.Jt;if(!s.It())return;let r=s.N(),n=r.lastValueVisible,l=""!==s.Ne(),o=0===r.seriesLastValueMode,a=s.Ve(!1);if(a.Be)return;n&&(t.ri=this.Fe(a,n,o),t.It=0!==t.ri.length),(l||o)&&(e.ri=this.We(a,n,l,o),e.It=e.ri.length>0);let h=s.Oe(a.R),u=this.Jt.Qt().Xi().Z(h);i.G=u.G,i.Ei=a.Ei,e.Ht=s.Qt().Ut(a.Ei/s.Ft().$t()),t.Ht=h,t.R=u.X,e.R=u.X}We(t,e,i,s){let r="",n=this.Jt.Ne();return i&&0!==n.length&&(r+=`${n} `),e&&s&&(r+=this.Jt.Ft().He()?t.Ue:t.$e),r.trim()}Fe(t,e,i){return e?i?this.Jt.Ft().He()?t.$e:t.Ue:t.ri:""}}function t2(t,e,i,s){let r=Number.isFinite(e),n=Number.isFinite(i);return r&&n?t(e,i):r||n?r?e:i:s}class t3{constructor(t,e){this.qe=t,this.je=e}Ye(t){return null!==t&&this.qe===t.qe&&this.je===t.je}Ke(){return new t3(this.qe,this.je)}Ze(){return this.qe}Ge(){return this.je}Xe(){return this.je-this.qe}Gi(){return this.je===this.qe||Number.isNaN(this.je)||Number.isNaN(this.qe)}Sn(t){return null===t?this:new t3(t2(Math.min,this.Ze(),t.Ze(),-1/0),t2(Math.max,this.Ge(),t.Ge(),1/0))}Je(t){if(!tr(t)||0==this.je-this.qe)return;let e=.5*(this.je+this.qe),i=this.je-e,s=this.qe-e;i*=t,s*=t,this.je=e+i,this.qe=e+s}Qe(t){tr(t)&&(this.je+=t,this.qe+=t)}tr(){return{minValue:this.qe,maxValue:this.je}}static ir(t){return null===t?null:new t3(t.minValue,t.maxValue)}}class t5{constructor(t,e){this.sr=t,this.nr=e||null}er(){return this.sr}rr(){return this.nr}tr(){return{priceRange:null===this.sr?null:this.sr.tr(),margins:this.nr||void 0}}static ir(t){return null===t?null:new t5(t3.ir(t.priceRange),t.margins)}}let t4=[2,4,8,16,32,64,128,256,512];class t6 extends tY{constructor(t,e){super(t),this.hr=e}he(){let t=this.se;t.It=!1;let e=this.hr.N();if(!this.ee.It()||!e.lineVisible)return;let i=this.hr.ar();null!==i&&(t.It=!0,t.ut=i,t.R=e.color,t.ct=e.lineWidth,t.Zt=e.lineStyle,t.te=this.hr.N().id)}}class t9 extends t_{constructor(t,e){super(),this.ye=t,this.hr=e}Yi(t,e,i){t.It=!1,e.It=!1;let s=this.hr.N(),r=s.axisLabelVisible,n=""!==s.title,l=this.ye;if(!r||!l.It())return;let o=this.hr.ar();if(null===o)return;n&&(e.ri=s.title,e.It=!0),e.Ht=l.Qt().Ut(o/l.Ft().$t()),t.ri=this.lr(s.price),t.It=!0;let a=this.ye.Qt().Xi().Z(s.axisLabelColor||s.color);i.G=a.G;let h=s.axisLabelTextColor||a.X;t.R=h,e.R=h,i.Ei=o}lr(t){let e=this.ye.Lt();return null===e?"":this.ye.Ft().Ji(t,e.Wt)}}class t7{constructor(t,e){this.ye=t,this.Ps=e,this._r=new t6(t,this),this.jn=new t9(t,this),this.ur=new tJ(this.jn,t,t.Qt())}cr(t){ts(this.Ps,t),this.kt(),this.ye.Qt().dr()}N(){return this.Ps}pr(){return this._r}vr(){return this.ur}mr(){return this.jn}kt(){this._r.kt(),this.jn.kt()}ar(){let t=this.ye,e=t.Ft();if(t.Qt().Et().Gi()||e.Gi())return null;let i=t.Lt();return null===i?null:e.Nt(this.Ps.price,i.Wt)}}class t8{constructor(){this.wr=new WeakMap}gr(t,e,i){let s=1/e*i;return t>=s?1:Math.min(Math.pow(2,Math.floor(Math.log2(s/t))),512)}Mr(t,e,i,s=!1,r){if(0===t.length||e<=1)return t;let n=this.br(e);if(n<=1)return t;let l=this.Sr(t),o=l.Cr.get(n);return void 0!==o||(o=this.yr(t,n,i,s,r,l.Cr),l.Cr.set(n,o)),o}kr(t,e,i,s,r=!1,n){if(i<1||0===t.length)return t;let l=this.Sr(t),o=l.Cr.get(i);if(!o)return this.Mr(t,i,s,r,n);let a=this.Pr(t,e,i,o,r,s,n);return l.Cr.set(i,a),a}br(t){if(t<=2)return 2;for(let e of t4)if(t<=e)return e;return 512}Tr(t){if(0===t.length)return 0;let e=t[0],i=t[t.length-1];return 31*t.length+17*e.js+13*i.js}yr(t,e,i,s=!1,r,n=new Map){if(2===e)return this.Rr(t,2,i,s,r);let l=e/2,o=n.get(l);return o||(o=this.yr(t,l,i,s,r,n),n.set(l,o)),this.Dr(o,i,s,r)}Rr(t,e,i,s=!1,r){let n=this.Ir(t,e,i,s,r);return this.Vr(n,s)}Dr(t,e,i=!1,s){let r=this.Ir(t,2,e,i,s);return this.Vr(r,i)}Ir(t,e,i,s=!1,r){let n=[];for(let l=0;l<t.length;l+=e)if(t.length-l>=e){let e=this.Br(t[l],t[l+1],i,s,r);e.Er=!1,n.push(e)}else if(0===n.length)n.push(this.Ar(t[l],!0));else{let e=n[n.length-1];n[n.length-1]=this.Lr(e,t[l],i,s,r)}return n}zr(t,e){return(t??1)+(e??1)}Br(t,e,i,s=!1,r){if(!s||!i||!r){let i=t.Wt[1]>e.Wt[1]?t.Wt[1]:e.Wt[1],s=t.Wt[2]<e.Wt[2]?t.Wt[2]:e.Wt[2];return{Or:t.js,Nr:e.js,Fr:t.wt,Wr:e.wt,Hr:t.Wt[0],Ur:i,$r:s,qr:e.Wt[3],jr:this.zr(t.jr,e.jr),Yr:void 0,Er:!1}}let n=i(this.Kr(t,r),this.Kr(e,r)),l=r(n),o=l.length?l[l.length-1]:0;return{Or:t.js,Nr:e.js,Fr:t.wt,Wr:e.wt,Hr:t.Wt[0],Ur:Math.max(t.Wt[1],o),$r:Math.min(t.Wt[2],o),qr:o,jr:this.zr(t.jr,e.jr),Yr:n,Er:!1}}Lr(t,e,i,s=!1,r){if(!s||!i||!r)return{Or:t.Or,Nr:e.js,Fr:t.Fr,Wr:e.wt,Hr:t.Hr,Ur:t.Ur>e.Wt[1]?t.Ur:e.Wt[1],$r:t.$r<e.Wt[2]?t.$r:e.Wt[2],qr:e.Wt[3],jr:t.jr+(e.jr??1),Yr:t.Yr,Er:!1};let n=t.Yr,l=this.Kr(e,r),o=n?{data:n,index:t.Or,originalTime:t.Fr,time:t.Fr,priceValues:r(n)}:null,a=o?i(o,l):l.data,h=o?r(a):l.priceValues,u=h.length?h[h.length-1]:0;return{Or:t.Or,Nr:e.js,Fr:t.Fr,Wr:e.wt,Hr:t.Hr,Ur:Math.max(t.Ur,u),$r:Math.min(t.$r,u),qr:u,jr:t.jr+(e.jr??1),Yr:a,Er:!1}}Zr(t,e,i,s,r,n,l=!1,o){let a=e===s?r:t[e];if(i-e==1)return this.Ar(a,!0);let h=e+1===s?r:t[e+1],u=this.Br(a,h,n,l,o);for(let a=e+2;a<i;a++){let e=a===s?r:t[a];u=this.Lr(u,e,n,l,o)}return u}Kr(t,e){let i=t.le??{};return{data:t.le,index:t.js,originalTime:t.Gr,time:t.wt,priceValues:e(i)}}Xr(t,e=!1){let i=!0===e,s=!!t.Yr;return{...{js:t.Or,wt:t.Fr,Gr:t.Fr,Wt:[i?t.qr:t.Hr,t.Ur,t.$r,t.qr],jr:t.jr},le:i?s?t.Yr:{wt:t.Fr}:void 0}}Vr(t,e=!1){return t.map(t=>this.Xr(t,e))}Pr(t,e,i,s,r=!1,n,l){if(0===s.length)return s;let o=t.length-1,a=Math.floor(o/i)*i;if(Math.min(a+i,t.length)-a<i&&t.length>i){let s=t.slice();return s[s.length-1]=e,this.Mr(s,i,n,r,l)}if(Math.floor((o-1)/i)===Math.floor(o/i)||1===s.length){let h=Math.min(a+i,t.length),u=h-a;if(u<=0)return s;let c=1===u?this.Ar(a===o?e:t[a],!0):this.Zr(t,a,h,o,e,n,r,l);return s[s.length-1]=this.Xr(c,r),s}{let s=t.slice();return s[s.length-1]=e,this.Mr(s,i,n,r,l)}}Ar(t,e=!1){return{Or:t.js,Nr:t.js,Fr:t.wt,Wr:t.wt,Hr:t.Wt[0],Ur:t.Wt[1],$r:t.Wt[2],qr:t.Wt[3],jr:t.jr??1,Yr:t.le,Er:e}}Sr(t){let e=this.Jr(t),i=this.Tr(t);return e.Qr!==i&&(e.Cr.clear(),e.Qr=i),e}Jr(t){let e=this.wr.get(t);return void 0===e&&(e={Qr:this.Tr(t),Cr:new Map},this.wr.set(t,e)),e}}class et extends tF{constructor(t){super(),this.ns=t}Qt(){return this.ns}}let ee={Bar:(t,e,i,s)=>{let r=e.upColor,n=e.downColor,l=tt(t(i,s)),o=te(l.Wt[0])<=te(l.Wt[3]);return{th:l.R??(o?r:n)}},Candlestick:(t,e,i,s)=>{let r=e.upColor,n=e.downColor,l=e.borderUpColor,o=e.borderDownColor,a=e.wickUpColor,h=e.wickDownColor,u=tt(t(i,s)),c=te(u.Wt[0])<=te(u.Wt[3]);return{th:u.R??(c?r:n),ih:u.Ht??(c?l:o),sh:u.nh??(c?a:h)}},Custom:(t,e,i,s)=>({th:tt(t(i,s)).R??e.color}),Area:(t,e,i,s)=>{let r=tt(t(i,s));return{th:r.vt??e.lineColor,vt:r.vt??e.lineColor,eh:r.eh??e.topColor,rh:r.rh??e.bottomColor}},Baseline:(t,e,i,s)=>{let r=tt(t(i,s));return{th:r.Wt[3]>=e.baseValue.price?e.topLineColor:e.bottomLineColor,hh:r.hh??e.topLineColor,ah:r.ah??e.bottomLineColor,oh:r.oh??e.topFillColor1,_h:r._h??e.topFillColor2,uh:r.uh??e.bottomFillColor1,dh:r.dh??e.bottomFillColor2}},Line:(t,e,i,s)=>{let r=tt(t(i,s));return{th:r.R??e.color,vt:r.R??e.color}},Histogram:(t,e,i,s)=>({th:tt(t(i,s)).R??e.color})};class ei{constructor(t){this.fh=(t,e)=>void 0!==e?e.Wt:this.ye.qs().ph(t),this.ye=t,this.mh=ee[t.wh()]}gh(t,e){return this.mh(this.fh,this.ye.N(),t,e)}}function es(t,e,i,s,r=0,n=e.length){let l=n-r;for(;0<l;){let n=l>>1,o=r+n;s(e[o],i)===t?(r=o+1,l-=n+1):l=n}return r}let er=es.bind(null,!0),en=es.bind(null,!1);(o=M||(M={}))[o.NearestLeft=-1]="NearestLeft",o[o.None=0]="None",o[o.NearestRight=1]="NearestRight";class el{constructor(){this.Mh=[],this.bh=new Map,this.Sh=new Map,this.xh=[]}Ch(){return this.yh()>0?this.Mh[this.Mh.length-1]:null}kh(){return this.yh()>0?this.Ph(0):null}sn(){return this.yh()>0?this.Ph(this.Mh.length-1):null}yh(){return this.Mh.length}Gi(){return 0===this.yh()}Ee(t){return null!==this.Th(t,0)}ph(t){return this.$s(t)}$s(t,e=0){let i=this.Th(t,e);return null===i?null:{...this.Rh(i),js:this.Ph(i)}}Dh(){return this.Mh}Ih(t,e,i){if(this.Gi())return null;let s=null;for(let r of i)s=eo(s,this.Vh(t,e,r));return s}ht(t){this.Sh.clear(),this.bh.clear(),this.Mh=t,this.xh=t.map(t=>t.js)}Bh(){return this.xh}Ph(t){return this.Mh[t].js}Rh(t){return this.Mh[t]}Th(t,e){let i=this.Eh(t);if(null===i&&0!==e)switch(e){case -1:return this.Ah(t);case 1:return this.Lh(t);default:throw TypeError("Unknown search mode")}return i}Ah(t){let e=this.zh(t);return e>0&&(e-=1),e!==this.Mh.length&&this.Ph(e)<t?e:null}Lh(t){let e=this.Oh(t);return e!==this.Mh.length&&t<this.Ph(e)?e:null}Eh(t){let e=this.zh(t);return e===this.Mh.length||t<this.Mh[e].js?null:e}zh(t){return er(this.Mh,t,(t,e)=>t.js<e)}Oh(t){return en(this.Mh,t,(t,e)=>t.js>e)}Nh(t,e,i){let s=null;for(let r=t;r<e;r++){let t=this.Mh[r].Wt[i];Number.isNaN(t)||(null===s?s={Fh:t,Wh:t}:(t<s.Fh&&(s.Fh=t),t>s.Wh&&(s.Wh=t)))}return s}Vh(t,e,i){if(this.Gi())return null;let s=null,r=tt(this.kh()),n=tt(this.sn()),l=Math.max(t,r),o=Math.min(e,n),a=30*Math.ceil(l/30),h=Math.max(a,30*Math.floor(o/30));{let t=this.zh(l),r=this.Oh(Math.min(o,a,e));s=eo(s,this.Nh(t,r,i))}let u=this.bh.get(i);void 0===u&&(u=new Map,this.bh.set(i,u));for(let t=Math.max(a+1,l);t<h;t+=30){let e=Math.floor(t/30),r=u.get(e);if(void 0===r){let t=this.zh(30*e),s=this.Oh((e+1)*30-1);r=this.Nh(t,s,i),u.set(e,r)}s=eo(s,r)}{let t=this.zh(h),e=this.Oh(o);s=eo(s,this.Nh(t,e,i))}return s}}function eo(t,e){return null===t?e:null===e?t:{Fh:Math.min(t.Fh,e.Fh),Wh:Math.max(t.Wh,e.Wh)}}let ea={setLineStyle:X};class eh{constructor(t){this.Hh=t}nt(t,e,i){this.Hh.draw(t,ea)}Uh(t,e,i){this.Hh.drawBackground?.(t,ea)}}class eu{constructor(t){this.Ln=null,this.$h=t}Tt(){let t=this.$h.renderer();if(null===t)return null;if(this.Ln?.qh===t)return this.Ln.jh;let e=new eh(t);return this.Ln={qh:t,jh:e},e}Yh(){return this.$h.zOrder?.()??"normal"}}class ec{constructor(t){this.Kh=null,this.Zh=t}Gh(){return this.Zh}Ws(){this.Zh.updateAllViews?.()}Ys(){let t=this.Zh.paneViews?.()??[];if(this.Kh?.qh===t)return this.Kh.jh;let e=t.map(t=>new eu(t));return this.Kh={qh:t,jh:e},e}Qn(t,e){return this.Zh.hitTest?.(t,e)??null}}let ed=class extends ec{ds(){return[]}};class em{constructor(t){this.Hh=t}nt(t,e,i){this.Hh.draw(t,ea)}Uh(t,e,i){this.Hh.drawBackground?.(t,ea)}}class ep{constructor(t){this.Ln=null,this.$h=t}Tt(){let t=this.$h.renderer();if(null===t)return null;if(this.Ln?.qh===t)return this.Ln.jh;let e=new em(t);return this.Ln={qh:t,jh:e},e}Yh(){return this.$h.zOrder?.()??"normal"}}function ef(t){return{ri:t.text(),Ei:t.coordinate(),Vi:t.fixedCoordinate?.(),R:t.textColor(),G:t.backColor(),It:t.visible?.()??!0,pi:t.tickVisible?.()??!0}}class eg{constructor(t,e){this.Xt=new tL,this.Xh=t,this.Jh=e}Tt(){return this.Xt.ht({ss:this.Jh.ss(),...ef(this.Xh)}),this.Xt}}class ev extends t_{constructor(t,e){super(),this.Xh=t,this.Ki=e}Yi(t,e,i){let s=ef(this.Xh);i.G=s.G,t.R=s.R;let r=2/12*this.Ki.k();i.Ti=r,i.Ri=r,i.Ei=s.Ei,i.Vi=s.Vi,t.ri=s.ri,t.It=s.It,t.pi=s.pi}}class ex extends ec{constructor(t,e){super(t),this.Qh=null,this.ta=null,this.ia=null,this.sa=null,this.ye=e}fs(){let t=this.Zh.timeAxisViews?.()??[];if(this.Qh?.qh===t)return this.Qh.jh;let e=this.ye.Qt().Et(),i=t.map(t=>new eg(t,e));return this.Qh={qh:t,jh:i},i}Ks(){let t=this.Zh.priceAxisViews?.()??[];if(this.ta?.qh===t)return this.ta.jh;let e=this.ye.Ft(),i=t.map(t=>new ev(t,e));return this.ta={qh:t,jh:i},i}na(){let t=this.Zh.priceAxisPaneViews?.()??[];if(this.ia?.qh===t)return this.ia.jh;let e=t.map(t=>new ep(t));return this.ia={qh:t,jh:e},e}ea(){let t=this.Zh.timeAxisPaneViews?.()??[];if(this.sa?.qh===t)return this.sa.jh;let e=t.map(t=>new ep(t));return this.sa={qh:t,jh:e},e}ra(t,e){return this.Zh.autoscaleInfo?.(t,e)??null}}function ew(t,e,i,s){t.forEach(t=>{e(t).forEach(t=>{t.Yh()===i&&s.push(t)})})}function ey(t){return t.Ys()}function eb(t){return t.na()}function eS(t){return t.ea()}let ej=["Area","Line","Baseline"];class eM extends et{constructor(t,e,i,s,r){super(t),this.jt=new el,this._r=new t0(this),this.ha=[],this.aa=new tX(this),this.la=null,this.oa=null,this._a=null,this.ua=[],this.ca=new t8,this.da=new Map,this.fa=null,this.Ps=i,this.pa=e;const n=new t1(this);if(this.gs=[n],this.ur=new tJ(n,this,t),ej.includes(this.pa)&&(this.la=new tZ(this)),this.va(),this.$h=s(this,this.Qt(),r),"Custom"===this.pa){const t=this.$h;t.ma&&this.wa(t.ma)}}m(){null!==this._a&&clearTimeout(this._a)}Oe(t){return this.Ps.priceLineColor||t}Ve(t){let e,i,s={Be:!0},r=this.Ft();if(this.Qt().Et().Gi()||r.Gi()||this.jt.Gi())return s;let n=this.Qt().Et().Ie(),l=this.Lt();if(null===n||null===l)return s;if(t){let t=this.jt.Ch();if(null===t)return s;e=t,i=t.js}else{let t=this.jt.$s(n.bi(),-1);if(null===t||null===(e=this.jt.ph(t.js)))return s;i=t.js}let o=e.Wt[3],a=this.ga().gh(i,{Wt:e}),h=r.Nt(o,l.Wt);return{Be:!1,gt:o,ri:r.Ji(o,l.Wt),Ue:r.Ma(o),$e:r.ba(o,l.Wt),R:a.th,Ei:h,js:i}}ga(){return null!==this.oa||(this.oa=new ei(this)),this.oa}N(){return this.Ps}cr(t){let e=this.Qt(),{priceScaleId:i,visible:s,priceFormat:r}=t;void 0!==i&&i!==this.Ps.priceScaleId&&e.Sa(this,i),void 0!==s&&s!==this.Ps.visible&&e.xa();let n=void 0!==t.conflationThresholdFactor;ts(this.Ps,t),n&&(this.da.clear(),this.Qt().dr()),void 0!==r&&(this.va(),e.Ca()),e.ya(this),e.ka(),this.$h.kt("options")}ht(t,e){this.jt.ht(t),this.da.clear();let i=this.Qt().Et().N();i.enableConflation&&i.precomputeConflationOnInit&&this.Pa(i.precomputeConflationPriority),this.$h.kt("data"),null!==this.la&&(e&&e.Ta?this.la.Pe():0===t.length&&this.la.ke());let s=this.Qt().Kn(this);this.Qt().Ra(s),this.Qt().ya(this),this.Qt().ka(),this.Qt().dr()}Da(t){let e=new t7(this,t);return this.ha.push(e),this.Qt().ya(this),e}Ia(t){let e=this.ha.indexOf(t);-1!==e&&this.ha.splice(e,1),this.Qt().ya(this)}Va(){return this.ha}wh(){return this.pa}Lt(){let t=this.Ba();return null===t?null:{Wt:t.Wt[3],Ea:t.wt}}Ba(){let t=this.Qt().Et().Ie();if(null===t)return null;let e=t.Aa();return this.jt.$s(e,1)}qs(){return this.jt}wa(t){this.fa=t,this.da.clear()}La(){return!!this.Qt().Et().N().enableConflation&&this.za()>1}kr(t){if(!this.La())return;let e=this.za();if(!this.da.has(e))return;let i="Custom"===this.pa,s=i&&this.fa||void 0,r=i&&this.$h.Oa?t=>{let e=this.$h.Oa(t);return Array.isArray(e)?e:["number"==typeof e?e:0]}:void 0,n=this.ca.kr(this.jt.Dh(),t,e,s,i,r),l=new el;l.ht(n),this.da.set(e,l)}Na(){let t=this.Qt().Et().N().enableConflation;if("Custom"===this.pa&&null===this.fa||!t)return this.jt;let e=this.za(),i=this.da.get(e);return i||(this.Fa(e),this.da.get(e)??this.jt)}Wa(t){let e=this.jt.ph(t);return null===e?null:"Bar"===this.pa||"Candlestick"===this.pa||"Custom"===this.pa?{Hr:e.Wt[0],Ur:e.Wt[1],$r:e.Wt[2],qr:e.Wt[3]}:e.Wt[3]}Ha(t){let e=[];ew(this.ua,ey,"top",e);let i=this.la;return null!==i&&i.It()&&(null===this._a&&i.Re()&&(this._a=setTimeout(()=>{this._a=null,this.Qt().Ua()},0)),i.Te(),e.unshift(i)),e}Ys(){let t=[];this.$a()||t.push(this.aa),t.push(this.$h,this._r);let e=this.ha.map(t=>t.pr());return t.push(...e),ew(this.ua,ey,"normal",t),t}qa(){return this.ja(ey,"bottom")}Ya(t){return this.ja(eb,t)}Ka(t){return this.ja(eS,t)}Za(t,e){return this.ua.map(i=>i.Qn(t,e)).filter(t=>null!==t)}ds(){return[this.ur,...this.ha.map(t=>t.vr())]}Ks(t,e){if(e!==this.hs&&!this.$a())return[];let i=[...this.gs];for(let t of this.ha)i.push(t.mr());return this.ua.forEach(t=>{i.push(...t.Ks())}),i}fs(){let t=[];return this.ua.forEach(e=>{t.push(...e.fs())}),t}ra(t,e){if(void 0!==this.Ps.autoscaleInfoProvider){let i=this.Ps.autoscaleInfoProvider(()=>{let i=this.Ga(t,e);return null===i?null:i.tr()});return t5.ir(i)}return this.Ga(t,e)}qh(){let t=this.Ps.priceFormat;return t.base??1/t.minMove}Xa(){return this.Ja}Ws(){for(let t of(this.$h.kt(),this.gs))t.kt();for(let t of this.ha)t.kt();this._r.kt(),this.aa.kt(),this.la?.kt(),this.ua.forEach(t=>t.Ws())}Ft(){return tt(super.Ft())}At(t){if(!(("Line"===this.pa||"Area"===this.pa||"Baseline"===this.pa)&&this.Ps.crosshairMarkerVisible))return null;let e=this.jt.ph(t);return null===e?null:{gt:e.Wt[3],ft:this.Qa(),Ht:this.tl(),Ot:this.il(),zt:this.sl(t)}}Ne(){return this.Ps.title}It(){return this.Ps.visible}nl(t){this.ua.push(new ex(t,this))}el(t){this.ua=this.ua.filter(e=>e.Gh()!==t)}rl(){if("Custom"===this.pa)return t=>this.$h.Oa(t)}hl(){if("Custom"===this.pa)return t=>this.$h.al(t)}ll(){return this.jt.Bh()}$a(){return!tA(this.Ft().ol())}Ga(t,e){if(!tn(t)||!tn(e)||this.jt.Gi())return null;let i="Line"===this.pa||"Area"===this.pa||"Baseline"===this.pa||"Histogram"===this.pa?[3]:[2,1],s=this.jt.Ih(t,e,i),r=null!==s?new t3(s.Fh,s.Wh):null,n=null;if("Histogram"===this.wh()){let t=this.Ps.base,e=new t3(t,t);r=null!==r?r.Sn(e):e}return this.ua.forEach(i=>{let s=i.ra(t,e);if(s?.priceRange){let t=new t3(s.priceRange.minValue,s.priceRange.maxValue);r=null!==r?r.Sn(t):t}s?.margins&&(n=s.margins)}),new t5(r,n)}Qa(){switch(this.pa){case"Line":case"Area":case"Baseline":return this.Ps.crosshairMarkerRadius}return 0}tl(){switch(this.pa){case"Line":case"Area":case"Baseline":{let t=this.Ps.crosshairMarkerBorderColor;if(0!==t.length)return t}}return null}il(){switch(this.pa){case"Line":case"Area":case"Baseline":return this.Ps.crosshairMarkerBorderWidth}return 0}sl(t){switch(this.pa){case"Line":case"Area":case"Baseline":{let t=this.Ps.crosshairMarkerBackgroundColor;if(0!==t.length)return t}}return this.ga().gh(t).th}va(){switch(this.Ps.priceFormat.type){case"custom":{let t=this.Ps.priceFormat.formatter;this.Ja={format:t,formatTickmarks:this.Ps.priceFormat.tickmarksFormatter??(e=>e.map(t))};break}case"volume":this.Ja=new tK(this.Ps.priceFormat.precision);break;case"percent":this.Ja=new tW(this.Ps.priceFormat.precision);break;default:{let t=Math.pow(10,this.Ps.priceFormat.precision);this.Ja=new t$(t,this.Ps.priceFormat.minMove*t)}}null!==this.hs&&this.hs._l()}ja(t,e){let i=[];return ew(this.ua,t,e,i),i}za(){let{ul:t,cl:e,dl:i}=this.fl();return this.ca.gr(t,e,i)}fl(){let t=this.Qt().Et(),e=t.ul(),i=window.devicePixelRatio||1,s=t.N().conflationThresholdFactor;return{ul:e,cl:i,dl:this.Ps.conflationThresholdFactor??s??1}}pl(t){let e,i=this.jt.Dh();if("Custom"===this.pa&&null!==this.fa){let s=this.rl();if(!s)throw Error("Custom series with conflation reducer must have a priceValueBuilder method");e=this.ca.Mr(i,t,this.fa,!0,t=>s(t))}else e=this.ca.Mr(i,t);let s=new el;return s.ht(e),s}Fa(t){let e=this.pl(t);this.da.set(t,e)}Pa(t){if("Custom"!==this.pa||null!==this.fa&&this.rl())for(let e of(this.da.clear(),this.Qt().Et().vl())){let i=()=>{this.ml(e)},s="object"==typeof window&&window||"object"==typeof self&&self;s?.gl?.wl?s.gl.wl(()=>{i()},{Ml:t}):Promise.resolve().then(()=>i())}}ml(t){if(this.da.has(t)||0===this.jt.Dh().length)return;let e=this.pl(t);this.da.set(t,e)}}let eC=[3],eN=[0,1,2,3];class eE{constructor(t){this.Ps=t}bl(t,e,i){if(0===this.Ps.mode)return t;let s=i.Rs(),r=s.Lt();if(null===r)return t;let n=s.Nt(t,r),l=i.Sl().filter(t=>t instanceof eM).reduce((t,s)=>{if(i.Zn(s)||!s.It())return t;let r=s.Ft(),n=s.qs();if(r.Gi()||!n.Ee(e))return t;let l=n.ph(e);if(null===l)return t;let o=te(s.Lt()),a=3===this.Ps.mode?eN:eC;return t.concat(a.map(t=>r.Nt(l.Wt[t],o.Wt)))},[]);if(0===l.length)return t;l.sort((t,e)=>Math.abs(t-n)-Math.abs(e-n));let o=l[0];return s.Ds(o,r)}}function eP(t,e,i){return Math.min(Math.max(t,e),i)}function ek(t){let e=Math.ceil(t);return e%2==0?e-1:e}class e_ extends tx{constructor(){super(...arguments),this.jt=null}ht(t){this.jt=t}et({context:t,bitmapSize:e,horizontalPixelRatio:i,verticalPixelRatio:s}){var r;if(null===this.jt)return;let n=Math.max(1,Math.floor(i));t.lineWidth=n,r=()=>{let r=tt(this.jt);if(r.xl){for(let s of(t.strokeStyle=r.Cl,X(t,r.yl),t.beginPath(),r.kl)){let r=Math.round(s.Pl*i);t.moveTo(r,-n),t.lineTo(r,e.height+n)}t.stroke()}if(r.Tl){for(let i of(t.strokeStyle=r.Rl,X(t,r.Dl),t.beginPath(),r.Il)){let r=Math.round(i.Pl*s);t.moveTo(-n,r),t.lineTo(e.width+n,r)}t.stroke()}},t.save(),t.lineWidth%2&&t.translate(.5,.5),r(),t.restore()}}class eR{constructor(t){this.Xt=new e_,this.xt=!0,this.yt=t}kt(){this.xt=!0}Tt(){if(this.xt){let t=this.yt.Qt().N().grid,e={Tl:t.horzLines.visible,xl:t.vertLines.visible,Rl:t.horzLines.color,Cl:t.vertLines.color,Dl:t.horzLines.style,yl:t.vertLines.style,Il:this.yt.Rs().Vl(),kl:(this.yt.Qt().Et().Vl()||[]).map(t=>({Pl:t.coord}))};this.Xt.ht(e),this.xt=!1}return this.Xt}}class eT{constructor(t){this.$h=new eR(t)}pr(){return this.$h}}let eL={Bl:4,El:1e-4};function eI(t,e){let i=100*(t-e)/e;return e<0?-i:i}function eF(t,e){let i=100*(t-e)/e+100;return e<0?-i:i}function ez(t,e){let i=Math.abs(t);if(i<1e-15)return 0;let s=Math.log10(i+e.El)+e.Bl;return t<0?-s:s}function eA(t,e){let i=Math.abs(t);if(i<1e-15)return 0;let s=Math.pow(10,i-e.Bl)-e.El;return t<0?-s:s}function eD(t,e){return null===t?null:new t3(ez(t.Ze(),e),ez(t.Ge(),e))}function eO(t,e){return null===t?null:new t3(eA(t.Ze(),e),eA(t.Ge(),e))}function eB(t){if(null===t)return eL;let e=Math.abs(t.Ge()-t.Ze());if(e>=1||e<1e-15)return eL;let i=Math.ceil(Math.abs(Math.log10(e))),s=eL.Bl+i;return{Bl:s,El:1/Math.pow(10,s)}}class e${constructor(t,e){if(this.Al=t,this.Ll=e,function(t){if(t<0)return!1;if(t>1e18)return!0;for(let e=t;e>1;e/=10)if(e%10!=0)return!1;return!0}(this.Al))this.zl=[2,2.5,2];else{this.zl=[];for(let t=this.Al;1!==t;){if(t%2==0)this.zl.push(2),t/=2;else{if(t%5!=0)throw Error("unexpected base");this.zl.push(2,2.5),t/=5}if(this.zl.length>100)throw Error("something wrong with base")}}}Ol(t,e,i){let s=0===this.Al?0:1/this.Al,r=Math.pow(10,Math.max(0,Math.ceil(Math.log10(t-e)))),n=0,l=this.Ll[0];for(;;){let t=s-r<=1e-14&&r>s+1e-14,e=i*l-r<=1e-14,o=1-r<=1e-14;if(!(t&&e&&o))break;r/=l,l=this.Ll[++n%this.Ll.length]}if(r<=s+1e-14&&(r=s),r=Math.max(1,r),this.zl.length>0&&1e-14>Math.abs(r-1))for(n=0,l=this.zl[0];i*l-r<=1e-14&&r>s+1e-14;)r/=l,l=this.zl[++n%this.zl.length];return r}}class eW{constructor(t,e,i,s){this.Nl=[],this.Ki=t,this.Al=e,this.Fl=i,this.Wl=s}Ol(t,e){if(t<e)throw Error("high < low");let i=this.Ki.$t(),s=(t-e)*this.Hl()/i,r=new e$(this.Al,[2,2.5,2]),n=new e$(this.Al,[2,2,2.5]),l=new e$(this.Al,[2.5,2,2]),o=[];return o.push(r.Ol(t,e,s),n.Ol(t,e,s),l.Ol(t,e,s)),function(t){if(t.length<1)throw Error("array is empty");let e=t[0];for(let i=1;i<t.length;++i)t[i]<e&&(e=t[i]);return e}(o)}Ul(){let t=this.Ki,e=t.Lt();if(null===e)return void(this.Nl=[]);let i=t.$t(),s=this.Fl(i-1,e),r=this.Fl(0,e),n=this.Ki.N().entireTextOnly?this.$l()/2:0,l=i-1-n,o=Math.max(s,r),a=Math.min(s,r);if(o===a)return void(this.Nl=[]);let h=this.Ol(o,a);if(this.ql(e,h,o,a,n,l),t.jl()&&this.Yl(h,a,o)){let t=this.Ki.Kl();this.Zl(e,h,n,l,t,2*t)}let u=this.Nl.map(t=>t.Gl),c=this.Ki.Xl(u);for(let t=0;t<this.Nl.length;t++)this.Nl[t].Jl=c[t]}Vl(){return this.Nl}$l(){return this.Ki.k()}Hl(){return Math.ceil(2.5*this.$l())}ql(t,e,i,s,r,n){let l=this.Nl,o=this.Ki,a=i%e;a+=a<0?e:0;let h=i>=s?1:-1,u=null,c=0;for(let d=i-a;d>s;d-=e){let i=this.Wl(d,t,!0);null!==u&&Math.abs(i-u)<this.Hl()||i<r||i>n||(c<l.length?(l[c].Pl=i,l[c].Jl=o.Ql(d),l[c].Gl=d):l.push({Pl:i,Jl:o.Ql(d),Gl:d}),c++,u=i,o.io()&&(e=this.Ol(d*h,s)))}l.length=c}Zl(t,e,i,s,r,n){let l=this.Nl,o=this.so(t,i,r,n),a=this.so(t,s,-n,-r),h=this.Wl(0,t,!0)-this.Wl(e,t,!0);l.length>0&&l[0].Pl-o.Pl<h/2&&l.shift(),l.length>0&&a.Pl-l[l.length-1].Pl<h/2&&l.pop(),l.unshift(o),l.push(a)}so(t,e,i,s){let r=this.Fl(e+i,t),n=this.Fl(e+s,t),l=Math.min(r,n),o=Math.max(r,n),a=Math.max(.1,this.Ol(o,l)),h=this.Fl(e+(i+s)/2,t),u=h-h%a,c=this.Wl(u,t,!0);return{Jl:this.Ki.Ql(u),Pl:c,Gl:u}}Yl(t,e,i){let s=te(this.Ki.er());return this.Ki.io()&&(s=eO(s,this.Ki.no())),s.Ze()-e<t&&i-s.Ge()<t}}function eK(t){return t.slice().sort((t,e)=>tt(t._s())-tt(e._s()))}(a=C||(C={}))[a.Normal=0]="Normal",a[a.Logarithmic=1]="Logarithmic",a[a.Percentage=2]="Percentage",a[a.IndexedTo100=3]="IndexedTo100";let eV=new tW,eU=new t$(100,1);class eH{constructor(t,e,i,s,r){this.eo=0,this.ro=null,this.sr=null,this.ho=null,this.ao={lo:!1,oo:null},this._o=!1,this.uo=0,this.co=0,this.do=new ti,this.fo=new ti,this.po=[],this.vo=null,this.mo=null,this.wo=null,this.Mo=null,this.bo=null,this.Ja=eU,this.So=eB(null),this.xo=t,this.Ps=e,this.Co=i,this.yo=s,this.ko=r,this.Po=new eW(this,100,this.To.bind(this),this.Ro.bind(this))}ol(){return this.xo}N(){return this.Ps}cr(t){if(ts(this.Ps,t),this._l(),void 0!==t.mode&&this.Do({ae:t.mode}),void 0!==t.scaleMargins){let e=Z(t.scaleMargins.top),i=Z(t.scaleMargins.bottom);if(e<0||e>1)throw Error(`Invalid top margin - expect value between 0 and 1, given=${e}`);if(i<0||i>1)throw Error(`Invalid bottom margin - expect value between 0 and 1, given=${i}`);if(e+i>1)throw Error(`Invalid margins - sum of margins must be less than 1, given=${e+i}`);this.Io(),this.wo=null}}Vo(){return this.Ps.autoScale}Bo(){return this._o}io(){return 1===this.Ps.mode}He(){return 2===this.Ps.mode}Eo(){return 3===this.Ps.mode}no(){return this.So}ae(){return{ln:this.Ps.autoScale,Ao:this.Ps.invertScale,ae:this.Ps.mode}}Do(t){let e=this.ae(),i=null;void 0!==t.ln&&(this.Ps.autoScale=t.ln),void 0!==t.ae&&(this.Ps.mode=t.ae,2!==t.ae&&3!==t.ae||(this.Ps.autoScale=!0),this.ao.lo=!1),1===e.ae&&t.ae!==e.ae&&(function(t,e){if(null===t)return!1;let i=eA(t.Ze(),e),s=eA(t.Ge(),e);return isFinite(i)&&isFinite(s)}(this.sr,this.So)?null!==(i=eO(this.sr,this.So))&&this.Lo(i):this.Ps.autoScale=!0),1===t.ae&&t.ae!==e.ae&&null!==(i=eD(this.sr,this.So))&&this.Lo(i);let s=e.ae!==this.Ps.mode;s&&(2===e.ae||this.He())&&this._l(),s&&(3===e.ae||this.Eo())&&this._l(),void 0!==t.Ao&&e.Ao!==t.Ao&&(this.Ps.invertScale=t.Ao,this.zo()),this.fo.p(e,this.ae())}Oo(){return this.fo}k(){return this.Co.fontSize}$t(){return this.eo}No(t){this.eo!==t&&(this.eo=t,this.Io(),this.wo=null)}Fo(){if(this.ro)return this.ro;let t=this.$t()-this.Wo()-this.Ho();return this.ro=t,t}er(){return this.Uo(),this.sr}Lo(t,e){let i=this.sr;(e||null===i&&null!==t||null!==i&&!i.Ye(t))&&(this.wo=null,this.sr=t)}$o(t){this.Lo(t),this.qo(null!==t)}Gi(){return this.Uo(),0===this.eo||!this.sr||this.sr.Gi()}jo(t){return this.Ao()?t:this.$t()-1-t}Nt(t,e){return this.He()?t=eI(t,e):this.Eo()&&(t=eF(t,e)),this.Ro(t,e)}Yo(t,e,i){this.Uo();let s=this.Ho(),r=tt(this.er()),n=r.Ze(),l=r.Ge(),o=this.Fo()-1,a=this.Ao(),h=o/(l-n),u=void 0===i?0:i.from,c=void 0===i?t.length:i.to,d=this.Ko();for(let i=u;i<c;i++){let r=t[i],l=r.gt;if(isNaN(l))continue;let o=l;null!==d&&(o=d(r.gt,e));let u=s+h*(o-n);r.ut=a?u:this.eo-1-u}}Zo(t,e,i){this.Uo();let s=this.Ho(),r=tt(this.er()),n=r.Ze(),l=r.Ge(),o=this.Fo()-1,a=this.Ao(),h=o/(l-n),u=void 0===i?0:i.from,c=void 0===i?t.length:i.to,d=this.Ko();for(let i=u;i<c;i++){let r=t[i],l=r.Hr,o=r.Ur,u=r.$r,c=r.qr;null!==d&&(l=d(r.Hr,e),o=d(r.Ur,e),u=d(r.$r,e),c=d(r.qr,e));let m=s+h*(l-n),p=a?m:this.eo-1-m;r.Go=p,m=s+h*(o-n),r.Xo=p=a?m:this.eo-1-m,m=s+h*(u-n),r.Jo=p=a?m:this.eo-1-m,m=s+h*(c-n),r.Qo=p=a?m:this.eo-1-m}}Ds(t,e){let i=this.To(t,e);return this.t_(i,e)}t_(t,e){var i,s;let r=t;return this.He()?(i=r,e<0&&(i=-i),r=i/100*e+e):this.Eo()&&(s=r-100,e<0&&(s=-s),r=s/100*e+e),r}Sl(){return this.po}Dt(){return this.mo||(this.mo=eK(this.po)),this.mo}i_(t){-1===this.po.indexOf(t)&&(this.po.push(t),this._l(),this.s_())}n_(t){let e=this.po.indexOf(t);if(-1===e)throw Error("source is not attached to scale");this.po.splice(e,1),0===this.po.length&&(this.Do({ln:!0}),this.Lo(null)),this._l(),this.s_()}Lt(){let t=null;for(let e of this.po){let i=e.Lt();null!==i&&(null===t||i.Ea<t.Ea)&&(t=i)}return null===t?null:t.Wt}Ao(){return this.Ps.invertScale}Vl(){let t=null===this.Lt();if(null!==this.wo&&(t||this.wo.e_===t))return this.wo.Vl;this.Po.Ul();let e=this.Po.Vl();return this.wo={Vl:e,e_:t},this.do.p(),e}r_(){return this.do}h_(t){this.He()||this.Eo()||null===this.Mo&&null===this.ho&&(this.Gi()||(this.Mo=this.eo-t,this.ho=tt(this.er()).Ke()))}a_(t){if(this.He()||this.Eo()||null===this.Mo)return;this.Do({ln:!1}),(t=this.eo-t)<0&&(t=0);let e=(this.Mo+.2*(this.eo-1))/(t+.2*(this.eo-1)),i=tt(this.ho).Ke();e=Math.max(e,.1),i.Je(e),this.Lo(i)}l_(){this.He()||this.Eo()||(this.Mo=null,this.ho=null)}o_(t){this.Vo()||null===this.bo&&null===this.ho&&(this.Gi()||(this.bo=t,this.ho=tt(this.er()).Ke()))}__(t){if(this.Vo()||null===this.bo)return;let e=tt(this.er()).Xe()/(this.Fo()-1),i=t-this.bo;this.Ao()&&(i*=-1);let s=i*e,r=tt(this.ho).Ke();r.Qe(s),this.Lo(r,!0),this.wo=null}u_(){this.Vo()||null!==this.bo&&(this.bo=null,this.ho=null)}Xa(){return this.Ja||this._l(),this.Ja}Ji(t,e){switch(this.Ps.mode){case 2:return this.c_(eI(t,e));case 3:return this.Xa().format(eF(t,e));default:return this.lr(t)}}Ql(t){switch(this.Ps.mode){case 2:return this.c_(t);case 3:return this.Xa().format(t);default:return this.lr(t)}}Xl(t){switch(this.Ps.mode){case 2:return this.d_(t);case 3:return this.Xa().formatTickmarks(t);default:return this.f_(t)}}Ma(t){return this.lr(t,tt(this.vo).Xa())}ba(t,e){return t=eI(t,e),this.c_(t,eV)}p_(){return this.po}v_(t){this.ao={oo:t,lo:!1}}Ws(){this.po.forEach(t=>t.Ws())}jl(){return this.Ps.ensureEdgeTickMarksVisible&&this.Vo()}Kl(){return this.k()/2}_l(){this.wo=null;let t=1/0;for(let e of(this.vo=null,this.po))e._s()<t&&(t=e._s(),this.vo=e);let e=100;null!==this.vo&&(e=Math.round(this.vo.qh())),this.Ja=eU,this.He()?(this.Ja=eV,e=100):this.Eo()?(this.Ja=new t$(100,1),e=100):null!==this.vo&&(this.Ja=this.vo.Xa()),this.Po=new eW(this,e,this.To.bind(this),this.Ro.bind(this)),this.Po.Ul()}s_(){this.mo=null}m_(){return null===this.vo||this.He()||this.Eo()?1:1/this.vo.qh()}Xi(){return this.ko}qo(t){this._o=t}Wo(){return this.Ao()?this.Ps.scaleMargins.bottom*this.$t()+this.co:this.Ps.scaleMargins.top*this.$t()+this.uo}Ho(){return this.Ao()?this.Ps.scaleMargins.top*this.$t()+this.uo:this.Ps.scaleMargins.bottom*this.$t()+this.co}Uo(){this.ao.lo||(this.ao.lo=!0,this.w_())}Io(){this.ro=null}Ro(t,e){if(this.Uo(),this.Gi())return 0;t=this.io()&&t?ez(t,this.So):t;let i=tt(this.er()),s=this.Ho()+(this.Fo()-1)*(t-i.Ze())/i.Xe();return this.jo(s)}To(t,e){if(this.Uo(),this.Gi())return 0;let i=this.jo(t),s=tt(this.er()),r=s.Ze()+s.Xe()*((i-this.Ho())/(this.Fo()-1));return this.io()?eA(r,this.So):r}zo(){this.wo=null,this.Po.Ul()}w_(){var t,e,i,s,r;if(this.Bo()&&!this.Vo())return;let n=this.ao.oo;if(null===n)return;let l=null,o=this.p_(),a=0,h=0;for(let t of o){if(!t.It())continue;let o=t.Lt();if(null===o)continue;let u=t.ra(n.Aa(),n.bi()),c=u&&u.er();if(null!==c){switch(this.Ps.mode){case 1:c=eD(c,this.So);break;case 2:e=c,i=o.Wt,c=new t3(eI(e.Ze(),i),eI(e.Ge(),i));break;case 3:s=c,r=o.Wt,c=new t3(eF(s.Ze(),r),eF(s.Ge(),r))}if(l=null===l?c:l.Sn(tt(c)),null!==u){let t=u.rr();null!==t&&(a=Math.max(a,t.above),h=Math.max(h,t.below))}}}if(this.jl()&&(a=Math.max(a,this.Kl()),h=Math.max(h,this.Kl())),a===this.uo&&h===this.co||(this.uo=a,this.co=h,this.wo=null,this.Io()),null!==l){if(l.Ze()===l.Ge()){let t=5*this.m_();this.io()&&(l=eO(l,this.So)),l=new t3(l.Ze()-t,l.Ge()+t),this.io()&&(l=eD(l,this.So))}if(this.io()){let e=eO(l,this.So),i=eB(e);if(t=this.So,i.Bl!==t.Bl||i.El!==t.El){let t=null!==this.ho?eO(this.ho,this.So):null;this.So=i,l=eD(e,i),null!==t&&(this.ho=eD(t,i))}}this.Lo(l)}else null===this.sr&&(this.Lo(new t3(-.5,.5)),this.So=eB(null))}Ko(){return this.He()?eI:this.Eo()?eF:this.io()?t=>ez(t,this.So):null}g_(t,e,i){return void 0===e?(void 0===i&&(i=this.Xa()),i.format(t)):e(t)}M_(t,e,i){return void 0===e?(void 0===i&&(i=this.Xa()),i.formatTickmarks(t)):e(t)}lr(t,e){return this.g_(t,this.yo.priceFormatter,e)}f_(t,e){let i=this.yo.priceFormatter;return this.M_(t,this.yo.tickmarksPriceFormatter??(i?t=>t.map(i):void 0),e)}c_(t,e){return this.g_(t,this.yo.percentageFormatter,e)}d_(t,e){let i=this.yo.percentageFormatter;return this.M_(t,this.yo.tickmarksPercentageFormatter??(i?t=>t.map(i):void 0),e)}}function eJ(t){return t instanceof eM}class eq{constructor(t,e){this.po=[],this.b_=new Map,this.eo=0,this.S_=0,this.x_=1,this.mo=null,this.C_=!1,this.y_=new ti,this.ua=[],this.Jh=t,this.ns=e,this.k_=new eT(this);const i=e.N();this.P_=this.T_("left",i.leftPriceScale),this.R_=this.T_("right",i.rightPriceScale),this.P_.Oo().i(this.D_.bind(this,this.P_),this),this.R_.Oo().i(this.D_.bind(this,this.R_),this),this.I_(i)}I_(t){if(t.leftPriceScale&&this.P_.cr(t.leftPriceScale),t.rightPriceScale&&this.R_.cr(t.rightPriceScale),t.localization&&(this.P_._l(),this.R_._l()),t.overlayPriceScales)for(let e of Array.from(this.b_.values())){let i=tt(e[0].Ft());i.cr(t.overlayPriceScales),t.localization&&i._l()}}V_(t){switch(t){case"left":return this.P_;case"right":return this.R_}return this.b_.has(t)?Z(this.b_.get(t))[0].Ft():null}m(){this.Qt().B_().u(this),this.P_.Oo().u(this),this.R_.Oo().u(this),this.po.forEach(t=>{t.m&&t.m()}),this.ua=this.ua.filter(t=>{let e=t.Gh();return e.detached&&e.detached(),!1}),this.y_.p()}E_(){return this.x_}A_(t){this.x_=t}Qt(){return this.ns}ss(){return this.S_}$t(){return this.eo}L_(t){this.S_=t,this.z_()}No(t){this.eo=t,this.P_.No(t),this.R_.No(t),this.po.forEach(e=>{if(this.Zn(e)){let i=e.Ft();null!==i&&i.No(t)}}),this.z_()}O_(t){this.C_=t}N_(){return this.C_}F_(){return this.po.filter(eJ)}Sl(){return this.po}Zn(t){let e=t.Ft();return null===e||this.P_!==e&&this.R_!==e}i_(t,e,i){this.W_(t,e,i?t._s():this.po.length)}n_(t,e){let i=this.po.indexOf(t);Q(-1!==i,"removeDataSource: invalid data source"),this.po.splice(i,1),e||this.po.forEach((t,e)=>t.us(e));let s=tt(t.Ft()).ol();if(this.b_.has(s)){let e=Z(this.b_.get(s)),i=e.indexOf(t);-1!==i&&(e.splice(i,1),0===e.length&&this.b_.delete(s))}let r=t.Ft();r&&r.Sl().indexOf(t)>=0&&(r.n_(t),this.H_(r)),this.mo=null}Xn(t){return t===this.P_?"left":t===this.R_?"right":"overlay"}U_(){return this.P_}q_(){return this.R_}j_(t,e){t.h_(e)}Y_(t,e){t.a_(e),this.z_()}K_(t){t.l_()}Z_(t,e){t.o_(e)}G_(t,e){t.__(e),this.z_()}X_(t){t.u_()}z_(){this.po.forEach(t=>{t.Ws()})}Rs(){let t=null;return this.ns.N().rightPriceScale.visible&&0!==this.R_.Sl().length?t=this.R_:this.ns.N().leftPriceScale.visible&&0!==this.P_.Sl().length?t=this.P_:0!==this.po.length&&(t=this.po[0].Ft()),null===t&&(t=this.R_),t}Gn(){let t=null;return this.ns.N().rightPriceScale.visible?t=this.R_:this.ns.N().leftPriceScale.visible&&(t=this.P_),t}H_(t){null!==t&&t.Vo()&&this.J_(t)}Q_(t){let e=this.Jh.Ie();t.Do({ln:!0}),null!==e&&t.v_(e),this.z_()}tu(){this.J_(this.P_),this.J_(this.R_)}iu(){this.H_(this.P_),this.H_(this.R_),this.po.forEach(t=>{this.Zn(t)&&this.H_(t.Ft())}),this.z_(),this.ns.dr()}Dt(){return null===this.mo&&(this.mo=eK(this.po)),this.mo}su(t,e){e=eP(e,0,this.po.length-1);let i=this.po.indexOf(t);for(let s of(Q(-1!==i,"setSeriesOrder: invalid data source"),this.po.splice(i,1),this.po.splice(e,0,t),this.po.forEach((t,e)=>t.us(e)),this.mo=null,[this.P_,this.R_]))s.s_(),s._l();this.ns.dr()}Vt(){return this.Dt().filter(eJ)}nu(){return this.y_}eu(){return this.k_}nl(t){this.ua.push(new ed(t))}el(t){this.ua=this.ua.filter(e=>e.Gh()!==t),t.detached&&t.detached(),this.ns.dr()}ru(){return this.ua}Za(t,e){return this.ua.map(i=>i.Qn(t,e)).filter(t=>null!==t)}J_(t){let e=t.p_();if(e&&e.length>0&&!this.Jh.Gi()){let e=this.Jh.Ie();null!==e&&t.v_(e)}t.Ws()}W_(t,e,i){let s=this.V_(e);if(null===s&&(s=this.T_(e,this.ns.N().overlayPriceScales)),this.po.splice(i,0,t),!tA(e)){let i=this.b_.get(e)||[];i.push(t),this.b_.set(e,i)}t.us(i),s.i_(t),t.cs(s),this.H_(s),this.mo=null}D_(t,e,i){e.ae!==i.ae&&this.J_(t)}T_(t,e){let i=new eH(t,{visible:!0,autoScale:!0,...ta(e)},this.ns.N().layout,this.ns.N().localization,this.ns.Xi());return i.No(this.$t()),i}}function eY(t){return{hu:t.hu,au:{te:t.lu.externalId},ou:t.lu.cursorStyle}}function eX(t,e,i){let s=[t,...t.Dt()],r=function(t,e,i){var s,r;let n,l;for(let o of t)for(let t of o.Za?.(e,i)??[])s=t.zOrder,(r=n?.zOrder)&&("top"!==s||"top"===r)&&("normal"!==s||"bottom"!==r)||(n=t,l=o);return n&&l?{lu:n,hu:l}:null}(s,e,i);if("top"===r?.lu.zOrder)return eY(r);for(let n of s){if(r&&r.hu===n&&"bottom"!==r.lu.zOrder&&!r.lu.isBackground)return eY(r);if(void 0!==n.Ys){let s=function(t,e,i,s){for(let r of t){let t=r.Tt(s);if(null!==t&&t.Qn){let s=t.Qn(e,i);if(null!==s)return{_u:r,au:s}}}return null}(n.Ys(t),e,i,t);if(null!==s)return{hu:n,_u:s._u,au:s.au}}if(r&&r.hu===n&&"bottom"!==r.lu.zOrder&&r.lu.isBackground)return eY(r)}return r?.lu?eY(r):null}class eG{constructor(t,e,i=50){this.Vn=0,this.Bn=1,this.En=1,this.Ln=new Map,this.An=new Map,this.uu=t,this.cu=e,this.zn=i}du(t){let e=t.time,i=this.cu.cacheKey(e),s=this.Ln.get(i);if(void 0!==s)return s.fu;if(this.Vn===this.zn){let t=this.An.get(this.En);this.An.delete(this.En),this.Ln.delete(Z(t)),this.En++,this.Vn--}let r=this.uu(t);return this.Ln.set(i,{fu:r,Wn:this.Bn}),this.An.set(this.Bn,i),this.Vn++,this.Bn++,r}}class eQ{constructor(t,e){Q(t<=e,"right should be >= left"),this.pu=t,this.vu=e}Aa(){return this.pu}bi(){return this.vu}mu(){return this.vu-this.pu+1}Ee(t){return this.pu<=t&&t<=this.vu}Ye(t){return this.pu===t.Aa()&&this.vu===t.bi()}}function eZ(t,e){return null===t||null===e?t===e:t.Ye(e)}class e0{constructor(){this.wu=new Map,this.Ln=null,this.gu=!1}Mu(t){this.gu=t,this.Ln=null}bu(t,e){this.Su(e),this.Ln=null;for(let i=e;i<t.length;++i){let e=t[i],s=this.wu.get(e.timeWeight);void 0===s&&(s=[],this.wu.set(e.timeWeight,s)),s.push({index:i,time:e.time,weight:e.timeWeight,originalTime:e.originalTime})}}xu(t,e,i,s,r){let n=Math.ceil(e/t);return null!==this.Ln&&this.Ln.Cu===n&&r===this.Ln.yu&&i===this.Ln.ku||(this.Ln={yu:r,ku:i,Vl:this.Pu(n,i,s),Cu:n}),this.Ln.Vl}Su(t){if(0===t)return void this.wu.clear();let e=[];for(let i of(this.wu.forEach((i,s)=>{t<=i[0].index?e.push(s):i.splice(er(i,t,e=>e.index<t),1/0)}),e))this.wu.delete(i)}Pu(t,e,i){let s=[],r=t=>!e||i.has(t.index);for(let e of Array.from(this.wu.keys()).sort((t,e)=>e-t)){if(!this.wu.get(e))continue;let i=s;s=[];let n=i.length,l=0,o=Z(this.wu.get(e)),a=o.length,h=1/0,u=-1/0;for(let e=0;e<a;e++){let a=o[e],c=a.index;for(;l<n;){let t=i[l],e=t.index;if(!(e<c&&r(t))){h=e;break}l++,s.push(t),u=e,h=1/0}if(h-c>=t&&c-u>=t&&r(a))s.push(a),u=c;else if(this.gu)return i}for(;l<n;l++)r(i[l])&&s.push(i[l])}return s}}class e1{constructor(t){this.Tu=t}Ru(){return null===this.Tu?null:new eQ(Math.floor(this.Tu.Aa()),Math.ceil(this.Tu.bi()))}Du(){return this.Tu}static Iu(){return new e1(null)}}function e2(t,e){return t.weight>e.weight?t:e}class e3{constructor(t,e,i,s){this.S_=0,this.Vu=null,this.Bu=[],this.bo=null,this.Mo=null,this.Eu=new e0,this.Au=new Map,this.Lu=e1.Iu(),this.zu=!0,this.Ou=new ti,this.Nu=new ti,this.Fu=new ti,this.Wu=null,this.Hu=null,this.Uu=new Map,this.$u=-1,this.qu=[],this.ju=1,this.Ps=e,this.yo=i,this.Yu=e.rightOffset,this.Ku=e.barSpacing,this.ns=t,this.Zu(e),this.cu=s,this.Gu(),this.Eu.Mu(e.uniformDistribution),this.Xu(),this.Ju()}N(){return this.Ps}Qu(t){ts(this.yo,t),this.tc(),this.Gu()}cr(t,e){ts(this.Ps,t),this.Ps.fixLeftEdge&&this.sc(),this.Ps.fixRightEdge&&this.nc(),void 0!==t.barSpacing&&this.ns.gn(t.barSpacing),void 0!==t.rightOffset&&this.ns.Mn(t.rightOffset),this.Zu(t),void 0===t.minBarSpacing&&void 0===t.maxBarSpacing||this.ns.gn(t.barSpacing??this.Ku),void 0!==t.ignoreWhitespaceIndices&&t.ignoreWhitespaceIndices!==this.Ps.ignoreWhitespaceIndices&&this.Ju(),this.tc(),this.Gu(),void 0===t.enableConflation&&void 0===t.conflationThresholdFactor||this.Xu(),this.Fu.p()}Is(t){return this.Bu[t]?.time??null}es(t){return this.Bu[t]??null}ec(t,e){if(this.Bu.length<1)return null;if(this.cu.key(t)>this.cu.key(this.Bu[this.Bu.length-1].time))return e?this.Bu.length-1:null;let i=er(this.Bu,this.cu.key(t),(t,e)=>this.cu.key(t.time)<e);return this.cu.key(t)<this.cu.key(this.Bu[i].time)?e?i:null:i}Gi(){return 0===this.S_||0===this.Bu.length||null===this.Vu}rc(){return this.Bu.length>0}Ie(){return this.hc(),this.Lu.Ru()}ac(){return this.hc(),this.Lu.Du()}lc(){let t=this.Ie();if(null===t)return null;let e={from:t.Aa(),to:t.bi()};return this.oc(e)}oc(t){let e=Math.round(t.from),i=Math.round(t.to),s=tt(this._c()),r=tt(this.uc());return{from:tt(this.es(Math.max(s,e))),to:tt(this.es(Math.min(r,i)))}}cc(t){return{from:tt(this.ec(t.from,!0)),to:tt(this.ec(t.to,!0))}}ss(){return this.S_}L_(t){if(!isFinite(t)||t<=0||this.S_===t)return;let e=this.ac(),i=this.S_;if(this.S_=t,this.zu=!0,this.Ps.lockVisibleTimeRangeOnResize&&0!==i){let e=this.Ku*t/i;this.Ku=e}this.Ps.fixLeftEdge&&null!==e&&0>=e.Aa()&&(this.Yu-=Math.round((i-t)/this.Ku)+1,this.zu=!0),this.dc(),this.fc()}qt(t){if(this.Gi()||!tn(t))return 0;let e=this.vc()+this.Yu-t;return this.S_-(e+.5)*this.Ku-1}mc(t,e){let i=this.vc(),s=void 0===e?0:e.from,r=void 0===e?t.length:e.to;for(let e=s;e<r;e++){let s=t[e].wt,r=i+this.Yu-s,n=this.S_-(r+.5)*this.Ku-1;t[e]._t=n}}wc(t,e){let i=Math.ceil(this.gc(t));return e&&this.Ps.ignoreWhitespaceIndices&&!this.Mc(i)?this.bc(i):i}Mn(t){this.zu=!0,this.Yu=t,this.fc(),this.ns.Sc(),this.ns.dr()}ul(){return this.Ku}gn(t){let e=this.Ku;if(this.xc(t),void 0!==this.Ps.rightOffsetPixels&&0!==e){let t=this.Yu*e/this.Ku;this.Yu=t}this.fc(),this.ns.Sc(),this.ns.dr()}Cc(){return this.Yu}Vl(){if(this.Gi())return null;if(null!==this.Hu)return this.Hu;let t=this.Ku,e=5*(this.ns.N().layout.fontSize+4)/8*(this.Ps.tickMarkMaxCharacterLength||8),i=Math.round(e/t),s=tt(this.Ie()),r=Math.max(s.Aa(),s.Aa()-i),n=Math.max(s.bi(),s.bi()-i),l=this.Eu.xu(t,e,this.Ps.ignoreWhitespaceIndices,this.Uu,this.$u),o=this._c()+i,a=this.uc()-i,h=this.yc(),u=this.Ps.fixLeftEdge||h,c=this.Ps.fixRightEdge||h,d=0;for(let t of l){let i;r<=t.index&&t.index<=n&&(d<this.qu.length?((i=this.qu[d]).coord=this.qt(t.index),i.label=this.kc(t),i.weight=t.weight):(i={needAlignCoordinate:!1,coord:this.qt(t.index),label:this.kc(t),weight:t.weight},this.qu.push(i)),this.Ku>e/2&&!h?i.needAlignCoordinate=!1:i.needAlignCoordinate=u&&t.index<=o||c&&t.index>=a,d++)}return this.qu.length=d,this.Hu=this.qu,this.qu}Pc(){let t;this.zu=!0,this.gn(this.Ps.barSpacing),t=void 0!==this.Ps.rightOffsetPixels?this.Ps.rightOffsetPixels/this.ul():this.Ps.rightOffset,this.Mn(t)}Tc(t){this.zu=!0,this.Vu=t,this.fc(),this.sc()}Rc(t,e){let i=this.gc(t),s=this.ul();this.gn(s+s/10*e),this.Ps.rightBarStaysOnScroll||this.Mn(this.Cc()+(i-this.gc(t)))}h_(t){this.bo&&this.u_(),null===this.Mo&&null===this.Wu&&(this.Gi()||(this.Mo=t,this.Dc()))}a_(t){if(null===this.Wu)return;let e=eP(this.S_-t,0,this.S_),i=eP(this.S_-tt(this.Mo),0,this.S_);0!==e&&0!==i&&this.gn(this.Wu.ul*e/i)}l_(){null!==this.Mo&&(this.Mo=null,this.Ic())}o_(t){null===this.bo&&null===this.Wu&&(this.Gi()||(this.bo=t,this.Dc()))}__(t){if(null===this.bo)return;let e=(this.bo-t)/this.ul();this.Yu=tt(this.Wu).Cc+e,this.zu=!0,this.fc()}u_(){null!==this.bo&&(this.bo=null,this.Ic())}Vc(){this.Bc(this.Ps.rightOffset)}Bc(t,e=400){if(!isFinite(t))throw RangeError("offset is required and must be finite number");if(!isFinite(e)||e<=0)throw RangeError("animationDuration (optional) must be finite positive number");let i=this.Yu,s=performance.now();this.ns.vn({Ec:t=>(t-s)/e>=1,Ac:r=>{let n=(r-s)/e;return n>=1?t:i+(t-i)*n}})}kt(t,e){this.zu=!0,this.Bu=t,this.Eu.bu(t,e),this.fc()}Lc(){return this.Ou}zc(){return this.Nu}Oc(){return this.Fu}vc(){return this.Vu||0}Nc(t,e){let i=t.mu(),s=e&&this.Ps.rightOffsetPixels||0;this.xc((this.S_-s)/i),this.Yu=t.bi()-this.vc(),e&&(this.Yu=s?s/this.ul():this.Ps.rightOffset),this.fc(),this.zu=!0,this.ns.Sc(),this.ns.dr()}Fc(){let t=this._c(),e=this.uc();if(null===t||null===e)return;let i=!this.Ps.rightOffsetPixels&&this.Ps.rightOffset||0;this.Nc(new eQ(t,e+i),!0)}Wc(t){let e=new eQ(t.from,t.to);this.Nc(e)}rs(t){return void 0!==this.yo.timeFormatter?this.yo.timeFormatter(t.originalTime):this.cu.formatHorzItem(t.time)}Ju(){if(this.Ps.ignoreWhitespaceIndices){for(let t of(this.Uu.clear(),this.ns.tn()))for(let e of t.ll())this.Uu.set(e,!0);this.$u++}}Hc(){return this.ju}vl(){let t=1/(window.devicePixelRatio||1),e=this.Ps.minBarSpacing;if(e>=t)return[1];let i=[1],s=2;for(;s<=512;)e<t/s&&i.push(s),s*=2;return i}yc(){let t=this.ns.N().handleScroll,e=this.ns.N().handleScale;return!(t.horzTouchDrag||t.mouseWheel||t.pressedMouseMove||t.vertTouchDrag||e.axisDoubleClickReset.time||e.axisPressedMouseMove.time||e.mouseWheel||e.pinch)}_c(){return 0===this.Bu.length?null:0}uc(){return 0===this.Bu.length?null:this.Bu.length-1}Uc(t){return(this.S_-1-t)/this.Ku}gc(t){let e=this.Uc(t);return Math.round(1e6*(this.vc()+this.Yu-e))/1e6}xc(t){let e=this.Ku;this.Ku=t,this.dc(),e!==this.Ku&&(this.zu=!0,this.$c(),this.Xu())}hc(){if(!this.zu)return;if(this.zu=!1,this.Gi())return void this.qc(e1.Iu());let t=this.vc(),e=this.S_/this.Ku,i=this.Yu+t,s=new eQ(i-e+1,i);this.qc(new e1(s))}dc(){let t=eP(this.Ku,this.jc(),this.Yc());this.Ku!==t&&(this.Ku=t,this.zu=!0)}Yc(){return this.Ps.maxBarSpacing>0?this.Ps.maxBarSpacing:.5*this.S_}jc(){return this.Ps.fixLeftEdge&&this.Ps.fixRightEdge&&0!==this.Bu.length?this.S_/this.Bu.length:this.Ps.minBarSpacing}Xu(){if(!this.Ps.enableConflation)return void(this.ju=1);let t=1/(window.devicePixelRatio||1)*(this.Ps.conflationThresholdFactor??1);if(this.Ku>=t)return void(this.ju=1);let e=Math.pow(2,Math.floor(Math.log2(t/this.Ku)));this.ju=Math.min(e,512)}fc(){let t=this.Kc();null!==t&&this.Yu<t&&(this.Yu=t,this.zu=!0);let e=this.Zc();this.Yu>e&&(this.Yu=e,this.zu=!0)}Kc(){let t=this._c(),e=this.Vu;return null===t||null===e?null:t-e-1+(this.Ps.fixLeftEdge?this.S_/this.Ku:Math.min(2,this.Bu.length))}Zc(){return this.Ps.fixRightEdge?0:this.S_/this.Ku-Math.min(2,this.Bu.length)}Dc(){this.Wu={ul:this.ul(),Cc:this.Cc()}}Ic(){this.Wu=null}kc(t){let e=this.Au.get(t.weight);return void 0===e&&(e=new eG(t=>this.Gc(t),this.cu),this.Au.set(t.weight,e)),e.du(t)}Gc(t){return this.cu.formatTickmark(t,this.yo)}qc(t){let e=this.Lu;this.Lu=t,eZ(e.Ru(),this.Lu.Ru())||this.Ou.p(),eZ(e.Du(),this.Lu.Du())||this.Nu.p(),this.$c()}$c(){this.Hu=null}tc(){this.$c(),this.Au.clear()}Gu(){this.cu.updateFormatter(this.yo)}sc(){if(!this.Ps.fixLeftEdge)return;let t=this._c();if(null===t)return;let e=this.Ie();if(null===e)return;let i=e.Aa()-t;if(i<0){let t=this.Yu-i-1;this.Mn(t)}this.dc()}nc(){this.fc(),this.dc()}Mc(t){return!this.Ps.ignoreWhitespaceIndices||this.Uu.get(t)||!1}bc(t){let e=function*(t){let e=Math.round(t),i=e<t,s=1;for(;;)i?(yield e+s,yield e-s):(yield e-s,yield e+s),s++}(t),i=this.uc();for(;i;){let t=e.next().value;if(this.Uu.get(t))return t;if(t<0||t>i)break}return t}Zu(t){if(void 0!==t.rightOffsetPixels){let e=t.rightOffsetPixels/(t.barSpacing||this.Ku);this.ns.Mn(e)}}}(h=N||(N={}))[h.OnTouchEnd=0]="OnTouchEnd",h[h.OnNextTap=1]="OnNextTap";class e5{constructor(t,e,i){this.Xc=[],this.Jc=[],this.Qc=null,this.S_=0,this.td=null,this.sd=new ti,this.nd=new ti,this.ed=null,this.rd=t,this.Ps=e,this.cu=i,this.ko=new tg(this.Ps.layout.colorParsers),this.hd=new tm(this),this.Jh=new e3(this,e.timeScale,this.Ps.localization,i),this.Ct=new tz(this,e.crosshair),this.ad=new eE(e.crosshair),e.addDefaultPane&&(this.ld(0),this.Xc[0].A_(2)),this.od=this._d(0),this.ud=this._d(1)}Ca(){this.dd(tD.yn())}dr(){this.dd(tD.Cn())}Ua(){this.dd(new tD(1))}ya(t){let e=this.fd(t);this.dd(e)}pd(){return this.td}vd(t){if(this.td?.hu===t?.hu&&this.td?.au?.te===t?.au?.te)return;let e=this.td;this.td=t,null!==e&&this.ya(e.hu),null!==t&&t.hu!==e?.hu&&this.ya(t.hu)}N(){return this.Ps}cr(t){ts(this.Ps,t),this.Xc.forEach(e=>e.I_(t)),void 0!==t.timeScale&&this.Jh.cr(t.timeScale),void 0!==t.localization&&this.Jh.Qu(t.localization),(t.leftPriceScale||t.rightPriceScale)&&this.sd.p(),this.od=this._d(0),this.ud=this._d(1),this.Ca()}md(t,e,i=0){let s=this.Xc[i];if(void 0===s)return;if("left"===t)return ts(this.Ps,{leftPriceScale:e}),s.I_({leftPriceScale:e}),this.sd.p(),void this.Ca();if("right"===t)return ts(this.Ps,{rightPriceScale:e}),s.I_({rightPriceScale:e}),this.sd.p(),void this.Ca();let r=this.wd(t,i);null!==r&&(r.Ft.cr(e),this.sd.p())}wd(t,e){let i=this.Xc[e];if(void 0===i)return null;let s=i.V_(t);return null!==s?{Gs:i,Ft:s}:null}Et(){return this.Jh}Xs(){return this.Xc}gd(){return this.Ct}Md(){return this.nd}bd(t,e){t.No(e),this.Sc()}L_(t){this.S_=t,this.Jh.L_(this.S_),this.Xc.forEach(e=>e.L_(t)),this.Sc()}Sd(t){1!==this.Xc.length&&(Q(t>=0&&t<this.Xc.length,"Invalid pane index"),this.Xc.splice(t,1),this.Ca())}xd(t,e){if(this.Xc.length<2)return;Q(t>=0&&t<this.Xc.length,"Invalid pane index");let i=this.Xc[t],s=this.Xc.reduce((t,e)=>t+e.E_(),0),r=this.Xc.reduce((t,e)=>t+e.$t(),0),n=r-30*(this.Xc.length-1);e=Math.min(n,Math.max(30,e));let l=s/r,o=i.$t();i.A_(e*l);let a=e-o,h=this.Xc.length-1;for(let t of this.Xc)if(t!==i){let e=Math.min(n,Math.max(30,t.$t()-a/h));a-=t.$t()-e,h-=1;let i=e*l;t.A_(i)}this.Ca()}Cd(t,e){Q(t>=0&&t<this.Xc.length&&e>=0&&e<this.Xc.length,"Invalid pane index");let i=this.Xc[t],s=this.Xc[e];this.Xc[t]=s,this.Xc[e]=i,this.Ca()}yd(t,e){if(Q(t>=0&&t<this.Xc.length&&e>=0&&e<this.Xc.length,"Invalid pane index"),t===e)return;let[i]=this.Xc.splice(t,1);this.Xc.splice(e,0,i),this.Ca()}j_(t,e,i){t.j_(e,i)}Y_(t,e,i){t.Y_(e,i),this.ka(),this.dd(this.kd(t,2))}K_(t,e){t.K_(e),this.dd(this.kd(t,2))}Z_(t,e,i){e.Vo()||t.Z_(e,i)}G_(t,e,i){e.Vo()||(t.G_(e,i),this.ka(),this.dd(this.kd(t,2)))}X_(t,e){e.Vo()||(t.X_(e),this.dd(this.kd(t,2)))}Q_(t,e){t.Q_(e),this.dd(this.kd(t,2))}Pd(t){this.Jh.h_(t)}Td(t,e){let i=this.Et();if(i.Gi()||0===e)return;let s=i.ss();t=Math.max(1,Math.min(t,s)),i.Rc(t,e),this.Sc()}Rd(t){this.Dd(0),this.Id(t),this.Vd()}Bd(t){this.Jh.a_(t),this.Sc()}Ed(){this.Jh.l_(),this.dr()}Dd(t){this.Jh.o_(t)}Id(t){this.Jh.__(t),this.Sc()}Vd(){this.Jh.u_(),this.dr()}tn(){return this.Jc}Us(){return null===this.Qc&&(this.Qc=this.Jc.filter(t=>t.It())),this.Qc}xa(){this.Qc=null}Ad(t,e,i,s,r){this.Ct.Bs(t,e);let n=NaN,l=this.Jh.wc(t,!0),o=this.Jh.Ie();null!==o&&(l=Math.min(Math.max(o.Aa(),l),o.bi())),l=this.Ct.Hs(l);let a=s.Rs(),h=a.Lt();if(null!==h&&(n=a.Ds(e,h)),n=this.ad.bl(n,l,s),this.Ct.zs(l,n,s),this.Ua(),!r){let r=eX(s,t,e);this.vd(r&&{hu:r.hu,au:r.au,ou:r.ou||null}),this.nd.p(this.Ct.Bt(),{x:t,y:e},i)}}Ld(t,e,i){let s=i.Rs(),r=s.Lt(),n=s.Nt(t,tt(r)),l=this.Jh.ec(e,!0),o=this.Jh.qt(tt(l));this.Ad(o,n,null,i,!0)}zd(t){this.gd().Ns(),this.Ua(),t||this.nd.p(null,null,null)}ka(){let t=this.Ct.Gs();if(null!==t){let e=this.Ct.As(),i=this.Ct.Ls();this.Ad(e,i,null,t)}this.Ct.Ws()}Od(t,e,i){let s=this.Jh.Is(0);void 0!==e&&void 0!==i&&this.Jh.kt(e,i);let r=this.Jh.Is(0),n=this.Jh.vc(),l=this.Jh.Ie();if(null!==l&&null!==s&&null!==r){let e=l.Ee(n),o=this.cu.key(s)>this.cu.key(r),a=null!==t&&t>n&&!o,h=this.Jh.N().allowShiftVisibleRangeOnWhitespaceReplacement,u=e&&(void 0!==i||h)&&this.Jh.N().shiftVisibleRangeOnNewBar;if(a&&!u){let e=t-n;this.Jh.Mn(this.Jh.Cc()-e)}}this.Jh.Tc(t)}Ra(t){null!==t&&t.iu()}Kn(t){if(t instanceof eq)return t;let e=this.Xc.find(e=>e.Dt().includes(t));return void 0===e?null:e}Sc(){this.Xc.forEach(t=>t.iu()),this.ka()}m(){this.Xc.forEach(t=>t.m()),this.Xc.length=0,this.Ps.localization.priceFormatter=void 0,this.Ps.localization.percentageFormatter=void 0,this.Ps.localization.timeFormatter=void 0}Nd(){return this.hd}Jn(){return this.hd.N()}B_(){return this.sd}Fd(t,e){let i=this.ld(e);this.Wd(t,i),this.Jc.push(t),this.xa(),1===this.Jc.length?this.Ca():this.dr()}Hd(t){let e=this.Kn(t),i=this.Jc.indexOf(t);Q(-1!==i,"Series not found");let s=tt(e);this.Jc.splice(i,1),s.n_(t),t.m&&t.m(),this.xa(),this.Jh.Ju(),this.Ud(s)}Sa(t,e){let i=tt(this.Kn(t));i.n_(t,!0),i.i_(t,e,!0)}Fc(){let t=tD.Cn();t.cn(),this.dd(t)}$d(t){let e=tD.Cn();e.pn(t),this.dd(e)}wn(){let t=tD.Cn();t.wn(),this.dd(t)}gn(t){let e=tD.Cn();e.gn(t),this.dd(e)}Mn(t){let e=tD.Cn();e.Mn(t),this.dd(e)}vn(t){let e=tD.Cn();e.vn(t),this.dd(e)}dn(){let t=tD.Cn();t.dn(),this.dd(t)}qd(){return this.Ps.rightPriceScale.visible?"right":"left"}jd(t,e){if(Q(e>=0,"Index should be greater or equal to 0"),e===this.Yd(t))return;let i=tt(this.Kn(t));i.n_(t);let s=this.ld(e);this.Wd(t,s),0===i.Sl().length&&this.Ud(i),this.Ca()}Kd(){return this.ud}$(){return this.od}Ut(t){let e=this.ud,i=this.od;if(e===i)return e;if(t=Math.max(0,Math.min(100,Math.round(100*t))),null===this.ed||this.ed.eh!==i||this.ed.rh!==e)this.ed={eh:i,rh:e,Zd:new Map};else{let e=this.ed.Zd.get(t);if(void 0!==e)return e}let s=this.ko.tt(i,e,t/100);return this.ed.Zd.set(t,s),s}Gd(t){return this.Xc.indexOf(t)}Xi(){return this.ko}Xd(){return this.Jd()}Jd(t){let e=new eq(this.Jh,this);this.Xc.push(e);let i=t??this.Xc.length-1,s=tD.yn();return s.hn(i,{an:0,ln:!0}),this.dd(s),e}ld(t){return Q(t>=0,"Index should be greater or equal to 0"),(t=Math.min(this.Xc.length,t))<this.Xc.length?this.Xc[t]:this.Jd(t)}Yd(t){return this.Xc.findIndex(e=>e.F_().includes(t))}kd(t,e){let i=new tD(e);if(null!==t){let s=this.Xc.indexOf(t);i.hn(s,{an:e})}return i}fd(t,e){return void 0===e&&(e=2),this.kd(this.Kn(t),e)}dd(t){this.rd&&this.rd(t),this.Xc.forEach(t=>t.eu().pr().kt())}Wd(t,e){let i=t.N().priceScaleId,s=void 0!==i?i:this.qd();e.i_(t,s),tA(s)||t.cr(t.N())}_d(t){let e=this.Ps.layout;return"gradient"===e.background.type?0===t?e.background.topColor:e.background.bottomColor:e.background.color}Ud(t){!t.N_()&&0===t.Sl().length&&this.Xc.length>1&&this.Xc.splice(this.Gd(t),1)}}function e4(t){if(t>=1)return 0;let e=0;for(;e<8&&!(1e-8>Math.abs(Math.round(t)-t));e++)t*=10;return e}function e6(t){return!tr(t)&&!tl(t)}(u=E||(E={}))[u.Disabled=0]="Disabled",u[u.Continuous=1]="Continuous",u[u.OnDataUpdate=2]="OnDataUpdate",(c=P||(P={}))[c.LastBar=0]="LastBar",c[c.LastVisible=1]="LastVisible",(d=k||(k={})).Solid="solid",d.VerticalGradient="gradient",(m=_||(_={}))[m.Year=0]="Year",m[m.Month=1]="Month",m[m.DayOfMonth=2]="DayOfMonth",m[m.Time=3]="Time",m[m.TimeWithSeconds=4]="TimeWithSeconds";class e9{constructor(t="yyyy-MM-dd",e="default"){this.Qd=t,this.tf=e}du(t){return function(t,e,i){return e.replace(/yyyy/g,tB(t.getUTCFullYear(),4)).replace(/yy/g,tB(t.getUTCFullYear()%100,2)).replace(/MMMM/g,new Date(t.getUTCFullYear(),t.getUTCMonth(),1).toLocaleString(i,{month:"long"})).replace(/MMM/g,new Date(t.getUTCFullYear(),t.getUTCMonth(),1).toLocaleString(i,{month:"short"})).replace(/MM/g,tB(t.getUTCMonth()+1,2)).replace(/dd/g,tB(t.getUTCDate(),2))}(t,this.Qd,this.tf)}}class e7{constructor(t){this.if=t||"%h:%m:%s"}du(t){return this.if.replace("%h",tB(t.getUTCHours(),2)).replace("%m",tB(t.getUTCMinutes(),2)).replace("%s",tB(t.getUTCSeconds(),2))}}let e8={sf:"yyyy-MM-dd",nf:"%h:%m:%s",ef:" ",rf:"default"};class it{constructor(t={}){const e={...e8,...t};this.hf=new e9(e.sf,e.rf),this.af=new e7(e.nf),this.lf=e.ef}du(t){return`${this.hf.du(t)}${this.lf}${this.af.du(t)}`}}function ie(t){return 60*t*6e4}function ii(t){return 60*t*1e3}let is=[{_f:1e3,uf:10},{_f:ii(1),uf:20},{_f:ii(5),uf:21},{_f:ii(30),uf:22},{_f:ie(1),uf:30},{_f:ie(3),uf:31},{_f:ie(6),uf:32},{_f:ie(12),uf:33}];function ir(t,e){if(t.getUTCFullYear()!==e.getUTCFullYear())return 70;if(t.getUTCMonth()!==e.getUTCMonth())return 60;if(t.getUTCDate()!==e.getUTCDate())return 50;for(let i=is.length-1;i>=0;--i)if(Math.floor(e.getTime()/is[i]._f)!==Math.floor(t.getTime()/is[i]._f))return is[i].uf;return 0}function il(t){let e=t;if(tl(t)&&(e=ia(t)),!e6(e))throw Error("time must be of type BusinessDay");return{cf:Math.round(new Date(Date.UTC(e.year,e.month-1,e.day,0,0,0,0)).getTime()/1e3),df:e}}function io(t){if(!tr(t))throw Error("time must be of type isUTCTimestamp");return{cf:t}}function ia(t){let e=new Date(t);if(isNaN(e.getTime()))throw Error(`Invalid date string=${t}, expected format=yyyy-mm-dd`);return{day:e.getUTCDate(),month:e.getUTCMonth()+1,year:e.getUTCFullYear()}}function ih(t){tl(t.time)&&(t.time=ia(t.time))}class iu{options(){return this.Ps}setOptions(t){this.Ps=t,this.updateFormatter(t.localization)}preprocessData(t){Array.isArray(t)?t.forEach(ih):ih(t)}createConverterToInternalObj(t){return tt(0===t.length?null:e6(t[0].time)||tl(t[0].time)?il:io)}key(t){return"object"==typeof t&&"cf"in t?t.cf:this.key(this.convertHorzItemToInternal(t))}cacheKey(t){return void 0===t.df?new Date(1e3*t.cf).getTime():new Date(Date.UTC(t.df.year,t.df.month-1,t.df.day)).getTime()}convertHorzItemToInternal(t){return tr(t)?io(t):e6(t)?il(t):il(ia(t))}updateFormatter(t){if(!this.Ps)return;let e=t.dateFormat;this.Ps.timeScale.timeVisible?this.ff=new it({sf:e,nf:this.Ps.timeScale.secondsVisible?"%h:%m:%s":"%h:%m",ef:"   ",rf:t.locale}):this.ff=new e9(e,t.locale)}formatHorzItem(t){return this.ff.du(new Date(1e3*t.cf))}formatTickmark(t,e){let i=function(t,e,i){switch(t){case 0:case 10:return e?i?4:3:2;case 20:case 21:case 22:case 30:case 31:case 32:case 33:return e?3:2;case 50:return 2;case 60:return 1;case 70:return 0}}(t.weight,this.Ps.timeScale.timeVisible,this.Ps.timeScale.secondsVisible),s=this.Ps.timeScale;if(void 0!==s.tickMarkFormatter){let r=s.tickMarkFormatter(t.originalTime,i,e.locale);if(null!==r)return r}return function(t,e,i){let s={};switch(e){case 0:s.year="numeric";break;case 1:s.month="short";break;case 2:s.day="numeric";break;case 3:s.hour12=!1,s.hour="2-digit",s.minute="2-digit";break;case 4:s.hour12=!1,s.hour="2-digit",s.minute="2-digit",s.second="2-digit"}let r=new Date(void 0===t.df?1e3*t.cf:Date.UTC(t.df.year,t.df.month-1,t.df.day));return new Date(r.getUTCFullYear(),r.getUTCMonth(),r.getUTCDate(),r.getUTCHours(),r.getUTCMinutes(),r.getUTCSeconds(),r.getUTCMilliseconds()).toLocaleString(i,s)}(t.time,i,e.locale)}maxTickMarkWeight(t){let e=t.reduce(e2,t[0]).weight;return e>30&&e<50&&(e=30),e}fillWeightsForPoints(t,e){!function(t,e=0){if(0===t.length)return;let i=0===e?null:t[e-1].time.cf,s=null!==i?new Date(1e3*i):null,r=0;for(let n=e;n<t.length;++n){let e=t[n],l=new Date(1e3*e.time.cf);null!==s&&(e.timeWeight=ir(l,s)),r+=e.time.cf-(i||e.time.cf),i=e.time.cf,s=l}if(0===e&&t.length>1){let e=Math.ceil(r/(t.length-1)),i=new Date(1e3*(t[0].time.cf-e));t[0].timeWeight=ir(new Date(1e3*t[0].time.cf),i)}}(t,e)}static pf(t){return ts({localization:{dateFormat:"dd MMM 'yy"}},t??{})}}let ic="undefined"!=typeof window;function id(){return!!ic&&window.navigator.userAgent.toLowerCase().indexOf("firefox")>-1}function im(){return!!ic&&/iPhone|iPad|iPod/.test(window.navigator.platform)}class ip{constructor(t,e,i){this.vf=0,this.mf=null,this.wf={_t:-1/0,ut:1/0},this.gf=0,this.Mf=null,this.bf={_t:-1/0,ut:1/0},this.Sf=null,this.xf=!1,this.Cf=null,this.yf=null,this.kf=!1,this.Pf=!1,this.Tf=!1,this.Rf=null,this.Df=null,this.If=null,this.Vf=null,this.Bf=null,this.Ef=null,this.Af=null,this.Lf=0,this.zf=!1,this.Of=!1,this.Nf=!1,this.Ff=0,this.Wf=null,this.Hf=!im(),this.Uf=t=>{this.$f(t)},this.qf=t=>{if(this.jf(t)){let e=this.Yf(t);if(++this.gf,this.Mf&&this.gf>1){let{Kf:i}=this.Zf(ix(t),this.bf);i<30&&!this.Tf&&this.Gf(e,this.Jf.Xf),this.Qf()}}else{let e=this.Yf(t);if(++this.vf,this.mf&&this.vf>1){let{Kf:i}=this.Zf(ix(t),this.wf);i<5&&!this.Pf&&this.tp(e,this.Jf.ip),this.sp()}}},this.np=t,this.Jf=e,this.Ps=i,this.ep()}m(){null!==this.Rf&&(this.Rf(),this.Rf=null),null!==this.Df&&(this.Df(),this.Df=null),null!==this.Vf&&(this.Vf(),this.Vf=null),null!==this.Bf&&(this.Bf(),this.Bf=null),null!==this.Ef&&(this.Ef(),this.Ef=null),null!==this.If&&(this.If(),this.If=null),this.rp(),this.sp()}hp(t){this.Vf&&this.Vf();let e=this.ap.bind(this);if(this.Vf=()=>{this.np.removeEventListener("mousemove",e)},this.np.addEventListener("mousemove",e),this.jf(t))return;let i=this.Yf(t);this.tp(i,this.Jf.lp),this.Hf=!0}sp(){null!==this.mf&&clearTimeout(this.mf),this.vf=0,this.mf=null,this.wf={_t:-1/0,ut:1/0}}Qf(){null!==this.Mf&&clearTimeout(this.Mf),this.gf=0,this.Mf=null,this.bf={_t:-1/0,ut:1/0}}ap(t){if(this.Nf||null!==this.yf||this.jf(t))return;let e=this.Yf(t);this.tp(e,this.Jf.op),this.Hf=!0}_p(t){let e=iy(t.changedTouches,tt(this.Wf));if(null===e||(this.Ff=iw(t),null!==this.Af)||this.Of)return;this.zf=!0;let{up:i,cp:s,Kf:r}=this.Zf(ix(e),tt(this.yf));if(this.kf||!(r<5)){if(!this.kf){let t=.5*i,e=s>=t&&!this.Ps.dp(),r=t>s&&!this.Ps.fp();e||r||(this.Of=!0),this.kf=!0,this.Tf=!0,this.rp(),this.Qf()}if(!this.Of){let i=this.Yf(t,e);this.Gf(i,this.Jf.pp),iv(t)}}}vp(t){if(0!==t.button)return;let{Kf:e}=this.Zf(ix(t),tt(this.Cf));if(e>=5&&(this.Pf=!0,this.sp()),this.Pf){let e=this.Yf(t);this.tp(e,this.Jf.mp)}}Zf(t,e){let i=Math.abs(e._t-t._t),s=Math.abs(e.ut-t.ut);return{up:i,cp:s,Kf:i+s}}wp(t){let e=iy(t.changedTouches,tt(this.Wf));if(null===e&&0===t.touches.length&&(e=t.changedTouches[0]),null===e)return;this.Wf=null,this.Ff=iw(t),this.rp(),this.yf=null,this.Ef&&(this.Ef(),this.Ef=null);let i=this.Yf(t,e);if(this.Gf(i,this.Jf.gp),++this.gf,this.Mf&&this.gf>1){let{Kf:t}=this.Zf(ix(e),this.bf);t<30&&!this.Tf&&this.Gf(i,this.Jf.Xf),this.Qf()}else this.Tf||(this.Gf(i,this.Jf.Mp),this.Jf.Mp&&iv(t));0===this.gf&&iv(t),0===t.touches.length&&this.xf&&(this.xf=!1,iv(t))}$f(t){if(0!==t.button)return;let e=this.Yf(t);if(this.Cf=null,this.Nf=!1,this.Bf&&(this.Bf(),this.Bf=null),id()&&this.np.ownerDocument.documentElement.removeEventListener("mouseleave",this.Uf),!this.jf(t))if(this.tp(e,this.Jf.bp),++this.vf,this.mf&&this.vf>1){let{Kf:i}=this.Zf(ix(t),this.wf);i<5&&!this.Pf&&this.tp(e,this.Jf.ip),this.sp()}else this.Pf||this.tp(e,this.Jf.Sp)}rp(){null!==this.Sf&&(clearTimeout(this.Sf),this.Sf=null)}xp(t){if(null!==this.Wf)return;let e=t.changedTouches[0];this.Wf=e.identifier,this.Ff=iw(t);let i=this.np.ownerDocument.documentElement;this.Tf=!1,this.kf=!1,this.Of=!1,this.yf=ix(e),this.Ef&&(this.Ef(),this.Ef=null);{let e=this._p.bind(this),s=this.wp.bind(this);this.Ef=()=>{i.removeEventListener("touchmove",e),i.removeEventListener("touchend",s)},i.addEventListener("touchmove",e,{passive:!1}),i.addEventListener("touchend",s,{passive:!1}),this.rp(),this.Sf=setTimeout(this.Cp.bind(this,t),240)}let s=this.Yf(t,e);this.Gf(s,this.Jf.yp),this.Mf||(this.gf=0,this.Mf=setTimeout(this.Qf.bind(this),500),this.bf=ix(e))}kp(t){if(0!==t.button)return;let e=this.np.ownerDocument.documentElement;id()&&e.addEventListener("mouseleave",this.Uf),this.Pf=!1,this.Cf=ix(t),this.Bf&&(this.Bf(),this.Bf=null);{let t=this.vp.bind(this),i=this.$f.bind(this);this.Bf=()=>{e.removeEventListener("mousemove",t),e.removeEventListener("mouseup",i)},e.addEventListener("mousemove",t),e.addEventListener("mouseup",i)}if(this.Nf=!0,this.jf(t))return;let i=this.Yf(t);this.tp(i,this.Jf.Pp),this.mf||(this.vf=0,this.mf=setTimeout(this.sp.bind(this),500),this.wf=ix(t))}ep(){var t;this.np.addEventListener("mouseenter",this.hp.bind(this)),this.np.addEventListener("touchcancel",this.rp.bind(this));{let t=this.np.ownerDocument,e=t=>{this.Jf.Tp&&(t.composed&&this.np.contains(t.composedPath()[0])||t.target&&this.np.contains(t.target)||this.Jf.Tp())};this.Df=()=>{t.removeEventListener("touchstart",e)},this.Rf=()=>{t.removeEventListener("mousedown",e)},t.addEventListener("mousedown",e),t.addEventListener("touchstart",e,{passive:!0})}im()&&(this.If=()=>{this.np.removeEventListener("dblclick",this.qf)},this.np.addEventListener("dblclick",this.qf)),this.np.addEventListener("mouseleave",this.Rp.bind(this)),this.np.addEventListener("touchstart",this.xp.bind(this),{passive:!0}),t=this.np,ic&&void 0!==window.chrome&&t.addEventListener("mousedown",t=>{if(1===t.button)return t.preventDefault(),!1}),this.np.addEventListener("mousedown",this.kp.bind(this)),this.Dp(),this.np.addEventListener("touchmove",()=>{},{passive:!1})}Dp(){void 0===this.Jf.Ip&&void 0===this.Jf.Vp&&void 0===this.Jf.Bp||(this.np.addEventListener("touchstart",t=>this.Ep(t.touches),{passive:!0}),this.np.addEventListener("touchmove",t=>{if(2===t.touches.length&&null!==this.Af&&void 0!==this.Jf.Vp){let e=ig(t.touches[0],t.touches[1])/this.Lf;this.Jf.Vp(this.Af,e),iv(t)}},{passive:!1}),this.np.addEventListener("touchend",t=>{this.Ep(t.touches)}))}Ep(t){1===t.length&&(this.zf=!1),2!==t.length||this.zf||this.xf?this.Ap():this.Lp(t)}Lp(t){let e=this.np.getBoundingClientRect()||{left:0,top:0};this.Af={_t:(t[0].clientX-e.left+(t[1].clientX-e.left))/2,ut:(t[0].clientY-e.top+(t[1].clientY-e.top))/2},this.Lf=ig(t[0],t[1]),void 0!==this.Jf.Ip&&this.Jf.Ip(),this.rp()}Ap(){null!==this.Af&&(this.Af=null,void 0!==this.Jf.Bp&&this.Jf.Bp())}Rp(t){if(this.Vf&&this.Vf(),this.jf(t)||!this.Hf)return;let e=this.Yf(t);this.tp(e,this.Jf.zp),this.Hf=!im()}Cp(t){let e=iy(t.touches,tt(this.Wf));if(null===e)return;let i=this.Yf(t,e);this.Gf(i,this.Jf.Op),this.Tf=!0,this.xf=!0}jf(t){return t.sourceCapabilities&&void 0!==t.sourceCapabilities.firesTouchEvents?t.sourceCapabilities.firesTouchEvents:iw(t)<this.Ff+500}Gf(t,e){e&&e.call(this.Jf,t)}tp(t,e){e&&e.call(this.Jf,t)}Yf(t,e){let i=e||t,s=this.np.getBoundingClientRect()||{left:0,top:0};return{clientX:i.clientX,clientY:i.clientY,pageX:i.pageX,pageY:i.pageY,screenX:i.screenX,screenY:i.screenY,localX:i.clientX-s.left,localY:i.clientY-s.top,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey,metaKey:t.metaKey,Np:!t.type.startsWith("mouse")&&"contextmenu"!==t.type&&"click"!==t.type,Fp:t.type,Wp:i.target,_u:t.view,Hp:()=>{"touchstart"!==t.type&&iv(t)}}}}function ig(t,e){let i=t.clientX-e.clientX,s=t.clientY-e.clientY;return Math.sqrt(i*i+s*s)}function iv(t){t.cancelable&&t.preventDefault()}function ix(t){return{_t:t.pageX,ut:t.pageY}}function iw(t){return t.timeStamp||performance.now()}function iy(t,e){for(let i=0;i<t.length;++i)if(t[i].identifier===e)return t[i];return null}class ib{constructor(t,e,i){this.Up=null,this.$p=null,this.qp=!0,this.jp=null,this.Yp=t,this.Kp=t.Zp()[e],this.Gp=t.Zp()[i],this.Xp=document.createElement("tr"),this.Xp.style.height="1px",this.Jp=document.createElement("td"),this.Jp.style.position="relative",this.Jp.style.padding="0",this.Jp.style.margin="0",this.Jp.setAttribute("colspan","3"),this.Qp(),this.Xp.appendChild(this.Jp),this.qp=this.Yp.N().layout.panes.enableResize,this.qp?this.tv():(this.Up=null,this.$p=null)}m(){null!==this.$p&&this.$p.m()}iv(){return this.Xp}sv(){return W({width:this.Kp.sv().width,height:1})}nv(){return W({width:this.Kp.nv().width,height:+window.devicePixelRatio})}ev(t,e,i){let s=this.nv();t.fillStyle=this.Yp.N().layout.panes.separatorColor,t.fillRect(e,i,s.width,s.height)}kt(){this.Qp(),this.Yp.N().layout.panes.enableResize!==this.qp&&(this.qp=this.Yp.N().layout.panes.enableResize,this.qp?this.tv():(null!==this.Up&&(this.Jp.removeChild(this.Up.rv),this.Jp.removeChild(this.Up.hv),this.Up=null),null!==this.$p&&(this.$p.m(),this.$p=null)))}tv(){let t=document.createElement("div"),e=t.style;e.position="fixed",e.display="none",e.zIndex="49",e.top="0",e.left="0",e.width="100%",e.height="100%",e.cursor="row-resize",this.Jp.appendChild(t);let i=document.createElement("div"),s=i.style;s.position="absolute",s.zIndex="50",s.top="-4px",s.height="9px",s.width="100%",s.backgroundColor="",s.cursor="row-resize",this.Jp.appendChild(i);let r={lp:this.av.bind(this),zp:this.lv.bind(this),Pp:this.ov.bind(this),yp:this.ov.bind(this),mp:this._v.bind(this),pp:this._v.bind(this),bp:this.uv.bind(this),gp:this.uv.bind(this)};this.$p=new ip(i,r,{dp:()=>!1,fp:()=>!0}),this.Up={hv:i,rv:t}}Qp(){this.Jp.style.background=this.Yp.N().layout.panes.separatorColor}av(t){null!==this.Up&&(this.Up.hv.style.backgroundColor=this.Yp.N().layout.panes.separatorHoverColor)}lv(t){null!==this.Up&&null===this.jp&&(this.Up.hv.style.backgroundColor="")}ov(t){if(null===this.Up)return;let e=this.Kp.cv().E_()+this.Gp.cv().E_(),i=e/(this.Kp.sv().height+this.Gp.sv().height),s=30*i;e<=2*s||(this.jp={dv:t.pageY,fv:this.Kp.cv().E_(),pv:e-s,vv:e,mv:i,wv:s},this.Up.rv.style.display="block")}_v(t){let e=this.jp;if(null===e)return;let i=(t.pageY-e.dv)*e.mv,s=eP(e.fv+i,e.wv,e.pv);this.Kp.cv().A_(s),this.Gp.cv().A_(e.vv-s),this.Yp.Qt().Ca()}uv(t){null!==this.jp&&null!==this.Up&&(this.jp=null,this.Up.rv.style.display="none")}}function iS(t,e,i){let s=(t.gv-e.gv)/(t.wt-e.wt);return Math.sign(s)*Math.min(Math.abs(s),i)}class ij{constructor(t,e,i,s){this.Mv=null,this.bv=null,this.Sv=null,this.xv=null,this.Cv=null,this.yv=0,this.kv=0,this.Pv=t,this.Tv=e,this.Rv=i,this.kn=s}Dv(t,e){if(null!==this.Mv){if(this.Mv.wt===e)return void(this.Mv.gv=t);if(Math.abs(this.Mv.gv-t)<this.kn)return}this.xv=this.Sv,this.Sv=this.bv,this.bv=this.Mv,this.Mv={wt:e,gv:t}}fe(t,e){var i,s,r,n,l,o,a;let h;if(null===this.Mv||null===this.bv||e-this.Mv.wt>50)return;let u=0,c=iS(this.Mv,this.bv,this.Tv),d=(i=this.Mv,s=this.bv,i.gv-s.gv),m=[c],p=[d];if(u+=d,null!==this.Sv){let t=iS(this.bv,this.Sv,this.Tv);if(Math.sign(t)===Math.sign(c)){let e=(r=this.bv,n=this.Sv,r.gv-n.gv);if(m.push(t),p.push(e),u+=e,null!==this.xv){let t=iS(this.Sv,this.xv,this.Tv);if(Math.sign(t)===Math.sign(c)){let e=(l=this.Sv,o=this.xv,l.gv-o.gv);m.push(t),p.push(e),u+=e}}}}let f=0;for(let t=0;t<m.length;++t)f+=p[t]/u*m[t];Math.abs(f)<this.Pv||(this.Cv={gv:t,wt:e},this.kv=f,this.yv=(a=Math.abs(f),Math.log(-((h=Math.log(this.Rv))/a))/h))}Ac(t){let e=tt(this.Cv),i=t-e.wt;return e.gv+this.kv*(Math.pow(this.Rv,i)-1)/Math.log(this.Rv)}Ec(t){return null===this.Cv||this.Iv(t)===this.yv}Iv(t){return Math.min(t-tt(this.Cv).wt,this.yv)}}class iM{constructor(t,e){this.Vv=void 0,this.Bv=void 0,this.Ev=void 0,this.ws=!1,this.Av=t,this.Lv=e,this.zv()}kt(){this.zv()}Ov(){this.Vv&&this.Av.removeChild(this.Vv),this.Bv&&this.Av.removeChild(this.Bv),this.Vv=void 0,this.Bv=void 0}Nv(){return this.ws!==this.Fv()||this.Ev!==this.Wv()}Wv(){return this.Lv.Qt().Xi().J(this.Lv.N().layout.textColor)>160?"dark":"light"}Fv(){return this.Lv.N().layout.attributionLogo}Hv(){let t=new URL(location.href);return t.hostname?"&utm_source="+t.hostname+t.pathname:""}zv(){this.Nv()&&(this.Ov(),this.ws=this.Fv(),this.ws&&(this.Ev=this.Wv(),this.Bv=document.createElement("style"),this.Bv.innerText="a#tv-attr-logo{--fill:#131722;--stroke:#fff;position:absolute;left:10px;bottom:10px;height:19px;width:35px;margin:0;padding:0;border:0;z-index:3;}a#tv-attr-logo[data-dark]{--fill:#D1D4DC;--stroke:#131722;}",this.Vv=document.createElement("a"),this.Vv.href=`https://www.tradingview.com/?utm_medium=lwc-link&utm_campaign=lwc-chart${this.Hv()}`,this.Vv.title="Charting by TradingView",this.Vv.id="tv-attr-logo",this.Vv.target="_blank",this.Vv.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="35" height="19" fill="none"><g fill-rule="evenodd" clip-path="url(#a)" clip-rule="evenodd"><path fill="var(--stroke)" d="M2 0H0v10h6v9h21.4l.5-1.3 6-15 1-2.7H23.7l-.5 1.3-.2.6a5 5 0 0 0-7-.9V0H2Zm20 17h4l5.2-13 .8-2h-7l-1 2.5-.2.5-1.5 3.8-.3.7V17Zm-.8-10a3 3 0 0 0 .7-2.7A3 3 0 1 0 16.8 7h4.4ZM14 7V2H2v6h6v9h4V7h2Z"/><path fill="var(--fill)" d="M14 2H2v6h6v9h6V2Zm12 15h-7l6-15h7l-6 15Zm-7-9a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"/></g><defs><clipPath id="a"><path fill="var(--stroke)" d="M0 0h35v19H0z"/></clipPath></defs></svg>',this.Vv.toggleAttribute("data-dark","dark"===this.Ev),this.Av.appendChild(this.Bv),this.Av.appendChild(this.Vv)))}}function iC(t,e){let i=tt(t.ownerDocument).createElement("canvas");t.appendChild(i);let s=function(t,e){if("device-pixel-content-box"===e.type)return new U(t,e.transform,e.options);throw Error("Unsupported binding target")}(i,{type:"device-pixel-content-box",options:{allowResizeObserver:!0},transform:(t,e)=>({width:Math.max(t.width,e.width),height:Math.max(t.height,e.height)})});return s.resizeCanvasElement(e),s}function iN(t){t.width=1,t.height=1,t.getContext("2d")?.clearRect(0,0,1,1)}function iE(t,e,i,s){t.Uh&&t.Uh(e,i,s)}function iP(t,e,i,s){t.nt(e,i,s)}function ik(t,e,i,s){for(let r of t(i,s)){let t=r.Tt(s);null!==t&&e(t)}}function i_(t,e){return i=>void 0===i.Ft||(i.Ft()?.ol()??"")!==e?[]:i.Ya?.(t)??[]}function iR(t,e,i,s){if(!t.length)return;let r=0,n=t[0].$t(s,!0),l=1===e?i/2-(t[0].Hi()-n/2):t[0].Hi()-n/2-i/2;l=Math.max(0,l);for(let n=1;n<t.length;n++){let o=t[n],a=t[n-1],h=a.$t(s,!1),u=o.Hi(),c=a.Hi();if(1===e?u>c-h:u<c+h){let s=c-h*e;o.Ui(s);let n=s-e*h/2;if((1===e?n<0:n>i)&&l>0){let s=Math.min(1===e?-1-n:n-i,l);for(let i=r;i<t.length;i++)t[i].Ui(t[i].Hi()+e*s);l-=s}}else r=n,l=1===e?c-h-u:u-(c+h)}}class iT{constructor(t,e,i,s){this.Ki=null,this.Uv=null,this.$v=!1,this.qv=new tU(200),this.jv=null,this.Yv=0,this.Kv=!1,this.Zv=()=>{this.Kv||this.yt.Gv().Qt().dr()},this.Xv=()=>{this.Kv||this.yt.Gv().Qt().dr()},this.yt=t,this.Ps=e,this.Co=e.layout,this.hd=i,this.Jv="left"===s,this.Qv=i_("normal",s),this.tm=i_("top",s),this.im=i_("bottom",s),this.Jp=document.createElement("div"),this.Jp.style.height="100%",this.Jp.style.overflow="hidden",this.Jp.style.width="25px",this.Jp.style.left="0",this.Jp.style.position="relative",this.sm=iC(this.Jp,W({width:16,height:16})),this.sm.subscribeSuggestedBitmapSizeChanged(this.Zv);const r=this.sm.canvasElement;r.style.position="absolute",r.style.zIndex="1",r.style.left="0",r.style.top="0",this.nm=iC(this.Jp,W({width:16,height:16})),this.nm.subscribeSuggestedBitmapSizeChanged(this.Xv);const n=this.nm.canvasElement;n.style.position="absolute",n.style.zIndex="2",n.style.left="0",n.style.top="0";const l={Pp:this.ov.bind(this),yp:this.ov.bind(this),mp:this._v.bind(this),pp:this._v.bind(this),Tp:this.rm.bind(this),bp:this.uv.bind(this),gp:this.uv.bind(this),ip:this.hm.bind(this),Xf:this.hm.bind(this),lp:this.am.bind(this),zp:this.lv.bind(this)};this.$p=new ip(this.nm.canvasElement,l,{dp:()=>!this.Ps.handleScroll.vertTouchDrag,fp:()=>!0})}m(){this.$p.m(),this.nm.unsubscribeSuggestedBitmapSizeChanged(this.Xv),iN(this.nm.canvasElement),this.nm.dispose(),this.sm.unsubscribeSuggestedBitmapSizeChanged(this.Zv),iN(this.sm.canvasElement),this.sm.dispose(),null!==this.Ki&&this.Ki.r_().u(this),this.Ki=null}iv(){return this.Jp}k(){return this.Co.fontSize}lm(){let t=this.hd.N();return this.jv!==t.P&&(this.qv.On(),this.jv=t.P),t}om(){var t,e;if(null===this.Ki)return 0;let i=0,s=this.lm(),r=tt(this.sm.canvasElement.getContext("2d",{colorSpace:this.yt.Gv().N().layout.colorSpace}));r.save();let n=this.Ki.Vl();r.font=this._m(),n.length>0&&(i=Math.max(this.qv.Ii(r,n[0].Jl),this.qv.Ii(r,n[n.length-1].Jl)));let l=this.um();for(let t=l.length;t--;){let e=this.qv.Ii(r,l[t].ri());e>i&&(i=e)}let o=this.Ki.Lt();if(null!==o&&null!==this.Uv&&2!==(t=this.Ps.crosshair).mode&&t.horzLine.visible&&t.horzLine.labelVisible){let t=this.Ki.Ds(1,o),e=this.Ki.Ds(this.Uv.height-2,o);i=Math.max(i,this.qv.Ii(r,this.Ki.Ji(Math.floor(Math.min(t,e))+.11111111111111,o)),this.qv.Ii(r,this.Ki.Ji(Math.ceil(Math.max(t,e))-.11111111111111,o)))}r.restore();let a=i||34;return(e=Math.ceil(s.S+s.C+s.V+s.B+5+a))+e%2}dm(t){null!==this.Uv&&K(this.Uv,t)||(this.Uv=t,this.Kv=!0,this.sm.resizeCanvasElement(t),this.nm.resizeCanvasElement(t),this.Kv=!1,this.Jp.style.width=`${t.width}px`,this.Jp.style.height=`${t.height}px`)}fm(){return tt(this.Uv).width}cs(t){this.Ki!==t&&(null!==this.Ki&&this.Ki.r_().u(this),this.Ki=t,t.r_().i(this.do.bind(this),this))}Ft(){return this.Ki}On(){let t=this.yt.cv();this.yt.Gv().Qt().Q_(t,tt(this.Ft()))}pm(t){if(null===this.Uv)return;let e={colorSpace:this.yt.Gv().N().layout.colorSpace};if(1!==t){this.vm(),this.sm.applySuggestedBitmapSize();let t=q(this.sm,e);null!==t&&(t.useBitmapCoordinateSpace(t=>{this.wm(t),this.gm(t)}),this.yt.Mm(t,this.im),this.bm(t),this.yt.Mm(t,this.Qv),this.Sm(t))}this.nm.applySuggestedBitmapSize();let i=q(this.nm,e);null!==i&&(i.useBitmapCoordinateSpace(({context:t,bitmapSize:e})=>{t.clearRect(0,0,e.width,e.height)}),this.xm(i),this.yt.Mm(i,this.tm))}nv(){return this.sm.bitmapSize}ev(t,e,i,s){let r=this.nv();if(r.width>0&&r.height>0&&(t.drawImage(this.sm.canvasElement,e,i),s)){let s=this.nm.canvasElement;t.drawImage(s,e,i)}}kt(){this.Ki?.Vl()}ov(t){if(null===this.Ki||this.Ki.Gi()||!this.Ps.handleScale.axisPressedMouseMove.price)return;let e=this.yt.Gv().Qt(),i=this.yt.cv();this.$v=!0,e.j_(i,this.Ki,t.localY)}_v(t){if(null===this.Ki||!this.Ps.handleScale.axisPressedMouseMove.price)return;let e=this.yt.Gv().Qt(),i=this.yt.cv(),s=this.Ki;e.Y_(i,s,t.localY)}rm(){if(null===this.Ki||!this.Ps.handleScale.axisPressedMouseMove.price)return;let t=this.yt.Gv().Qt(),e=this.yt.cv(),i=this.Ki;this.$v&&(this.$v=!1,t.K_(e,i))}uv(t){if(null===this.Ki||!this.Ps.handleScale.axisPressedMouseMove.price)return;let e=this.yt.Gv().Qt(),i=this.yt.cv();this.$v=!1,e.K_(i,this.Ki)}hm(t){this.Ps.handleScale.axisDoubleClickReset.price&&this.On()}am(t){null!==this.Ki&&(!this.yt.Gv().Qt().N().handleScale.axisPressedMouseMove.price||this.Ki.He()||this.Ki.Eo()||this.Cm(1))}lv(t){this.Cm(0)}um(){let t=[],e=null===this.Ki?void 0:this.Ki;return(i=>{for(let s=0;s<i.length;++s){let r=i[s].Ks(this.yt.cv(),e);for(let e=0;e<r.length;e++)t.push(r[e])}})(this.yt.cv().Dt()),t}wm({context:t,bitmapSize:e}){let{width:i,height:s}=e,r=this.yt.cv().Qt(),n=r.$(),l=r.Kd();n===l?tC(t,0,0,i,s,n):tP(t,0,0,i,s,n,l)}gm({context:t,bitmapSize:e,horizontalPixelRatio:i}){let s;if(null===this.Uv||null===this.Ki||!this.Ki.N().borderVisible)return;t.fillStyle=this.Ki.N().borderColor;let r=Math.max(1,Math.floor(this.lm().S*i));s=this.Jv?e.width-r:0,t.fillRect(s,0,r,e.height)}bm(t){if(null===this.Uv||null===this.Ki)return;let e=this.Ki.Vl(),i=this.Ki.N(),s=this.lm(),r=this.Jv?this.Uv.width-s.C:0;i.borderVisible&&i.ticksVisible&&t.useBitmapCoordinateSpace(({context:t,horizontalPixelRatio:n,verticalPixelRatio:l})=>{t.fillStyle=i.borderColor;let o=Math.max(1,Math.floor(l)),a=Math.floor(.5*l),h=Math.round(s.C*n);for(let i of(t.beginPath(),e))t.rect(Math.floor(r*n),Math.round(i.Pl*l)-a,h,o);t.fill()}),t.useMediaCoordinateSpace(({context:t})=>{t.font=this._m(),t.fillStyle=i.textColor??this.Co.textColor,t.textAlign=this.Jv?"right":"left",t.textBaseline="middle";let n=this.Jv?Math.round(r-s.V):Math.round(r+s.C+s.V),l=e.map(e=>this.qv.Di(t,e.Jl));for(let i=e.length;i--;){let s=e[i];t.fillText(s.Jl,n,s.Pl+l[i])}})}vm(){if(null===this.Uv||null===this.Ki)return;let t=this.Uv.height/2,e=[],i=this.Ki.Dt().slice(),s=this.yt.cv(),r=this.lm();this.Ki===s.Gn()&&this.yt.cv().Dt().forEach(t=>{s.Zn(t)&&i.push(t)});let n=this.Ki.Sl()[0],l=this.Ki;i.forEach(i=>{let r=i.Ks(s,l);r.forEach(t=>{t.$i()&&null===t.Wi()&&(t.Ui(null),e.push(t))}),n===i&&r.length>0&&(t=r[0].Ei())}),this.Ki.N().alignLabels&&this.ym(e,r,t)}ym(t,e,i){if(null===this.Uv)return;let s=t.filter(t=>t.Ei()<=i),r=t.filter(t=>t.Ei()>i);for(let i of(s.sort((t,e)=>e.Ei()-t.Ei()),s.length&&r.length&&r.push(s[0]),r.sort((t,e)=>t.Ei()-e.Ei()),t)){let t=Math.floor(i.$t(e)/2),s=i.Ei();s>-t&&s<t&&i.Ui(t),s>this.Uv.height-t&&s<this.Uv.height+t&&i.Ui(this.Uv.height-t)}iR(s,1,this.Uv.height,e),iR(r,-1,this.Uv.height,e)}Sm(t){if(null===this.Uv)return;let e=this.um(),i=this.lm(),s=this.Jv?"right":"left";e.forEach(e=>{e.qi()&&e.Tt(tt(this.Ki)).nt(t,i,this.qv,s)})}xm(t){if(null===this.Uv||null===this.Ki)return;let e=this.yt.Gv().Qt(),i=[],s=this.yt.cv(),r=e.gd().Ks(s,this.Ki);r.length&&i.push(r);let n=this.lm(),l=this.Jv?"right":"left";i.forEach(e=>{e.forEach(e=>{e.Tt(tt(this.Ki)).nt(t,n,this.qv,l)})})}Cm(t){this.Jp.style.cursor=1===t?"ns-resize":"default"}do(){let t=this.om();this.Yv<t&&this.yt.Gv().Qt().Ca(),this.Yv=t}_m(){return td(this.Co.fontSize,this.Co.fontFamily)}}function iL(t,e){return t.qa?.(e)??[]}function iI(t,e){return t.Ys?.(e)??[]}function iF(t,e){return t.ds?.(e)??[]}function iz(t,e){return t.Ha?.(e)??[]}class iA{constructor(t,e){this.Uv=W({width:0,height:0}),this.km=null,this.Pm=null,this.Tm=null,this.Rm=null,this.Dm=!1,this.Im=new ti,this.Vm=new ti,this.Bm=0,this.Em=!1,this.Am=null,this.Lm=!1,this.zm=null,this.Om=null,this.Kv=!1,this.Zv=()=>{this.Kv||null===this.Nm||this.ns().dr()},this.Xv=()=>{this.Kv||null===this.Nm||this.ns().dr()},this.Lv=t,this.Nm=e,this.Nm.nu().i(this.Fm.bind(this),this,!0),this.Wm=document.createElement("td"),this.Wm.style.padding="0",this.Wm.style.position="relative";const i=document.createElement("div");i.style.width="100%",i.style.height="100%",i.style.position="relative",i.style.overflow="hidden",this.Hm=document.createElement("td"),this.Hm.style.padding="0",this.Um=document.createElement("td"),this.Um.style.padding="0",this.Wm.appendChild(i),this.sm=iC(i,W({width:16,height:16})),this.sm.subscribeSuggestedBitmapSizeChanged(this.Zv);const s=this.sm.canvasElement;s.style.position="absolute",s.style.zIndex="1",s.style.left="0",s.style.top="0",this.nm=iC(i,W({width:16,height:16})),this.nm.subscribeSuggestedBitmapSizeChanged(this.Xv);const r=this.nm.canvasElement;r.style.position="absolute",r.style.zIndex="2",r.style.left="0",r.style.top="0",this.Xp=document.createElement("tr"),this.Xp.appendChild(this.Hm),this.Xp.appendChild(this.Wm),this.Xp.appendChild(this.Um),this.$m(),this.$p=new ip(this.nm.canvasElement,this,{dp:()=>null===this.Am&&!this.Lv.N().handleScroll.vertTouchDrag,fp:()=>null===this.Am&&!this.Lv.N().handleScroll.horzTouchDrag})}m(){null!==this.km&&this.km.m(),null!==this.Pm&&this.Pm.m(),this.Tm=null,this.nm.unsubscribeSuggestedBitmapSizeChanged(this.Xv),iN(this.nm.canvasElement),this.nm.dispose(),this.sm.unsubscribeSuggestedBitmapSizeChanged(this.Zv),iN(this.sm.canvasElement),this.sm.dispose(),null!==this.Nm&&(this.Nm.nu().u(this),this.Nm.m()),this.$p.m()}cv(){return tt(this.Nm)}qm(t){null!==this.Nm&&this.Nm.nu().u(this),this.Nm=t,null!==this.Nm&&this.Nm.nu().i(iA.prototype.Fm.bind(this),this,!0),this.$m(),this.Lv.Zp().indexOf(this)===this.Lv.Zp().length-1?(this.Tm=this.Tm??new iM(this.Wm,this.Lv),this.Tm.kt()):(this.Tm?.Ov(),this.Tm=null)}Gv(){return this.Lv}iv(){return this.Xp}$m(){if(null!==this.Nm&&(this.jm(),0!==this.ns().tn().length)){if(null!==this.km){let t=this.Nm.U_();this.km.cs(tt(t))}if(null!==this.Pm){let t=this.Nm.q_();this.Pm.cs(tt(t))}}}Ym(){null!==this.km&&this.km.kt(),null!==this.Pm&&this.Pm.kt()}E_(){return null!==this.Nm?this.Nm.E_():0}A_(t){this.Nm&&this.Nm.A_(t)}lp(t){if(!this.Nm)return;this.Km();let e=t.localX,i=t.localY;this.Zm(e,i,t)}Pp(t){this.Km(),this.Gm(),this.Zm(t.localX,t.localY,t)}op(t){if(!this.Nm)return;this.Km();let e=t.localX,i=t.localY;this.Zm(e,i,t)}Sp(t){null!==this.Nm&&(this.Km(),this.Xm(t))}ip(t){null!==this.Nm&&this.Jm(this.Vm,t)}Xf(t){this.ip(t)}mp(t){this.Km(),this.Qm(t),this.Zm(t.localX,t.localY,t)}bp(t){null!==this.Nm&&(this.Km(),this.Em=!1,this.tw(t))}Mp(t){null!==this.Nm&&this.Xm(t)}Op(t){if(this.Em=!0,null===this.Am){let e={x:t.localX,y:t.localY};this.iw(e,e,t)}}zp(t){null!==this.Nm&&(this.Km(),this.Nm.Qt().vd(null),this.sw())}nw(){return this.Im}ew(){return this.Vm}Ip(){this.Bm=1,this.ns().dn()}Vp(t,e){if(!this.Lv.N().handleScale.pinch)return;let i=5*(e-this.Bm);this.Bm=e,this.ns().Td(t._t,i)}yp(t){this.Em=!1,this.Lm=null!==this.Am,this.Gm();let e=this.ns().gd();null!==this.Am&&e.It()&&(this.zm={x:e.si(),y:e.ni()},this.Am={x:t.localX,y:t.localY})}pp(t){if(null===this.Nm)return;let e=t.localX,i=t.localY;if(null===this.Am)this.Qm(t);else{this.Lm=!1;let s=tt(this.zm),r=s.x+(e-this.Am.x),n=s.y+(i-this.Am.y);this.Zm(r,n,t)}}gp(t){0===this.Gv().N().trackingMode.exitMode&&(this.Lm=!0),this.rw(),this.tw(t)}Qn(t,e){let i=this.Nm;return null===i?null:eX(i,t,e)}hw(t,e){tt("left"===e?this.km:this.Pm).dm(W({width:t,height:this.Uv.height}))}sv(){return this.Uv}dm(t){K(this.Uv,t)||(this.Uv=t,this.Kv=!0,this.sm.resizeCanvasElement(t),this.nm.resizeCanvasElement(t),this.Kv=!1,this.Wm.style.width=t.width+"px",this.Wm.style.height=t.height+"px")}aw(){let t=tt(this.Nm);for(let e of(t.H_(t.U_()),t.H_(t.q_()),t.Sl()))if(t.Zn(e)){let i=e.Ft();null!==i&&t.H_(i),e.Ws()}for(let e of t.ru())e.Ws()}nv(){return this.sm.bitmapSize}ev(t,e,i,s){let r=this.nv();if(r.width>0&&r.height>0&&(t.drawImage(this.sm.canvasElement,e,i),s)){let s=this.nm.canvasElement;null!==t&&t.drawImage(s,e,i)}}pm(t){if(0===t||null===this.Nm)return;t>1&&this.aw(),null!==this.km&&this.km.pm(t),null!==this.Pm&&this.Pm.pm(t);let e={colorSpace:this.Lv.N().layout.colorSpace};if(1!==t){this.sm.applySuggestedBitmapSize();let t=q(this.sm,e);null!==t&&(t.useBitmapCoordinateSpace(t=>{this.wm(t)}),this.Nm&&(this.lw(t,iL),this.ow(t),this.lw(t,iI),this.lw(t,iF)))}this.nm.applySuggestedBitmapSize();let i=q(this.nm,e);null!==i&&(i.useBitmapCoordinateSpace(({context:t,bitmapSize:e})=>{t.clearRect(0,0,e.width,e.height)}),this._w(i),this.lw(i,iz),this.lw(i,iF))}uw(){return this.km}cw(){return this.Pm}Mm(t,e){this.lw(t,e)}Fm(){null!==this.Nm&&this.Nm.nu().u(this),this.Nm=null}Xm(t){this.Jm(this.Im,t)}Jm(t,e){let i=e.localX,s=e.localY;t.v()&&t.p(this.ns().Et().wc(i),{x:i,y:s},e)}wm({context:t,bitmapSize:e}){let{width:i,height:s}=e,r=this.ns(),n=r.$(),l=r.Kd();n===l?tC(t,0,0,i,s,l):tP(t,0,0,i,s,n,l)}ow(t){let e=tt(this.Nm),i=e.eu().pr().Tt(e);null!==i&&i.nt(t,!1)}_w(t){this.dw(t,iI,iP,this.ns().gd())}lw(t,e){let i=tt(this.Nm),s=i.Dt(),r=i.ru();for(let i of r)this.dw(t,e,iE,i);for(let i of s)this.dw(t,e,iE,i);for(let i of r)this.dw(t,e,iP,i);for(let i of s)this.dw(t,e,iP,i)}dw(t,e,i,s){let r=tt(this.Nm),n=r.Qt().pd(),l=null!==n&&n.hu===s,o=null!==n&&l&&void 0!==n.au?n.au.ie:void 0;ik(e,e=>i(e,t,l,o),s,r)}jm(){if(null===this.Nm)return;let t=this.Lv,e=this.Nm.U_().N().visible,i=this.Nm.q_().N().visible;e||null===this.km||(this.Hm.removeChild(this.km.iv()),this.km.m(),this.km=null),i||null===this.Pm||(this.Um.removeChild(this.Pm.iv()),this.Pm.m(),this.Pm=null);let s=t.Qt().Nd();e&&null===this.km&&(this.km=new iT(this,t.N(),s,"left"),this.Hm.appendChild(this.km.iv())),i&&null===this.Pm&&(this.Pm=new iT(this,t.N(),s,"right"),this.Um.appendChild(this.Pm.iv()))}fw(t){return t.Np&&this.Em||null!==this.Am}Zm(t,e,i){t=Math.max(0,Math.min(t,this.Uv.width-1)),e=Math.max(0,Math.min(e,this.Uv.height-1)),this.ns().Ad(t,e,i,tt(this.Nm))}sw(){this.ns().zd()}rw(){this.Lm&&(this.Am=null,this.sw())}iw(t,e,i){this.Am=t,this.Lm=!1,this.Zm(e.x,e.y,i);let s=this.ns().gd();this.zm={x:s.si(),y:s.ni()}}ns(){return this.Lv.Qt()}tw(t){if(!this.Dm)return;let e=this.ns(),i=this.cv();if(e.X_(i,i.Rs()),this.Rm=null,this.Dm=!1,e.Vd(),null!==this.Om){let t=performance.now(),i=e.Et();this.Om.fe(i.Cc(),t),this.Om.Ec(t)||e.vn(this.Om)}}Km(){this.Am=null}Gm(){if(this.Nm){if(this.ns().dn(),document.activeElement!==document.body&&document.activeElement!==document.documentElement)tt(document.activeElement).blur();else{let t=document.getSelection();null!==t&&t.removeAllRanges()}this.Nm.Rs().Gi()||this.ns().Et().Gi()}}Qm(t){if(null===this.Nm)return;let e=this.ns(),i=e.Et();if(i.Gi())return;let s=this.Lv.N(),r=s.handleScroll,n=s.kineticScroll;if((!r.pressedMouseMove||t.Np)&&(!r.horzTouchDrag&&!r.vertTouchDrag||!t.Np))return;let l=this.Nm.Rs(),o=performance.now();if(null!==this.Rm||this.fw(t)||(this.Rm={x:t.clientX,y:t.clientY,cf:o,pw:t.localX,mw:t.localY}),null!==this.Rm&&!this.Dm&&(this.Rm.x!==t.clientX||this.Rm.y!==t.clientY)){if(t.Np&&n.touch||!t.Np&&n.mouse){let t=i.ul();this.Om=new ij(.2/t,7/t,.997,15/t),this.Om.Dv(i.Cc(),this.Rm.cf)}else this.Om=null;l.Gi()||e.Z_(this.Nm,l,t.localY),e.Dd(t.localX),this.Dm=!0}this.Dm&&(l.Gi()||e.G_(this.Nm,l,t.localY),e.Id(t.localX),null!==this.Om&&this.Om.Dv(i.Cc(),o))}}class iD{constructor(t,e,i,s,r){this.xt=!0,this.Uv=W({width:0,height:0}),this.Zv=()=>this.pm(3),this.Jv="left"===t,this.hd=i.Nd,this.Ps=e,this.ww=s,this.gw=r,this.Jp=document.createElement("div"),this.Jp.style.width="25px",this.Jp.style.height="100%",this.Jp.style.overflow="hidden",this.sm=iC(this.Jp,W({width:16,height:16})),this.sm.subscribeSuggestedBitmapSizeChanged(this.Zv)}m(){this.sm.unsubscribeSuggestedBitmapSizeChanged(this.Zv),iN(this.sm.canvasElement),this.sm.dispose()}iv(){return this.Jp}sv(){return this.Uv}dm(t){K(this.Uv,t)||(this.Uv=t,this.sm.resizeCanvasElement(t),this.Jp.style.width=`${t.width}px`,this.Jp.style.height=`${t.height}px`,this.xt=!0)}pm(t){if(t<3&&!this.xt||0===this.Uv.width||0===this.Uv.height)return;this.xt=!1,this.sm.applySuggestedBitmapSize();let e=q(this.sm,{colorSpace:this.Ps.layout.colorSpace});null!==e&&e.useBitmapCoordinateSpace(t=>{this.wm(t),this.gm(t)})}nv(){return this.sm.bitmapSize}ev(t,e,i){let s=this.nv();s.width>0&&s.height>0&&t.drawImage(this.sm.canvasElement,e,i)}gm({context:t,bitmapSize:e,horizontalPixelRatio:i,verticalPixelRatio:s}){if(!this.ww())return;t.fillStyle=this.Ps.timeScale.borderColor;let r=Math.floor(this.hd.N().S*i),n=Math.floor(this.hd.N().S*s),l=this.Jv?e.width-r:0;t.fillRect(l,0,r,n)}wm({context:t,bitmapSize:e}){tC(t,0,0,e.width,e.height,this.gw())}}function iO(t){return e=>e.Ka?.(t)??[]}let iB=iO("normal"),i$=iO("top"),iW=iO("bottom");class iK{constructor(t,e){this.Mw=null,this.bw=null,this.M=null,this.Sw=!1,this.Uv=W({width:0,height:0}),this.xw=new ti,this.qv=new tU(5),this.Kv=!1,this.Zv=()=>{this.Kv||this.Lv.Qt().dr()},this.Xv=()=>{this.Kv||this.Lv.Qt().dr()},this.Lv=t,this.cu=e,this.Ps=t.N().layout,this.Vv=document.createElement("tr"),this.Cw=document.createElement("td"),this.Cw.style.padding="0",this.yw=document.createElement("td"),this.yw.style.padding="0",this.Jp=document.createElement("td"),this.Jp.style.height="25px",this.Jp.style.padding="0",this.kw=document.createElement("div"),this.kw.style.width="100%",this.kw.style.height="100%",this.kw.style.position="relative",this.kw.style.overflow="hidden",this.Jp.appendChild(this.kw),this.sm=iC(this.kw,W({width:16,height:16})),this.sm.subscribeSuggestedBitmapSizeChanged(this.Zv);const i=this.sm.canvasElement;i.style.position="absolute",i.style.zIndex="1",i.style.left="0",i.style.top="0",this.nm=iC(this.kw,W({width:16,height:16})),this.nm.subscribeSuggestedBitmapSizeChanged(this.Xv);const s=this.nm.canvasElement;s.style.position="absolute",s.style.zIndex="2",s.style.left="0",s.style.top="0",this.Vv.appendChild(this.Cw),this.Vv.appendChild(this.Jp),this.Vv.appendChild(this.yw),this.Pw(),this.Lv.Qt().B_().i(this.Pw.bind(this),this),this.$p=new ip(this.nm.canvasElement,this,{dp:()=>!0,fp:()=>!this.Lv.N().handleScroll.horzTouchDrag})}m(){this.$p.m(),null!==this.Mw&&this.Mw.m(),null!==this.bw&&this.bw.m(),this.nm.unsubscribeSuggestedBitmapSizeChanged(this.Xv),iN(this.nm.canvasElement),this.nm.dispose(),this.sm.unsubscribeSuggestedBitmapSizeChanged(this.Zv),iN(this.sm.canvasElement),this.sm.dispose()}iv(){return this.Vv}Tw(){return this.Mw}Rw(){return this.bw}Pp(t){if(this.Sw)return;this.Sw=!0;let e=this.Lv.Qt();!e.Et().Gi()&&this.Lv.N().handleScale.axisPressedMouseMove.time&&e.Pd(t.localX)}yp(t){this.Pp(t)}Tp(){let t=this.Lv.Qt();!t.Et().Gi()&&this.Sw&&(this.Sw=!1,this.Lv.N().handleScale.axisPressedMouseMove.time&&t.Ed())}mp(t){let e=this.Lv.Qt();!e.Et().Gi()&&this.Lv.N().handleScale.axisPressedMouseMove.time&&e.Bd(t.localX)}pp(t){this.mp(t)}bp(){this.Sw=!1;let t=this.Lv.Qt();t.Et().Gi()&&!this.Lv.N().handleScale.axisPressedMouseMove.time||t.Ed()}gp(){this.bp()}ip(){this.Lv.N().handleScale.axisDoubleClickReset.time&&this.Lv.Qt().wn()}Xf(){this.ip()}lp(){this.Lv.Qt().N().handleScale.axisPressedMouseMove.time&&this.Cm(1)}zp(){this.Cm(0)}sv(){return this.Uv}Dw(){return this.xw}Iw(t,e,i){K(this.Uv,t)||(this.Uv=t,this.Kv=!0,this.sm.resizeCanvasElement(t),this.nm.resizeCanvasElement(t),this.Kv=!1,this.Jp.style.width=`${t.width}px`,this.Jp.style.height=`${t.height}px`,this.xw.p(t)),null!==this.Mw&&this.Mw.dm(W({width:e,height:t.height})),null!==this.bw&&this.bw.dm(W({width:i,height:t.height}))}Vw(){let t=this.Bw();return Math.ceil(t.S+t.C+t.k+t.A+t.I+t.Ew)}kt(){this.Lv.Qt().Et().Vl()}nv(){return this.sm.bitmapSize}ev(t,e,i,s){let r=this.nv();if(r.width>0&&r.height>0&&(t.drawImage(this.sm.canvasElement,e,i),s)){let s=this.nm.canvasElement;t.drawImage(s,e,i)}}pm(t){if(0===t)return;let e={colorSpace:this.Ps.colorSpace};if(1!==t){this.sm.applySuggestedBitmapSize();let i=q(this.sm,e);null!==i&&(i.useBitmapCoordinateSpace(t=>{this.wm(t),this.gm(t),this.Aw(i,iW)}),this.bm(i),this.Aw(i,iB)),null!==this.Mw&&this.Mw.pm(t),null!==this.bw&&this.bw.pm(t)}this.nm.applySuggestedBitmapSize();let i=q(this.nm,e);null!==i&&(i.useBitmapCoordinateSpace(({context:t,bitmapSize:e})=>{t.clearRect(0,0,e.width,e.height)}),this.Lw([...this.Lv.Qt().tn(),this.Lv.Qt().gd()],i),this.Aw(i,i$))}Aw(t,e){let i=this.Lv.Qt().tn();for(let s of i)ik(e,e=>iE(e,t,!1,void 0),s,void 0);for(let s of i)ik(e,e=>iP(e,t,!1,void 0),s,void 0)}wm({context:t,bitmapSize:e}){tC(t,0,0,e.width,e.height,this.Lv.Qt().Kd())}gm({context:t,bitmapSize:e,verticalPixelRatio:i}){if(this.Lv.N().timeScale.borderVisible){t.fillStyle=this.zw();let s=Math.max(1,Math.floor(this.Bw().S*i));t.fillRect(0,0,e.width,s)}}bm(t){let e=this.Lv.Qt().Et(),i=e.Vl();if(!i||0===i.length)return;let s=this.cu.maxTickMarkWeight(i),r=this.Bw(),n=e.N();n.borderVisible&&n.ticksVisible&&t.useBitmapCoordinateSpace(({context:t,horizontalPixelRatio:e,verticalPixelRatio:s})=>{t.strokeStyle=this.zw(),t.fillStyle=this.zw();let n=Math.max(1,Math.floor(e)),l=Math.floor(.5*e);t.beginPath();let o=Math.round(r.C*s);for(let s=i.length;s--;){let r=Math.round(i[s].coord*e);t.rect(r-l,0,n,o)}t.fill()}),t.useMediaCoordinateSpace(({context:t})=>{let e=r.S+r.C+r.A+r.k/2;for(let r of(t.textAlign="center",t.textBaseline="middle",t.fillStyle=this.H(),t.font=this._m(),i))if(r.weight<s){let i=r.needAlignCoordinate?this.Ow(t,r.coord,r.label):r.coord;t.fillText(r.label,i,e)}for(let r of(this.Lv.N().timeScale.allowBoldLabels&&(t.font=this.Nw()),i))if(r.weight>=s){let i=r.needAlignCoordinate?this.Ow(t,r.coord,r.label):r.coord;t.fillText(r.label,i,e)}})}Ow(t,e,i){let s=this.qv.Ii(t,i),r=Math.floor(e-s/2)+.5;return r<0?e+=Math.abs(0-r):r+s>this.Uv.width&&(e-=Math.abs(this.Uv.width-(r+s))),e}Lw(t,e){let i=this.Bw();for(let s of t)for(let t of s.fs())t.Tt().nt(e,i)}zw(){return this.Lv.N().timeScale.borderColor}H(){return this.Ps.textColor}F(){return this.Ps.fontSize}_m(){return td(this.F(),this.Ps.fontFamily)}Nw(){return td(this.F(),this.Ps.fontFamily,"bold")}Bw(){null===this.M&&(this.M={S:1,L:NaN,A:NaN,I:NaN,ts:NaN,C:5,k:NaN,P:"",Qi:new tU,Ew:0});let t=this.M,e=this._m();if(t.P!==e){let i=this.F();t.k=i,t.P=e,t.A=3*i/12,t.I=3*i/12,t.ts=9*i/12,t.L=0,t.Ew=4*i/12,t.Qi.On()}return this.M}Cm(t){this.Jp.style.cursor=1===t?"ew-resize":"default"}Pw(){let t=this.Lv.Qt(),e=t.N();e.leftPriceScale.visible||null===this.Mw||(this.Cw.removeChild(this.Mw.iv()),this.Mw.m(),this.Mw=null),e.rightPriceScale.visible||null===this.bw||(this.yw.removeChild(this.bw.iv()),this.bw.m(),this.bw=null);let i={Nd:this.Lv.Qt().Nd()},s=()=>e.leftPriceScale.borderVisible&&t.Et().N().borderVisible,r=()=>t.Kd();e.leftPriceScale.visible&&null===this.Mw&&(this.Mw=new iD("left",e,i,s,r),this.Cw.appendChild(this.Mw.iv())),e.rightPriceScale.visible&&null===this.bw&&(this.bw=new iD("right",e,i,s,r),this.yw.appendChild(this.bw.iv()))}}let iV=!!ic&&!!navigator.userAgentData&&navigator.userAgentData.brands.some(t=>t.brand.includes("Chromium"))&&!!ic&&(navigator?.userAgentData?.platform?"Windows"===navigator.userAgentData.platform:navigator.userAgent.toLowerCase().indexOf("win")>=0);class iU{constructor(t,e,i){var s;this.Fw=[],this.Ww=[],this.Hw=0,this.eo=0,this.S_=0,this.Uw=0,this.$w=0,this.qw=null,this.jw=!1,this.Im=new ti,this.Vm=new ti,this.nd=new ti,this.Yw=null,this.Kw=null,this.Av=t,this.Ps=e,this.cu=i,this.Vv=document.createElement("div"),this.Vv.classList.add("tv-lightweight-charts"),this.Vv.style.overflow="hidden",this.Vv.style.direction="ltr",this.Vv.style.width="100%",this.Vv.style.height="100%",(s=this.Vv).style.userSelect="none",s.style.webkitUserSelect="none",s.style.msUserSelect="none",s.style.MozUserSelect="none",s.style.webkitTapHighlightColor="transparent",this.Zw=document.createElement("table"),this.Zw.setAttribute("cellspacing","0"),this.Vv.appendChild(this.Zw),this.Gw=this.Xw.bind(this),iH(this.Ps)&&this.Jw(!0),this.ns=new e5(this.rd.bind(this),this.Ps,i),this.Qt().Md().i(this.Qw.bind(this),this),this.tg=new iK(this,this.cu),this.Zw.appendChild(this.tg.iv());const r=e.autoSize&&this.ig();let n=this.Ps.width,l=this.Ps.height;if(r||0===n||0===l){const e=t.getBoundingClientRect();n=n||e.width,l=l||e.height}this.sg(n,l),this.ng(),t.appendChild(this.Vv),this.eg(),this.ns.Et().Oc().i(this.ns.Ca.bind(this.ns),this),this.ns.B_().i(this.ns.Ca.bind(this.ns),this)}Qt(){return this.ns}N(){return this.Ps}Zp(){return this.Fw}rg(){return this.tg}m(){for(let t of(this.Jw(!1),0!==this.Hw&&window.cancelAnimationFrame(this.Hw),this.ns.Md().u(this),this.ns.Et().Oc().u(this),this.ns.B_().u(this),this.ns.m(),this.Fw))this.Zw.removeChild(t.iv()),t.nw().u(this),t.ew().u(this),t.m();for(let t of(this.Fw=[],this.Ww))this.hg(t);this.Ww=[],tt(this.tg).m(),null!==this.Vv.parentElement&&this.Vv.parentElement.removeChild(this.Vv),this.nd.m(),this.Im.m(),this.Vm.m(),this.ag()}sg(t,e,i=!1){var s;let r,n;if(this.eo===e&&this.S_===t)return;let l=(r=Math.floor((s=W({width:t,height:e})).width),W({width:r-r%2,height:(n=Math.floor(s.height))-n%2}));this.eo=l.height,this.S_=l.width;let o=this.eo+"px",a=this.S_+"px";tt(this.Vv).style.height=o,tt(this.Vv).style.width=a,this.Zw.style.height=o,this.Zw.style.width=a,i?this.lg(tD.yn(),performance.now()):this.ns.Ca()}pm(t){void 0===t&&(t=tD.yn());for(let e=0;e<this.Fw.length;e++)this.Fw[e].pm(t.un(e).an);this.Ps.timeScale.visible&&this.tg.pm(t._n())}cr(t){let e=iH(this.Ps);this.ns.cr(t);let i=iH(this.Ps);i!==e&&this.Jw(i),t.layout?.panes&&this.og(),this.eg(),this._g(t)}nw(){return this.Im}ew(){return this.Vm}Md(){return this.nd}ug(t=!1){null!==this.qw&&(this.lg(this.qw,performance.now()),this.qw=null);let e=this.cg(null),i=document.createElement("canvas");i.width=e.width,i.height=e.height;let s=tt(i.getContext("2d"));return this.cg(s,t),i}dg(t){return("left"!==t||this.fg())&&("right"!==t||this.pg())&&0!==this.Fw.length?tt("left"===t?this.Fw[0].uw():this.Fw[0].cw()).fm():0}vg(){return this.Ps.autoSize&&null!==this.Yw}hv(){return this.Vv}mg(t){this.Kw=t,this.Kw?this.hv().style.setProperty("cursor",t):this.hv().style.removeProperty("cursor")}wg(){return this.Kw}gg(t){return Z(this.Fw[t]).sv()}og(){this.Ww.forEach(t=>{t.kt()})}_g(t){(void 0!==t.autoSize||!this.Yw||void 0===t.width&&void 0===t.height)&&(t.autoSize&&!this.Yw&&this.ig(),!1===t.autoSize&&null!==this.Yw&&this.ag(),t.autoSize||void 0===t.width&&void 0===t.height||this.sg(t.width||this.S_,t.height||this.eo))}cg(t,e){let i=0,s=0,r=this.Fw[0],n=(i,s)=>{let r=0;for(let n=0;n<this.Fw.length;n++){let l=this.Fw[n],o=tt("left"===i?l.uw():l.cw()),a=o.nv();if(null!==t&&o.ev(t,s,r,e),r+=a.height,n<this.Fw.length-1){let e=this.Ww[n],i=e.nv();null!==t&&e.ev(t,s,r),r+=i.height}}};this.fg()&&(n("left",0),i+=tt(r.uw()).nv().width);for(let r=0;r<this.Fw.length;r++){let n=this.Fw[r],l=n.nv();if(null!==t&&n.ev(t,i,s,e),s+=l.height,r<this.Fw.length-1){let e=this.Ww[r],n=e.nv();null!==t&&e.ev(t,i,s),s+=n.height}}i+=r.nv().width,this.pg()&&(n("right",i),i+=tt(r.cw()).nv().width);let l=(e,i,s)=>{tt("left"===e?this.tg.Tw():this.tg.Rw()).ev(tt(t),i,s)};if(this.Ps.timeScale.visible){let i=this.tg.nv();if(null!==t){let n=0;this.fg()&&(l("left",n,s),n=tt(r.uw()).nv().width),this.tg.ev(t,n,s,e),n+=i.width,this.pg()&&l("right",n,s)}s+=i.height}return W({width:i,height:s})}Mg(){var t,e,i;let s=0,r=0,n=0;for(let t of this.Fw)this.fg()&&(r=Math.max(r,tt(t.uw()).om(),this.Ps.leftPriceScale.minimumWidth)),this.pg()&&(n=Math.max(n,tt(t.cw()).om(),this.Ps.rightPriceScale.minimumWidth)),s+=t.E_();r=(e=r)+e%2,n=(i=n)+i%2;let l=this.S_,o=this.eo,a=Math.max(l-r-n,0),h=+this.Ww.length,u=this.Ps.timeScale.visible,c=u?Math.max(this.tg.Vw(),this.Ps.timeScale.minimumHeight):0,d=h+(c=(t=c)+t%2),m=o<d?0:o-d,p=m/s,f=0,g=window.devicePixelRatio||1;for(let t=0;t<this.Fw.length;++t){let e=this.Fw[t];e.qm(this.ns.Xs()[t]);let i=0;i=Math.max(t===this.Fw.length-1?Math.ceil((m-f)*g)/g:Math.round(e.E_()*p*g)/g,2),f+=i,e.dm(W({width:a,height:i})),this.fg()&&e.hw(r,"left"),this.pg()&&e.hw(n,"right"),e.cv()&&this.ns.bd(e.cv(),i)}this.tg.Iw(W({width:u?a:0,height:c}),u?r:0,u?n:0),this.ns.L_(a),this.Uw!==r&&(this.Uw=r),this.$w!==n&&(this.$w=n)}Jw(t){t?this.Vv.addEventListener("wheel",this.Gw,{passive:!1}):this.Vv.removeEventListener("wheel",this.Gw)}bg(t){switch(t.deltaMode){case t.DOM_DELTA_PAGE:return 120;case t.DOM_DELTA_LINE:return 32}return iV?1/window.devicePixelRatio:1}Xw(t){if(!(0!==t.deltaX&&this.Ps.handleScroll.mouseWheel||0!==t.deltaY&&this.Ps.handleScale.mouseWheel))return;let e=this.bg(t),i=e*t.deltaX/100,s=-e*t.deltaY/100;if(t.cancelable&&t.preventDefault(),0!==s&&this.Ps.handleScale.mouseWheel){let e=Math.sign(s)*Math.min(1,Math.abs(s)),i=t.clientX-this.Vv.getBoundingClientRect().left;this.Qt().Td(i,e)}0!==i&&this.Ps.handleScroll.mouseWheel&&this.Qt().Rd(-80*i)}lg(t,e){let i=t._n();3===i&&this.Sg(),3!==i&&2!==i||(this.xg(t),this.Cg(t,e),this.tg.kt(),this.Fw.forEach(t=>{t.Ym()}),3===this.qw?._n()&&(this.qw.Sn(t),this.Sg(),this.xg(this.qw),this.Cg(this.qw,e),t=this.qw,this.qw=null)),this.pm(t)}Cg(t,e){for(let i of t.bn())this.xn(i,e)}xg(t){let e=this.ns.Xs();for(let i=0;i<e.length;i++)t.un(i).ln&&e[i].tu()}xn(t,e){let i=this.ns.Et();switch(t.fn){case 0:i.Fc();break;case 1:i.Wc(t.Wt);break;case 2:i.gn(t.Wt);break;case 3:i.Mn(t.Wt);break;case 4:i.Pc();break;case 5:t.Wt.Ec(e)||i.Mn(t.Wt.Ac(e))}}rd(t){null!==this.qw?this.qw.Sn(t):this.qw=t,this.jw||(this.jw=!0,this.Hw=window.requestAnimationFrame(t=>{if(this.jw=!1,this.Hw=0,null!==this.qw){let e=this.qw;for(let i of(this.qw=null,this.lg(e,t),e.bn()))if(5===i.fn&&!i.Wt.Ec(t)){this.Qt().vn(i.Wt);break}}}))}Sg(){this.ng()}hg(t){this.Zw.removeChild(t.iv()),t.m()}ng(){let t=this.ns.Xs(),e=t.length,i=this.Fw.length;for(let t=e;t<i;t++){let t=Z(this.Fw.pop());this.Zw.removeChild(t.iv()),t.nw().u(this),t.ew().u(this),t.m();let e=this.Ww.pop();void 0!==e&&this.hg(e)}for(let s=i;s<e;s++){let e=new iA(this,t[s]);if(e.nw().i(this.yg.bind(this,e),this),e.ew().i(this.kg.bind(this,e),this),this.Fw.push(e),s>0){let t=new ib(this,s-1,s);this.Ww.push(t),this.Zw.insertBefore(t.iv(),this.tg.iv())}this.Zw.insertBefore(e.iv(),this.tg.iv())}for(let i=0;i<e;i++){let e=t[i],s=this.Fw[i];s.cv()!==e?s.qm(e):s.$m()}this.eg(),this.Mg()}Pg(t,e,i,s){let r,n=new Map;if(null!==t&&this.ns.tn().forEach(e=>{let i=e.qs().$s(t);null!==i&&n.set(e,i)}),null!==t){let e=this.ns.Et().es(t)?.originalTime;void 0!==e&&(r=e)}let l=this.Qt().pd(),o=null!==l&&l.hu instanceof eM?l.hu:void 0,a=null!==l&&void 0!==l.au?l.au.te:void 0,h=this.Tg(s);return{Gr:r,js:t??void 0,Rg:e??void 0,Dg:-1!==h?h:void 0,Ig:o,Vg:n,Bg:a,Eg:i??void 0}}Tg(t){let e=-1;if(t)e=this.Fw.indexOf(t);else{let t=this.Qt().gd().Gs();null!==t&&(e=this.Qt().Xs().indexOf(t))}return e}yg(t,e,i,s){this.Im.p(()=>this.Pg(e,i,s,t))}kg(t,e,i,s){this.Vm.p(()=>this.Pg(e,i,s,t))}Qw(t,e,i){this.mg(this.Qt().pd()?.ou??null),this.nd.p(()=>this.Pg(t,e,i))}eg(){let t=this.Ps.timeScale.visible?"":"none";this.tg.iv().style.display=t}fg(){return this.Fw[0].cv().U_().N().visible}pg(){return this.Fw[0].cv().q_().N().visible}ig(){return"ResizeObserver"in window&&(this.Yw=new ResizeObserver(t=>{let e=t[t.length-1];e&&this.sg(e.contentRect.width,e.contentRect.height)}),this.Yw.observe(this.Av,{box:"border-box"}),!0)}ag(){null!==this.Yw&&this.Yw.disconnect(),this.Yw=null}}function iH(t){return!!(t.handleScroll.mouseWheel||t.handleScale.mouseWheel)}function iJ(t,e,i,s){let r=i.value,n={js:e,wt:t,Wt:[r,r,r,r],Gr:s};return void 0!==i.color&&(n.R=i.color),n}function iq(t,e,i,s){let r=i.value,n={js:e,wt:t,Wt:[r,r,r,r],Gr:s};return void 0!==i.lineColor&&(n.vt=i.lineColor),void 0!==i.topColor&&(n.eh=i.topColor),void 0!==i.bottomColor&&(n.rh=i.bottomColor),n}function iY(t,e,i,s){let r=i.value,n={js:e,wt:t,Wt:[r,r,r,r],Gr:s};return void 0!==i.topLineColor&&(n.hh=i.topLineColor),void 0!==i.bottomLineColor&&(n.ah=i.bottomLineColor),void 0!==i.topFillColor1&&(n.oh=i.topFillColor1),void 0!==i.topFillColor2&&(n._h=i.topFillColor2),void 0!==i.bottomFillColor1&&(n.uh=i.bottomFillColor1),void 0!==i.bottomFillColor2&&(n.dh=i.bottomFillColor2),n}function iX(t,e,i,s){let r={js:e,wt:t,Wt:[i.open,i.high,i.low,i.close],Gr:s};return void 0!==i.color&&(r.R=i.color),r}function iG(t,e,i,s){let r={js:e,wt:t,Wt:[i.open,i.high,i.low,i.close],Gr:s};return void 0!==i.color&&(r.R=i.color),void 0!==i.borderColor&&(r.Ht=i.borderColor),void 0!==i.wickColor&&(r.nh=i.wickColor),r}function iQ(t,e,i,s,r){let n=Z(r)(i),l=Math.max(...n),o=Math.min(...n),a=n[n.length-1],{time:h,color:u,...c}=i;return{js:e,wt:t,Wt:[a,l,o,a],Gr:s,le:c,R:u}}function iZ(t){return void 0!==t.Wt}function i0(t,e){return void 0!==e.customValues&&(t.Ag=e.customValues),t}function i1(t){return(e,i,s,r,n,l)=>(l?l(s):void 0===s.open&&void 0===s.value)?i0({wt:e,js:i,Gr:r},s):i0(t(e,i,s,r,n),s)}function i2(t){return({Candlestick:i1(iG),Bar:i1(iX),Area:i1(iq),Baseline:i1(iY),Histogram:i1(iJ),Line:i1(iJ),Custom:i1(iQ)})[t]}function i3(t){return{js:0,Lg:new Map,Ea:t}}function i5(t,e){if(void 0!==t&&0!==t.length)return{zg:e.key(t[0].wt),Og:e.key(t[t.length-1].wt)}}function i4(t){let e;return t.forEach(t=>{void 0===e&&(e=t.Gr)}),Z(e)}class i6{constructor(t){this.Ng=new Map,this.Fg=new Map,this.Wg=new Map,this.Hg=[],this.cu=t}m(){this.Ng.clear(),this.Fg.clear(),this.Wg.clear(),this.Hg=[]}Ug(t,e){let i=0!==this.Ng.size,s=!1,r=this.Fg.get(t);if(void 0!==r)if(1===this.Fg.size)i=!1,s=!0,this.Ng.clear();else for(let e of this.Hg)e.pointData.Lg.delete(t)&&(s=!0);let n=[];if(0!==e.length){let i=e.map(t=>t.time),r=this.cu.createConverterToInternalObj(e),l=i2(t.wh()),o=t.rl(),a=t.hl();n=e.map((e,n)=>{let h=r(e.time),u=this.cu.key(h),c=this.Ng.get(u);void 0===c&&(c=i3(h),this.Ng.set(u,c),s=!0);let d=l(h,c.js,e,i[n],o,a);return c.Lg.set(t,d),d})}i&&this.$g(),this.qg(t,n);let l=-1;if(s){let t=[];this.Ng.forEach(e=>{t.push({timeWeight:0,time:e.Ea,pointData:e,originalTime:i4(e.Lg)})}),t.sort((t,e)=>this.cu.key(t.time)-this.cu.key(e.time)),l=this.jg(t)}return this.Yg(t,l,function(t,e,i){let s=i5(t,i),r=i5(e,i);if(void 0!==s&&void 0!==r)return{Kg:!1,Ta:s.Og>=r.Og&&s.zg>=r.zg}}(this.Fg.get(t),r,this.cu))}Hd(t){return this.Ug(t,[])}Zg(t,e,i){if(i&&t.La())throw Error("Historical updates are not supported when conflation is enabled. Conflation requires data to be processed in order.");void 0===e.Gr&&(e.Gr=e.time),this.cu.preprocessData(e);let s=this.cu.createConverterToInternalObj([e])(e.time),r=this.Wg.get(t);if(!i&&void 0!==r&&this.cu.key(s)<this.cu.key(r))throw Error(`Cannot update oldest data, last time=${r}, new time=${s}`);let n=this.Ng.get(this.cu.key(s));if(i&&void 0===n)throw Error("Cannot update non-existing data point when historicalUpdate is true");let l=void 0===n;void 0===n&&(n=i3(s),this.Ng.set(this.cu.key(s),n));let o=i2(t.wh()),a=t.rl(),h=t.hl(),u=o(s,n.js,e,e.Gr,a,h),c=!i&&!l&&void 0!==r&&this.cu.key(s)===this.cu.key(r);n.Lg.set(t,u),i?this.Gg(t,u,n.js):(c&&t.La()&&iZ(u)&&t.kr(u),this.Xg(t,u));let d={Ta:iZ(u),Kg:i};if(!l)return this.Yg(t,-1,d);let m={timeWeight:0,time:n.Ea,pointData:n,originalTime:i4(n.Lg)},p=er(this.Hg,this.cu.key(m.time),(t,e)=>this.cu.key(t.time)<e);this.Hg.splice(p,0,m);for(let t=p;t<this.Hg.length;++t)i9(this.Hg[t].pointData,t);return this.cu.fillWeightsForPoints(this.Hg,p),this.Yg(t,p,d)}Jg(t,e){let i=this.Fg.get(t);if(void 0===i||e<=0)return[[],this.Qg()];e=Math.min(e,i.length);let s=i.splice(-e).reverse();for(let e of(0===i.length?this.Wg.delete(t):this.Wg.set(t,i[i.length-1].wt),s)){let i=this.Ng.get(this.cu.key(e.wt));if(i&&(i.Lg.delete(t),0===i.Lg.size)){this.Ng.delete(this.cu.key(i.Ea)),this.Hg.splice(i.js,1);for(let t=i.js;t<this.Hg.length;++t)i9(this.Hg[t].pointData,t)}}return[s,this.Yg(t,this.Hg.length-1,{Kg:!1,Ta:!1})]}Xg(t,e){let i=this.Fg.get(t);void 0===i&&(i=[],this.Fg.set(t,i));let s=0!==i.length?i[i.length-1]:null;null===s||this.cu.key(e.wt)>this.cu.key(s.wt)?iZ(e)&&i.push(e):iZ(e)?i[i.length-1]=e:i.splice(-1,1),this.Wg.set(t,e.wt)}Gg(t,e,i){let s=this.Fg.get(t);if(void 0===s)return;let r=er(s,i,(t,e)=>t.js<e);iZ(e)?s[r]=e:s.splice(r,1)}qg(t,e){0!==e.length?(this.Fg.set(t,e.filter(iZ)),this.Wg.set(t,e[e.length-1].wt)):(this.Fg.delete(t),this.Wg.delete(t))}$g(){for(let t of this.Hg)0===t.pointData.Lg.size&&this.Ng.delete(this.cu.key(t.time))}jg(t){let e=-1;for(let i=0;i<this.Hg.length&&i<t.length;++i){let s=this.Hg[i],r=t[i];if(this.cu.key(s.time)!==this.cu.key(r.time)){e=i;break}r.timeWeight=s.timeWeight,i9(r.pointData,i)}if(-1===e&&this.Hg.length!==t.length&&(e=Math.min(this.Hg.length,t.length)),-1===e)return -1;for(let i=e;i<t.length;++i)i9(t[i].pointData,i);return this.cu.fillWeightsForPoints(t,e),this.Hg=t,e}tM(){if(0===this.Fg.size)return null;let t=0;return this.Fg.forEach(e=>{0!==e.length&&(t=Math.max(t,e[e.length-1].js))}),t}Yg(t,e,i){let s=this.Qg();if(-1!==e)this.Fg.forEach((e,r)=>{s.F_.set(r,{le:e,iM:r===t?i:void 0})}),this.Fg.has(t)||s.F_.set(t,{le:[],iM:i}),s.Et.sM=this.Hg,s.Et.nM=e;else{let e=this.Fg.get(t);s.F_.set(t,{le:e||[],iM:i})}return s}Qg(){return{F_:new Map,Et:{vc:this.tM()}}}}function i9(t,e){t.js=e,t.Lg.forEach(t=>{t.js=e})}function i7(t,e){return t.wt<e}function i8(t,e){return e<t.wt}function st(t,e,i){let s=e.Aa(),r=e.bi(),n=er(t,s,i7),l=en(t,r,i8);if(!i)return{from:n,to:l};let o=n,a=l;return n>0&&n<t.length&&t[n].wt>=s&&(o=n-1),l>0&&l<t.length&&t[l-1].wt<=r&&(a=l+1),{from:o,to:a}}class se{constructor(t,e,i){this.eM=!0,this.rM=!0,this.hM=!0,this.aM=[],this.lM=null,this.oM=-1,this.ee=t,this.re=e,this._M=i}kt(t){this.eM=!0,"data"===t&&(this.rM=!0),"options"===t&&(this.hM=!0)}Tt(){return this.ee.It()?(this.uM(),null===this.lM?null:this.cM):null}dM(){this.aM=this.aM.map(t=>({...t,...this.ee.ga().gh(t.wt)}))}fM(){this.lM=null}uM(){let t=this.re.Et(),e=t.N().enableConflation?t.Hc():0;e!==this.oM&&(this.rM=!0,this.oM=e),this.rM&&(this.pM(),this.rM=!1),this.hM&&(this.dM(),this.hM=!1),this.eM&&(this.vM(),this.eM=!1)}vM(){let t=this.ee.Ft(),e=this.re.Et();if(this.fM(),e.Gi()||t.Gi())return;let i=e.Ie();if(null===i||0===this.ee.qs().yh())return;let s=this.ee.Lt();null!==s&&(this.lM=st(this.aM,i,this._M),this.mM(t,e,s.Wt),this.wM())}}class si{constructor(t,e){this.gM=t,this.Ki=e}nt(t,e,i){this.gM.draw(t,this.Ki,e,i)}}class ss extends se{constructor(t,e,i){super(t,e,!1),this.$h=i,this.cM=new si(this.$h.renderer(),e=>{let i=t.Lt();return null===i?null:t.Ft().Nt(e,i.Wt)})}get ma(){return this.$h.conflationReducer}Oa(t){return this.$h.priceValueBuilder(t)}al(t){return this.$h.isWhitespace(t)}pM(){let t=this.ee.ga();this.aM=this.ee.Na().Dh().map(e=>({wt:e.js,_t:NaN,...t.gh(e.js),MM:e.le}))}mM(t,e){e.mc(this.aM,tu(this.lM))}wM(){this.$h.update({bars:this.aM.map(sr),barSpacing:this.re.Et().ul(),visibleRange:this.lM,conflationFactor:this.re.Et().Hc()},this.ee.N())}}function sr(t){return{x:t._t,time:t.wt,originalData:t.MM,barColor:t.th}}let sn={color:"#2196f3"},sl=(t,e,i)=>new ss(t,e,te(i));function so(t){let e={value:t.Wt[3],time:t.Gr};return void 0!==t.Ag&&(e.customValues=t.Ag),e}function sa(t){let e=so(t);return void 0!==t.R&&(e.color=t.R),e}function sh(t){let e=so(t);return void 0!==t.vt&&(e.lineColor=t.vt),void 0!==t.eh&&(e.topColor=t.eh),void 0!==t.rh&&(e.bottomColor=t.rh),e}function su(t){let e=so(t);return void 0!==t.hh&&(e.topLineColor=t.hh),void 0!==t.ah&&(e.bottomLineColor=t.ah),void 0!==t.oh&&(e.topFillColor1=t.oh),void 0!==t._h&&(e.topFillColor2=t._h),void 0!==t.uh&&(e.bottomFillColor1=t.uh),void 0!==t.dh&&(e.bottomFillColor2=t.dh),e}function sc(t){let e={open:t.Wt[0],high:t.Wt[1],low:t.Wt[2],close:t.Wt[3],time:t.Gr};return void 0!==t.Ag&&(e.customValues=t.Ag),e}function sd(t){let e=sc(t);return void 0!==t.R&&(e.color=t.R),e}function sm(t){let e=sc(t),{R:i,Ht:s,nh:r}=t;return void 0!==i&&(e.color=i),void 0!==s&&(e.borderColor=s),void 0!==r&&(e.wickColor=r),e}function sp(t){return({Area:sh,Line:sa,Baseline:su,Histogram:sa,Bar:sd,Candlestick:sm,Custom:sf})[t]}function sf(t){let e=t.Gr;return{...t.le,time:e}}let sg={vertLine:{color:"#9598A1",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#131722"},horzLine:{color:"#9598A1",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#131722"},mode:1,doNotSnapToHiddenSeriesIndices:!1},sv={vertLines:{color:"#D6DCDE",style:0,visible:!0},horzLines:{color:"#D6DCDE",style:0,visible:!0}},sx={background:{type:"solid",color:"#FFFFFF"},textColor:"#191919",fontSize:12,fontFamily:tc,panes:{enableResize:!0,separatorColor:"#E0E3EB",separatorHoverColor:"rgba(178, 181, 189, 0.2)"},attributionLogo:!0,colorSpace:"srgb",colorParsers:[]},sw={autoScale:!0,mode:0,invertScale:!1,alignLabels:!0,borderVisible:!0,borderColor:"#2B2B43",entireTextOnly:!1,visible:!1,ticksVisible:!1,scaleMargins:{bottom:.1,top:.2},minimumWidth:0,ensureEdgeTickMarksVisible:!1},sy={rightOffset:0,barSpacing:6,minBarSpacing:.5,maxBarSpacing:0,fixLeftEdge:!1,fixRightEdge:!1,lockVisibleTimeRangeOnResize:!1,rightBarStaysOnScroll:!1,borderVisible:!0,borderColor:"#2B2B43",visible:!0,timeVisible:!1,secondsVisible:!0,shiftVisibleRangeOnNewBar:!0,allowShiftVisibleRangeOnWhitespaceReplacement:!1,ticksVisible:!1,uniformDistribution:!1,minimumHeight:0,allowBoldLabels:!0,ignoreWhitespaceIndices:!1,enableConflation:!1,conflationThresholdFactor:1,precomputeConflationOnInit:!1,precomputeConflationPriority:"background"};function sb(){return{addDefaultPane:!0,width:0,height:0,autoSize:!1,layout:sx,crosshair:sg,grid:sv,overlayPriceScales:{...sw},leftPriceScale:{...sw,visible:!1},rightPriceScale:{...sw,visible:!0},timeScale:sy,localization:{locale:ic?navigator.language:"",dateFormat:"dd MMM 'yy"},handleScroll:{mouseWheel:!0,pressedMouseMove:!0,horzTouchDrag:!0,vertTouchDrag:!0},handleScale:{axisPressedMouseMove:{time:!0,price:!0},axisDoubleClickReset:{time:!0,price:!0},mouseWheel:!0,pinch:!0},kineticScroll:{mouse:!1,touch:!0},trackingMode:{exitMode:1}}}class sS{constructor(t,e,i){this.Yp=t,this.bM=e,this.SM=i??0}applyOptions(t){this.Yp.Qt().md(this.bM,t,this.SM)}options(){return this.Ki().N()}width(){return tA(this.bM)?this.Yp.dg(this.bM):0}setVisibleRange(t){this.setAutoScale(!1),this.Ki().$o(new t3(t.from,t.to))}getVisibleRange(){let t,e,i=this.Ki().er();if(null===i)return null;if(this.Ki().io()){let s=this.Ki().m_(),r=e4(s);t=Number((Math.round((i=eO(i,this.Ki().no())).Ze()/s)*s).toFixed(r)),e=Number((Math.round(i.Ge()/s)*s).toFixed(r))}else t=i.Ze(),e=i.Ge();return{from:t,to:e}}setAutoScale(t){this.applyOptions({autoScale:t})}Ki(){return tt(this.Yp.Qt().wd(this.bM,this.SM)).Ft}}class sj{constructor(t,e,i,s){this.Yp=t,this.yt=i,this.xM=e,this.CM=s}getHeight(){return this.yt.$t()}setHeight(t){let e=this.Yp.Qt(),i=e.Gd(this.yt);e.xd(i,t)}getStretchFactor(){return this.yt.E_()}setStretchFactor(t){this.yt.A_(t),this.Yp.Qt().Ca()}paneIndex(){return this.Yp.Qt().Gd(this.yt)}moveTo(t){let e=this.paneIndex();e!==t&&(Q(t>=0&&t<this.Yp.Zp().length,"Invalid pane index"),this.Yp.Qt().yd(e,t))}getSeries(){return this.yt.F_().map(t=>this.xM(t))??[]}getHTMLElement(){let t=this.Yp.Zp();return t&&0!==t.length&&t[this.paneIndex()]?t[this.paneIndex()].iv():null}attachPrimitive(t){this.yt.nl(t),t.attached&&t.attached({chart:this.CM,requestUpdate:()=>this.yt.Qt().Ca()})}detachPrimitive(t){this.yt.el(t)}priceScale(t){if(null===this.yt.V_(t))throw Error(`Cannot find price scale with id: ${t}`);return new sS(this.Yp,t,this.paneIndex())}setPreserveEmptyPane(t){this.yt.O_(t)}preserveEmptyPane(){return this.yt.N_()}addCustomSeries(t,e={},i=0){return this.CM.addCustomSeries(t,e,i)}addSeries(t,e={}){return this.CM.addSeries(t,e,this.paneIndex())}}let sM={color:"#FF0000",price:0,lineStyle:2,lineWidth:1,lineVisible:!0,axisLabelVisible:!0,title:"",axisLabelColor:"",axisLabelTextColor:""};class sC{constructor(t){this.hr=t}applyOptions(t){this.hr.cr(t)}options(){return this.hr.N()}yM(){return this.hr}}class sN{constructor(t,e,i,s,r,n){this.kM=new ti,this.ee=t,this.PM=e,this.TM=i,this.cu=r,this.CM=s,this.RM=n}m(){this.kM.m()}priceFormatter(){return this.ee.Xa()}priceToCoordinate(t){let e=this.ee.Lt();return null===e?null:this.ee.Ft().Nt(t,e.Wt)}coordinateToPrice(t){let e=this.ee.Lt();return null===e?null:this.ee.Ft().Ds(t,e.Wt)}barsInLogicalRange(t){if(null===t)return null;let e=new e1(new eQ(t.from,t.to)).Ru(),i=this.ee.qs();if(i.Gi())return null;let s=i.$s(e.Aa(),1),r=i.$s(e.bi(),-1),n=tt(i.kh()),l=tt(i.sn());if(null!==s&&null!==r&&s.js>r.js)return{barsBefore:t.from-n,barsAfter:l-t.to};let o={barsBefore:null===s||s.js===n?t.from-n:s.js-n,barsAfter:null===r||r.js===l?l-t.to:l-r.js};return null!==s&&null!==r&&(o.from=s.Gr,o.to=r.Gr),o}setData(t){this.cu,this.ee.wh(),this.PM.DM(this.ee,t),this.IM("full")}update(t,e=!1){this.ee.wh(),this.PM.VM(this.ee,t,e),this.IM("update")}pop(t=1){let e=this.PM.BM(this.ee,t);0!==e.length&&this.IM("update");let i=sp(this.seriesType());return e.map(t=>i(t))}dataByIndex(t,e){let i=this.ee.qs().$s(t,e);return null===i?null:sp(this.seriesType())(i)}data(){let t=sp(this.seriesType());return this.ee.qs().Dh().map(e=>t(e))}subscribeDataChanged(t){this.kM.i(t)}unsubscribeDataChanged(t){this.kM._(t)}applyOptions(t){this.ee.cr(t)}options(){return ta(this.ee.N())}priceScale(){return this.TM.priceScale(this.ee.Ft().ol(),this.getPane().paneIndex())}createPriceLine(t){let e=ts(ta(sM),t);return new sC(this.ee.Da(e))}removePriceLine(t){this.ee.Ia(t.yM())}priceLines(){return this.ee.Va().map(t=>new sC(t))}seriesType(){return this.ee.wh()}lastValueData(t){let e=this.ee.Ve(t);return e.Be?{noData:!0}:{noData:!1,price:e.gt,color:e.R}}attachPrimitive(t){this.ee.nl(t),t.attached&&t.attached({chart:this.CM,series:this,requestUpdate:()=>this.ee.Qt().Ca(),horzScaleBehavior:this.cu})}detachPrimitive(t){this.ee.el(t),t.detached&&t.detached(),this.ee.Qt().Ca()}getPane(){let t=this.ee,e=tt(this.ee.Qt().Kn(t));return this.RM(e)}moveToPane(t){this.ee.Qt().jd(this.ee,t)}seriesOrder(){let t=this.ee.Qt().Kn(this.ee);return null===t?-1:t.F_().indexOf(this.ee)}setSeriesOrder(t){let e=this.ee.Qt().Kn(this.ee);null!==e&&e.su(this.ee,t)}IM(t){this.kM.v()&&this.kM.p(t)}}class sE{constructor(t,e,i){this.EM=new ti,this.Nu=new ti,this.xw=new ti,this.ns=t,this.Jh=t.Et(),this.tg=e,this.Jh.Lc().i(this.AM.bind(this)),this.Jh.zc().i(this.LM.bind(this)),this.tg.Dw().i(this.zM.bind(this)),this.cu=i}m(){this.Jh.Lc().u(this),this.Jh.zc().u(this),this.tg.Dw().u(this),this.EM.m(),this.Nu.m(),this.xw.m()}scrollPosition(){return this.Jh.Cc()}scrollToPosition(t,e){e?this.Jh.Bc(t,1e3):this.ns.Mn(t)}scrollToRealTime(){this.Jh.Vc()}getVisibleRange(){let t=this.Jh.lc();return null===t?null:{from:t.from.originalTime,to:t.to.originalTime}}setVisibleRange(t){let e={from:this.cu.convertHorzItemToInternal(t.from),to:this.cu.convertHorzItemToInternal(t.to)},i=this.Jh.cc(e);this.ns.$d(i)}getVisibleLogicalRange(){let t=this.Jh.ac();return null===t?null:{from:t.Aa(),to:t.bi()}}setVisibleLogicalRange(t){Q(t.from<=t.to,"The from index cannot be after the to index."),this.ns.$d(t)}resetTimeScale(){this.ns.wn()}fitContent(){this.ns.Fc()}logicalToCoordinate(t){let e=this.ns.Et();return e.Gi()?null:e.qt(t)}coordinateToLogical(t){return this.Jh.Gi()?null:this.Jh.wc(t)}timeToIndex(t,e){let i=this.cu.convertHorzItemToInternal(t);return this.Jh.ec(i,e)}timeToCoordinate(t){let e=this.timeToIndex(t,!1);return null===e?null:this.Jh.qt(e)}coordinateToTime(t){let e=this.ns.Et(),i=e.wc(t),s=e.es(i);return null===s?null:s.originalTime}width(){return this.tg.sv().width}height(){return this.tg.sv().height}subscribeVisibleTimeRangeChange(t){this.EM.i(t)}unsubscribeVisibleTimeRangeChange(t){this.EM._(t)}subscribeVisibleLogicalRangeChange(t){this.Nu.i(t)}unsubscribeVisibleLogicalRangeChange(t){this.Nu._(t)}subscribeSizeChange(t){this.xw.i(t)}unsubscribeSizeChange(t){this.xw._(t)}applyOptions(t){this.Jh.cr(t)}options(){return{...ta(this.Jh.N()),barSpacing:this.Jh.ul()}}AM(){this.EM.v()&&this.EM.p(this.getVisibleRange())}LM(){this.Nu.v()&&this.Nu.p(this.getVisibleLogicalRange())}zM(t){this.xw.p(t.width,t.height)}}function sP(t){return function(t){if(to(t.handleScale)){let e=t.handleScale;t.handleScale={axisDoubleClickReset:{time:e,price:e},axisPressedMouseMove:{time:e,price:e},mouseWheel:e,pinch:e}}else if(void 0!==t.handleScale){let{axisPressedMouseMove:e,axisDoubleClickReset:i}=t.handleScale;to(e)&&(t.handleScale.axisPressedMouseMove={time:e,price:e}),to(i)&&(t.handleScale.axisDoubleClickReset={time:i,price:i})}let e=t.handleScroll;to(e)&&(t.handleScroll={horzTouchDrag:e,vertTouchDrag:e,mouseWheel:e,pressedMouseMove:e})}(t),t}class sk{constructor(t,e,i){this.OM=new Map,this.NM=new Map,this.FM=new ti,this.WM=new ti,this.HM=new ti,this.Xc=new WeakMap,this.UM=new i6(e);const s=void 0===i?ta(sb()):ts(ta(sb()),sP(i));this.$M=e,this.Yp=new iU(t,s,e),this.Yp.nw().i(t=>{this.FM.v()&&this.FM.p(this.qM(t()))},this),this.Yp.ew().i(t=>{this.WM.v()&&this.WM.p(this.qM(t()))},this),this.Yp.Md().i(t=>{this.HM.v()&&this.HM.p(this.qM(t()))},this);const r=this.Yp.Qt();this.jM=new sE(r,this.Yp.rg(),this.$M)}remove(){this.Yp.nw().u(this),this.Yp.ew().u(this),this.Yp.Md().u(this),this.jM.m(),this.Yp.m(),this.OM.clear(),this.NM.clear(),this.FM.m(),this.WM.m(),this.HM.m(),this.UM.m()}resize(t,e,i){this.autoSizeActive()||this.Yp.sg(t,e,i)}addCustomSeries(t,e={},i=0){let s,r=(s=te(t),{type:"Custom",isBuiltIn:!1,defaultOptions:{...sn,...s.defaultOptions()},YM:sl,KM:s});return this.ZM(r,e,i)}addSeries(t,e={},i=0){return this.ZM(t,e,i)}removeSeries(t){let e=Z(this.OM.get(t)),i=this.UM.Hd(e);this.Yp.Qt().Hd(e),this.GM(i),this.OM.delete(t),this.NM.delete(e)}DM(t,e){this.GM(this.UM.Ug(t,e))}VM(t,e,i){this.GM(this.UM.Zg(t,e,i))}BM(t,e){let[i,s]=this.UM.Jg(t,e);return 0!==i.length&&this.GM(s),i}subscribeClick(t){this.FM.i(t)}unsubscribeClick(t){this.FM._(t)}subscribeCrosshairMove(t){this.HM.i(t)}unsubscribeCrosshairMove(t){this.HM._(t)}subscribeDblClick(t){this.WM.i(t)}unsubscribeDblClick(t){this.WM._(t)}priceScale(t,e=0){return new sS(this.Yp,t,e)}timeScale(){return this.jM}applyOptions(t){this.Yp.cr(sP(t))}options(){return this.Yp.N()}takeScreenshot(t=!1,e=!1){let i,s;try{e||(i=this.Yp.Qt().N().crosshair.mode,this.Yp.cr({crosshair:{mode:2}})),s=this.Yp.ug(t)}finally{e||void 0===i||this.Yp.Qt().cr({crosshair:{mode:i}})}return s}addPane(t=!1){let e=this.Yp.Qt().Xd();return e.O_(t),this.XM(e)}removePane(t){this.Yp.Qt().Sd(t)}swapPanes(t,e){this.Yp.Qt().Cd(t,e)}autoSizeActive(){return this.Yp.vg()}chartElement(){return this.Yp.hv()}panes(){return this.Yp.Qt().Xs().map(t=>this.XM(t))}paneSize(t=0){let e=this.Yp.gg(t);return{height:e.height,width:e.width}}setCrosshairPosition(t,e,i){let s=this.OM.get(i);if(void 0===s)return;let r=this.Yp.Qt().Kn(s);null!==r&&this.Yp.Qt().Ld(t,e,r)}clearCrosshairPosition(){this.Yp.Qt().zd(!0)}horzBehaviour(){return this.$M}ZM(t,e={},i=0){var s;Q(void 0!==t.YM),void 0===(s=e.priceFormat)||"custom"===s.type||void 0!==s.minMove&&void 0===s.precision&&(s.precision=e4(s.minMove)),"Candlestick"===t.type&&(void 0!==e.borderColor&&(e.borderUpColor=e.borderColor,e.borderDownColor=e.borderColor),void 0!==e.wickColor&&(e.wickUpColor=e.wickColor,e.wickDownColor=e.wickColor));let r=ts(ta(Y),ta(t.defaultOptions),e),n=t.YM,l=new eM(this.Yp.Qt(),t.type,r,n,t.KM);this.Yp.Qt().Fd(l,i);let o=new sN(l,this,this,this,this.$M,t=>this.XM(t));return this.OM.set(o,l),this.NM.set(l,o),o}GM(t){let e=this.Yp.Qt();e.Od(t.Et.vc,t.Et.sM,t.Et.nM),t.F_.forEach((t,e)=>e.ht(t.le,t.iM)),e.Et().Ju(),e.Sc()}JM(t){return Z(this.NM.get(t))}qM(t){let e=new Map;t.Vg.forEach((t,i)=>{let s=i.wh(),r=sp(s)(t);if("Custom"!==s){var n;Q(void 0!==(n=r).open||void 0!==n.value)}else{let t=i.hl();Q(!t||!1===t(r))}e.set(this.JM(i),r)});let i=void 0!==t.Ig&&this.NM.has(t.Ig)?this.JM(t.Ig):void 0;return{time:t.Gr,logical:t.js,point:t.Rg,paneIndex:t.Dg,hoveredSeries:i,hoveredObjectId:t.Bg,seriesData:e,sourceEvent:t.Eg}}XM(t){let e=this.Xc.get(t);return e||(e=new sj(this.Yp,t=>this.JM(t),t,this),this.Xc.set(t,e)),e}}class s_ extends se{constructor(t,e){super(t,e,!1)}mM(t,e,i){e.mc(this.aM,tu(this.lM)),t.Zo(this.aM,i,tu(this.lM))}Lb(t,e,i){return{wt:t,Hr:e.Wt[0],Ur:e.Wt[1],$r:e.Wt[2],qr:e.Wt[3],_t:NaN,Go:NaN,Xo:NaN,Jo:NaN,Qo:NaN}}pM(){let t=this.ee.ga();this.aM=this.ee.Na().Dh().map(e=>this.tb(e.js,e,t))}}class sR extends tx{constructor(){super(...arguments),this.jt=null,this.Ib=0}ht(t){this.jt=t}et(t){if(null===this.jt||0===this.jt.qs.length||null===this.jt.lt)return;let{horizontalPixelRatio:e}=t;this.Ib=function(t,e){if(t>=2.5&&t<=4)return Math.floor(3*e);let i=1-.2*Math.atan(Math.max(4,t)-4)/(.5*Math.PI),s=Math.min(Math.floor(t*i*e),Math.floor(t*e));return Math.max(Math.floor(e),s)}(this.jt.ul,e),this.Ib>=2&&Math.floor(e)%2!=this.Ib%2&&this.Ib--;let i=this.jt.qs;this.jt.zb&&this.Ob(t,i,this.jt.lt),this.jt.Mi&&this.gm(t,i,this.jt.lt);let s=this.Nb(e);(!this.jt.Mi||this.Ib>2*s)&&this.Fb(t,i,this.jt.lt)}Ob(t,e,i){if(null===this.jt)return;let{context:s,horizontalPixelRatio:r,verticalPixelRatio:n}=t,l="",o=Math.min(Math.floor(r),Math.floor(this.jt.ul*r)),a=Math.floor(.5*(o=Math.max(Math.floor(r),Math.min(o,this.Ib)))),h=null;for(let t=i.from;t<i.to;t++){let i=e[t];i.sh!==l&&(s.fillStyle=i.sh,l=i.sh);let u=Math.round(Math.min(i.Go,i.Qo)*n),c=Math.round(Math.max(i.Go,i.Qo)*n),d=Math.round(i.Xo*n),m=Math.round(i.Jo*n),p=Math.round(r*i._t)-a,f=p+o-1;null!==h&&(p=Math.min(p=Math.max(h+1,p),f));let g=f-p+1;s.fillRect(p,d,g,u-d),s.fillRect(p,c+1,g,m-c),h=f}}Nb(t){let e=Math.floor(+t);this.Ib<=2*e&&(e=Math.floor(.5*(this.Ib-1)));let i=Math.max(Math.floor(t),e);return this.Ib<=2*i?Math.max(Math.floor(t),Math.floor(+t)):i}gm(t,e,i){if(null===this.jt)return;let{context:s,horizontalPixelRatio:r,verticalPixelRatio:n}=t,l="",o=this.Nb(r),a=null;for(let t=i.from;t<i.to;t++){let i=e[t];i.ih!==l&&(s.fillStyle=i.ih,l=i.ih);let d=Math.round(i._t*r)-Math.floor(.5*this.Ib),m=d+this.Ib-1,p=Math.round(Math.min(i.Go,i.Qo)*n),f=Math.round(Math.max(i.Go,i.Qo)*n);if(null!==a&&(d=Math.min(d=Math.max(a+1,d),m)),this.jt.ul*r>2*o){var h,u,c;h=d,u=m-d+1,c=f-p+1,s.fillRect(h+o,p,u-2*o,o),s.fillRect(h+o,p+c-o,u-2*o,o),s.fillRect(h,p,o,c),s.fillRect(h+u-o,p,o,c)}else{let t=m-d+1;s.fillRect(d,p,t,f-p+1)}a=m}}Fb(t,e,i){if(null===this.jt)return;let{context:s,horizontalPixelRatio:r,verticalPixelRatio:n}=t,l="",o=this.Nb(r);for(let t=i.from;t<i.to;t++){let i=e[t],a=Math.round(Math.min(i.Go,i.Qo)*n),h=Math.round(Math.max(i.Go,i.Qo)*n),u=Math.round(i._t*r)-Math.floor(.5*this.Ib),c=u+this.Ib-1;if(i.th!==l){let t=i.th;s.fillStyle=t,l=t}this.jt.Mi&&(u+=o,a+=o,c-=o,h-=o),a>h||s.fillRect(u,a,c-u+1,h-a+1)}}}class sT extends s_{constructor(){super(...arguments),this.cM=new sR}tb(t,e,i){return{...this.Lb(t,e,i),...i.gh(t)}}wM(){let t=this.ee.N();this.cM.ht({qs:this.aM,ul:this.re.Et().ul(),zb:t.wickVisible,Mi:t.borderVisible,lt:this.lM})}}let sL={type:"Candlestick",isBuiltIn:!0,defaultOptions:{upColor:"#26a69a",downColor:"#ef5350",wickVisible:!0,borderVisible:!0,borderColor:"#378658",borderUpColor:"#26a69a",borderDownColor:"#ef5350",wickColor:"#737375",wickUpColor:"#26a69a",wickDownColor:"#ef5350"},YM:(t,e)=>new sT(t,e)};class sI{constructor(t,e){this.ee=t,this.Zh=e,this.jb()}detach(){this.ee.detachPrimitive(this.Zh)}getSeries(){return this.ee}applyOptions(t){this.Zh&&this.Zh.cr&&this.Zh.cr(t)}jb(){this.ee.attachPrimitive(this.Zh)}}let sF={autoScale:!0,zOrder:"normal"};function sz(t,e){return ek(Math.min(Math.max(t,12),30)*e)}function sA(t,e){switch(t){case"arrowDown":case"arrowUp":return sz(e,1);case"circle":return sz(e,.8);case"square":return sz(e,.7)}}function sD(t){let e;return(e=Math.ceil(sz(t,1)))%2!=0?e-1:e}function sO(t){return Math.max(sz(t,.1),3)}function sB(t,e,i){return e?t:i?Math.ceil(t/2):0}function s$(t,e,i,s){let r=(sA("arrowUp",s)-1)/2*i.pS,n=(ek(s/2)-1)/2*i.pS;e.beginPath(),t?(e.moveTo(i._t-r,i.ut),e.lineTo(i._t,i.ut-r),e.lineTo(i._t+r,i.ut),e.lineTo(i._t+n,i.ut),e.lineTo(i._t+n,i.ut+r),e.lineTo(i._t-n,i.ut+r)):(e.moveTo(i._t-r,i.ut),e.lineTo(i._t,i.ut+r),e.lineTo(i._t+r,i.ut),e.lineTo(i._t+n,i.ut),e.lineTo(i._t+n,i.ut-r),e.lineTo(i._t-n,i.ut-r)),e.lineTo(i._t-n,i.ut),e.fill()}function sW(t,e,i,s,r,n){let l=(sA("arrowUp",s)-1)/2,o=(ek(s/2)-1)/2;return r>=e-o-2&&r<=e+o+2&&n>=(t?i:i-l)-2&&n<=(t?i+l:i)+2||!(r<e-l-3)&&!(r>e+l+3)&&!(n<(t?i-l-3:i))&&!(n>(t?i:i+l+3))&&Math.abs(n-i)+3>=Math.abs(r-e)/2}class sK{constructor(){this.jt=null,this.$n=new tU,this.F=-1,this.W="",this.jv="",this.vS="normal"}ht(t){this.jt=t}qn(t,e,i){this.F===t&&this.W===e||(this.F=t,this.W=e,this.jv=td(t,e),this.$n.On()),this.vS=i}Qn(t,e){if(null===this.jt||null===this.jt.lt)return null;for(let i=this.jt.lt.from;i<this.jt.lt.to;i++){let s=this.jt.ot[i];if(s&&function(t,e,i){var s,r,n,l;let o;return!(void 0===t.ri||(s=t.ri._t,r=t.ri.ut,n=t.ri.ss,l=t.ri.$t,o=l/2,!(e>=s)||!(e<=s+n)||!(i>=r-o)||!(i<=r+o)))||function(t,e,i){var s,r,n,l,o,a;if(0===t.yh)return!1;switch(t.wS){case"arrowDown":return sW(!0,t._t,t.ut,t.yh,e,i);case"arrowUp":return sW(!1,t._t,t.ut,t.yh,e,i);case"circle":let h,u,c;return s=t._t,r=t.ut,n=t.yh,h=2+sA("circle",n)/2,Math.sqrt((u=s-e)*u+(c=r-i)*c)<=h;case"square":let d,m,p,f;return l=t._t,o=t.ut,a=t.yh,p=l-(m=((d=sA("square",a))-1)/2),f=o-m,e>=p&&e<=p+d&&i>=f&&i<=f+d}}(t,e,i)}(s,t,e))return{zOrder:"normal",externalId:s.te??""}}return null}draw(t){"aboveSeries"!==this.vS&&t.useBitmapCoordinateSpace(t=>{this.et(t)})}drawBackground(t){"aboveSeries"===this.vS&&t.useBitmapCoordinateSpace(t=>{this.et(t)})}et({context:t,horizontalPixelRatio:e,verticalPixelRatio:i}){if(null!==this.jt&&null!==this.jt.lt){t.textBaseline="middle",t.font=this.jv;for(let s=this.jt.lt.from;s<this.jt.lt.to;s++){let r=this.jt.ot[s];void 0!==r.ri&&(r.ri.ss=this.$n.Ii(t,r.ri.mS),r.ri.$t=this.F,r.ri._t=r._t-r.ri.ss/2),function(t,e,i,s){var r,n,l;let o;e.fillStyle=t.R,void 0!==t.ri&&(r=t.ri.mS,n=t.ri._t,l=t.ri.ut,e.save(),e.scale(i,s),e.fillText(r,n,l),e.restore()),function(t,e,i){if(0!==t.yh){switch(t.wS){case"arrowDown":return s$(!1,e,i,t.yh);case"arrowUp":return s$(!0,e,i,t.yh);case"circle":let s;return s=(sA("circle",t.yh)-1)/2,e.beginPath(),e.arc(i._t,i.ut,s*i.pS,0,2*Math.PI,!1),e.fill();case"square":let r,n,l,o;return n=((r=sA("square",t.yh))-1)*i.pS/2,l=i._t-n,o=i.ut-n,e.fillRect(l,o,r*i.pS,r*i.pS)}t.wS}}(t,e,(o=Math.max(1,Math.floor(i))%2/2,{_t:Math.round(t._t*i)+o,ut:t.ut*s,pS:i}))}(r,t,e,i)}}}}function sV(t){return"atPriceTop"===t||"atPriceBottom"===t||"atPriceMiddle"===t}class sU{constructor(t,e,i){this.bS=[],this.xt=!0,this.SS=!0,this.Xt=new sK,this.ye=t,this.Lv=e,this.jt={ot:[],lt:null},this.Ps=i}renderer(){if(!this.ye.options().visible)return null;this.xt&&this.xS();let t=this.Lv.options().layout;return this.Xt.qn(t.fontSize,t.fontFamily,this.Ps.zOrder),this.Xt.ht(this.jt),this.Xt}CS(t){this.bS=t,this.kt("data")}kt(t){this.xt=!0,"data"===t&&(this.SS=!0)}yS(t){this.xt=!0,this.Ps=t}zOrder(){return"aboveSeries"===this.Ps.zOrder?"top":this.Ps.zOrder}xS(){let t=this.Lv.timeScale(),e=this.bS;this.SS&&(this.jt.ot=e.map(t=>({wt:t.time,_t:0,ut:0,yh:0,wS:t.shape,R:t.color,te:t.id,kS:t.kS,ri:void 0})),this.SS=!1);let i=this.Lv.options().layout;this.jt.lt=null;let s=t.getVisibleLogicalRange();if(null===s)return;let r=new eQ(Math.floor(s.from),Math.ceil(s.to));if(null===this.ye.data()[0]||0===this.jt.ot.length)return;let n=NaN,l=sO(t.options().barSpacing),o={gS:l,MS:l};this.jt.lt=st(this.jt.ot,r,!0);for(let s=this.jt.lt.from;s<this.jt.lt.to;s++){let r=e[s];r.time!==n&&(o.gS=l,o.MS=l,n=r.time);let a=this.jt.ot[s];a._t=tt(t.logicalToCoordinate(r.time)),void 0!==r.text&&r.text.length>0&&(a.ri={mS:r.text,_t:0,ut:0,ss:0,$t:0});let h=this.ye.dataByIndex(r.time,0);null!==h&&function(t,e,i,s,r,n,l,o){let a=function(t,e,i){if(sV(e.position)&&void 0!==e.price)return e.price;if("value"in t&&"number"==typeof t.value)return t.value;if("open"in t&&"high"in t&&"low"in t&&"close"in t){if("inBar"===e.position)return t.close;if("aboveBar"===e.position)return i?t.low:t.high;if("belowBar"===e.position)return i?t.high:t.low}}(i,e,l.priceScale().options().invertScale);if(void 0===a)return;let h=sV(e.position),u=o.timeScale(),c=tr(e.size)?Math.max(e.size,0):1,d=sD(u.options().barSpacing)*c,m=d/2;switch(t.yh=d,e.position){case"inBar":case"atPriceMiddle":return t.ut=tt(l.priceToCoordinate(a)),void 0!==t.ri&&(t.ri.ut=t.ut+m+n+.6*r);case"aboveBar":case"atPriceTop":{let e=h?0:s.gS;return t.ut=tt(l.priceToCoordinate(a))-m-e,void 0!==t.ri&&(t.ri.ut=t.ut-m-.6*r,s.gS+=1.2*r),h||(s.gS+=d+n)}case"belowBar":case"atPriceBottom":{let e=h?0:s.MS;return t.ut=tt(l.priceToCoordinate(a))+m+e,void 0!==t.ri&&(t.ri.ut=t.ut+m+n+.6*r,s.MS+=1.2*r),h||(s.MS+=d+n)}}}(a,r,h,o,i.fontSize,l,this.ye,this.Lv)}this.xt=!1}}class sH{constructor(t){this.$h=null,this.bS=[],this.PS=[],this.TS=null,this.ye=null,this.Lv=null,this.RS=!0,this.DS=null,this.IS=null,this.VS=null,this.BS=!0,this.Ps={...sF,...t}}attached(t){this.ES(),this.Lv=t.chart,this.ye=t.series,this.$h=new sU(this.ye,tt(this.Lv),this.Ps),this.dS=t.requestUpdate,this.ye.subscribeDataChanged(t=>this.IM(t)),this.BS=!0,this.Jb()}Jb(){this.dS&&this.dS()}detached(){this.ye&&this.TS&&this.ye.unsubscribeDataChanged(this.TS),this.Lv=null,this.ye=null,this.$h=null,this.TS=null}CS(t){this.BS=!0,this.bS=t,this.ES(),this.RS=!0,this.IS=null,this.Jb()}AS(){return this.bS}paneViews(){return this.$h?[this.$h]:[]}updateAllViews(){this.LS()}hitTest(t,e){return this.$h?this.$h.renderer()?.Qn(t,e)??null:null}autoscaleInfo(t,e){if(this.Ps.autoScale&&this.$h){let t=this.zS();if(t)return{priceRange:null,margins:t}}return null}cr(t){var e;this.Ps=(e={...this.Ps,...t},{...sF,...e}),this.Jb&&this.Jb()}zS(){let t=tt(this.Lv).timeScale().options().barSpacing;if(this.RS||t!==this.VS){if(this.VS=t,this.bS.length>0){let e=sO(t),i=1.5*sD(t)+2*e,s=this.OS();this.DS={above:sB(i,s.aboveBar,s.inBar),below:sB(i,s.belowBar,s.inBar)}}else this.DS=null;this.RS=!1}return this.DS}OS(){return null===this.IS&&(this.IS=this.bS.reduce((t,e)=>(t[e.position]||(t[e.position]=!0),t),{inBar:!1,aboveBar:!1,belowBar:!1,atPriceTop:!1,atPriceBottom:!1,atPriceMiddle:!1})),this.IS}ES(){if(!this.BS||!this.Lv||!this.ye)return;let t=this.Lv.timeScale(),e=this.ye?.data();if(null==t.getVisibleLogicalRange()||!this.ye||0===e.length)return void(this.PS=[]);let i=t.timeToIndex(tt(e[0].time),!0);this.PS=this.bS.map((e,s)=>{let r=t.timeToIndex(e.time,!0),n=tt(this.ye).dataByIndex(r,r<i?1:-1),l={time:t.timeToIndex(tt(n).time,!1),position:e.position,shape:e.shape,color:e.color,id:e.id,kS:s,text:e.text,size:e.size,price:e.price,Gr:e.time};if(("atPriceTop"===e.position||"atPriceBottom"===e.position||"atPriceMiddle"===e.position)&&void 0===e.price)throw Error(`Price is required for position ${e.position}`);return{...l,position:e.position,price:e.price}}),this.BS=!1}LS(t){this.$h&&(this.ES(),this.$h.CS(this.PS),this.$h.yS(this.Ps),this.$h.kt(t))}IM(t){this.BS=!0,this.Jb()}}class sJ extends sI{constructor(t,e,i){super(t,e),i&&this.setMarkers(i)}setMarkers(t){this.Zh.CS(t)}markers(){return this.Zh.AS()}}({...Y,color:"#2196f3"});var sq=t.i(10965);let sY=(0,sq.default)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);var sX=t.i(67881),sG=t.i(49463);function sQ(t,[e,i]){return Math.min(i,Math.max(e,t))}function sZ(t,e,{checkForDefaultPrevented:i=!0}={}){return function(s){if(t?.(s),!1===i||!s.defaultPrevented)return e?.(s)}}function s0(t,e=[]){let i=[],s=()=>{let e=i.map(t=>$.createContext(t));return function(i){let s=i?.[t]||e;return $.useMemo(()=>({[`__scope${t}`]:{...i,[t]:s}}),[i,s])}};return s.scopeName=t,[function(e,s){let r=$.createContext(s),n=i.length;i=[...i,s];let l=e=>{let{scope:i,children:s,...l}=e,o=i?.[t]?.[n]||r,a=$.useMemo(()=>l,Object.values(l));return(0,L.jsx)(o.Provider,{value:a,children:s})};return l.displayName=e+"Provider",[l,function(i,l){let o=l?.[t]?.[n]||r,a=$.useContext(o);if(a)return a;if(void 0!==s)return s;throw Error(`\`${i}\` must be used within \`${e}\``)}]},function(...t){let e=t[0];if(1===t.length)return e;let i=()=>{let i=t.map(t=>({useScope:t(),scopeName:t.scopeName}));return function(t){let s=i.reduce((e,{useScope:i,scopeName:s})=>{let r=i(t)[`__scope${s}`];return{...e,...r}},{});return $.useMemo(()=>({[`__scope${e.scopeName}`]:s}),[s])}};return i.scopeName=e.scopeName,i}(s,...e)]}var s1=t.i(866),s2=t.i(64701);function s3(t){let e=t+"CollectionProvider",[i,s]=s0(e),[r,n]=i(e,{collectionRef:{current:null},itemMap:new Map}),l=t=>{let{scope:e,children:i}=t,s=$.default.useRef(null),n=$.default.useRef(new Map).current;return(0,L.jsx)(r,{scope:e,itemMap:n,collectionRef:s,children:i})};l.displayName=e;let o=t+"CollectionSlot",a=$.default.forwardRef((t,e)=>{let{scope:i,children:s}=t,r=n(o,i),l=(0,s1.useComposedRefs)(e,r.collectionRef);return(0,L.jsx)(s2.Slot,{ref:l,children:s})});a.displayName=o;let h=t+"CollectionItemSlot",u="data-radix-collection-item",c=$.default.forwardRef((t,e)=>{let{scope:i,children:s,...r}=t,l=$.default.useRef(null),o=(0,s1.useComposedRefs)(e,l),a=n(h,i);return $.default.useEffect(()=>(a.itemMap.set(l,{ref:l,...r}),()=>void a.itemMap.delete(l))),(0,L.jsx)(s2.Slot,{...{[u]:""},ref:o,children:s})});return c.displayName=h,[{Provider:l,Slot:a,ItemSlot:c},function(e){let i=n(t+"CollectionConsumer",e);return $.default.useCallback(()=>{let t=i.collectionRef.current;if(!t)return[];let e=Array.from(t.querySelectorAll(`[${u}]`));return Array.from(i.itemMap.values()).sort((t,i)=>e.indexOf(t.ref.current)-e.indexOf(i.ref.current))},[i.collectionRef,i.itemMap])},s]}var s5=$.createContext(void 0),s4=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"].reduce((t,e)=>{let i=$.forwardRef((t,i)=>{let{asChild:s,...r}=t,n=s?s2.Slot:e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,L.jsx)(n,{...r,ref:i})});return i.displayName=`Primitive.${e}`,{...t,[e]:i}},{});function s6(t,e){t&&sG.flushSync(()=>t.dispatchEvent(e))}function s9(t){let e=$.useRef(t);return $.useEffect(()=>{e.current=t}),$.useMemo(()=>(...t)=>e.current?.(...t),[])}var s7="dismissableLayer.update",s8=$.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),rt=$.forwardRef((t,e)=>{let{disableOutsidePointerEvents:i=!1,onEscapeKeyDown:s,onPointerDownOutside:r,onFocusOutside:n,onInteractOutside:l,onDismiss:o,...a}=t,h=$.useContext(s8),[u,c]=$.useState(null),d=u?.ownerDocument??globalThis?.document,[,m]=$.useState({}),p=(0,s1.useComposedRefs)(e,t=>c(t)),f=Array.from(h.layers),[g]=[...h.layersWithOutsidePointerEventsDisabled].slice(-1),v=f.indexOf(g),x=u?f.indexOf(u):-1,w=h.layersWithOutsidePointerEventsDisabled.size>0,y=x>=v,b=function(t,e=globalThis?.document){let i=s9(t),s=$.useRef(!1),r=$.useRef(()=>{});return $.useEffect(()=>{let t=t=>{if(t.target&&!s.current){let s=function(){rs("dismissableLayer.pointerDownOutside",i,n,{discrete:!0})},n={originalEvent:t};"touch"===t.pointerType?(e.removeEventListener("click",r.current),r.current=s,e.addEventListener("click",r.current,{once:!0})):s()}else e.removeEventListener("click",r.current);s.current=!1},n=window.setTimeout(()=>{e.addEventListener("pointerdown",t)},0);return()=>{window.clearTimeout(n),e.removeEventListener("pointerdown",t),e.removeEventListener("click",r.current)}},[e,i]),{onPointerDownCapture:()=>s.current=!0}}(t=>{let e=t.target,i=[...h.branches].some(t=>t.contains(e));y&&!i&&(r?.(t),l?.(t),t.defaultPrevented||o?.())},d),S=function(t,e=globalThis?.document){let i=s9(t),s=$.useRef(!1);return $.useEffect(()=>{let t=t=>{t.target&&!s.current&&rs("dismissableLayer.focusOutside",i,{originalEvent:t},{discrete:!1})};return e.addEventListener("focusin",t),()=>e.removeEventListener("focusin",t)},[e,i]),{onFocusCapture:()=>s.current=!0,onBlurCapture:()=>s.current=!1}}(t=>{let e=t.target;![...h.branches].some(t=>t.contains(e))&&(n?.(t),l?.(t),t.defaultPrevented||o?.())},d);return!function(t,e=globalThis?.document){let i=s9(t);$.useEffect(()=>{let t=t=>{"Escape"===t.key&&i(t)};return e.addEventListener("keydown",t,{capture:!0}),()=>e.removeEventListener("keydown",t,{capture:!0})},[i,e])}(t=>{x===h.layers.size-1&&(s?.(t),!t.defaultPrevented&&o&&(t.preventDefault(),o()))},d),$.useEffect(()=>{if(u)return i&&(0===h.layersWithOutsidePointerEventsDisabled.size&&(R=d.body.style.pointerEvents,d.body.style.pointerEvents="none"),h.layersWithOutsidePointerEventsDisabled.add(u)),h.layers.add(u),ri(),()=>{i&&1===h.layersWithOutsidePointerEventsDisabled.size&&(d.body.style.pointerEvents=R)}},[u,d,i,h]),$.useEffect(()=>()=>{u&&(h.layers.delete(u),h.layersWithOutsidePointerEventsDisabled.delete(u),ri())},[u,h]),$.useEffect(()=>{let t=()=>m({});return document.addEventListener(s7,t),()=>document.removeEventListener(s7,t)},[]),(0,L.jsx)(s4.div,{...a,ref:p,style:{pointerEvents:w?y?"auto":"none":void 0,...t.style},onFocusCapture:sZ(t.onFocusCapture,S.onFocusCapture),onBlurCapture:sZ(t.onBlurCapture,S.onBlurCapture),onPointerDownCapture:sZ(t.onPointerDownCapture,b.onPointerDownCapture)})});rt.displayName="DismissableLayer";var re=$.forwardRef((t,e)=>{let i=$.useContext(s8),s=$.useRef(null),r=(0,s1.useComposedRefs)(e,s);return $.useEffect(()=>{let t=s.current;if(t)return i.branches.add(t),()=>{i.branches.delete(t)}},[i.branches]),(0,L.jsx)(s4.div,{...t,ref:r})});function ri(){let t=new CustomEvent(s7);document.dispatchEvent(t)}function rs(t,e,i,{discrete:s}){let r=i.originalEvent.target,n=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:i});e&&r.addEventListener(t,e,{once:!0}),s?s6(r,n):r.dispatchEvent(n)}re.displayName="DismissableLayerBranch";var rr=0;function rn(){$.useEffect(()=>{let t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??rl()),document.body.insertAdjacentElement("beforeend",t[1]??rl()),rr++,()=>{1===rr&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),rr--}},[])}function rl(){let t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var ro="focusScope.autoFocusOnMount",ra="focusScope.autoFocusOnUnmount",rh={bubbles:!1,cancelable:!0},ru=$.forwardRef((t,e)=>{let{loop:i=!1,trapped:s=!1,onMountAutoFocus:r,onUnmountAutoFocus:n,...l}=t,[o,a]=$.useState(null),h=s9(r),u=s9(n),c=$.useRef(null),d=(0,s1.useComposedRefs)(e,t=>a(t)),m=$.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;$.useEffect(()=>{if(s){let t=function(t){if(m.paused||!o)return;let e=t.target;o.contains(e)?c.current=e:rm(c.current,{select:!0})},e=function(t){if(m.paused||!o)return;let e=t.relatedTarget;null!==e&&(o.contains(e)||rm(c.current,{select:!0}))};document.addEventListener("focusin",t),document.addEventListener("focusout",e);let i=new MutationObserver(function(t){if(document.activeElement===document.body)for(let e of t)e.removedNodes.length>0&&rm(o)});return o&&i.observe(o,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",t),document.removeEventListener("focusout",e),i.disconnect()}}},[s,o,m.paused]),$.useEffect(()=>{if(o){rp.add(m);let t=document.activeElement;if(!o.contains(t)){let e=new CustomEvent(ro,rh);o.addEventListener(ro,h),o.dispatchEvent(e),e.defaultPrevented||(function(t,{select:e=!1}={}){let i=document.activeElement;for(let s of t)if(rm(s,{select:e}),document.activeElement!==i)return}(rc(o).filter(t=>"A"!==t.tagName),{select:!0}),document.activeElement===t&&rm(o))}return()=>{o.removeEventListener(ro,h),setTimeout(()=>{let e=new CustomEvent(ra,rh);o.addEventListener(ra,u),o.dispatchEvent(e),e.defaultPrevented||rm(t??document.body,{select:!0}),o.removeEventListener(ra,u),rp.remove(m)},0)}}},[o,h,u,m]);let p=$.useCallback(t=>{if(!i&&!s||m.paused)return;let e="Tab"===t.key&&!t.altKey&&!t.ctrlKey&&!t.metaKey,r=document.activeElement;if(e&&r){var n;let e,s=t.currentTarget,[l,o]=[rd(e=rc(n=s),n),rd(e.reverse(),n)];l&&o?t.shiftKey||r!==o?t.shiftKey&&r===l&&(t.preventDefault(),i&&rm(o,{select:!0})):(t.preventDefault(),i&&rm(l,{select:!0})):r===s&&t.preventDefault()}},[i,s,m.paused]);return(0,L.jsx)(s4.div,{tabIndex:-1,...l,ref:d,onKeyDown:p})});function rc(t){let e=[],i=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:t=>{let e="INPUT"===t.tagName&&"hidden"===t.type;return t.disabled||t.hidden||e?NodeFilter.FILTER_SKIP:t.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;i.nextNode();)e.push(i.currentNode);return e}function rd(t,e){for(let i of t)if(!function(t,{upTo:e}){if("hidden"===getComputedStyle(t).visibility)return!0;for(;t&&(void 0===e||t!==e);){if("none"===getComputedStyle(t).display)return!0;t=t.parentElement}return!1}(i,{upTo:e}))return i}function rm(t,{select:e=!1}={}){if(t&&t.focus){var i;let s=document.activeElement;t.focus({preventScroll:!0}),t!==s&&(i=t)instanceof HTMLInputElement&&"select"in i&&e&&t.select()}}ru.displayName="FocusScope";var rp=(s=[],{add(t){let e=s[0];t!==e&&e?.pause(),(s=rf(s,t)).unshift(t)},remove(t){s=rf(s,t),s[0]?.resume()}});function rf(t,e){let i=[...t],s=i.indexOf(e);return -1!==s&&i.splice(s,1),i}var rg=globalThis?.document?$.useLayoutEffect:()=>{},rv=$["useId".toString()]||(()=>void 0),rx=0;function rw(t){let[e,i]=$.useState(rv());return rg(()=>{t||i(t=>t??String(rx++))},[t]),t||(e?`radix-${e}`:"")}let ry=["top","right","bottom","left"],rb=Math.min,rS=Math.max,rj=Math.round,rM=Math.floor,rC=t=>({x:t,y:t}),rN={left:"right",right:"left",bottom:"top",top:"bottom"},rE={start:"end",end:"start"};function rP(t,e){return"function"==typeof t?t(e):t}function rk(t){return t.split("-")[0]}function r_(t){return t.split("-")[1]}function rR(t){return"x"===t?"y":"x"}function rT(t){return"y"===t?"height":"width"}let rL=new Set(["top","bottom"]);function rI(t){return rL.has(rk(t))?"y":"x"}function rF(t){return t.replace(/start|end/g,t=>rE[t])}let rz=["left","right"],rA=["right","left"],rD=["top","bottom"],rO=["bottom","top"];function rB(t){return t.replace(/left|right|bottom|top/g,t=>rN[t])}function r$(t){return"number"!=typeof t?{top:0,right:0,bottom:0,left:0,...t}:{top:t,right:t,bottom:t,left:t}}function rW(t){let{x:e,y:i,width:s,height:r}=t;return{width:s,height:r,top:i,left:e,right:e+s,bottom:i+r,x:e,y:i}}function rK(t,e,i){let s,{reference:r,floating:n}=t,l=rI(e),o=rR(rI(e)),a=rT(o),h=rk(e),u="y"===l,c=r.x+r.width/2-n.width/2,d=r.y+r.height/2-n.height/2,m=r[a]/2-n[a]/2;switch(h){case"top":s={x:c,y:r.y-n.height};break;case"bottom":s={x:c,y:r.y+r.height};break;case"right":s={x:r.x+r.width,y:d};break;case"left":s={x:r.x-n.width,y:d};break;default:s={x:r.x,y:r.y}}switch(r_(e)){case"start":s[o]-=m*(i&&u?-1:1);break;case"end":s[o]+=m*(i&&u?-1:1)}return s}let rV=async(t,e,i)=>{let{placement:s="bottom",strategy:r="absolute",middleware:n=[],platform:l}=i,o=n.filter(Boolean),a=await (null==l.isRTL?void 0:l.isRTL(e)),h=await l.getElementRects({reference:t,floating:e,strategy:r}),{x:u,y:c}=rK(h,s,a),d=s,m={},p=0;for(let i=0;i<o.length;i++){let{name:n,fn:f}=o[i],{x:g,y:v,data:x,reset:w}=await f({x:u,y:c,initialPlacement:s,placement:d,strategy:r,middlewareData:m,rects:h,platform:l,elements:{reference:t,floating:e}});u=null!=g?g:u,c=null!=v?v:c,m={...m,[n]:{...m[n],...x}},w&&p<=50&&(p++,"object"==typeof w&&(w.placement&&(d=w.placement),w.rects&&(h=!0===w.rects?await l.getElementRects({reference:t,floating:e,strategy:r}):w.rects),{x:u,y:c}=rK(h,d,a)),i=-1)}return{x:u,y:c,placement:d,strategy:r,middlewareData:m}};async function rU(t,e){var i;void 0===e&&(e={});let{x:s,y:r,platform:n,rects:l,elements:o,strategy:a}=t,{boundary:h="clippingAncestors",rootBoundary:u="viewport",elementContext:c="floating",altBoundary:d=!1,padding:m=0}=rP(e,t),p=r$(m),f=o[d?"floating"===c?"reference":"floating":c],g=rW(await n.getClippingRect({element:null==(i=await (null==n.isElement?void 0:n.isElement(f)))||i?f:f.contextElement||await (null==n.getDocumentElement?void 0:n.getDocumentElement(o.floating)),boundary:h,rootBoundary:u,strategy:a})),v="floating"===c?{x:s,y:r,width:l.floating.width,height:l.floating.height}:l.reference,x=await (null==n.getOffsetParent?void 0:n.getOffsetParent(o.floating)),w=await (null==n.isElement?void 0:n.isElement(x))&&await (null==n.getScale?void 0:n.getScale(x))||{x:1,y:1},y=rW(n.convertOffsetParentRelativeRectToViewportRelativeRect?await n.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:v,offsetParent:x,strategy:a}):v);return{top:(g.top-y.top+p.top)/w.y,bottom:(y.bottom-g.bottom+p.bottom)/w.y,left:(g.left-y.left+p.left)/w.x,right:(y.right-g.right+p.right)/w.x}}function rH(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function rJ(t){return ry.some(e=>t[e]>=0)}let rq=new Set(["left","top"]);async function rY(t,e){let{placement:i,platform:s,elements:r}=t,n=await (null==s.isRTL?void 0:s.isRTL(r.floating)),l=rk(i),o=r_(i),a="y"===rI(i),h=rq.has(l)?-1:1,u=n&&a?-1:1,c=rP(e,t),{mainAxis:d,crossAxis:m,alignmentAxis:p}="number"==typeof c?{mainAxis:c,crossAxis:0,alignmentAxis:null}:{mainAxis:c.mainAxis||0,crossAxis:c.crossAxis||0,alignmentAxis:c.alignmentAxis};return o&&"number"==typeof p&&(m="end"===o?-1*p:p),a?{x:m*u,y:d*h}:{x:d*h,y:m*u}}function rX(){return"undefined"!=typeof window}function rG(t){return r0(t)?(t.nodeName||"").toLowerCase():"#document"}function rQ(t){var e;return(null==t||null==(e=t.ownerDocument)?void 0:e.defaultView)||window}function rZ(t){var e;return null==(e=(r0(t)?t.ownerDocument:t.document)||window.document)?void 0:e.documentElement}function r0(t){return!!rX()&&(t instanceof Node||t instanceof rQ(t).Node)}function r1(t){return!!rX()&&(t instanceof Element||t instanceof rQ(t).Element)}function r2(t){return!!rX()&&(t instanceof HTMLElement||t instanceof rQ(t).HTMLElement)}function r3(t){return!!rX()&&"undefined"!=typeof ShadowRoot&&(t instanceof ShadowRoot||t instanceof rQ(t).ShadowRoot)}let r5=new Set(["inline","contents"]);function r4(t){let{overflow:e,overflowX:i,overflowY:s,display:r}=nl(t);return/auto|scroll|overlay|hidden|clip/.test(e+s+i)&&!r5.has(r)}let r6=new Set(["table","td","th"]),r9=[":popover-open",":modal"];function r7(t){return r9.some(e=>{try{return t.matches(e)}catch(t){return!1}})}let r8=["transform","translate","scale","rotate","perspective"],nt=["transform","translate","scale","rotate","perspective","filter"],ne=["paint","layout","strict","content"];function ni(t){let e=ns(),i=r1(t)?nl(t):t;return r8.some(t=>!!i[t]&&"none"!==i[t])||!!i.containerType&&"normal"!==i.containerType||!e&&!!i.backdropFilter&&"none"!==i.backdropFilter||!e&&!!i.filter&&"none"!==i.filter||nt.some(t=>(i.willChange||"").includes(t))||ne.some(t=>(i.contain||"").includes(t))}function ns(){return"undefined"!=typeof CSS&&!!CSS.supports&&CSS.supports("-webkit-backdrop-filter","none")}let nr=new Set(["html","body","#document"]);function nn(t){return nr.has(rG(t))}function nl(t){return rQ(t).getComputedStyle(t)}function no(t){return r1(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function na(t){if("html"===rG(t))return t;let e=t.assignedSlot||t.parentNode||r3(t)&&t.host||rZ(t);return r3(e)?e.host:e}function nh(t,e,i){var s;void 0===e&&(e=[]),void 0===i&&(i=!0);let r=function t(e){let i=na(e);return nn(i)?e.ownerDocument?e.ownerDocument.body:e.body:r2(i)&&r4(i)?i:t(i)}(t),n=r===(null==(s=t.ownerDocument)?void 0:s.body),l=rQ(r);if(n){let t=nu(l);return e.concat(l,l.visualViewport||[],r4(r)?r:[],t&&i?nh(t):[])}return e.concat(r,nh(r,[],i))}function nu(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function nc(t){let e=nl(t),i=parseFloat(e.width)||0,s=parseFloat(e.height)||0,r=r2(t),n=r?t.offsetWidth:i,l=r?t.offsetHeight:s,o=rj(i)!==n||rj(s)!==l;return o&&(i=n,s=l),{width:i,height:s,$:o}}function nd(t){return r1(t)?t:t.contextElement}function nm(t){let e=nd(t);if(!r2(e))return rC(1);let i=e.getBoundingClientRect(),{width:s,height:r,$:n}=nc(e),l=(n?rj(i.width):i.width)/s,o=(n?rj(i.height):i.height)/r;return l&&Number.isFinite(l)||(l=1),o&&Number.isFinite(o)||(o=1),{x:l,y:o}}let np=rC(0);function nf(t){let e=rQ(t);return ns()&&e.visualViewport?{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}:np}function ng(t,e,i,s){var r;void 0===e&&(e=!1),void 0===i&&(i=!1);let n=t.getBoundingClientRect(),l=nd(t),o=rC(1);e&&(s?r1(s)&&(o=nm(s)):o=nm(t));let a=(void 0===(r=i)&&(r=!1),s&&(!r||s===rQ(l))&&r)?nf(l):rC(0),h=(n.left+a.x)/o.x,u=(n.top+a.y)/o.y,c=n.width/o.x,d=n.height/o.y;if(l){let t=rQ(l),e=s&&r1(s)?rQ(s):s,i=t,r=nu(i);for(;r&&s&&e!==i;){let t=nm(r),e=r.getBoundingClientRect(),s=nl(r),n=e.left+(r.clientLeft+parseFloat(s.paddingLeft))*t.x,l=e.top+(r.clientTop+parseFloat(s.paddingTop))*t.y;h*=t.x,u*=t.y,c*=t.x,d*=t.y,h+=n,u+=l,r=nu(i=rQ(r))}}return rW({width:c,height:d,x:h,y:u})}function nv(t,e){let i=no(t).scrollLeft;return e?e.left+i:ng(rZ(t)).left+i}function nx(t,e){let i=t.getBoundingClientRect();return{x:i.left+e.scrollLeft-nv(t,i),y:i.top+e.scrollTop}}let nw=new Set(["absolute","fixed"]);function ny(t,e,i){var s;let r;if("viewport"===e)r=function(t,e){let i=rQ(t),s=rZ(t),r=i.visualViewport,n=s.clientWidth,l=s.clientHeight,o=0,a=0;if(r){n=r.width,l=r.height;let t=ns();(!t||t&&"fixed"===e)&&(o=r.offsetLeft,a=r.offsetTop)}let h=nv(s);if(h<=0){let t=s.ownerDocument,e=t.body,i=getComputedStyle(e),r="CSS1Compat"===t.compatMode&&parseFloat(i.marginLeft)+parseFloat(i.marginRight)||0,l=Math.abs(s.clientWidth-e.clientWidth-r);l<=25&&(n-=l)}else h<=25&&(n+=h);return{width:n,height:l,x:o,y:a}}(t,i);else if("document"===e){let e,i,n,l,o,a,h;s=rZ(t),e=rZ(s),i=no(s),n=s.ownerDocument.body,l=rS(e.scrollWidth,e.clientWidth,n.scrollWidth,n.clientWidth),o=rS(e.scrollHeight,e.clientHeight,n.scrollHeight,n.clientHeight),a=-i.scrollLeft+nv(s),h=-i.scrollTop,"rtl"===nl(n).direction&&(a+=rS(e.clientWidth,n.clientWidth)-l),r={width:l,height:o,x:a,y:h}}else if(r1(e)){let t,s,n,l,o,a;s=(t=ng(e,!0,"fixed"===i)).top+e.clientTop,n=t.left+e.clientLeft,l=r2(e)?nm(e):rC(1),o=e.clientWidth*l.x,a=e.clientHeight*l.y,r={width:o,height:a,x:n*l.x,y:s*l.y}}else{let i=nf(t);r={x:e.x-i.x,y:e.y-i.y,width:e.width,height:e.height}}return rW(r)}function nb(t){return"static"===nl(t).position}function nS(t,e){if(!r2(t)||"fixed"===nl(t).position)return null;if(e)return e(t);let i=t.offsetParent;return rZ(t)===i&&(i=i.ownerDocument.body),i}function nj(t,e){var i;let s=rQ(t);if(r7(t))return s;if(!r2(t)){let e=na(t);for(;e&&!nn(e);){if(r1(e)&&!nb(e))return e;e=na(e)}return s}let r=nS(t,e);for(;r&&(i=r,r6.has(rG(i)))&&nb(r);)r=nS(r,e);return r&&nn(r)&&nb(r)&&!ni(r)?s:r||function(t){let e=na(t);for(;r2(e)&&!nn(e);){if(ni(e))return e;if(r7(e))break;e=na(e)}return null}(t)||s}let nM=async function(t){let e=this.getOffsetParent||nj,i=this.getDimensions,s=await i(t.floating);return{reference:function(t,e,i){let s=r2(e),r=rZ(e),n="fixed"===i,l=ng(t,!0,n,e),o={scrollLeft:0,scrollTop:0},a=rC(0);if(s||!s&&!n)if(("body"!==rG(e)||r4(r))&&(o=no(e)),s){let t=ng(e,!0,n,e);a.x=t.x+e.clientLeft,a.y=t.y+e.clientTop}else r&&(a.x=nv(r));n&&!s&&r&&(a.x=nv(r));let h=!r||s||n?rC(0):nx(r,o);return{x:l.left+o.scrollLeft-a.x-h.x,y:l.top+o.scrollTop-a.y-h.y,width:l.width,height:l.height}}(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:s.width,height:s.height}}},nC={convertOffsetParentRelativeRectToViewportRelativeRect:function(t){let{elements:e,rect:i,offsetParent:s,strategy:r}=t,n="fixed"===r,l=rZ(s),o=!!e&&r7(e.floating);if(s===l||o&&n)return i;let a={scrollLeft:0,scrollTop:0},h=rC(1),u=rC(0),c=r2(s);if((c||!c&&!n)&&(("body"!==rG(s)||r4(l))&&(a=no(s)),r2(s))){let t=ng(s);h=nm(s),u.x=t.x+s.clientLeft,u.y=t.y+s.clientTop}let d=!l||c||n?rC(0):nx(l,a);return{width:i.width*h.x,height:i.height*h.y,x:i.x*h.x-a.scrollLeft*h.x+u.x+d.x,y:i.y*h.y-a.scrollTop*h.y+u.y+d.y}},getDocumentElement:rZ,getClippingRect:function(t){let{element:e,boundary:i,rootBoundary:s,strategy:r}=t,n=[..."clippingAncestors"===i?r7(e)?[]:function(t,e){let i=e.get(t);if(i)return i;let s=nh(t,[],!1).filter(t=>r1(t)&&"body"!==rG(t)),r=null,n="fixed"===nl(t).position,l=n?na(t):t;for(;r1(l)&&!nn(l);){let e=nl(l),i=ni(l);i||"fixed"!==e.position||(r=null),(n?!i&&!r:!i&&"static"===e.position&&!!r&&nw.has(r.position)||r4(l)&&!i&&function t(e,i){let s=na(e);return!(s===i||!r1(s)||nn(s))&&("fixed"===nl(s).position||t(s,i))}(t,l))?s=s.filter(t=>t!==l):r=e,l=na(l)}return e.set(t,s),s}(e,this._c):[].concat(i),s],l=n[0],o=n.reduce((t,i)=>{let s=ny(e,i,r);return t.top=rS(s.top,t.top),t.right=rb(s.right,t.right),t.bottom=rb(s.bottom,t.bottom),t.left=rS(s.left,t.left),t},ny(e,l,r));return{width:o.right-o.left,height:o.bottom-o.top,x:o.left,y:o.top}},getOffsetParent:nj,getElementRects:nM,getClientRects:function(t){return Array.from(t.getClientRects())},getDimensions:function(t){let{width:e,height:i}=nc(t);return{width:e,height:i}},getScale:nm,isElement:r1,isRTL:function(t){return"rtl"===nl(t).direction}};function nN(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}let nE=t=>({name:"arrow",options:t,async fn(e){let{x:i,y:s,placement:r,rects:n,platform:l,elements:o,middlewareData:a}=e,{element:h,padding:u=0}=rP(t,e)||{};if(null==h)return{};let c=r$(u),d={x:i,y:s},m=rR(rI(r)),p=rT(m),f=await l.getDimensions(h),g="y"===m,v=g?"clientHeight":"clientWidth",x=n.reference[p]+n.reference[m]-d[m]-n.floating[p],w=d[m]-n.reference[m],y=await (null==l.getOffsetParent?void 0:l.getOffsetParent(h)),b=y?y[v]:0;b&&await (null==l.isElement?void 0:l.isElement(y))||(b=o.floating[v]||n.floating[p]);let S=b/2-f[p]/2-1,j=rb(c[g?"top":"left"],S),M=rb(c[g?"bottom":"right"],S),C=b-f[p]-M,N=b/2-f[p]/2+(x/2-w/2),E=rS(j,rb(N,C)),P=!a.arrow&&null!=r_(r)&&N!==E&&n.reference[p]/2-(N<j?j:M)-f[p]/2<0,k=P?N<j?N-j:N-C:0;return{[m]:d[m]+k,data:{[m]:E,centerOffset:N-E-k,...P&&{alignmentOffset:k}},reset:P}}});var nP="undefined"!=typeof document?$.useLayoutEffect:function(){};function nk(t,e){let i,s,r;if(t===e)return!0;if(typeof t!=typeof e)return!1;if("function"==typeof t&&t.toString()===e.toString())return!0;if(t&&e&&"object"==typeof t){if(Array.isArray(t)){if((i=t.length)!==e.length)return!1;for(s=i;0!=s--;)if(!nk(t[s],e[s]))return!1;return!0}if((i=(r=Object.keys(t)).length)!==Object.keys(e).length)return!1;for(s=i;0!=s--;)if(!({}).hasOwnProperty.call(e,r[s]))return!1;for(s=i;0!=s--;){let i=r[s];if(("_owner"!==i||!t.$$typeof)&&!nk(t[i],e[i]))return!1}return!0}return t!=t&&e!=e}function n_(t){return"undefined"==typeof window?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function nR(t,e){let i=n_(t);return Math.round(e*i)/i}function nT(t){let e=$.useRef(t);return nP(()=>{e.current=t}),e}var nL=$.forwardRef((t,e)=>{let{children:i,width:s=10,height:r=5,...n}=t;return(0,L.jsx)(s4.svg,{...n,ref:e,width:s,height:r,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?i:(0,L.jsx)("polygon",{points:"0,0 30,0 15,10"})})});nL.displayName="Arrow";var nI="Popper",[nF,nz]=s0(nI),[nA,nD]=nF(nI),nO=t=>{let{__scopePopper:e,children:i}=t,[s,r]=$.useState(null);return(0,L.jsx)(nA,{scope:e,anchor:s,onAnchorChange:r,children:i})};nO.displayName=nI;var nB="PopperAnchor",n$=$.forwardRef((t,e)=>{let{__scopePopper:i,virtualRef:s,...r}=t,n=nD(nB,i),l=$.useRef(null),o=(0,s1.useComposedRefs)(e,l);return $.useEffect(()=>{n.onAnchorChange(s?.current||l.current)}),s?null:(0,L.jsx)(s4.div,{...r,ref:o})});n$.displayName=nB;var nW="PopperContent",[nK,nV]=nF(nW),nU=$.forwardRef((t,e)=>{var i,s,r,n,l,o,a,h,u,c,d,m,p,f,g,v,x,w,y,b,S;let{__scopePopper:j,side:M="bottom",sideOffset:C=0,align:N="center",alignOffset:E=0,arrowPadding:P=0,avoidCollisions:k=!0,collisionBoundary:_=[],collisionPadding:R=0,sticky:T="partial",hideWhenDetached:I=!1,updatePositionStrategy:F="optimized",onPlaced:z,...A}=t,D=nD(nW,j),[O,B]=$.useState(null),W=(0,s1.useComposedRefs)(e,t=>B(t)),[K,V]=$.useState(null),U=function(t){let[e,i]=$.useState(void 0);return rg(()=>{if(t){i({width:t.offsetWidth,height:t.offsetHeight});let e=new ResizeObserver(e=>{let s,r;if(!Array.isArray(e)||!e.length)return;let n=e[0];if("borderBoxSize"in n){let t=n.borderBoxSize,e=Array.isArray(t)?t[0]:t;s=e.inlineSize,r=e.blockSize}else s=t.offsetWidth,r=t.offsetHeight;i({width:s,height:r})});return e.observe(t,{box:"border-box"}),()=>e.unobserve(t)}i(void 0)},[t]),e}(K),H=U?.width??0,J=U?.height??0,q="number"==typeof R?R:{top:0,right:0,bottom:0,left:0,...R},Y=Array.isArray(_)?_:[_],X=Y.length>0,G={padding:q,boundary:Y.filter(nY),altBoundary:X},{refs:Q,floatingStyles:Z,placement:tt,isPositioned:te,middlewareData:ti}=function(t){void 0===t&&(t={});let{placement:e="bottom",strategy:i="absolute",middleware:s=[],platform:r,elements:{reference:n,floating:l}={},transform:o=!0,whileElementsMounted:a,open:h}=t,[u,c]=$.useState({x:0,y:0,strategy:i,placement:e,middlewareData:{},isPositioned:!1}),[d,m]=$.useState(s);nk(d,s)||m(s);let[p,f]=$.useState(null),[g,v]=$.useState(null),x=$.useCallback(t=>{t!==S.current&&(S.current=t,f(t))},[]),w=$.useCallback(t=>{t!==j.current&&(j.current=t,v(t))},[]),y=n||p,b=l||g,S=$.useRef(null),j=$.useRef(null),M=$.useRef(u),C=null!=a,N=nT(a),E=nT(r),P=nT(h),k=$.useCallback(()=>{var t,s;let r,n,l;if(!S.current||!j.current)return;let o={placement:e,strategy:i,middleware:d};E.current&&(o.platform=E.current),(t=S.current,s=j.current,r=new Map,l={...(n={platform:nC,...o}).platform,_c:r},rV(t,s,{...n,platform:l})).then(t=>{let e={...t,isPositioned:!1!==P.current};_.current&&!nk(M.current,e)&&(M.current=e,sG.flushSync(()=>{c(e)}))})},[d,e,i,E,P]);nP(()=>{!1===h&&M.current.isPositioned&&(M.current.isPositioned=!1,c(t=>({...t,isPositioned:!1})))},[h]);let _=$.useRef(!1);nP(()=>(_.current=!0,()=>{_.current=!1}),[]),nP(()=>{if(y&&(S.current=y),b&&(j.current=b),y&&b){if(N.current)return N.current(y,b,k);k()}},[y,b,k,N,C]);let R=$.useMemo(()=>({reference:S,floating:j,setReference:x,setFloating:w}),[x,w]),T=$.useMemo(()=>({reference:y,floating:b}),[y,b]),L=$.useMemo(()=>{let t={position:i,left:0,top:0};if(!T.floating)return t;let e=nR(T.floating,u.x),s=nR(T.floating,u.y);return o?{...t,transform:"translate("+e+"px, "+s+"px)",...n_(T.floating)>=1.5&&{willChange:"transform"}}:{position:i,left:e,top:s}},[i,o,T.floating,u.x,u.y]);return $.useMemo(()=>({...u,update:k,refs:R,elements:T,floatingStyles:L}),[u,k,R,T,L])}({strategy:"fixed",placement:M+("center"!==N?"-"+N:""),whileElementsMounted:(...t)=>(function(t,e,i,s){let r;void 0===s&&(s={});let{ancestorScroll:n=!0,ancestorResize:l=!0,elementResize:o="function"==typeof ResizeObserver,layoutShift:a="function"==typeof IntersectionObserver,animationFrame:h=!1}=s,u=nd(t),c=n||l?[...u?nh(u):[],...nh(e)]:[];c.forEach(t=>{n&&t.addEventListener("scroll",i,{passive:!0}),l&&t.addEventListener("resize",i)});let d=u&&a?function(t,e){let i,s=null,r=rZ(t);function n(){var t;clearTimeout(i),null==(t=s)||t.disconnect(),s=null}return!function l(o,a){void 0===o&&(o=!1),void 0===a&&(a=1),n();let h=t.getBoundingClientRect(),{left:u,top:c,width:d,height:m}=h;if(o||e(),!d||!m)return;let p={rootMargin:-rM(c)+"px "+-rM(r.clientWidth-(u+d))+"px "+-rM(r.clientHeight-(c+m))+"px "+-rM(u)+"px",threshold:rS(0,rb(1,a))||1},f=!0;function g(e){let s=e[0].intersectionRatio;if(s!==a){if(!f)return l();s?l(!1,s):i=setTimeout(()=>{l(!1,1e-7)},1e3)}1!==s||nN(h,t.getBoundingClientRect())||l(),f=!1}try{s=new IntersectionObserver(g,{...p,root:r.ownerDocument})}catch(t){s=new IntersectionObserver(g,p)}s.observe(t)}(!0),n}(u,i):null,m=-1,p=null;o&&(p=new ResizeObserver(t=>{let[s]=t;s&&s.target===u&&p&&(p.unobserve(e),cancelAnimationFrame(m),m=requestAnimationFrame(()=>{var t;null==(t=p)||t.observe(e)})),i()}),u&&!h&&p.observe(u),p.observe(e));let f=h?ng(t):null;return h&&function e(){let s=ng(t);f&&!nN(f,s)&&i(),f=s,r=requestAnimationFrame(e)}(),i(),()=>{var t;c.forEach(t=>{n&&t.removeEventListener("scroll",i),l&&t.removeEventListener("resize",i)}),null==d||d(),null==(t=p)||t.disconnect(),p=null,h&&cancelAnimationFrame(r)}})(...t,{animationFrame:"always"===F}),elements:{reference:D.anchor},middleware:[{...{name:"offset",options:r=i={mainAxis:C+J,alignmentAxis:E},async fn(t){var e,i;let{x:s,y:n,placement:l,middlewareData:o}=t,a=await rY(t,r);return l===(null==(e=o.offset)?void 0:e.placement)&&null!=(i=o.arrow)&&i.alignmentOffset?{}:{x:s+a.x,y:n+a.y,data:{...a,placement:l}}}},options:[i,s]},k&&{...{name:"shift",options:u=a={mainAxis:!0,crossAxis:!1,limiter:"partial"===T?{...(void 0===(o=n)&&(o={}),{options:o,fn(t){let{x:e,y:i,placement:s,rects:r,middlewareData:n}=t,{offset:l=0,mainAxis:a=!0,crossAxis:h=!0}=rP(o,t),u={x:e,y:i},c=rI(s),d=rR(c),m=u[d],p=u[c],f=rP(l,t),g="number"==typeof f?{mainAxis:f,crossAxis:0}:{mainAxis:0,crossAxis:0,...f};if(a){let t="y"===d?"height":"width",e=r.reference[d]-r.floating[t]+g.mainAxis,i=r.reference[d]+r.reference[t]-g.mainAxis;m<e?m=e:m>i&&(m=i)}if(h){var v,x;let t="y"===d?"width":"height",e=rq.has(rk(s)),i=r.reference[c]-r.floating[t]+(e&&(null==(v=n.offset)?void 0:v[c])||0)+(e?0:g.crossAxis),l=r.reference[c]+r.reference[t]+(e?0:(null==(x=n.offset)?void 0:x[c])||0)-(e?g.crossAxis:0);p<i?p=i:p>l&&(p=l)}return{[d]:m,[c]:p}}}),options:[n,l]}:void 0,...G},async fn(t){let{x:e,y:i,placement:s}=t,{mainAxis:r=!0,crossAxis:n=!1,limiter:l={fn:t=>{let{x:e,y:i}=t;return{x:e,y:i}}},...o}=rP(u,t),a={x:e,y:i},h=await rU(t,o),c=rI(rk(s)),d=rR(c),m=a[d],p=a[c];if(r){let t="y"===d?"top":"left",e="y"===d?"bottom":"right",i=m+h[t],s=m-h[e];m=rS(i,rb(m,s))}if(n){let t="y"===c?"top":"left",e="y"===c?"bottom":"right",i=p+h[t],s=p-h[e];p=rS(i,rb(p,s))}let f=l.fn({...t,[d]:m,[c]:p});return{...f,data:{x:f.x-e,y:f.y-i,enabled:{[d]:r,[c]:n}}}}},options:[a,h]},k&&{...{name:"flip",options:m=c={...G},async fn(t){var e,i,s,r,n,l,o,a;let h,u,c,{placement:d,middlewareData:p,rects:f,initialPlacement:g,platform:v,elements:x}=t,{mainAxis:w=!0,crossAxis:y=!0,fallbackPlacements:b,fallbackStrategy:S="bestFit",fallbackAxisSideDirection:j="none",flipAlignment:M=!0,...C}=rP(m,t);if(null!=(e=p.arrow)&&e.alignmentOffset)return{};let N=rk(d),E=rI(g),P=rk(g)===g,k=await (null==v.isRTL?void 0:v.isRTL(x.floating)),_=b||(P||!M?[rB(g)]:(h=rB(g),[rF(g),h,rF(h)])),R="none"!==j;!b&&R&&_.push(...(u=r_(g),c=function(t,e,i){switch(t){case"top":case"bottom":if(i)return e?rA:rz;return e?rz:rA;case"left":case"right":return e?rD:rO;default:return[]}}(rk(g),"start"===j,k),u&&(c=c.map(t=>t+"-"+u),M&&(c=c.concat(c.map(rF)))),c));let T=[g,..._],L=await rU(t,C),I=[],F=(null==(i=p.flip)?void 0:i.overflows)||[];if(w&&I.push(L[N]),y){let t,e,i,s,r=(l=d,o=f,void 0===(a=k)&&(a=!1),t=r_(l),i=rT(e=rR(rI(l))),s="x"===e?t===(a?"end":"start")?"right":"left":"start"===t?"bottom":"top",o.reference[i]>o.floating[i]&&(s=rB(s)),[s,rB(s)]);I.push(L[r[0]],L[r[1]])}if(F=[...F,{placement:d,overflows:I}],!I.every(t=>t<=0)){let t=((null==(s=p.flip)?void 0:s.index)||0)+1,e=T[t];if(e&&("alignment"!==y||E===rI(e)||F.every(t=>rI(t.placement)!==E||t.overflows[0]>0)))return{data:{index:t,overflows:F},reset:{placement:e}};let i=null==(r=F.filter(t=>t.overflows[0]<=0).sort((t,e)=>t.overflows[1]-e.overflows[1])[0])?void 0:r.placement;if(!i)switch(S){case"bestFit":{let t=null==(n=F.filter(t=>{if(R){let e=rI(t.placement);return e===E||"y"===e}return!0}).map(t=>[t.placement,t.overflows.filter(t=>t>0).reduce((t,e)=>t+e,0)]).sort((t,e)=>t[1]-e[1])[0])?void 0:n[0];t&&(i=t);break}case"initialPlacement":i=g}if(d!==i)return{reset:{placement:i}}}return{}}},options:[c,d]},{...{name:"size",options:g=p={...G,apply:({elements:t,rects:e,availableWidth:i,availableHeight:s})=>{let{width:r,height:n}=e.reference,l=t.floating.style;l.setProperty("--radix-popper-available-width",`${i}px`),l.setProperty("--radix-popper-available-height",`${s}px`),l.setProperty("--radix-popper-anchor-width",`${r}px`),l.setProperty("--radix-popper-anchor-height",`${n}px`)}},async fn(t){var e,i;let s,r,{placement:n,rects:l,platform:o,elements:a}=t,{apply:h=()=>{},...u}=rP(g,t),c=await rU(t,u),d=rk(n),m=r_(n),p="y"===rI(n),{width:f,height:v}=l.floating;"top"===d||"bottom"===d?(s=d,r=m===(await (null==o.isRTL?void 0:o.isRTL(a.floating))?"start":"end")?"left":"right"):(r=d,s="end"===m?"top":"bottom");let x=v-c.top-c.bottom,w=f-c.left-c.right,y=rb(v-c[s],x),b=rb(f-c[r],w),S=!t.middlewareData.shift,j=y,M=b;if(null!=(e=t.middlewareData.shift)&&e.enabled.x&&(M=w),null!=(i=t.middlewareData.shift)&&i.enabled.y&&(j=x),S&&!m){let t=rS(c.left,0),e=rS(c.right,0),i=rS(c.top,0),s=rS(c.bottom,0);p?M=f-2*(0!==t||0!==e?t+e:rS(c.left,c.right)):j=v-2*(0!==i||0!==s?i+s:rS(c.top,c.bottom))}await h({...t,availableWidth:M,availableHeight:j});let C=await o.getDimensions(a.floating);return f!==C.width||v!==C.height?{reset:{rects:!0}}:{}}},options:[p,f]},K&&{...{name:"arrow",options:w=v={element:K,padding:P},fn(t){let{element:e,padding:i}="function"==typeof w?w(t):w;return e&&({}).hasOwnProperty.call(e,"current")?null!=e.current?nE({element:e.current,padding:i}).fn(t):{}:e?nE({element:e,padding:i}).fn(t):{}}},options:[v,x]},nX({arrowWidth:H,arrowHeight:J}),I&&{...{name:"hide",options:S=y={strategy:"referenceHidden",...G},async fn(t){let{rects:e}=t,{strategy:i="referenceHidden",...s}=rP(S,t);switch(i){case"referenceHidden":{let i=rH(await rU(t,{...s,elementContext:"reference"}),e.reference);return{data:{referenceHiddenOffsets:i,referenceHidden:rJ(i)}}}case"escaped":{let i=rH(await rU(t,{...s,altBoundary:!0}),e.floating);return{data:{escapedOffsets:i,escaped:rJ(i)}}}default:return{}}}},options:[y,b]}]}),[ts,tr]=nG(tt),tn=s9(z);rg(()=>{te&&tn?.()},[te,tn]);let tl=ti.arrow?.x,to=ti.arrow?.y,ta=ti.arrow?.centerOffset!==0,[th,tu]=$.useState();return rg(()=>{O&&tu(window.getComputedStyle(O).zIndex)},[O]),(0,L.jsx)("div",{ref:Q.setFloating,"data-radix-popper-content-wrapper":"",style:{...Z,transform:te?Z.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:th,"--radix-popper-transform-origin":[ti.transformOrigin?.x,ti.transformOrigin?.y].join(" "),...ti.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:(0,L.jsx)(nK,{scope:j,placedSide:ts,onArrowChange:V,arrowX:tl,arrowY:to,shouldHideArrow:ta,children:(0,L.jsx)(s4.div,{"data-side":ts,"data-align":tr,...A,ref:W,style:{...A.style,animation:te?void 0:"none"}})})})});nU.displayName=nW;var nH="PopperArrow",nJ={top:"bottom",right:"left",bottom:"top",left:"right"},nq=$.forwardRef(function(t,e){let{__scopePopper:i,...s}=t,r=nV(nH,i),n=nJ[r.placedSide];return(0,L.jsx)("span",{ref:r.onArrowChange,style:{position:"absolute",left:r.arrowX,top:r.arrowY,[n]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[r.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[r.placedSide],visibility:r.shouldHideArrow?"hidden":void 0},children:(0,L.jsx)(nL,{...s,ref:e,style:{...s.style,display:"block"}})})});function nY(t){return null!==t}nq.displayName=nH;var nX=t=>({name:"transformOrigin",options:t,fn(e){let{placement:i,rects:s,middlewareData:r}=e,n=r.arrow?.centerOffset!==0,l=n?0:t.arrowWidth,o=n?0:t.arrowHeight,[a,h]=nG(i),u={start:"0%",center:"50%",end:"100%"}[h],c=(r.arrow?.x??0)+l/2,d=(r.arrow?.y??0)+o/2,m="",p="";return"bottom"===a?(m=n?u:`${c}px`,p=`${-o}px`):"top"===a?(m=n?u:`${c}px`,p=`${s.floating.height+o}px`):"right"===a?(m=`${-o}px`,p=n?u:`${d}px`):"left"===a&&(m=`${s.floating.width+o}px`,p=n?u:`${d}px`),{data:{x:m,y:p}}}});function nG(t){let[e,i="center"]=t.split("-");return[e,i]}var nQ=$.forwardRef((t,e)=>{let{container:i,...s}=t,[r,n]=$.useState(!1);rg(()=>n(!0),[]);let l=i||r&&globalThis?.document?.body;return l?sG.default.createPortal((0,L.jsx)(s4.div,{...s,ref:e}),l):null});function nZ({prop:t,defaultProp:e,onChange:i=()=>{}}){let[s,r]=function({defaultProp:t,onChange:e}){let i=$.useState(t),[s]=i,r=$.useRef(s),n=s9(e);return $.useEffect(()=>{r.current!==s&&(n(s),r.current=s)},[s,r,n]),i}({defaultProp:e,onChange:i}),n=void 0!==t,l=n?t:s,o=s9(i);return[l,$.useCallback(e=>{if(n){let i="function"==typeof e?e(t):e;i!==t&&o(i)}else r(e)},[n,t,r,o])]}nQ.displayName="Portal";var n0=$.forwardRef((t,e)=>(0,L.jsx)(s4.span,{...t,ref:e,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...t.style}}));n0.displayName="VisuallyHidden";var n1=new WeakMap,n2=new WeakMap,n3={},n5=0,n4=function(t){return t&&(t.host||n4(t.parentNode))},n6=function(t,e,i,s){var r=(Array.isArray(t)?t:[t]).map(function(t){if(e.contains(t))return t;var i=n4(t);return i&&e.contains(i)?i:(console.error("aria-hidden",t,"in not contained inside",e,". Doing nothing"),null)}).filter(function(t){return!!t});n3[i]||(n3[i]=new WeakMap);var n=n3[i],l=[],o=new Set,a=new Set(r),h=function(t){!t||o.has(t)||(o.add(t),h(t.parentNode))};r.forEach(h);var u=function(t){!t||a.has(t)||Array.prototype.forEach.call(t.children,function(t){if(o.has(t))u(t);else try{var e=t.getAttribute(s),r=null!==e&&"false"!==e,a=(n1.get(t)||0)+1,h=(n.get(t)||0)+1;n1.set(t,a),n.set(t,h),l.push(t),1===a&&r&&n2.set(t,!0),1===h&&t.setAttribute(i,"true"),r||t.setAttribute(s,"true")}catch(e){console.error("aria-hidden: cannot operate on ",t,e)}})};return u(e),o.clear(),n5++,function(){l.forEach(function(t){var e=n1.get(t)-1,r=n.get(t)-1;n1.set(t,e),n.set(t,r),e||(n2.has(t)||t.removeAttribute(s),n2.delete(t)),r||t.removeAttribute(i)}),--n5||(n1=new WeakMap,n1=new WeakMap,n2=new WeakMap,n3={})}},n9=function(t,e,i){void 0===i&&(i="data-aria-hidden");var s=Array.from(Array.isArray(t)?t:[t]),r=e||("undefined"==typeof document?null:(Array.isArray(t)?t[0]:t).ownerDocument.body);return r?(s.push.apply(s,Array.from(r.querySelectorAll("[aria-live], script"))),n6(s,r,i,"aria-hidden")):function(){return null}},n7=function(){return(n7=Object.assign||function(t){for(var e,i=1,s=arguments.length;i<s;i++)for(var r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function n8(t,e){var i={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&0>e.indexOf(s)&&(i[s]=t[s]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,s=Object.getOwnPropertySymbols(t);r<s.length;r++)0>e.indexOf(s[r])&&Object.prototype.propertyIsEnumerable.call(t,s[r])&&(i[s[r]]=t[s[r]]);return i}var lt=("function"==typeof SuppressedError&&SuppressedError,"right-scroll-bar-position"),le="width-before-scroll-bar";function li(t,e){return"function"==typeof t?t(e):t&&(t.current=e),t}var ls="undefined"!=typeof window?$.useLayoutEffect:$.useEffect,lr=new WeakMap,ln=(void 0===p&&(p={}),(void 0===f&&(f=function(t){return t}),g=[],v=!1,x={read:function(){if(v)throw Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return g.length?g[g.length-1]:null},useMedium:function(t){var e=f(t,v);return g.push(e),function(){g=g.filter(function(t){return t!==e})}},assignSyncMedium:function(t){for(v=!0;g.length;){var e=g;g=[],e.forEach(t)}g={push:function(e){return t(e)},filter:function(){return g}}},assignMedium:function(t){v=!0;var e=[];if(g.length){var i=g;g=[],i.forEach(t),e=g}var s=function(){var i=e;e=[],i.forEach(t)},r=function(){return Promise.resolve().then(s)};r(),g={push:function(t){e.push(t),r()},filter:function(t){return e=e.filter(t),g}}}}).options=n7({async:!0,ssr:!1},p),x),ll=function(){},lo=$.forwardRef(function(t,e){var i,s,r,n,l=$.useRef(null),o=$.useState({onScrollCapture:ll,onWheelCapture:ll,onTouchMoveCapture:ll}),a=o[0],h=o[1],u=t.forwardProps,c=t.children,d=t.className,m=t.removeScrollBar,p=t.enabled,f=t.shards,g=t.sideCar,v=t.noRelative,x=t.noIsolation,w=t.inert,y=t.allowPinchZoom,b=t.as,S=t.gapMode,j=n8(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),M=(i=[l,e],s=function(t){return i.forEach(function(e){return li(e,t)})},(r=(0,$.useState)(function(){return{value:null,callback:s,facade:{get current(){return r.value},set current(value){var t=r.value;t!==value&&(r.value=value,r.callback(value,t))}}}})[0]).callback=s,n=r.facade,ls(function(){var t=lr.get(n);if(t){var e=new Set(t),s=new Set(i),r=n.current;e.forEach(function(t){s.has(t)||li(t,null)}),s.forEach(function(t){e.has(t)||li(t,r)})}lr.set(n,i)},[i]),n),C=n7(n7({},j),a);return $.createElement($.Fragment,null,p&&$.createElement(g,{sideCar:ln,removeScrollBar:m,shards:f,noRelative:v,noIsolation:x,inert:w,setCallbacks:h,allowPinchZoom:!!y,lockRef:l,gapMode:S}),u?$.cloneElement($.Children.only(c),n7(n7({},C),{ref:M})):$.createElement(void 0===b?"div":b,n7({},C,{className:d,ref:M}),c))});lo.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1},lo.classNames={fullWidth:le,zeroRight:lt};var la=function(t){var e=t.sideCar,i=n8(t,["sideCar"]);if(!e)throw Error("Sidecar: please provide `sideCar` property to import the right car");var s=e.read();if(!s)throw Error("Sidecar medium not found");return $.createElement(s,n7({},i))};la.isSideCarExport=!0;var lh=function(){var t=0,e=null;return{add:function(i){if(0==t&&(e=function(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=T||("undefined"!=typeof __webpack_nonce__?__webpack_nonce__:void 0);return e&&t.setAttribute("nonce",e),t}())){var s,r;(s=e).styleSheet?s.styleSheet.cssText=i:s.appendChild(document.createTextNode(i)),r=e,(document.head||document.getElementsByTagName("head")[0]).appendChild(r)}t++},remove:function(){--t||!e||(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},lu=function(){var t=lh();return function(e,i){$.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&i])}},lc=function(){var t=lu();return function(e){return t(e.styles,e.dynamic),null}},ld={left:0,top:0,right:0,gap:0},lm=function(t){return parseInt(t||"",10)||0},lp=function(t){var e=window.getComputedStyle(document.body),i=e["padding"===t?"paddingLeft":"marginLeft"],s=e["padding"===t?"paddingTop":"marginTop"],r=e["padding"===t?"paddingRight":"marginRight"];return[lm(i),lm(s),lm(r)]},lf=function(t){if(void 0===t&&(t="margin"),"undefined"==typeof window)return ld;var e=lp(t),i=document.documentElement.clientWidth,s=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,s-i+e[2]-e[0])}},lg=lc(),lv="data-scroll-locked",lx=function(t,e,i,s){var r=t.left,n=t.top,l=t.right,o=t.gap;return void 0===i&&(i="margin"),"\n  .".concat("with-scroll-bars-hidden"," {\n   overflow: hidden ").concat(s,";\n   padding-right: ").concat(o,"px ").concat(s,";\n  }\n  body[").concat(lv,"] {\n    overflow: hidden ").concat(s,";\n    overscroll-behavior: contain;\n    ").concat([e&&"position: relative ".concat(s,";"),"margin"===i&&"\n    padding-left: ".concat(r,"px;\n    padding-top: ").concat(n,"px;\n    padding-right: ").concat(l,"px;\n    margin-left:0;\n    margin-top:0;\n    margin-right: ").concat(o,"px ").concat(s,";\n    "),"padding"===i&&"padding-right: ".concat(o,"px ").concat(s,";")].filter(Boolean).join(""),"\n  }\n  \n  .").concat(lt," {\n    right: ").concat(o,"px ").concat(s,";\n  }\n  \n  .").concat(le," {\n    margin-right: ").concat(o,"px ").concat(s,";\n  }\n  \n  .").concat(lt," .").concat(lt," {\n    right: 0 ").concat(s,";\n  }\n  \n  .").concat(le," .").concat(le," {\n    margin-right: 0 ").concat(s,";\n  }\n  \n  body[").concat(lv,"] {\n    ").concat("--removed-body-scroll-bar-size",": ").concat(o,"px;\n  }\n")},lw=function(){var t=parseInt(document.body.getAttribute(lv)||"0",10);return isFinite(t)?t:0},ly=function(){$.useEffect(function(){return document.body.setAttribute(lv,(lw()+1).toString()),function(){var t=lw()-1;t<=0?document.body.removeAttribute(lv):document.body.setAttribute(lv,t.toString())}},[])},lb=function(t){var e=t.noRelative,i=t.noImportant,s=t.gapMode,r=void 0===s?"margin":s;ly();var n=$.useMemo(function(){return lf(r)},[r]);return $.createElement(lg,{styles:lx(n,!e,r,i?"":"!important")})},lS=!1;if("undefined"!=typeof window)try{var lj=Object.defineProperty({},"passive",{get:function(){return lS=!0,!0}});window.addEventListener("test",lj,lj),window.removeEventListener("test",lj,lj)}catch(t){lS=!1}var lM=!!lS&&{passive:!1},lC=function(t,e){if(!(t instanceof Element))return!1;var i=window.getComputedStyle(t);return"hidden"!==i[e]&&(i.overflowY!==i.overflowX||"TEXTAREA"===t.tagName||"visible"!==i[e])},lN=function(t,e){var i=e.ownerDocument,s=e;do{if("undefined"!=typeof ShadowRoot&&s instanceof ShadowRoot&&(s=s.host),lE(t,s)){var r=lP(t,s);if(r[1]>r[2])return!0}s=s.parentNode}while(s&&s!==i.body)return!1},lE=function(t,e){return"v"===t?lC(e,"overflowY"):lC(e,"overflowX")},lP=function(t,e){return"v"===t?[e.scrollTop,e.scrollHeight,e.clientHeight]:[e.scrollLeft,e.scrollWidth,e.clientWidth]},lk=function(t,e,i,s,r){var n,l=(n=window.getComputedStyle(e).direction,"h"===t&&"rtl"===n?-1:1),o=l*s,a=i.target,h=e.contains(a),u=!1,c=o>0,d=0,m=0;do{if(!a)break;var p=lP(t,a),f=p[0],g=p[1]-p[2]-l*f;(f||g)&&lE(t,a)&&(d+=g,m+=f);var v=a.parentNode;a=v&&v.nodeType===Node.DOCUMENT_FRAGMENT_NODE?v.host:v}while(!h&&a!==document.body||h&&(e.contains(a)||e===a))return c&&(r&&1>Math.abs(d)||!r&&o>d)?u=!0:!c&&(r&&1>Math.abs(m)||!r&&-o>m)&&(u=!0),u},l_=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},lR=function(t){return[t.deltaX,t.deltaY]},lT=function(t){return t&&"current"in t?t.current:t},lL=0,lI=[];let lF=(w=function(t){var e=$.useRef([]),i=$.useRef([0,0]),s=$.useRef(),r=$.useState(lL++)[0],n=$.useState(lc)[0],l=$.useRef(t);$.useEffect(function(){l.current=t},[t]),$.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(r));var e=(function(t,e,i){if(i||2==arguments.length)for(var s,r=0,n=e.length;r<n;r++)!s&&r in e||(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return t.concat(s||Array.prototype.slice.call(e))})([t.lockRef.current],(t.shards||[]).map(lT),!0).filter(Boolean);return e.forEach(function(t){return t.classList.add("allow-interactivity-".concat(r))}),function(){document.body.classList.remove("block-interactivity-".concat(r)),e.forEach(function(t){return t.classList.remove("allow-interactivity-".concat(r))})}}},[t.inert,t.lockRef.current,t.shards]);var o=$.useCallback(function(t,e){if("touches"in t&&2===t.touches.length||"wheel"===t.type&&t.ctrlKey)return!l.current.allowPinchZoom;var r,n=l_(t),o=i.current,a="deltaX"in t?t.deltaX:o[0]-n[0],h="deltaY"in t?t.deltaY:o[1]-n[1],u=t.target,c=Math.abs(a)>Math.abs(h)?"h":"v";if("touches"in t&&"h"===c&&"range"===u.type)return!1;var d=window.getSelection(),m=d&&d.anchorNode;if(m&&(m===u||m.contains(u)))return!1;var p=lN(c,u);if(!p)return!0;if(p?r=c:(r="v"===c?"h":"v",p=lN(c,u)),!p)return!1;if(!s.current&&"changedTouches"in t&&(a||h)&&(s.current=r),!r)return!0;var f=s.current||r;return lk(f,e,t,"h"===f?a:h,!0)},[]),a=$.useCallback(function(t){if(lI.length&&lI[lI.length-1]===n){var i="deltaY"in t?lR(t):l_(t),s=e.current.filter(function(e){var s;return e.name===t.type&&(e.target===t.target||t.target===e.shadowParent)&&(s=e.delta,s[0]===i[0]&&s[1]===i[1])})[0];if(s&&s.should){t.cancelable&&t.preventDefault();return}if(!s){var r=(l.current.shards||[]).map(lT).filter(Boolean).filter(function(e){return e.contains(t.target)});(r.length>0?o(t,r[0]):!l.current.noIsolation)&&t.cancelable&&t.preventDefault()}}},[]),h=$.useCallback(function(t,i,s,r){var n={name:t,delta:i,target:s,should:r,shadowParent:function(t){for(var e=null;null!==t;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}(s)};e.current.push(n),setTimeout(function(){e.current=e.current.filter(function(t){return t!==n})},1)},[]),u=$.useCallback(function(t){i.current=l_(t),s.current=void 0},[]),c=$.useCallback(function(e){h(e.type,lR(e),e.target,o(e,t.lockRef.current))},[]),d=$.useCallback(function(e){h(e.type,l_(e),e.target,o(e,t.lockRef.current))},[]);$.useEffect(function(){return lI.push(n),t.setCallbacks({onScrollCapture:c,onWheelCapture:c,onTouchMoveCapture:d}),document.addEventListener("wheel",a,lM),document.addEventListener("touchmove",a,lM),document.addEventListener("touchstart",u,lM),function(){lI=lI.filter(function(t){return t!==n}),document.removeEventListener("wheel",a,lM),document.removeEventListener("touchmove",a,lM),document.removeEventListener("touchstart",u,lM)}},[]);var m=t.removeScrollBar,p=t.inert;return $.createElement($.Fragment,null,p?$.createElement(n,{styles:"\n  .block-interactivity-".concat(r," {pointer-events: none;}\n  .allow-interactivity-").concat(r," {pointer-events: all;}\n")}):null,m?$.createElement(lb,{noRelative:t.noRelative,gapMode:t.gapMode}):null)},ln.useMedium(w),la);var lz=$.forwardRef(function(t,e){return $.createElement(lo,n7({},t,{ref:e,sideCar:lF}))});lz.classNames=lo.classNames;var lA=[" ","Enter","ArrowUp","ArrowDown"],lD=[" ","Enter"],lO="Select",[lB,l$,lW]=s3(lO),[lK,lV]=s0(lO,[lW,nz]),lU=nz(),[lH,lJ]=lK(lO),[lq,lY]=lK(lO),lX=t=>{let e,{__scopeSelect:i,children:s,open:r,defaultOpen:n,onOpenChange:l,value:o,defaultValue:a,onValueChange:h,dir:u,name:c,autoComplete:d,disabled:m,required:p,form:f}=t,g=lU(i),[v,x]=$.useState(null),[w,y]=$.useState(null),[b,S]=$.useState(!1),j=(e=$.useContext(s5),u||e||"ltr"),[M=!1,C]=nZ({prop:r,defaultProp:n,onChange:l}),[N,E]=nZ({prop:o,defaultProp:a,onChange:h}),P=$.useRef(null),k=!v||f||!!v.closest("form"),[_,R]=$.useState(new Set),T=Array.from(_).map(t=>t.props.value).join(";");return(0,L.jsx)(nO,{...g,children:(0,L.jsxs)(lH,{required:p,scope:i,trigger:v,onTriggerChange:x,valueNode:w,onValueNodeChange:y,valueNodeHasChildren:b,onValueNodeHasChildrenChange:S,contentId:rw(),value:N,onValueChange:E,open:M,onOpenChange:C,dir:j,triggerPointerDownPosRef:P,disabled:m,children:[(0,L.jsx)(lB.Provider,{scope:i,children:(0,L.jsx)(lq,{scope:t.__scopeSelect,onNativeOptionAdd:$.useCallback(t=>{R(e=>new Set(e).add(t))},[]),onNativeOptionRemove:$.useCallback(t=>{R(e=>{let i=new Set(e);return i.delete(t),i})},[]),children:s})}),k?(0,L.jsxs)(oj,{"aria-hidden":!0,required:p,tabIndex:-1,name:c,autoComplete:d,value:N,onChange:t=>E(t.target.value),disabled:m,form:f,children:[void 0===N?(0,L.jsx)("option",{value:""}):null,Array.from(_)]},T):null]})})};lX.displayName=lO;var lG="SelectTrigger",lQ=$.forwardRef((t,e)=>{let{__scopeSelect:i,disabled:s=!1,...r}=t,n=lU(i),l=lJ(lG,i),o=l.disabled||s,a=(0,s1.useComposedRefs)(e,l.onTriggerChange),h=l$(i),u=$.useRef("touch"),[c,d,m]=oM(t=>{let e=h().filter(t=>!t.disabled),i=e.find(t=>t.value===l.value),s=oC(e,t,i);void 0!==s&&l.onValueChange(s.value)}),p=t=>{o||(l.onOpenChange(!0),m()),t&&(l.triggerPointerDownPosRef.current={x:Math.round(t.pageX),y:Math.round(t.pageY)})};return(0,L.jsx)(n$,{asChild:!0,...n,children:(0,L.jsx)(s4.button,{type:"button",role:"combobox","aria-controls":l.contentId,"aria-expanded":l.open,"aria-required":l.required,"aria-autocomplete":"none",dir:l.dir,"data-state":l.open?"open":"closed",disabled:o,"data-disabled":o?"":void 0,"data-placeholder":oS(l.value)?"":void 0,...r,ref:a,onClick:sZ(r.onClick,t=>{t.currentTarget.focus(),"mouse"!==u.current&&p(t)}),onPointerDown:sZ(r.onPointerDown,t=>{u.current=t.pointerType;let e=t.target;e.hasPointerCapture(t.pointerId)&&e.releasePointerCapture(t.pointerId),0===t.button&&!1===t.ctrlKey&&"mouse"===t.pointerType&&(p(t),t.preventDefault())}),onKeyDown:sZ(r.onKeyDown,t=>{let e=""!==c.current;t.ctrlKey||t.altKey||t.metaKey||1!==t.key.length||d(t.key),(!e||" "!==t.key)&&lA.includes(t.key)&&(p(),t.preventDefault())})})})});lQ.displayName=lG;var lZ="SelectValue",l0=$.forwardRef((t,e)=>{let{__scopeSelect:i,className:s,style:r,children:n,placeholder:l="",...o}=t,a=lJ(lZ,i),{onValueNodeHasChildrenChange:h}=a,u=void 0!==n,c=(0,s1.useComposedRefs)(e,a.onValueNodeChange);return rg(()=>{h(u)},[h,u]),(0,L.jsx)(s4.span,{...o,ref:c,style:{pointerEvents:"none"},children:oS(a.value)?(0,L.jsx)(L.Fragment,{children:l}):n})});l0.displayName=lZ;var l1=$.forwardRef((t,e)=>{let{__scopeSelect:i,children:s,...r}=t;return(0,L.jsx)(s4.span,{"aria-hidden":!0,...r,ref:e,children:s||"â–¼"})});l1.displayName="SelectIcon";var l2=t=>(0,L.jsx)(nQ,{asChild:!0,...t});l2.displayName="SelectPortal";var l3="SelectContent",l5=$.forwardRef((t,e)=>{let i=lJ(l3,t.__scopeSelect),[s,r]=$.useState();return(rg(()=>{r(new DocumentFragment)},[]),i.open)?(0,L.jsx)(l9,{...t,ref:e}):s?sG.createPortal((0,L.jsx)(l4,{scope:t.__scopeSelect,children:(0,L.jsx)(lB.Slot,{scope:t.__scopeSelect,children:(0,L.jsx)("div",{children:t.children})})}),s):null});l5.displayName=l3;var[l4,l6]=lK(l3),l9=$.forwardRef((t,e)=>{let{__scopeSelect:i,position:s="item-aligned",onCloseAutoFocus:r,onEscapeKeyDown:n,onPointerDownOutside:l,side:o,sideOffset:a,align:h,alignOffset:u,arrowPadding:c,collisionBoundary:d,collisionPadding:m,sticky:p,hideWhenDetached:f,avoidCollisions:g,...v}=t,x=lJ(l3,i),[w,y]=$.useState(null),[b,S]=$.useState(null),j=(0,s1.useComposedRefs)(e,t=>y(t)),[M,C]=$.useState(null),[N,E]=$.useState(null),P=l$(i),[k,_]=$.useState(!1),R=$.useRef(!1);$.useEffect(()=>{if(w)return n9(w)},[w]),rn();let T=$.useCallback(t=>{let[e,...i]=P().map(t=>t.ref.current),[s]=i.slice(-1),r=document.activeElement;for(let i of t)if(i===r||(i?.scrollIntoView({block:"nearest"}),i===e&&b&&(b.scrollTop=0),i===s&&b&&(b.scrollTop=b.scrollHeight),i?.focus(),document.activeElement!==r))return},[P,b]),I=$.useCallback(()=>T([M,w]),[T,M,w]);$.useEffect(()=>{k&&I()},[k,I]);let{onOpenChange:F,triggerPointerDownPosRef:z}=x;$.useEffect(()=>{if(w){let t={x:0,y:0},e=e=>{t={x:Math.abs(Math.round(e.pageX)-(z.current?.x??0)),y:Math.abs(Math.round(e.pageY)-(z.current?.y??0))}},i=i=>{t.x<=10&&t.y<=10?i.preventDefault():w.contains(i.target)||F(!1),document.removeEventListener("pointermove",e),z.current=null};return null!==z.current&&(document.addEventListener("pointermove",e),document.addEventListener("pointerup",i,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",e),document.removeEventListener("pointerup",i,{capture:!0})}}},[w,F,z]),$.useEffect(()=>{let t=()=>F(!1);return window.addEventListener("blur",t),window.addEventListener("resize",t),()=>{window.removeEventListener("blur",t),window.removeEventListener("resize",t)}},[F]);let[A,D]=oM(t=>{let e=P().filter(t=>!t.disabled),i=e.find(t=>t.ref.current===document.activeElement),s=oC(e,t,i);s&&setTimeout(()=>s.ref.current.focus())}),O=$.useCallback((t,e,i)=>{let s=!R.current&&!i;(void 0!==x.value&&x.value===e||s)&&(C(t),s&&(R.current=!0))},[x.value]),B=$.useCallback(()=>w?.focus(),[w]),W=$.useCallback((t,e,i)=>{let s=!R.current&&!i;(void 0!==x.value&&x.value===e||s)&&E(t)},[x.value]),K="popper"===s?l8:l7,V=K===l8?{side:o,sideOffset:a,align:h,alignOffset:u,arrowPadding:c,collisionBoundary:d,collisionPadding:m,sticky:p,hideWhenDetached:f,avoidCollisions:g}:{};return(0,L.jsx)(l4,{scope:i,content:w,viewport:b,onViewportChange:S,itemRefCallback:O,selectedItem:M,onItemLeave:B,itemTextRefCallback:W,focusSelectedItem:I,selectedItemText:N,position:s,isPositioned:k,searchRef:A,children:(0,L.jsx)(lz,{as:s2.Slot,allowPinchZoom:!0,children:(0,L.jsx)(ru,{asChild:!0,trapped:x.open,onMountAutoFocus:t=>{t.preventDefault()},onUnmountAutoFocus:sZ(r,t=>{x.trigger?.focus({preventScroll:!0}),t.preventDefault()}),children:(0,L.jsx)(rt,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:n,onPointerDownOutside:l,onFocusOutside:t=>t.preventDefault(),onDismiss:()=>x.onOpenChange(!1),children:(0,L.jsx)(K,{role:"listbox",id:x.contentId,"data-state":x.open?"open":"closed",dir:x.dir,onContextMenu:t=>t.preventDefault(),...v,...V,onPlaced:()=>_(!0),ref:j,style:{display:"flex",flexDirection:"column",outline:"none",...v.style},onKeyDown:sZ(v.onKeyDown,t=>{let e=t.ctrlKey||t.altKey||t.metaKey;if("Tab"===t.key&&t.preventDefault(),e||1!==t.key.length||D(t.key),["ArrowUp","ArrowDown","Home","End"].includes(t.key)){let e=P().filter(t=>!t.disabled).map(t=>t.ref.current);if(["ArrowUp","End"].includes(t.key)&&(e=e.slice().reverse()),["ArrowUp","ArrowDown"].includes(t.key)){let i=t.target,s=e.indexOf(i);e=e.slice(s+1)}setTimeout(()=>T(e)),t.preventDefault()}})})})})})})});l9.displayName="SelectContentImpl";var l7=$.forwardRef((t,e)=>{let{__scopeSelect:i,onPlaced:s,...r}=t,n=lJ(l3,i),l=l6(l3,i),[o,a]=$.useState(null),[h,u]=$.useState(null),c=(0,s1.useComposedRefs)(e,t=>u(t)),d=l$(i),m=$.useRef(!1),p=$.useRef(!0),{viewport:f,selectedItem:g,selectedItemText:v,focusSelectedItem:x}=l,w=$.useCallback(()=>{if(n.trigger&&n.valueNode&&o&&h&&f&&g&&v){let t=n.trigger.getBoundingClientRect(),e=h.getBoundingClientRect(),i=n.valueNode.getBoundingClientRect(),r=v.getBoundingClientRect();if("rtl"!==n.dir){let s=r.left-e.left,n=i.left-s,l=t.left-n,a=t.width+l,h=Math.max(a,e.width),u=sQ(n,[10,Math.max(10,window.innerWidth-10-h)]);o.style.minWidth=a+"px",o.style.left=u+"px"}else{let s=e.right-r.right,n=window.innerWidth-i.right-s,l=window.innerWidth-t.right-n,a=t.width+l,h=Math.max(a,e.width),u=sQ(n,[10,Math.max(10,window.innerWidth-10-h)]);o.style.minWidth=a+"px",o.style.right=u+"px"}let l=d(),a=window.innerHeight-20,u=f.scrollHeight,c=window.getComputedStyle(h),p=parseInt(c.borderTopWidth,10),x=parseInt(c.paddingTop,10),w=parseInt(c.borderBottomWidth,10),y=p+x+u+parseInt(c.paddingBottom,10)+w,b=Math.min(5*g.offsetHeight,y),S=window.getComputedStyle(f),j=parseInt(S.paddingTop,10),M=parseInt(S.paddingBottom,10),C=t.top+t.height/2-10,N=g.offsetHeight/2,E=p+x+(g.offsetTop+N);if(E<=C){let t=l.length>0&&g===l[l.length-1].ref.current;o.style.bottom="0px";let e=Math.max(a-C,N+(t?M:0)+(h.clientHeight-f.offsetTop-f.offsetHeight)+w);o.style.height=E+e+"px"}else{let t=l.length>0&&g===l[0].ref.current;o.style.top="0px";let e=Math.max(C,p+f.offsetTop+(t?j:0)+N);o.style.height=e+(y-E)+"px",f.scrollTop=E-C+f.offsetTop}o.style.margin="10px 0",o.style.minHeight=b+"px",o.style.maxHeight=a+"px",s?.(),requestAnimationFrame(()=>m.current=!0)}},[d,n.trigger,n.valueNode,o,h,f,g,v,n.dir,s]);rg(()=>w(),[w]);let[y,b]=$.useState();rg(()=>{h&&b(window.getComputedStyle(h).zIndex)},[h]);let S=$.useCallback(t=>{t&&!0===p.current&&(w(),x?.(),p.current=!1)},[w,x]);return(0,L.jsx)(ot,{scope:i,contentWrapper:o,shouldExpandOnScrollRef:m,onScrollButtonChange:S,children:(0,L.jsx)("div",{ref:a,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:y},children:(0,L.jsx)(s4.div,{...r,ref:c,style:{boxSizing:"border-box",maxHeight:"100%",...r.style}})})})});l7.displayName="SelectItemAlignedPosition";var l8=$.forwardRef((t,e)=>{let{__scopeSelect:i,align:s="start",collisionPadding:r=10,...n}=t,l=lU(i);return(0,L.jsx)(nU,{...l,...n,ref:e,align:s,collisionPadding:r,style:{boxSizing:"border-box",...n.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});l8.displayName="SelectPopperPosition";var[ot,oe]=lK(l3,{}),oi="SelectViewport",os=$.forwardRef((t,e)=>{let{__scopeSelect:i,nonce:s,...r}=t,n=l6(oi,i),l=oe(oi,i),o=(0,s1.useComposedRefs)(e,n.onViewportChange),a=$.useRef(0);return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:s}),(0,L.jsx)(lB.Slot,{scope:i,children:(0,L.jsx)(s4.div,{"data-radix-select-viewport":"",role:"presentation",...r,ref:o,style:{position:"relative",flex:1,overflow:"hidden auto",...r.style},onScroll:sZ(r.onScroll,t=>{let e=t.currentTarget,{contentWrapper:i,shouldExpandOnScrollRef:s}=l;if(s?.current&&i){let t=Math.abs(a.current-e.scrollTop);if(t>0){let s=window.innerHeight-20,r=Math.max(parseFloat(i.style.minHeight),parseFloat(i.style.height));if(r<s){let n=r+t,l=Math.min(s,n),o=n-l;i.style.height=l+"px","0px"===i.style.bottom&&(e.scrollTop=o>0?o:0,i.style.justifyContent="flex-end")}}}a.current=e.scrollTop})})})]})});os.displayName=oi;var or="SelectGroup",[on,ol]=lK(or);$.forwardRef((t,e)=>{let{__scopeSelect:i,...s}=t,r=rw();return(0,L.jsx)(on,{scope:i,id:r,children:(0,L.jsx)(s4.div,{role:"group","aria-labelledby":r,...s,ref:e})})}).displayName=or;var oo="SelectLabel";$.forwardRef((t,e)=>{let{__scopeSelect:i,...s}=t,r=ol(oo,i);return(0,L.jsx)(s4.div,{id:r.id,...s,ref:e})}).displayName=oo;var oa="SelectItem",[oh,ou]=lK(oa),oc=$.forwardRef((t,e)=>{let{__scopeSelect:i,value:s,disabled:r=!1,textValue:n,...l}=t,o=lJ(oa,i),a=l6(oa,i),h=o.value===s,[u,c]=$.useState(n??""),[d,m]=$.useState(!1),p=(0,s1.useComposedRefs)(e,t=>a.itemRefCallback?.(t,s,r)),f=rw(),g=$.useRef("touch"),v=()=>{r||(o.onValueChange(s),o.onOpenChange(!1))};if(""===s)throw Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return(0,L.jsx)(oh,{scope:i,value:s,disabled:r,textId:f,isSelected:h,onItemTextChange:$.useCallback(t=>{c(e=>e||(t?.textContent??"").trim())},[]),children:(0,L.jsx)(lB.ItemSlot,{scope:i,value:s,disabled:r,textValue:u,children:(0,L.jsx)(s4.div,{role:"option","aria-labelledby":f,"data-highlighted":d?"":void 0,"aria-selected":h&&d,"data-state":h?"checked":"unchecked","aria-disabled":r||void 0,"data-disabled":r?"":void 0,tabIndex:r?void 0:-1,...l,ref:p,onFocus:sZ(l.onFocus,()=>m(!0)),onBlur:sZ(l.onBlur,()=>m(!1)),onClick:sZ(l.onClick,()=>{"mouse"!==g.current&&v()}),onPointerUp:sZ(l.onPointerUp,()=>{"mouse"===g.current&&v()}),onPointerDown:sZ(l.onPointerDown,t=>{g.current=t.pointerType}),onPointerMove:sZ(l.onPointerMove,t=>{g.current=t.pointerType,r?a.onItemLeave?.():"mouse"===g.current&&t.currentTarget.focus({preventScroll:!0})}),onPointerLeave:sZ(l.onPointerLeave,t=>{t.currentTarget===document.activeElement&&a.onItemLeave?.()}),onKeyDown:sZ(l.onKeyDown,t=>{(a.searchRef?.current===""||" "!==t.key)&&(lD.includes(t.key)&&v()," "===t.key&&t.preventDefault())})})})})});oc.displayName=oa;var od="SelectItemText",om=$.forwardRef((t,e)=>{let{__scopeSelect:i,className:s,style:r,...n}=t,l=lJ(od,i),o=l6(od,i),a=ou(od,i),h=lY(od,i),[u,c]=$.useState(null),d=(0,s1.useComposedRefs)(e,t=>c(t),a.onItemTextChange,t=>o.itemTextRefCallback?.(t,a.value,a.disabled)),m=u?.textContent,p=$.useMemo(()=>(0,L.jsx)("option",{value:a.value,disabled:a.disabled,children:m},a.value),[a.disabled,a.value,m]),{onNativeOptionAdd:f,onNativeOptionRemove:g}=h;return rg(()=>(f(p),()=>g(p)),[f,g,p]),(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(s4.span,{id:a.textId,...n,ref:d}),a.isSelected&&l.valueNode&&!l.valueNodeHasChildren?sG.createPortal(n.children,l.valueNode):null]})});om.displayName=od;var op="SelectItemIndicator",of=$.forwardRef((t,e)=>{let{__scopeSelect:i,...s}=t;return ou(op,i).isSelected?(0,L.jsx)(s4.span,{"aria-hidden":!0,...s,ref:e}):null});of.displayName=op;var og="SelectScrollUpButton",ov=$.forwardRef((t,e)=>{let i=l6(og,t.__scopeSelect),s=oe(og,t.__scopeSelect),[r,n]=$.useState(!1),l=(0,s1.useComposedRefs)(e,s.onScrollButtonChange);return rg(()=>{if(i.viewport&&i.isPositioned){let t=function(){n(e.scrollTop>0)},e=i.viewport;return t(),e.addEventListener("scroll",t),()=>e.removeEventListener("scroll",t)}},[i.viewport,i.isPositioned]),r?(0,L.jsx)(oy,{...t,ref:l,onAutoScroll:()=>{let{viewport:t,selectedItem:e}=i;t&&e&&(t.scrollTop=t.scrollTop-e.offsetHeight)}}):null});ov.displayName=og;var ox="SelectScrollDownButton",ow=$.forwardRef((t,e)=>{let i=l6(ox,t.__scopeSelect),s=oe(ox,t.__scopeSelect),[r,n]=$.useState(!1),l=(0,s1.useComposedRefs)(e,s.onScrollButtonChange);return rg(()=>{if(i.viewport&&i.isPositioned){let t=function(){let t=e.scrollHeight-e.clientHeight;n(Math.ceil(e.scrollTop)<t)},e=i.viewport;return t(),e.addEventListener("scroll",t),()=>e.removeEventListener("scroll",t)}},[i.viewport,i.isPositioned]),r?(0,L.jsx)(oy,{...t,ref:l,onAutoScroll:()=>{let{viewport:t,selectedItem:e}=i;t&&e&&(t.scrollTop=t.scrollTop+e.offsetHeight)}}):null});ow.displayName=ox;var oy=$.forwardRef((t,e)=>{let{__scopeSelect:i,onAutoScroll:s,...r}=t,n=l6("SelectScrollButton",i),l=$.useRef(null),o=l$(i),a=$.useCallback(()=>{null!==l.current&&(window.clearInterval(l.current),l.current=null)},[]);return $.useEffect(()=>()=>a(),[a]),rg(()=>{let t=o().find(t=>t.ref.current===document.activeElement);t?.ref.current?.scrollIntoView({block:"nearest"})},[o]),(0,L.jsx)(s4.div,{"aria-hidden":!0,...r,ref:e,style:{flexShrink:0,...r.style},onPointerDown:sZ(r.onPointerDown,()=>{null===l.current&&(l.current=window.setInterval(s,50))}),onPointerMove:sZ(r.onPointerMove,()=>{n.onItemLeave?.(),null===l.current&&(l.current=window.setInterval(s,50))}),onPointerLeave:sZ(r.onPointerLeave,()=>{a()})})});$.forwardRef((t,e)=>{let{__scopeSelect:i,...s}=t;return(0,L.jsx)(s4.div,{"aria-hidden":!0,...s,ref:e})}).displayName="SelectSeparator";var ob="SelectArrow";function oS(t){return""===t||void 0===t}$.forwardRef((t,e)=>{let{__scopeSelect:i,...s}=t,r=lU(i),n=lJ(ob,i),l=l6(ob,i);return n.open&&"popper"===l.position?(0,L.jsx)(nq,{...r,...s,ref:e}):null}).displayName=ob;var oj=$.forwardRef((t,e)=>{let i,{value:s,...r}=t,n=$.useRef(null),l=(0,s1.useComposedRefs)(e,n),o=(i=$.useRef({value:s,previous:s}),$.useMemo(()=>(i.current.value!==s&&(i.current.previous=i.current.value,i.current.value=s),i.current.previous),[s]));return $.useEffect(()=>{let t=n.current,e=Object.getOwnPropertyDescriptor(window.HTMLSelectElement.prototype,"value").set;if(o!==s&&e){let i=new Event("change",{bubbles:!0});e.call(t,s),t.dispatchEvent(i)}},[o,s]),(0,L.jsx)(n0,{asChild:!0,children:(0,L.jsx)("select",{...r,ref:l,defaultValue:s})})});function oM(t){let e=s9(t),i=$.useRef(""),s=$.useRef(0),r=$.useCallback(t=>{let r=i.current+t;e(r),function t(e){i.current=e,window.clearTimeout(s.current),""!==e&&(s.current=window.setTimeout(()=>t(""),1e3))}(r)},[e]),n=$.useCallback(()=>{i.current="",window.clearTimeout(s.current)},[]);return $.useEffect(()=>()=>window.clearTimeout(s.current),[]),[i,r,n]}function oC(t,e,i){var s,r;let n=e.length>1&&Array.from(e).every(t=>t===e[0])?e[0]:e,l=i?t.indexOf(i):-1,o=(s=t,r=Math.max(l,0),s.map((t,e)=>s[(r+e)%s.length]));1===n.length&&(o=o.filter(t=>t!==i));let a=o.find(t=>t.textValue.toLowerCase().startsWith(n.toLowerCase()));return a!==i?a:void 0}oj.displayName="BubbleSelect";let oN=(0,sq.default)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),oE=(0,sq.default)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),oP=(0,sq.default)("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);function ok({...t}){return(0,L.jsx)(lX,{"data-slot":"select",...t})}function o_({...t}){return(0,L.jsx)(l0,{"data-slot":"select-value",...t})}function oR({className:t,size:e="default",children:i,...s}){return(0,L.jsxs)(lQ,{"data-slot":"select-trigger","data-size":e,className:(0,I.cn)("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...s,children:[i,(0,L.jsx)(l1,{asChild:!0,children:(0,L.jsx)(oE,{className:"size-4 opacity-50"})})]})}function oT({className:t,children:e,position:i="popper",...s}){return(0,L.jsx)(l2,{children:(0,L.jsxs)(l5,{"data-slot":"select-content",className:(0,I.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===i&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:i,...s,children:[(0,L.jsx)(oI,{}),(0,L.jsx)(os,{className:(0,I.cn)("p-1","popper"===i&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:e}),(0,L.jsx)(oF,{})]})})}function oL({className:t,children:e,...i}){return(0,L.jsxs)(oc,{"data-slot":"select-item",className:(0,I.cn)("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",t),...i,children:[(0,L.jsx)("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:(0,L.jsx)(of,{children:(0,L.jsx)(oN,{className:"size-4"})})}),(0,L.jsx)(om,{children:e})]})}function oI({className:t,...e}){return(0,L.jsx)(ov,{"data-slot":"select-scroll-up-button",className:(0,I.cn)("flex cursor-default items-center justify-center py-1",t),...e,children:(0,L.jsx)(oP,{className:"size-4"})})}function oF({className:t,...e}){return(0,L.jsx)(ow,{"data-slot":"select-scroll-down-button",className:(0,I.cn)("flex cursor-default items-center justify-center py-1",t),...e,children:(0,L.jsx)(oE,{className:"size-4"})})}var oz=t=>{var e;let i,s,{present:r,children:n}=t,l=function(t){var e,i;let[s,r]=$.useState(),n=$.useRef({}),l=$.useRef(t),o=$.useRef("none"),[a,h]=(e=t?"mounted":"unmounted",i={mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}},$.useReducer((t,e)=>i[t][e]??t,e));return $.useEffect(()=>{let t=oA(n.current);o.current="mounted"===a?t:"none"},[a]),rg(()=>{let e=n.current,i=l.current;if(i!==t){let s=o.current,r=oA(e);t?h("MOUNT"):"none"===r||e?.display==="none"?h("UNMOUNT"):i&&s!==r?h("ANIMATION_OUT"):h("UNMOUNT"),l.current=t}},[t,h]),rg(()=>{if(s){let t,e=s.ownerDocument.defaultView??window,i=i=>{let r=oA(n.current).includes(i.animationName);if(i.target===s&&r&&(h("ANIMATION_END"),!l.current)){let i=s.style.animationFillMode;s.style.animationFillMode="forwards",t=e.setTimeout(()=>{"forwards"===s.style.animationFillMode&&(s.style.animationFillMode=i)})}},r=t=>{t.target===s&&(o.current=oA(n.current))};return s.addEventListener("animationstart",r),s.addEventListener("animationcancel",i),s.addEventListener("animationend",i),()=>{e.clearTimeout(t),s.removeEventListener("animationstart",r),s.removeEventListener("animationcancel",i),s.removeEventListener("animationend",i)}}h("ANIMATION_END")},[s,h]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:$.useCallback(t=>{t&&(n.current=getComputedStyle(t)),r(t)},[])}}(r),o="function"==typeof n?n({present:l.isPresent}):$.Children.only(n),a=(0,s1.useComposedRefs)(l.ref,(e=o,(s=(i=Object.getOwnPropertyDescriptor(e.props,"ref")?.get)&&"isReactWarning"in i&&i.isReactWarning)?e.ref:(s=(i=Object.getOwnPropertyDescriptor(e,"ref")?.get)&&"isReactWarning"in i&&i.isReactWarning)?e.props.ref:e.props.ref||e.ref));return"function"==typeof n||l.isPresent?$.cloneElement(o,{ref:a}):null};function oA(t){return t?.animationName||"none"}oz.displayName="Presence";var oD="Popover",[oO,oB]=s0(oD,[nz]),o$=nz(),[oW,oK]=oO(oD),oV=t=>{let{__scopePopover:e,children:i,open:s,defaultOpen:r,onOpenChange:n,modal:l=!1}=t,o=o$(e),a=$.useRef(null),[h,u]=$.useState(!1),[c=!1,d]=nZ({prop:s,defaultProp:r,onChange:n});return(0,L.jsx)(nO,{...o,children:(0,L.jsx)(oW,{scope:e,contentId:rw(),triggerRef:a,open:c,onOpenChange:d,onOpenToggle:$.useCallback(()=>d(t=>!t),[d]),hasCustomAnchor:h,onCustomAnchorAdd:$.useCallback(()=>u(!0),[]),onCustomAnchorRemove:$.useCallback(()=>u(!1),[]),modal:l,children:i})})};oV.displayName=oD;var oU="PopoverAnchor";$.forwardRef((t,e)=>{let{__scopePopover:i,...s}=t,r=oK(oU,i),n=o$(i),{onCustomAnchorAdd:l,onCustomAnchorRemove:o}=r;return $.useEffect(()=>(l(),()=>o()),[l,o]),(0,L.jsx)(n$,{...n,...s,ref:e})}).displayName=oU;var oH="PopoverTrigger",oJ=$.forwardRef((t,e)=>{let{__scopePopover:i,...s}=t,r=oK(oH,i),n=o$(i),l=(0,s1.useComposedRefs)(e,r.triggerRef),o=(0,L.jsx)(s4.button,{type:"button","aria-haspopup":"dialog","aria-expanded":r.open,"aria-controls":r.contentId,"data-state":o5(r.open),...s,ref:l,onClick:sZ(t.onClick,r.onOpenToggle)});return r.hasCustomAnchor?o:(0,L.jsx)(n$,{asChild:!0,...n,children:o})});oJ.displayName=oH;var oq="PopoverPortal",[oY,oX]=oO(oq,{forceMount:void 0}),oG=t=>{let{__scopePopover:e,forceMount:i,children:s,container:r}=t,n=oK(oq,e);return(0,L.jsx)(oY,{scope:e,forceMount:i,children:(0,L.jsx)(oz,{present:i||n.open,children:(0,L.jsx)(nQ,{asChild:!0,container:r,children:s})})})};oG.displayName=oq;var oQ="PopoverContent",oZ=$.forwardRef((t,e)=>{let i=oX(oQ,t.__scopePopover),{forceMount:s=i.forceMount,...r}=t,n=oK(oQ,t.__scopePopover);return(0,L.jsx)(oz,{present:s||n.open,children:n.modal?(0,L.jsx)(o0,{...r,ref:e}):(0,L.jsx)(o1,{...r,ref:e})})});oZ.displayName=oQ;var o0=$.forwardRef((t,e)=>{let i=oK(oQ,t.__scopePopover),s=$.useRef(null),r=(0,s1.useComposedRefs)(e,s),n=$.useRef(!1);return $.useEffect(()=>{let t=s.current;if(t)return n9(t)},[]),(0,L.jsx)(lz,{as:s2.Slot,allowPinchZoom:!0,children:(0,L.jsx)(o2,{...t,ref:r,trapFocus:i.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:sZ(t.onCloseAutoFocus,t=>{t.preventDefault(),n.current||i.triggerRef.current?.focus()}),onPointerDownOutside:sZ(t.onPointerDownOutside,t=>{let e=t.detail.originalEvent,i=0===e.button&&!0===e.ctrlKey;n.current=2===e.button||i},{checkForDefaultPrevented:!1}),onFocusOutside:sZ(t.onFocusOutside,t=>t.preventDefault(),{checkForDefaultPrevented:!1})})})}),o1=$.forwardRef((t,e)=>{let i=oK(oQ,t.__scopePopover),s=$.useRef(!1),r=$.useRef(!1);return(0,L.jsx)(o2,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:e=>{t.onCloseAutoFocus?.(e),e.defaultPrevented||(s.current||i.triggerRef.current?.focus(),e.preventDefault()),s.current=!1,r.current=!1},onInteractOutside:e=>{t.onInteractOutside?.(e),e.defaultPrevented||(s.current=!0,"pointerdown"===e.detail.originalEvent.type&&(r.current=!0));let n=e.target;i.triggerRef.current?.contains(n)&&e.preventDefault(),"focusin"===e.detail.originalEvent.type&&r.current&&e.preventDefault()}})}),o2=$.forwardRef((t,e)=>{let{__scopePopover:i,trapFocus:s,onOpenAutoFocus:r,onCloseAutoFocus:n,disableOutsidePointerEvents:l,onEscapeKeyDown:o,onPointerDownOutside:a,onFocusOutside:h,onInteractOutside:u,...c}=t,d=oK(oQ,i),m=o$(i);return rn(),(0,L.jsx)(ru,{asChild:!0,loop:!0,trapped:s,onMountAutoFocus:r,onUnmountAutoFocus:n,children:(0,L.jsx)(rt,{asChild:!0,disableOutsidePointerEvents:l,onInteractOutside:u,onEscapeKeyDown:o,onPointerDownOutside:a,onFocusOutside:h,onDismiss:()=>d.onOpenChange(!1),children:(0,L.jsx)(nU,{"data-state":o5(d.open),role:"dialog",id:d.contentId,...m,...c,ref:e,style:{...c.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),o3="PopoverClose";function o5(t){return t?"open":"closed"}function o4({...t}){return(0,L.jsx)(oV,{"data-slot":"popover",...t})}function o6({...t}){return(0,L.jsx)(oJ,{"data-slot":"popover-trigger",...t})}function o9({className:t,align:e="center",sideOffset:i=4,...s}){return(0,L.jsx)(oG,{children:(0,L.jsx)(oZ,{"data-slot":"popover-content",align:e,sideOffset:i,className:(0,I.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",t),...s})})}$.forwardRef((t,e)=>{let{__scopePopover:i,...s}=t,r=oK(o3,i);return(0,L.jsx)(s4.button,{type:"button",...s,ref:e,onClick:sZ(t.onClick,()=>r.onOpenChange(!1))})}).displayName=o3,$.forwardRef((t,e)=>{let{__scopePopover:i,...s}=t,r=o$(i);return(0,L.jsx)(nq,{...r,...s,ref:e})}).displayName="PopoverArrow";var o7=/[\\\/_+.#"@\[\(\{&]/,o8=/[\\\/_+.#"@\[\(\{&]/g,at=/[\s-]/,ae=/[\s-]/g;function ai(t){return t.toLowerCase().replace(ae," ")}var as="Dialog",[ar,an]=s0(as),[al,ao]=ar(as),aa=t=>{let{__scopeDialog:e,children:i,open:s,defaultOpen:r,onOpenChange:n,modal:l=!0}=t,o=$.useRef(null),a=$.useRef(null),[h=!1,u]=nZ({prop:s,defaultProp:r,onChange:n});return(0,L.jsx)(al,{scope:e,triggerRef:o,contentRef:a,contentId:rw(),titleId:rw(),descriptionId:rw(),open:h,onOpenChange:u,onOpenToggle:$.useCallback(()=>u(t=>!t),[u]),modal:l,children:i})};aa.displayName=as;var ah="DialogTrigger";$.forwardRef((t,e)=>{let{__scopeDialog:i,...s}=t,r=ao(ah,i),n=(0,s1.useComposedRefs)(e,r.triggerRef);return(0,L.jsx)(s4.button,{type:"button","aria-haspopup":"dialog","aria-expanded":r.open,"aria-controls":r.contentId,"data-state":aC(r.open),...s,ref:n,onClick:sZ(t.onClick,r.onOpenToggle)})}).displayName=ah;var au="DialogPortal",[ac,ad]=ar(au,{forceMount:void 0}),am=t=>{let{__scopeDialog:e,forceMount:i,children:s,container:r}=t,n=ao(au,e);return(0,L.jsx)(ac,{scope:e,forceMount:i,children:$.Children.map(s,t=>(0,L.jsx)(oz,{present:i||n.open,children:(0,L.jsx)(nQ,{asChild:!0,container:r,children:t})}))})};am.displayName=au;var ap="DialogOverlay",af=$.forwardRef((t,e)=>{let i=ad(ap,t.__scopeDialog),{forceMount:s=i.forceMount,...r}=t,n=ao(ap,t.__scopeDialog);return n.modal?(0,L.jsx)(oz,{present:s||n.open,children:(0,L.jsx)(ag,{...r,ref:e})}):null});af.displayName=ap;var ag=$.forwardRef((t,e)=>{let{__scopeDialog:i,...s}=t,r=ao(ap,i);return(0,L.jsx)(lz,{as:s2.Slot,allowPinchZoom:!0,shards:[r.contentRef],children:(0,L.jsx)(s4.div,{"data-state":aC(r.open),...s,ref:e,style:{pointerEvents:"auto",...s.style}})})}),av="DialogContent",ax=$.forwardRef((t,e)=>{let i=ad(av,t.__scopeDialog),{forceMount:s=i.forceMount,...r}=t,n=ao(av,t.__scopeDialog);return(0,L.jsx)(oz,{present:s||n.open,children:n.modal?(0,L.jsx)(aw,{...r,ref:e}):(0,L.jsx)(ay,{...r,ref:e})})});ax.displayName=av;var aw=$.forwardRef((t,e)=>{let i=ao(av,t.__scopeDialog),s=$.useRef(null),r=(0,s1.useComposedRefs)(e,i.contentRef,s);return $.useEffect(()=>{let t=s.current;if(t)return n9(t)},[]),(0,L.jsx)(ab,{...t,ref:r,trapFocus:i.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:sZ(t.onCloseAutoFocus,t=>{t.preventDefault(),i.triggerRef.current?.focus()}),onPointerDownOutside:sZ(t.onPointerDownOutside,t=>{let e=t.detail.originalEvent,i=0===e.button&&!0===e.ctrlKey;(2===e.button||i)&&t.preventDefault()}),onFocusOutside:sZ(t.onFocusOutside,t=>t.preventDefault())})}),ay=$.forwardRef((t,e)=>{let i=ao(av,t.__scopeDialog),s=$.useRef(!1),r=$.useRef(!1);return(0,L.jsx)(ab,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:e=>{t.onCloseAutoFocus?.(e),e.defaultPrevented||(s.current||i.triggerRef.current?.focus(),e.preventDefault()),s.current=!1,r.current=!1},onInteractOutside:e=>{t.onInteractOutside?.(e),e.defaultPrevented||(s.current=!0,"pointerdown"===e.detail.originalEvent.type&&(r.current=!0));let n=e.target;i.triggerRef.current?.contains(n)&&e.preventDefault(),"focusin"===e.detail.originalEvent.type&&r.current&&e.preventDefault()}})}),ab=$.forwardRef((t,e)=>{let{__scopeDialog:i,trapFocus:s,onOpenAutoFocus:r,onCloseAutoFocus:n,...l}=t,o=ao(av,i),a=$.useRef(null),h=(0,s1.useComposedRefs)(e,a);return rn(),(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(ru,{asChild:!0,loop:!0,trapped:s,onMountAutoFocus:r,onUnmountAutoFocus:n,children:(0,L.jsx)(rt,{role:"dialog",id:o.contentId,"aria-describedby":o.descriptionId,"aria-labelledby":o.titleId,"data-state":aC(o.open),...l,ref:h,onDismiss:()=>o.onOpenChange(!1)})}),(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(ak,{titleId:o.titleId}),(0,L.jsx)(a_,{contentRef:a,descriptionId:o.descriptionId})]})]})}),aS="DialogTitle";$.forwardRef((t,e)=>{let{__scopeDialog:i,...s}=t,r=ao(aS,i);return(0,L.jsx)(s4.h2,{id:r.titleId,...s,ref:e})}).displayName=aS;var aj="DialogDescription";$.forwardRef((t,e)=>{let{__scopeDialog:i,...s}=t,r=ao(aj,i);return(0,L.jsx)(s4.p,{id:r.descriptionId,...s,ref:e})}).displayName=aj;var aM="DialogClose";function aC(t){return t?"open":"closed"}$.forwardRef((t,e)=>{let{__scopeDialog:i,...s}=t,r=ao(aM,i);return(0,L.jsx)(s4.button,{type:"button",...s,ref:e,onClick:sZ(t.onClick,()=>r.onOpenChange(!1))})}).displayName=aM;var aN="DialogTitleWarning",[aE,aP]=(y={contentName:av,titleName:aS,docsSlug:"dialog"},e=$.createContext(y),(i=t=>{let{children:i,...s}=t,r=$.useMemo(()=>s,Object.values(s));return(0,L.jsx)(e.Provider,{value:r,children:i})}).displayName=aN+"Provider",[i,function(t){let i=$.useContext(e);if(i)return i;if(void 0!==y)return y;throw Error(`\`${t}\` must be used within \`${aN}\``)}]),ak=({titleId:t})=>{let e=aP(aN),i=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return $.useEffect(()=>{t&&(document.getElementById(t)||console.error(i))},[i,t]),null},a_=({contentRef:t,descriptionId:e})=>{let i=aP("DialogDescriptionWarning"),s=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${i.contentName}}.`;return $.useEffect(()=>{let i=t.current?.getAttribute("aria-describedby");e&&i&&(document.getElementById(e)||console.warn(s))},[s,t,e]),null};function aR(t,e){if("function"==typeof t)return t(e);null!=t&&(t.current=e)}var aT=Symbol.for("react.lazy"),aL=$[" use ".trim().toString()];function aI(t){var e;return null!=t&&"object"==typeof t&&"$$typeof"in t&&t.$$typeof===aT&&"_payload"in t&&"object"==typeof(e=t._payload)&&null!==e&&"then"in e}var aF=Symbol("radix.slottable");function az(t){return $.isValidElement(t)&&"function"==typeof t.type&&"__radixId"in t.type&&t.type.__radixId===aF}var aA=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((t,e)=>{var i,s;let r,n,l,o=(s=i=`Primitive.${e}`,(r=$.forwardRef((t,e)=>{let{children:i,...s}=t;if(aI(i)&&"function"==typeof aL&&(i=aL(i._payload)),$.isValidElement(i)){var r;let t,n,l=(r=i,(n=(t=Object.getOwnPropertyDescriptor(r.props,"ref")?.get)&&"isReactWarning"in t&&t.isReactWarning)?r.ref:(n=(t=Object.getOwnPropertyDescriptor(r,"ref")?.get)&&"isReactWarning"in t&&t.isReactWarning)?r.props.ref:r.props.ref||r.ref),o=function(t,e){let i={...e};for(let s in e){let r=t[s],n=e[s];/^on[A-Z]/.test(s)?r&&n?i[s]=(...t)=>{let e=n(...t);return r(...t),e}:r&&(i[s]=r):"style"===s?i[s]={...r,...n}:"className"===s&&(i[s]=[r,n].filter(Boolean).join(" "))}return{...t,...i}}(s,i.props);return i.type!==$.Fragment&&(o.ref=e?function(...t){return e=>{let i=!1,s=t.map(t=>{let s=aR(t,e);return i||"function"!=typeof s||(i=!0),s});if(i)return()=>{for(let e=0;e<s.length;e++){let i=s[e];"function"==typeof i?i():aR(t[e],null)}}}}(e,l):l),$.cloneElement(i,o)}return $.Children.count(i)>1?$.Children.only(null):null})).displayName=`${s}.SlotClone`,n=r,(l=$.forwardRef((t,e)=>{let{children:i,...s}=t;aI(i)&&"function"==typeof aL&&(i=aL(i._payload));let r=$.Children.toArray(i),l=r.find(az);if(l){let t=l.props.children,i=r.map(e=>e!==l?e:$.Children.count(t)>1?$.Children.only(null):$.isValidElement(t)?t.props.children:null);return(0,L.jsx)(n,{...s,ref:e,children:$.isValidElement(t)?$.cloneElement(t,void 0,i):null})}return(0,L.jsx)(n,{...s,ref:e,children:i})})).displayName=`${i}.Slot`,l),a=$.forwardRef((t,i)=>{let{asChild:s,...r}=t;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,L.jsx)(s?o:e,{...r,ref:i})});return a.displayName=`Primitive.${e}`,{...t,[e]:a}},{}),aD=globalThis?.document?$.useLayoutEffect:()=>{},aO=$[" useId ".trim().toString()]||(()=>void 0),aB=0;function a$(t){let[e,i]=$.useState(aO());return aD(()=>{t||i(t=>t??String(aB++))},[t]),t||(e?`radix-${e}`:"")}var aW=t.i(34960),aK='[cmdk-group=""]',aV='[cmdk-group-items=""]',aU='[cmdk-item=""]',aH=`${aU}:not([aria-disabled="true"])`,aJ="cmdk-item-select",aq="data-value",aY=(t,e,i)=>{var s;return s=t,function t(e,i,s,r,n,l,o){if(l===i.length)return n===e.length?1:.99;var a=`${n},${l}`;if(void 0!==o[a])return o[a];for(var h,u,c,d,m=r.charAt(l),p=s.indexOf(m,n),f=0;p>=0;)(h=t(e,i,s,r,p+1,l+1,o))>f&&(p===n?h*=1:o7.test(e.charAt(p-1))?(h*=.8,(c=e.slice(n,p-1).match(o8))&&n>0&&(h*=Math.pow(.999,c.length))):at.test(e.charAt(p-1))?(h*=.9,(d=e.slice(n,p-1).match(ae))&&n>0&&(h*=Math.pow(.999,d.length))):(h*=.17,n>0&&(h*=Math.pow(.999,p-n))),e.charAt(p)!==i.charAt(l)&&(h*=.9999)),(h<.1&&s.charAt(p-1)===r.charAt(l+1)||r.charAt(l+1)===r.charAt(l)&&s.charAt(p-1)!==r.charAt(l))&&.1*(u=t(e,i,s,r,p+1,l+2,o))>h&&(h=.1*u),h>f&&(f=h),p=s.indexOf(m,p+1);return o[a]=f,f}(s=i&&i.length>0?`${s+" "+i.join(" ")}`:s,e,ai(s),ai(e),0,0,{})},aX=$.createContext(void 0),aG=$.createContext(void 0),aQ=$.createContext(void 0),aZ=$.forwardRef((t,e)=>{let i=a8(()=>{var e,i;return{search:"",value:null!=(i=null!=(e=t.value)?e:t.defaultValue)?i:"",filtered:{count:0,items:new Map,groups:new Set}}}),s=a8(()=>new Set),r=a8(()=>new Map),n=a8(()=>new Map),l=a8(()=>new Set),o=a9(t),{label:a,children:h,value:u,onValueChange:c,filter:d,shouldFilter:m,loop:p,disablePointerSelection:f=!1,vimBindings:g=!0,...v}=t,x=a$(),w=a$(),y=a$(),b=$.useRef(null),S=hs();a7(()=>{if(void 0!==u){let t=u.trim();i.current.value=t,j.emit()}},[u]),a7(()=>{S(6,k)},[]);let j=$.useMemo(()=>({subscribe:t=>(l.current.add(t),()=>l.current.delete(t)),snapshot:()=>i.current,setState:(t,e,s)=>{var r,n,l;if(!Object.is(i.current[t],e)){if(i.current[t]=e,"search"===t)P(),N(),S(1,E);else if("value"===t&&(s||S(5,k),(null==(r=o.current)?void 0:r.value)!==void 0)){null==(l=(n=o.current).onValueChange)||l.call(n,null!=e?e:"");return}j.emit()}},emit:()=>{l.current.forEach(t=>t())}}),[]),M=$.useMemo(()=>({value:(t,e,s)=>{var r;e!==(null==(r=n.current.get(t))?void 0:r.value)&&(n.current.set(t,{value:e,keywords:s}),i.current.filtered.items.set(t,C(e,s)),S(2,()=>{N(),j.emit()}))},item:(t,e)=>(s.current.add(t),e&&(r.current.has(e)?r.current.get(e).add(t):r.current.set(e,new Set([t]))),S(3,()=>{P(),N(),i.current.value||E(),j.emit()}),()=>{n.current.delete(t),s.current.delete(t),i.current.filtered.items.delete(t);let e=_();S(4,()=>{P(),(null==e?void 0:e.getAttribute("id"))===t&&E(),j.emit()})}),group:t=>(r.current.has(t)||r.current.set(t,new Set),()=>{n.current.delete(t),r.current.delete(t)}),filter:()=>o.current.shouldFilter,label:a||t["aria-label"],getDisablePointerSelection:()=>o.current.disablePointerSelection,listId:x,inputId:y,labelId:w,listInnerRef:b}),[]);function C(t,e){var s,r;let n=null!=(r=null==(s=o.current)?void 0:s.filter)?r:aY;return t?n(t,i.current.search,e):0}function N(){if(!i.current.search||!1===o.current.shouldFilter)return;let t=i.current.filtered.items,e=[];i.current.filtered.groups.forEach(i=>{let s=r.current.get(i),n=0;s.forEach(e=>{n=Math.max(t.get(e),n)}),e.push([i,n])});let s=b.current;R().sort((e,i)=>{var s,r;let n=e.getAttribute("id"),l=i.getAttribute("id");return(null!=(s=t.get(l))?s:0)-(null!=(r=t.get(n))?r:0)}).forEach(t=>{let e=t.closest(aV);e?e.appendChild(t.parentElement===e?t:t.closest(`${aV} > *`)):s.appendChild(t.parentElement===s?t:t.closest(`${aV} > *`))}),e.sort((t,e)=>e[1]-t[1]).forEach(t=>{var e;let i=null==(e=b.current)?void 0:e.querySelector(`${aK}[${aq}="${encodeURIComponent(t[0])}"]`);null==i||i.parentElement.appendChild(i)})}function E(){let t=R().find(t=>"true"!==t.getAttribute("aria-disabled")),e=null==t?void 0:t.getAttribute(aq);j.setState("value",e||void 0)}function P(){var t,e,l,a;if(!i.current.search||!1===o.current.shouldFilter){i.current.filtered.count=s.current.size;return}i.current.filtered.groups=new Set;let h=0;for(let r of s.current){let s=C(null!=(e=null==(t=n.current.get(r))?void 0:t.value)?e:"",null!=(a=null==(l=n.current.get(r))?void 0:l.keywords)?a:[]);i.current.filtered.items.set(r,s),s>0&&h++}for(let[t,e]of r.current)for(let s of e)if(i.current.filtered.items.get(s)>0){i.current.filtered.groups.add(t);break}i.current.filtered.count=h}function k(){var t,e,i;let s=_();s&&((null==(t=s.parentElement)?void 0:t.firstChild)===s&&(null==(i=null==(e=s.closest(aK))?void 0:e.querySelector('[cmdk-group-heading=""]'))||i.scrollIntoView({block:"nearest"})),s.scrollIntoView({block:"nearest"}))}function _(){var t;return null==(t=b.current)?void 0:t.querySelector(`${aU}[aria-selected="true"]`)}function R(){var t;return Array.from((null==(t=b.current)?void 0:t.querySelectorAll(aH))||[])}function T(t){let e=R()[t];e&&j.setState("value",e.getAttribute(aq))}function L(t){var e;let i=_(),s=R(),r=s.findIndex(t=>t===i),n=s[r+t];null!=(e=o.current)&&e.loop&&(n=r+t<0?s[s.length-1]:r+t===s.length?s[0]:s[r+t]),n&&j.setState("value",n.getAttribute(aq))}function I(t){let e=_(),i=null==e?void 0:e.closest(aK),s;for(;i&&!s;)s=null==(i=t>0?function(t,e){let i=t.nextElementSibling;for(;i;){if(i.matches(e))return i;i=i.nextElementSibling}}(i,aK):function(t,e){let i=t.previousElementSibling;for(;i;){if(i.matches(e))return i;i=i.previousElementSibling}}(i,aK))?void 0:i.querySelector(aH);s?j.setState("value",s.getAttribute(aq)):L(t)}let F=()=>T(R().length-1),z=t=>{t.preventDefault(),t.metaKey?F():t.altKey?I(1):L(1)},A=t=>{t.preventDefault(),t.metaKey?T(0):t.altKey?I(-1):L(-1)};return $.createElement(aA.div,{ref:e,tabIndex:-1,...v,"cmdk-root":"",onKeyDown:t=>{var e;if(null==(e=v.onKeyDown)||e.call(v,t),!t.defaultPrevented)switch(t.key){case"n":case"j":g&&t.ctrlKey&&z(t);break;case"ArrowDown":z(t);break;case"p":case"k":g&&t.ctrlKey&&A(t);break;case"ArrowUp":A(t);break;case"Home":t.preventDefault(),T(0);break;case"End":t.preventDefault(),F();break;case"Enter":if(!t.nativeEvent.isComposing&&229!==t.keyCode){t.preventDefault();let e=_();if(e){let t=new Event(aJ);e.dispatchEvent(t)}}}}},$.createElement("label",{"cmdk-label":"",htmlFor:M.inputId,id:M.labelId,style:hn},a),hr(t,t=>$.createElement(aG.Provider,{value:j},$.createElement(aX.Provider,{value:M},t))))}),a0=$.forwardRef((t,e)=>{var i,s;let r=a$(),n=$.useRef(null),l=$.useContext(aQ),o=$.useContext(aX),a=a9(t),h=null!=(s=null==(i=a.current)?void 0:i.forceMount)?s:null==l?void 0:l.forceMount;a7(()=>{if(!h)return o.item(r,null==l?void 0:l.id)},[h]);let u=hi(r,n,[t.value,t.children,n],t.keywords),c=$.useContext(aG),d=he(t=>t.value&&t.value===u.current),m=he(t=>!!h||!1===o.filter()||!t.search||t.filtered.items.get(r)>0);function p(){var t,e;f(),null==(e=(t=a.current).onSelect)||e.call(t,u.current)}function f(){c.setState("value",u.current,!0)}if($.useEffect(()=>{let e=n.current;if(!(!e||t.disabled))return e.addEventListener(aJ,p),()=>e.removeEventListener(aJ,p)},[m,t.onSelect,t.disabled]),!m)return null;let{disabled:g,value:v,onSelect:x,forceMount:w,keywords:y,...b}=t;return $.createElement(aA.div,{ref:ht([n,e]),...b,id:r,"cmdk-item":"",role:"option","aria-disabled":!!g,"aria-selected":!!d,"data-disabled":!!g,"data-selected":!!d,onPointerMove:g||o.getDisablePointerSelection()?void 0:f,onClick:g?void 0:p},t.children)}),a1=$.forwardRef((t,e)=>{let{heading:i,children:s,forceMount:r,...n}=t,l=a$(),o=$.useRef(null),a=$.useRef(null),h=a$(),u=$.useContext(aX),c=he(t=>!!r||!1===u.filter()||!t.search||t.filtered.groups.has(l));a7(()=>u.group(l),[]),hi(l,o,[t.value,t.heading,a]);let d=$.useMemo(()=>({id:l,forceMount:r}),[r]);return $.createElement(aA.div,{ref:ht([o,e]),...n,"cmdk-group":"",role:"presentation",hidden:!c||void 0},i&&$.createElement("div",{ref:a,"cmdk-group-heading":"","aria-hidden":!0,id:h},i),hr(t,t=>$.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":i?h:void 0},$.createElement(aQ.Provider,{value:d},t))))}),a2=$.forwardRef((t,e)=>{let{alwaysRender:i,...s}=t,r=$.useRef(null),n=he(t=>!t.search);return i||n?$.createElement(aA.div,{ref:ht([r,e]),...s,"cmdk-separator":"",role:"separator"}):null}),a3=$.forwardRef((t,e)=>{let{onValueChange:i,...s}=t,r=null!=t.value,n=$.useContext(aG),l=he(t=>t.search),o=he(t=>t.value),a=$.useContext(aX),h=$.useMemo(()=>{var t;let e=null==(t=a.listInnerRef.current)?void 0:t.querySelector(`${aU}[${aq}="${encodeURIComponent(o)}"]`);return null==e?void 0:e.getAttribute("id")},[]);return $.useEffect(()=>{null!=t.value&&n.setState("search",t.value)},[t.value]),$.createElement(aA.input,{ref:e,...s,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":a.listId,"aria-labelledby":a.labelId,"aria-activedescendant":h,id:a.inputId,type:"text",value:r?t.value:l,onChange:t=>{r||n.setState("search",t.target.value),null==i||i(t.target.value)}})}),a5=$.forwardRef((t,e)=>{let{children:i,label:s="Suggestions",...r}=t,n=$.useRef(null),l=$.useRef(null),o=$.useContext(aX);return $.useEffect(()=>{if(l.current&&n.current){let t=l.current,e=n.current,i,s=new ResizeObserver(()=>{i=requestAnimationFrame(()=>{let i=t.offsetHeight;e.style.setProperty("--cmdk-list-height",i.toFixed(1)+"px")})});return s.observe(t),()=>{cancelAnimationFrame(i),s.unobserve(t)}}},[]),$.createElement(aA.div,{ref:ht([n,e]),...r,"cmdk-list":"",role:"listbox","aria-label":s,id:o.listId},hr(t,t=>$.createElement("div",{ref:ht([l,o.listInnerRef]),"cmdk-list-sizer":""},t)))}),a4=$.forwardRef((t,e)=>{let{open:i,onOpenChange:s,overlayClassName:r,contentClassName:n,container:l,...o}=t;return $.createElement(aa,{open:i,onOpenChange:s},$.createElement(am,{container:l},$.createElement(af,{"cmdk-overlay":"",className:r}),$.createElement(ax,{"aria-label":t.label,"cmdk-dialog":"",className:n},$.createElement(aZ,{ref:e,...o}))))}),a6=Object.assign(aZ,{List:a5,Item:a0,Input:a3,Group:a1,Separator:a2,Dialog:a4,Empty:$.forwardRef((t,e)=>he(t=>0===t.filtered.count)?$.createElement(aA.div,{ref:e,...t,"cmdk-empty":"",role:"presentation"}):null),Loading:$.forwardRef((t,e)=>{let{progress:i,children:s,label:r="Loading...",...n}=t;return $.createElement(aA.div,{ref:e,...n,"cmdk-loading":"",role:"progressbar","aria-valuenow":i,"aria-valuemin":0,"aria-valuemax":100,"aria-label":r},hr(t,t=>$.createElement("div",{"aria-hidden":!0},t)))})});function a9(t){let e=$.useRef(t);return a7(()=>{e.current=t}),e}var a7="undefined"==typeof window?$.useEffect:$.useLayoutEffect;function a8(t){let e=$.useRef();return void 0===e.current&&(e.current=t()),e}function ht(t){return e=>{t.forEach(t=>{"function"==typeof t?t(e):null!=t&&(t.current=e)})}}function he(t){let e=$.useContext(aG),i=()=>t(e.snapshot());return(0,aW.useSyncExternalStore)(e.subscribe,i,i)}function hi(t,e,i,s=[]){let r=$.useRef(),n=$.useContext(aX);return a7(()=>{var l;let o=(()=>{var t;for(let e of i){if("string"==typeof e)return e.trim();if("object"==typeof e&&"current"in e)return e.current?null==(t=e.current.textContent)?void 0:t.trim():r.current}})(),a=s.map(t=>t.trim());n.value(t,o,a),null==(l=e.current)||l.setAttribute(aq,o),r.current=o}),r}var hs=()=>{let[t,e]=$.useState(),i=a8(()=>new Map);return a7(()=>{i.current.forEach(t=>t()),i.current=new Map},[t]),(t,s)=>{i.current.set(t,s),e({})}};function hr({asChild:t,children:e},i){let s;return t&&$.isValidElement(e)?$.cloneElement("function"==typeof(s=e.type)?s(e.props):"render"in s?s.render(e.props):e,{ref:e.ref},i(e.props.children)):i(e)}var hn={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};let hl=(0,sq.default)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);function ho({className:t,...e}){return(0,L.jsx)(a6,{"data-slot":"command",className:(0,I.cn)("bg-popover text-popover-foreground flex h-full w-full flex-col overflow-hidden rounded-md",t),...e})}function ha({className:t,...e}){return(0,L.jsxs)("div",{"data-slot":"command-input-wrapper",className:"flex h-9 items-center gap-2 border-b px-3",children:[(0,L.jsx)(hl,{className:"size-4 shrink-0 opacity-50"}),(0,L.jsx)(a6.Input,{"data-slot":"command-input",className:(0,I.cn)("placeholder:text-muted-foreground flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-hidden disabled:cursor-not-allowed disabled:opacity-50",t),...e})]})}function hh({className:t,...e}){return(0,L.jsx)(a6.List,{"data-slot":"command-list",className:(0,I.cn)("max-h-[300px] scroll-py-1 overflow-x-hidden overflow-y-auto",t),...e})}function hu({...t}){return(0,L.jsx)(a6.Empty,{"data-slot":"command-empty",className:"py-6 text-center text-sm",...t})}function hc({className:t,...e}){return(0,L.jsx)(a6.Group,{"data-slot":"command-group",className:(0,I.cn)("text-foreground [&_[cmdk-group-heading]]:text-muted-foreground overflow-hidden p-1 [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium",t),...e})}function hd({className:t,...e}){return(0,L.jsx)(a6.Item,{"data-slot":"command-item",className:(0,I.cn)("data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled=true]:pointer-events-none data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...e})}function hm({className:t,type:e,...i}){return(0,L.jsx)("input",{type:e,"data-slot":"input",className:(0,I.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t),...i})}function hp({data:t,onCandleClick:e,isLoading:i,tradingPair:s,onTradingPairChange:r,klineInterval:n,onIntervalChange:l,popularPairs:o,intervals:a,onTimePointChange:h,endTime:u,limit:c=100,onLimitChange:d,onForceReload:m}){let p=(0,$.useRef)(null),f=(0,$.useRef)(null),g=(0,$.useRef)(null),v=(0,$.useRef)(null),[x,w]=(0,$.useState)(""),[y,b]=(0,$.useState)(""),[S,j]=(0,$.useState)(!1),[M,C]=(0,$.useState)(()=>localStorage.getItem("klineSelectedDate")||""),[N,E]=(0,$.useState)(()=>localStorage.getItem("klineSelectedTime")||""),[P,k]=(0,$.useState)(()=>{{let t=localStorage.getItem("markedCandleTime");return t?Number.parseInt(t):null}});return(0,$.useEffect)(()=>{if(!p.current)return;let t=()=>{var e,i,s,r;let n;if(!p.current)return;let l=p.current.offsetWidth;if(0===l)return void setTimeout(t,100);let o=(e=p.current,i={width:l,height:400,layout:{background:{color:"transparent"},textColor:"#9ca3af"},grid:{vertLines:{color:"rgba(156, 163, 175, 0.1)"},horzLines:{color:"rgba(156, 163, 175, 0.1)"}},timeScale:{timeVisible:!0,borderVisible:!1,tickMarkFormatter:t=>{let e=new Date(new Date(1e3*t).getTime()+288e5),i=String(e.getUTCMonth()+1).padStart(2,"0"),s=String(e.getUTCDate()).padStart(2,"0"),r=String(e.getUTCHours()).padStart(2,"0"),n=String(e.getUTCMinutes()).padStart(2,"0");return`${i}-${s} ${r}:${n}`}},rightPriceScale:{borderVisible:!1},crosshair:{mode:1},localization:{timeFormatter:t=>{let e=new Date(new Date(1e3*t).getTime()+288e5),i=e.getUTCFullYear(),s=String(e.getUTCMonth()+1).padStart(2,"0"),r=String(e.getUTCDate()).padStart(2,"0"),n=String(e.getUTCHours()).padStart(2,"0"),l=String(e.getUTCMinutes()).padStart(2,"0"),o=String(e.getUTCSeconds()).padStart(2,"0");return`${i}-${s}-${r} ${n}:${l}:${o}`}}},s=new iu,r=iu.pf(i),n=new sk(function(t){if(tl(t)){let e=document.getElementById(t);return Q(null!==e,`Cannot find element in DOM with id=${t}`),e}return t}(e),s,r),s.setOptions(n.options()),n),a=o.addSeries(sL,{upColor:"#10b981",downColor:"#ef4444",borderVisible:!1,wickUpColor:"#10b981",wickDownColor:"#ef4444"}),h=new sJ(a,new sH((void 0)??{}));f.current=o,g.current=a,v.current=h},e=setTimeout(t,50),i=()=>{p.current&&f.current&&f.current.applyOptions({width:p.current.offsetWidth})};return window.addEventListener("resize",i),()=>{clearTimeout(e),window.removeEventListener("resize",i),v.current&&(v.current.detach(),v.current=null),f.current&&(f.current.remove(),f.current=null,g.current=null)}},[]),(0,$.useEffect)(()=>{if(g.current&&t.length>0){let e=t.map(t=>({time:t.time/1e3,open:t.open,high:t.high,low:t.low,close:t.close}));g.current.setData(e),f.current&&f.current.timeScale().fitContent()}},[t]),(0,$.useEffect)(()=>{if(v.current)if(null!==P)if(t.find(t=>t.time===P)){console.log("[v0] Setting marker for time:",P);let t=[{time:P/1e3,position:"aboveBar",color:"#000000",shape:"arrowDown",text:"å·²é€‰"}];v.current.setMarkers(t)}else console.log("[v0] Clearing markers - candle not found"),v.current.setMarkers([]);else console.log("[v0] Clearing markers - markedCandleTime is null"),v.current.setMarkers([])},[P,t]),(0,$.useEffect)(()=>{if(!f.current||!e)return;let i=i=>{if(!i.time)return;let s=i.time,r=t.findIndex(t=>t.time/1e3===s);if(r>=0){let i=t[r],s=t.slice(0,r+1);console.log("[v0] Candle clicked, time:",i.time),k(i.time),e(s,i)}};return f.current.subscribeClick(i),()=>{f.current&&f.current.unsubscribeClick(i)}},[t,e]),(0,$.useEffect)(()=>{M?localStorage.setItem("klineSelectedDate",M):localStorage.removeItem("klineSelectedDate")},[M]),(0,$.useEffect)(()=>{N?localStorage.setItem("klineSelectedTime",N):localStorage.removeItem("klineSelectedTime")},[N]),(0,$.useEffect)(()=>{null!==P?localStorage.setItem("markedCandleTime",P.toString()):localStorage.removeItem("markedCandleTime")},[P]),(0,L.jsxs)("div",{className:"space-y-4",children:[P&&(0,L.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground bg-muted/50 px-3 py-2 rounded-md",children:[(0,L.jsx)("span",{className:"text-black dark:text-white",children:"â—"}),(0,L.jsxs)("span",{children:["å·²é€‰ä¸­èœ¡çƒ›: ",new Date(P).toLocaleString()]}),(0,L.jsx)(sX.Button,{variant:"ghost",size:"sm",className:"h-6 px-2 ml-auto",onClick:()=>{console.log("[v0] Clear marker button clicked"),k(null)},children:"æ¸…é™¤æ ‡è®°"})]}),(0,L.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,L.jsxs)(o4,{children:[(0,L.jsx)(o6,{asChild:!0,children:(0,L.jsx)(sX.Button,{variant:"outline",className:"w-[140px] justify-between bg-transparent",children:(0,L.jsx)("span",{className:"truncate",children:s})})}),(0,L.jsx)(o9,{className:"w-[200px] p-0",align:"start",children:(0,L.jsxs)(ho,{children:[(0,L.jsx)(ha,{placeholder:"æœç´¢äº¤æ˜“å¯¹...",value:x,onValueChange:w}),(0,L.jsxs)(hh,{children:[(0,L.jsx)(hu,{children:"æœªæ‰¾åˆ°äº¤æ˜“å¯¹"}),(0,L.jsx)(hc,{children:o.filter(t=>t.toLowerCase().includes(x.toLowerCase())).map(t=>(0,L.jsx)(hd,{value:t,onSelect:()=>{r(t),w("")},children:t},t))})]})]})})]}),(0,L.jsxs)("div",{className:"flex items-center gap-2",children:[(0,L.jsxs)(ok,{value:S?"custom":n,onValueChange:t=>{"custom"===t?j(!0):(j(!1),l(t))},children:[(0,L.jsx)(oR,{className:"w-[110px]",children:(0,L.jsx)(o_,{children:S?"è‡ªå®šä¹‰":a.find(t=>t.value===n)?.label})}),(0,L.jsxs)(oT,{children:[a.map(t=>(0,L.jsx)(oL,{value:t.value,children:t.label},t.value)),(0,L.jsx)(oL,{value:"custom",children:"è‡ªå®šä¹‰å‘¨æœŸ"})]})]}),S&&(0,L.jsxs)("div",{className:"flex items-center gap-2",children:[(0,L.jsx)(hm,{type:"text",placeholder:"å¦‚: 30m, 2h, 1d",value:y,onChange:t=>b(t.target.value),className:"w-[120px] h-9"}),(0,L.jsx)(sX.Button,{size:"sm",onClick:()=>{y.trim()&&(l(y.trim()),j(!0))},variant:"outline",children:"åº”ç”¨"})]})]}),(0,L.jsxs)(ok,{value:c.toString(),onValueChange:t=>{let e=Number.parseInt(t);d&&d(e)},children:[(0,L.jsx)(oR,{className:"w-[120px]",children:(0,L.jsxs)(o_,{children:[c," ä¸ªå‘¨æœŸ"]})}),(0,L.jsxs)(oT,{children:[(0,L.jsx)(oL,{value:"50",children:"50 ä¸ªå‘¨æœŸ"}),(0,L.jsx)(oL,{value:"100",children:"100 ä¸ªå‘¨æœŸ"}),(0,L.jsx)(oL,{value:"200",children:"200 ä¸ªå‘¨æœŸ"}),(0,L.jsx)(oL,{value:"500",children:"500 ä¸ªå‘¨æœŸ"}),(0,L.jsx)(oL,{value:"1000",children:"1000 ä¸ªå‘¨æœŸ"})]})]}),(0,L.jsxs)("div",{className:"flex items-center gap-2",children:[(0,L.jsx)(hm,{type:"date",value:M,onChange:t=>C(t.target.value),className:"w-[150px] h-9"}),(0,L.jsx)(hm,{type:"time",value:N,onChange:t=>E(t.target.value),className:"w-[120px] h-9"}),(0,L.jsx)(sX.Button,{size:"sm",variant:"outline",onClick:()=>{C(""),E(""),localStorage.removeItem("klineSelectedDate"),localStorage.removeItem("klineSelectedTime")},className:"h-9 px-3 bg-transparent",title:"æ¸…é™¤æ—¥æœŸæ—¶é—´",children:(0,L.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"size-4",children:[(0,L.jsx)("path",{d:"M18 6 6 18"}),(0,L.jsx)("path",{d:"m6 6 12 12"})]})}),(0,L.jsx)(sX.Button,{size:"sm",variant:"outline",onClick:()=>{let t;(t=M||N?M&&N?new Date(`${M}T${N}`).getTime():0:Date.now())>0&&h&&h(t),m&&m()},disabled:i,className:"h-9 px-3 bg-transparent",title:"é‡è½½å›¾è¡¨æ•°æ®",children:(0,L.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"size-4",children:(0,L.jsx)("path",{d:"M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2"})})})]})]}),(0,L.jsxs)("div",{className:"relative w-full min-h-[400px]",children:[i&&(0,L.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-background/80 backdrop-blur-sm z-10",children:(0,L.jsx)(sY,{className:"size-8 animate-spin text-primary"})}),(0,L.jsx)("div",{ref:p,className:"w-full"})]})]})}t.i(34853);var hf=t.i(70065);let hg=(0,sq.default)("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),hv=(0,sq.default)("List",[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]]),hx=(0,sq.default)("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),hw=(0,sq.default)("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),hy=(0,sq.default)("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),hb=(0,sq.default)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),hS=(0,sq.default)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),hj=(0,sq.default)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),hM=(0,sq.default)("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]),hC=(0,sq.default)("CircleStop",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{x:"9",y:"9",width:"6",height:"6",rx:"1",key:"1ssd4o"}]]),hN=(0,sq.default)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),hE=(0,sq.default)("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),hP=(0,sq.default)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]),hk=(0,sq.default)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),h_=(0,sq.default)("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);var hR=t.i(34290);let hT=(0,sq.default)("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]),hL=(0,sq.default)("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),hI=(0,sq.default)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),hF=(0,sq.default)("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]),hz=(0,sq.default)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);var hA=$.forwardRef((t,e)=>(0,L.jsx)(s4.label,{...t,ref:e,onMouseDown:e=>{e.target.closest("button, input, select, textarea")||(t.onMouseDown?.(e),!e.defaultPrevented&&e.detail>1&&e.preventDefault())}}));function hD({className:t,...e}){return(0,L.jsx)(hA,{"data-slot":"label",className:(0,I.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",t),...e})}function hO({className:t,...e}){return(0,L.jsx)("textarea",{"data-slot":"textarea",className:(0,I.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),...e})}hA.displayName="Label";let hB=0,h$=new Map,hW=t=>{if(h$.has(t))return;let e=setTimeout(()=>{h$.delete(t),hU({type:"REMOVE_TOAST",toastId:t})},1e6);h$.set(t,e)},hK=[],hV={toasts:[]};function hU(t){hV=((t,e)=>{switch(e.type){case"ADD_TOAST":return{...t,toasts:[e.toast,...t.toasts].slice(0,1)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(t=>t.id===e.toast.id?{...t,...e.toast}:t)};case"DISMISS_TOAST":{let{toastId:i}=e;return i?hW(i):t.toasts.forEach(t=>{hW(t.id)}),{...t,toasts:t.toasts.map(t=>t.id===i||void 0===i?{...t,open:!1}:t)}}case"REMOVE_TOAST":if(void 0===e.toastId)return{...t,toasts:[]};return{...t,toasts:t.toasts.filter(t=>t.id!==e.toastId)}}})(hV,t),hK.forEach(t=>{t(hV)})}function hH({...t}){let e=(hB=(hB+1)%Number.MAX_SAFE_INTEGER).toString(),i=()=>hU({type:"DISMISS_TOAST",toastId:e});return hU({type:"ADD_TOAST",toast:{...t,id:e,open:!0,onOpenChange:t=>{t||i()}}}),{id:e,dismiss:i,update:t=>hU({type:"UPDATE_TOAST",toast:{...t,id:e}})}}function hJ(){let[t,e]=$.useState(hV);return $.useEffect(()=>(hK.push(e),()=>{let t=hK.indexOf(e);t>-1&&hK.splice(t,1)}),[t]),{...t,toast:hH,dismiss:t=>hU({type:"DISMISS_TOAST",toastId:t})}}var hq="ToastProvider",[hY,hX,hG]=s3("Toast"),[hQ,hZ]=s0("Toast",[hG]),[h0,h1]=hQ(hq),h2=t=>{let{__scopeToast:e,label:i="Notification",duration:s=5e3,swipeDirection:r="right",swipeThreshold:n=50,children:l}=t,[o,a]=$.useState(null),[h,u]=$.useState(0),c=$.useRef(!1),d=$.useRef(!1);return i.trim()||console.error(`Invalid prop \`label\` supplied to \`${hq}\`. Expected non-empty \`string\`.`),(0,L.jsx)(hY.Provider,{scope:e,children:(0,L.jsx)(h0,{scope:e,label:i,duration:s,swipeDirection:r,swipeThreshold:n,toastCount:h,viewport:o,onViewportChange:a,onToastAdd:$.useCallback(()=>u(t=>t+1),[]),onToastRemove:$.useCallback(()=>u(t=>t-1),[]),isFocusedToastEscapeKeyDownRef:c,isClosePausedRef:d,children:l})})};h2.displayName=hq;var h3="ToastViewport",h5=["F8"],h4="toast.viewportPause",h6="toast.viewportResume",h9=$.forwardRef((t,e)=>{let{__scopeToast:i,hotkey:s=h5,label:r="Notifications ({hotkey})",...n}=t,l=h1(h3,i),o=hX(i),a=$.useRef(null),h=$.useRef(null),u=$.useRef(null),c=$.useRef(null),d=(0,s1.useComposedRefs)(e,c,l.onViewportChange),m=s.join("+").replace(/Key/g,"").replace(/Digit/g,""),p=l.toastCount>0;$.useEffect(()=>{let t=t=>{0!==s.length&&s.every(e=>t[e]||t.code===e)&&c.current?.focus()};return document.addEventListener("keydown",t),()=>document.removeEventListener("keydown",t)},[s]),$.useEffect(()=>{let t=a.current,e=c.current;if(p&&t&&e){let i=()=>{if(!l.isClosePausedRef.current){let t=new CustomEvent(h4);e.dispatchEvent(t),l.isClosePausedRef.current=!0}},s=()=>{if(l.isClosePausedRef.current){let t=new CustomEvent(h6);e.dispatchEvent(t),l.isClosePausedRef.current=!1}},r=e=>{t.contains(e.relatedTarget)||s()},n=()=>{t.contains(document.activeElement)||s()};return t.addEventListener("focusin",i),t.addEventListener("focusout",r),t.addEventListener("pointermove",i),t.addEventListener("pointerleave",n),window.addEventListener("blur",i),window.addEventListener("focus",s),()=>{t.removeEventListener("focusin",i),t.removeEventListener("focusout",r),t.removeEventListener("pointermove",i),t.removeEventListener("pointerleave",n),window.removeEventListener("blur",i),window.removeEventListener("focus",s)}}},[p,l.isClosePausedRef]);let f=$.useCallback(({tabbingDirection:t})=>{let e=o().map(e=>{let i=e.ref.current,s=[i,...function(t){let e=[],i=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:t=>{let e="INPUT"===t.tagName&&"hidden"===t.type;return t.disabled||t.hidden||e?NodeFilter.FILTER_SKIP:t.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;i.nextNode();)e.push(i.currentNode);return e}(i)];return"forwards"===t?s:s.reverse()});return("forwards"===t?e.reverse():e).flat()},[o]);return $.useEffect(()=>{let t=c.current;if(t){let e=e=>{let i=e.altKey||e.ctrlKey||e.metaKey;if("Tab"===e.key&&!i){let i=document.activeElement,s=e.shiftKey;if(e.target===t&&s)return void h.current?.focus();let r=f({tabbingDirection:s?"backwards":"forwards"}),n=r.findIndex(t=>t===i);uf(r.slice(n+1))?e.preventDefault():s?h.current?.focus():u.current?.focus()}};return t.addEventListener("keydown",e),()=>t.removeEventListener("keydown",e)}},[o,f]),(0,L.jsxs)(re,{ref:a,role:"region","aria-label":r.replace("{hotkey}",m),tabIndex:-1,style:{pointerEvents:p?void 0:"none"},children:[p&&(0,L.jsx)(h8,{ref:h,onFocusFromOutsideViewport:()=>{uf(f({tabbingDirection:"forwards"}))}}),(0,L.jsx)(hY.Slot,{scope:i,children:(0,L.jsx)(s4.ol,{tabIndex:-1,...n,ref:d})}),p&&(0,L.jsx)(h8,{ref:u,onFocusFromOutsideViewport:()=>{uf(f({tabbingDirection:"backwards"}))}})]})});h9.displayName=h3;var h7="ToastFocusProxy",h8=$.forwardRef((t,e)=>{let{__scopeToast:i,onFocusFromOutsideViewport:s,...r}=t,n=h1(h7,i);return(0,L.jsx)(n0,{"aria-hidden":!0,tabIndex:0,...r,ref:e,style:{position:"fixed"},onFocus:t=>{let e=t.relatedTarget;n.viewport?.contains(e)||s()}})});h8.displayName=h7;var ut="Toast",ue=$.forwardRef((t,e)=>{let{forceMount:i,open:s,defaultOpen:r,onOpenChange:n,...l}=t,[o=!0,a]=nZ({prop:s,defaultProp:r,onChange:n});return(0,L.jsx)(oz,{present:i||o,children:(0,L.jsx)(ur,{open:o,...l,ref:e,onClose:()=>a(!1),onPause:s9(t.onPause),onResume:s9(t.onResume),onSwipeStart:sZ(t.onSwipeStart,t=>{t.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:sZ(t.onSwipeMove,t=>{let{x:e,y:i}=t.detail.delta;t.currentTarget.setAttribute("data-swipe","move"),t.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${e}px`),t.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${i}px`)}),onSwipeCancel:sZ(t.onSwipeCancel,t=>{t.currentTarget.setAttribute("data-swipe","cancel"),t.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),t.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),t.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),t.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:sZ(t.onSwipeEnd,t=>{let{x:e,y:i}=t.detail.delta;t.currentTarget.setAttribute("data-swipe","end"),t.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),t.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),t.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${e}px`),t.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${i}px`),a(!1)})})})});ue.displayName=ut;var[ui,us]=hQ(ut,{onClose(){}}),ur=$.forwardRef((t,e)=>{let{__scopeToast:i,type:s="foreground",duration:r,open:n,onClose:l,onEscapeKeyDown:o,onPause:a,onResume:h,onSwipeStart:u,onSwipeMove:c,onSwipeCancel:d,onSwipeEnd:m,...p}=t,f=h1(ut,i),[g,v]=$.useState(null),x=(0,s1.useComposedRefs)(e,t=>v(t)),w=$.useRef(null),y=$.useRef(null),b=r||f.duration,S=$.useRef(0),j=$.useRef(b),M=$.useRef(0),{onToastAdd:C,onToastRemove:N}=f,E=s9(()=>{g?.contains(document.activeElement)&&f.viewport?.focus(),l()}),P=$.useCallback(t=>{t&&t!==1/0&&(window.clearTimeout(M.current),S.current=new Date().getTime(),M.current=window.setTimeout(E,t))},[E]);$.useEffect(()=>{let t=f.viewport;if(t){let e=()=>{P(j.current),h?.()},i=()=>{let t=new Date().getTime()-S.current;j.current=j.current-t,window.clearTimeout(M.current),a?.()};return t.addEventListener(h4,i),t.addEventListener(h6,e),()=>{t.removeEventListener(h4,i),t.removeEventListener(h6,e)}}},[f.viewport,b,a,h,P]),$.useEffect(()=>{n&&!f.isClosePausedRef.current&&P(b)},[n,b,f.isClosePausedRef,P]),$.useEffect(()=>(C(),()=>N()),[C,N]);let k=$.useMemo(()=>g?function t(e){let i=[];return Array.from(e.childNodes).forEach(e=>{var s;if(e.nodeType===e.TEXT_NODE&&e.textContent&&i.push(e.textContent),(s=e).nodeType===s.ELEMENT_NODE){let s=e.ariaHidden||e.hidden||"none"===e.style.display,r=""===e.dataset.radixToastAnnounceExclude;if(!s)if(r){let t=e.dataset.radixToastAnnounceAlt;t&&i.push(t)}else i.push(...t(e))}}),i}(g):null,[g]);return f.viewport?(0,L.jsxs)(L.Fragment,{children:[k&&(0,L.jsx)(un,{__scopeToast:i,role:"status","aria-live":"foreground"===s?"assertive":"polite","aria-atomic":!0,children:k}),(0,L.jsx)(ui,{scope:i,onClose:E,children:sG.createPortal((0,L.jsx)(hY.ItemSlot,{scope:i,children:(0,L.jsx)(rt,{asChild:!0,onEscapeKeyDown:sZ(o,()=>{f.isFocusedToastEscapeKeyDownRef.current||E(),f.isFocusedToastEscapeKeyDownRef.current=!1}),children:(0,L.jsx)(s4.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":n?"open":"closed","data-swipe-direction":f.swipeDirection,...p,ref:x,style:{userSelect:"none",touchAction:"none",...t.style},onKeyDown:sZ(t.onKeyDown,t=>{"Escape"===t.key&&(o?.(t.nativeEvent),t.nativeEvent.defaultPrevented||(f.isFocusedToastEscapeKeyDownRef.current=!0,E()))}),onPointerDown:sZ(t.onPointerDown,t=>{0===t.button&&(w.current={x:t.clientX,y:t.clientY})}),onPointerMove:sZ(t.onPointerMove,t=>{if(!w.current)return;let e=t.clientX-w.current.x,i=t.clientY-w.current.y,s=!!y.current,r=["left","right"].includes(f.swipeDirection),n=["left","up"].includes(f.swipeDirection)?Math.min:Math.max,l=r?n(0,e):0,o=r?0:n(0,i),a="touch"===t.pointerType?10:2,h={x:l,y:o},d={originalEvent:t,delta:h};s?(y.current=h,um("toast.swipeMove",c,d,{discrete:!1})):up(h,f.swipeDirection,a)?(y.current=h,um("toast.swipeStart",u,d,{discrete:!1}),t.target.setPointerCapture(t.pointerId)):(Math.abs(e)>a||Math.abs(i)>a)&&(w.current=null)}),onPointerUp:sZ(t.onPointerUp,t=>{let e=y.current,i=t.target;if(i.hasPointerCapture(t.pointerId)&&i.releasePointerCapture(t.pointerId),y.current=null,w.current=null,e){let i=t.currentTarget,s={originalEvent:t,delta:e};up(e,f.swipeDirection,f.swipeThreshold)?um("toast.swipeEnd",m,s,{discrete:!0}):um("toast.swipeCancel",d,s,{discrete:!0}),i.addEventListener("click",t=>t.preventDefault(),{once:!0})}})})})}),f.viewport)})]}):null}),un=t=>{let{__scopeToast:e,children:i,...s}=t,r=h1(ut,e),[n,l]=$.useState(!1),[o,a]=$.useState(!1);return function(t=()=>{}){let e=s9(t);rg(()=>{let t=0,i=0;return t=window.requestAnimationFrame(()=>i=window.requestAnimationFrame(e)),()=>{window.cancelAnimationFrame(t),window.cancelAnimationFrame(i)}},[e])}(()=>l(!0)),$.useEffect(()=>{let t=window.setTimeout(()=>a(!0),1e3);return()=>window.clearTimeout(t)},[]),o?null:(0,L.jsx)(nQ,{asChild:!0,children:(0,L.jsx)(n0,{...s,children:n&&(0,L.jsxs)(L.Fragment,{children:[r.label," ",i]})})})},ul=$.forwardRef((t,e)=>{let{__scopeToast:i,...s}=t;return(0,L.jsx)(s4.div,{...s,ref:e})});ul.displayName="ToastTitle";var uo=$.forwardRef((t,e)=>{let{__scopeToast:i,...s}=t;return(0,L.jsx)(s4.div,{...s,ref:e})});uo.displayName="ToastDescription";var ua="ToastAction",uh=$.forwardRef((t,e)=>{let{altText:i,...s}=t;return i.trim()?(0,L.jsx)(ud,{altText:i,asChild:!0,children:(0,L.jsx)(uc,{...s,ref:e})}):(console.error(`Invalid prop \`altText\` supplied to \`${ua}\`. Expected non-empty \`string\`.`),null)});uh.displayName=ua;var uu="ToastClose",uc=$.forwardRef((t,e)=>{let{__scopeToast:i,...s}=t,r=us(uu,i);return(0,L.jsx)(ud,{asChild:!0,children:(0,L.jsx)(s4.button,{type:"button",...s,ref:e,onClick:sZ(t.onClick,r.onClose)})})});uc.displayName=uu;var ud=$.forwardRef((t,e)=>{let{__scopeToast:i,altText:s,...r}=t;return(0,L.jsx)(s4.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":s||void 0,...r,ref:e})});function um(t,e,i,{discrete:s}){let r=i.originalEvent.currentTarget,n=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:i});e&&r.addEventListener(t,e,{once:!0}),s?s6(r,n):r.dispatchEvent(n)}var up=(t,e,i=0)=>{let s=Math.abs(t.x),r=Math.abs(t.y),n=s>r;return"left"===e||"right"===e?n&&s>i:!n&&r>i};function uf(t){let e=document.activeElement;return t.some(t=>t===e||(t.focus(),document.activeElement!==e))}var ug=t.i(94237);let uv=$.forwardRef(({className:t,...e},i)=>(0,L.jsx)(h9,{ref:i,className:(0,I.cn)("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",t),...e}));uv.displayName=h9.displayName;let ux=(0,ug.cva)("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),uw=$.forwardRef(({className:t,variant:e,...i},s)=>(0,L.jsx)(ue,{ref:s,className:(0,I.cn)(ux({variant:e}),t),...i}));uw.displayName=ue.displayName,$.forwardRef(({className:t,...e},i)=>(0,L.jsx)(uh,{ref:i,className:(0,I.cn)("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",t),...e})).displayName=uh.displayName;let uy=$.forwardRef(({className:t,...e},i)=>(0,L.jsx)(uc,{ref:i,className:(0,I.cn)("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",t),"toast-close":"",...e,children:(0,L.jsx)(hR.X,{className:"h-4 w-4"})}));uy.displayName=uc.displayName;let ub=$.forwardRef(({className:t,...e},i)=>(0,L.jsx)(ul,{ref:i,className:(0,I.cn)("text-sm font-semibold",t),...e}));ub.displayName=ul.displayName;let uS=$.forwardRef(({className:t,...e},i)=>(0,L.jsx)(uo,{ref:i,className:(0,I.cn)("text-sm opacity-90",t),...e}));function uj(){let{toasts:t}=hJ();return(0,L.jsxs)(h2,{children:[t.map(function({id:t,title:e,description:i,action:s,...r}){return(0,L.jsxs)(uw,{...r,children:[(0,L.jsxs)("div",{className:"grid gap-1",children:[e&&(0,L.jsx)(ub,{children:e}),i&&(0,L.jsx)(uS,{children:i})]}),s,(0,L.jsx)(uy,{})]},t)}),(0,L.jsx)(uv,{})]})}uS.displayName=uo.displayName;let uM="history",uC="settings",uN="responseImages",uE=()=>new Promise((t,e)=>{let i=indexedDB.open("llm-api-test-db",2);i.onerror=()=>e(i.error),i.onsuccess=()=>t(i.result),i.onupgradeneeded=t=>{let e=t.target.result;e.objectStoreNames.contains(uM)||e.createObjectStore(uM,{keyPath:"id"}).createIndex("timestamp","timestamp",{unique:!1}),e.objectStoreNames.contains(uC)||e.createObjectStore(uC,{keyPath:"key"}),e.objectStoreNames.contains(uN)||e.createObjectStore(uN,{keyPath:"historyTimestamp"}).createIndex("timestamp","historyTimestamp",{unique:!0})}}),uP=async t=>{let e=await uE(),i=e.transaction([uM],"readwrite").objectStore(uM);for(let e of(await new Promise((t,e)=>{let s=i.clear();s.onsuccess=()=>t(),s.onerror=()=>e(s.error)}),t))await new Promise((t,s)=>{let r=i.add(e);r.onsuccess=()=>t(),r.onerror=()=>s(r.error)});e.close()},uk=async()=>{let t=await uE(),e=t.transaction([uM],"readonly").objectStore(uM);return new Promise((i,s)=>{let r=e.getAll();r.onsuccess=()=>{let e=r.result;e.sort((t,e)=>e.timestamp-t.timestamp),i(e),t.close()},r.onerror=()=>{s(r.error),t.close()}})},u_=async t=>{let e=await uE(),i=e.transaction([uC],"readwrite").objectStore(uC);return new Promise((s,r)=>{let n=i.put({key:"messageImages",value:t});n.onsuccess=()=>{s(),e.close()},n.onerror=()=>{r(n.error),e.close()}})},uR=async()=>{let t=await uE(),e=t.transaction([uC],"readonly").objectStore(uC);return new Promise((i,s)=>{let r=e.get("messageImages");r.onsuccess=()=>{let e=r.result;i(e?.value||[]),t.close()},r.onerror=()=>{s(r.error),t.close()}})},uT=async()=>{try{let t=localStorage.getItem("indexeddb_migration_complete");if("true"===t)return;let e=localStorage.getItem("llm_api_history");if(e){let t=JSON.parse(e);await uP(t),console.log("[v0] Migrated history to IndexedDB")}let i=localStorage.getItem("llm-api-test-settings");if(i){let t=JSON.parse(i);t.messageImages&&Array.isArray(t.messageImages)&&(await u_(t.messageImages),console.log("[v0] Migrated images to IndexedDB"))}localStorage.setItem("indexeddb_migration_complete","true"),localStorage.removeItem("llm_api_history"),console.log("[v0] Migration complete, cleaned up localStorage")}catch(t){console.error("[v0] Error during migration:",t)}},uL=async(t,e)=>{let i=await uE(),s=i.transaction([uN],"readwrite").objectStore(uN);return new Promise((r,n)=>{let l=s.put({historyTimestamp:t,images:e});l.onsuccess=()=>{r(),i.close()},l.onerror=()=>{n(l.error),i.close()}})},uI=async t=>{let e=await uE(),i=e.transaction([uN],"readonly").objectStore(uN);return new Promise((s,r)=>{let n=i.get(t);n.onsuccess=()=>{let t=n.result;s(t?.images||[]),e.close()},n.onerror=()=>{r(n.error),e.close()}})},uF=async t=>{let e=await uE(),i=e.transaction([uN],"readwrite").objectStore(uN);return new Promise((s,r)=>{let n=i.delete(t);n.onsuccess=()=>{s(),e.close()},n.onerror=()=>{r(n.error),e.close()}})},uz=async()=>{let t=await uE(),e=t.transaction([uM],"readwrite").objectStore(uM);await new Promise((t,i)=>{let s=e.clear();s.onsuccess=()=>t(),s.onerror=()=>i(s.error)});let i=t.transaction([uC],"readwrite").objectStore(uC);await new Promise((t,e)=>{let s=i.clear();s.onsuccess=()=>t(),s.onerror=()=>e(s.error)});let s=t.transaction([uN],"readwrite").objectStore(uN);await new Promise((t,e)=>{let i=s.clear();i.onsuccess=()=>t(),i.onerror=()=>e(i.error)}),t.close()},uA="fileHandles",uD=async t=>{try{if(t.queryPermission){let e=await t.queryPermission({mode:"read"});if("granted"===e)return!0;let i=await t.requestPermission({mode:"read"});return"granted"===i}return!0}catch(t){return console.error("[v0] Error checking/requesting file permission:",t),!1}},uO=()=>new Promise((t,e)=>{let i=indexedDB.open("llm-api-tester-db",1);i.onerror=()=>{console.log("[v0] IndexedDB open error:",i.error),e(i.error)},i.onsuccess=()=>{console.log("[v0] IndexedDB opened successfully"),t(i.result)},i.onupgradeneeded=t=>{console.log("[v0] IndexedDB upgrade needed, creating object store");let e=t.target.result;e.objectStoreNames.contains(uA)||e.createObjectStore(uA)}}),uB=async(t,e)=>{console.log("[v0] saveFileHandle called with key:",t,"handle:",e);try{let i=await uO();return console.log("[v0] DB opened for saving, starting transaction..."),new Promise(s=>{let r=i.transaction(uA,"readwrite"),n=r.objectStore(uA);console.log("[v0] Putting handle into store...");let l=n.put(e,t);l.onerror=t=>{console.log("[v0] Put request error:",l.error,t)},l.onsuccess=()=>{console.log("[v0] Put request success for:",t)},r.oncomplete=()=>{console.log("[v0] Transaction completed successfully for:",t),i.close(),s(!0)},r.onerror=t=>{console.log("[v0] Transaction error:",r.error,t),i.close(),s(!1)},r.onabort=t=>{console.log("[v0] Transaction aborted:",r.error,t),i.close(),s(!1)}})}catch(t){return console.log("[v0] Error in saveFileHandle:",t),!1}},u$=async t=>{console.log("[v0] getFileHandle called with key:",t);try{let e=await uO();return new Promise(i=>{let s=e.transaction(uA,"readonly").objectStore(uA).get(t);s.onerror=()=>{console.log("[v0] Failed to get file handle:",s.error),e.close(),i(null)},s.onsuccess=()=>{let r=s.result||null;console.log("[v0] Got file handle from IndexedDB:",t,r?"found":"not found"),e.close(),i(r)}})}catch(t){return console.log("[v0] Error in getFileHandle:",t),null}},uW=async t=>{console.log("[v0] deleteFileHandle called with key:",t);try{let e=await uO();return new Promise(i=>{let s=e.transaction(uA,"readwrite");s.objectStore(uA).delete(t),s.oncomplete=()=>{console.log("[v0] Delete transaction completed for:",t),e.close(),i()},s.onerror=()=>{console.log("[v0] Delete transaction error:",s.error),e.close(),i()}})}catch(t){console.log("[v0] Failed to delete file handle from IndexedDB:",t)}},uK=[{id:"openrouter",name:"OpenRouter",endpoint:"https://openrouter.ai/api/v1/chat/completions"},{id:"deepseek",name:"DeepSeek",endpoint:"https://api.deepseek.com/v1/chat/completions"},{id:"cerebras",name:"Cerebras",endpoint:"https://api.cerebras.ai/v1/chat/completions"},{id:"modelscope",name:"ModelScope",endpoint:"https://api-inference.modelscope.cn/v1/chat/completions"},{id:"custom",name:"è‡ªå®šä¹‰",endpoint:""}],uV=async t=>{let e=new Map;for(let i of t)try{let t=await uI(i.timestamp);if(t.length>0){let s=t.map(t=>t.base64||t.url||"").filter(Boolean);s.length>0&&e.set(i.timestamp,s)}}catch(t){console.warn(`[v0] Failed to load response images for timestamp ${i.timestamp}:`,t)}return e};function uU(){let t,e={provider:"openrouter",model:"",apiKey:"",baseURL:"https://openrouter.ai",apiPath:"/api/v1/chat/completions",systemPrompt:`Role: ä½ æ˜¯ä¸€ä½ç²¾é€šä»·æ ¼è¡Œä¸ºï¼ˆPrice Actionï¼‰ä¸Žé‡åŒ–åˆ†æžçš„åŠ å¯†è´§å¸é¦–å¸­åˆ†æžå¸ˆã€‚ä½ æ“…é•¿ä»ŽåŽŸå§‹ OHLCV æ•°æ®ä¸­å‰¥ç¦»å™ªéŸ³,è¯†åˆ«è¶‹åŠ¿æ‹ç‚¹åŠé«˜ç›ˆäºæ¯”çš„äº¤æ˜“æœºä¼šã€‚
Core Skills:
æ•°æ®æ¸…æ´—ä¸Žè®¡ç®—ï¼š èƒ½å¤Ÿæ ¹æ®æ”¶ç›˜ä»·åºåˆ—è®¡ç®—ç®€å•çš„ç§»åŠ¨å¹³å‡çº¿ (MA)ã€æ³¢åŠ¨çŽ‡ (ATR) åŠå¼ºå¼±æŒ‡æ ‡ (RSI)ã€‚
å½¢æ€è¯†åˆ«ï¼š è¯†åˆ«åžæ²¡å½¢æ€ã€é”¤å¤´çº¿ã€ç©¿å¤´ç ´è„šã€Våž‹åè½¬ç­‰ç»å…¸ K çº¿ç»„åˆã€‚
é‡ä»·åˆ†æžï¼š åˆ†æžæˆäº¤é‡å¯¹ä»·æ ¼å˜åŠ¨çš„æ”¯æ’‘æ€§ï¼ˆå¦‚ï¼šæ”¾é‡çªç ´ vs ç¼©é‡ä¸Šæ¶¨ï¼‰ã€‚
æ”¯æ’‘/åŽ‹åŠ›æŽ¢æµ‹ï¼š ä»ŽåŽ†å²é«˜ä½Žç‚¹ä¸­é”å®šå…³é”®çš„æµåŠ¨æ€§åŒºåŸŸã€‚
ANALYSIS LOGIC (é€»è¾‘åˆ†æžæ­¥éª¤):
å½¢æ€ç‰¹å¾æ‰«æï¼š
åˆ†æžæœ€è¿‘ 3-5 æ ¹ K çº¿ï¼šæ˜¯è¿žç»­é˜³çº¿/é˜´çº¿ï¼Ÿå®žä½“å¤§å°æ˜¯å¦åœ¨è¡°å‡ï¼Ÿ
æ˜¯å¦å­˜åœ¨é•¿å½±çº¿ï¼ˆæ’é’ˆï¼‰ï¼šåˆ¤æ–­å½±çº¿å‡ºçŽ°çš„å…³é”®ä»·æ ¼ä½åŠå…¶ä»£è¡¨çš„ä¾›éœ€åŽ‹åŠ›ã€‚
é‡ä»·é…åˆåº¦ï¼š
ç¡®è®¤å½“å‰çš„ä»·æ ¼æ³¢åŠ¨æ˜¯å¦æœ‰æˆäº¤é‡æ”¯æ’‘ï¼ˆVolume Confirmationï¼‰ã€‚
æ³¢åŠ¨çŽ‡è¯„ä¼°ï¼š
è§‚å¯Ÿé«˜ä½Žç‚¹æ³¢åŠ¨èŒƒå›´ï¼ˆHigh-Low Spreadï¼‰ï¼Œåˆ¤æ–­å¸‚åœºæ˜¯å¤„äºŽ"ä½Žæ³¢åŠ¨è“„åŠ¿"è¿˜æ˜¯"é«˜æ³¢åŠ¨æ´—ç›˜"ã€‚
è¶‹åŠ¿ç»“æž„å®šä¹‰ï¼š
ä½¿ç”¨ Higher Highs/Lower Lows å®šä¹‰å½“å‰æ˜¯ Bullish Trend, Bearish Trend è¿˜æ˜¯ Range-boundã€‚
FORMATTED OUTPUT (æ ¼å¼åŒ–è¾“å‡ºè§„èŒƒ):
ä½ å¿…é¡»ä¸¥æ ¼æŒ‰ç…§ä»¥ä¸‹ Markdown ç»“æž„å›žå¤ï¼Œç¦æ­¢é—²èŠï¼š
markdown
### ðŸ“Š å¸‚åœºç›˜é¢é‡åŒ–åˆ†æžæŠ¥å‘Š
**äº¤æ˜“å¯¹:** [å¸ç§] | **å‘¨æœŸ:** [æ—¶é—´ç»´åº¦] | **åˆ†æžæ—¶åˆ»:** [æ•°æ®æœ€åŽä¸€æ ¹Kçº¿çš„æ—¶é—´]

#### 1. ä»·æ ¼è¡Œä¸ºç»¼è¿° (Price Action)
*   **å½“å‰è¶‹åŠ¿:** [ä¾‹å¦‚ï¼š1h çº§åˆ« Våž‹åè½¬åŽè¿›å…¥é«˜ä½éœ‡è¡]
*   **æœ€è¿‘åŠ¨æ€:** [æè¿°æœ€åŽ 3 æ ¹ K çº¿çš„å®žä½“ä¸Žé‡æ¯”å…³ç³»]
*   **å…³é”®ä½:**
    *   ðŸ”´ é˜»åŠ›ä½: [ä»·æ ¼1], [ä»·æ ¼2]
    *   ðŸŸ¢ æ”¯æ’‘ä½: [ä»·æ ¼1], [ä»·æ ¼2]

#### 2. é‡ä»·å¼‚åŠ¨æ£€æµ‹ (Volume Analysis)
*   [ä¾‹å¦‚ï¼š2025-12-19 03:00 å‡ºçŽ°æ”¾é‡ä¸‹è·Œï¼Œæˆäº¤é‡4102ä¸ºè¿‘æœŸæœ€é«˜ï¼Œæ˜¾ç¤ºå–ç›˜ææ…Œï¼Œä½†éšåŽä»·æ ¼å›žå‡ï¼Œå½¢æˆå–ç›˜æž¯ç«­ã€‚]

#### 3. äº¤æ˜“ç­–ç•¥å»ºè®® (Tactical Advice)

| ç­–ç•¥ç±»åž‹ | è§¦å‘æ¡ä»¶ | å…¥åœºç›®æ ‡ | æ­¢æŸ (SL) | æ­¢ç›ˆ (TP) | ç›ˆäºæ¯”  |
| :-: | :-: | :-: | :-: | :-: | :-: |
| å¤šå• (Long)    | çªç ´å¹¶å›žæµ‹ [ä»·æ ¼]   | [ä»·æ ¼]   | [ä»·æ ¼]    | [ä»·æ ¼]    | [X:1]   |
| ç©ºå• (Short)   | è·Œç ´ [ä»·æ ¼] ç¡®è®¤    | [ä»·æ ¼]   | [ä»·æ ¼]    | [ä»·æ ¼]    | [X:1]   |

#### 4. æžç«¯é£Žé™©æç¤º
[ä¾‹å¦‚ï¼šRSI å¤„äºŽé«˜ä½ä¸”æˆäº¤é‡æŒç»­èŽç¼©ï¼Œå­˜åœ¨äºŒæŽ¢åº•éƒ¨çš„é£Žé™©ã€‚]`,userMessage:"ä½ æ˜¯è°ï¼Ÿä¸­æ–‡å›žå¤",promptFilePath:"",enablePromptFile:!1,systemPromptFilePath:"",enableSystemPromptFile:!1,autoReloadPrompt:!1,autoReloadSystemPrompt:!1,autoReloadImages:!1,maxTokens:4096,temperature:1,topP:1,frequencyPenalty:0,presencePenalty:0,showRawColumns:!1,expandRequestContent:!1,expandResponseContent:!1,timerEnabled:!1,timerInterval:60,maxTokensLimit:8192,pageSize:3,prompt:""},[i,s]=(0,$.useState)(e.provider),[r,n]=(0,$.useState)(""),[l,o]=(0,$.useState)(e.apiKey),[a,h]=(0,$.useState)(!1),[u,c]=(0,$.useState)(!1),[d,m]=(0,$.useState)(!1),[p,f]=(0,$.useState)(""),[g,v]=(0,$.useState)([]),[x,w]=(0,$.useState)([]),[y,b]=(0,$.useState)([]),[S,j]=(0,$.useState)(!1),[M,C]=(0,$.useState)(!1),[N,E]=(0,$.useState)([]),[P,k]=(0,$.useState)([]),[_,R]=(0,$.useState)(""),[T,I]=(0,$.useState)(""),[W,K]=(0,$.useState)(!1),[V,U]=(0,$.useState)(""),[H,J]=(0,$.useState)(e.maxTokens),[q,Y]=(0,$.useState)(e.temperature),[X,G]=(0,$.useState)(e.topP),[Q,Z]=(0,$.useState)(e.frequencyPenalty),[tt,te]=(0,$.useState)(e.presencePenalty),[ti,ts]=(0,$.useState)(!1),[tr,tn]=(0,$.useState)(!1),tl=(0,$.useRef)(null),[to,ta]=(0,$.useState)(""),[th,tu]=(0,$.useState)(""),[tc,td]=(0,$.useState)(""),[tm,tp]=(0,$.useState)(e.maxTokensLimit),[tf,tg]=(0,$.useState)(e.prompt),[tv,tx]=(0,$.useState)(e.baseURL),[tw,ty]=(0,$.useState)(e.apiPath),[tb,tS]=(0,$.useState)(e.systemPrompt),[tj,tM]=(0,$.useState)(e.userMessage),[tC,tN]=(0,$.useState)(e.promptFilePath),[tE,tP]=(0,$.useState)(e.enablePromptFile),[tk,t_]=(0,$.useState)(!1),tR=(0,$.useRef)(null),[tT,tL]=(0,$.useState)(""),[tI,tF]=(0,$.useState)(!1),[tz,tA]=(0,$.useState)(e.systemPromptFilePath),[tD,tO]=(0,$.useState)(e.enableSystemPromptFile),[tB,t$]=(0,$.useState)(!1),tW=(0,$.useRef)(null),[tK,tV]=(0,$.useState)(""),[tU,tH]=(0,$.useState)(!1),[tJ,tq]=(0,$.useState)(e.autoReloadPrompt),[tY,tX]=(0,$.useState)(e.autoReloadSystemPrompt),[tG,tQ]=(0,$.useState)(e.autoReloadImages),[tZ,t0]=(0,$.useState)([]),[t1,t2]=(0,$.useState)(e.pageSize),[t3,t5]=(0,$.useState)(1),[t4,t6]=(0,$.useState)(new Set),[t9,t7]=(0,$.useState)(new Set),[t8,et]=(0,$.useState)(e.showRawColumns),[ee,ei]=(0,$.useState)(!1),[es,er]=(0,$.useState)(e.expandRequestContent),[en,el]=(0,$.useState)(e.expandResponseContent),[eo,ea]=(0,$.useState)(!0),[eh,eu]=(0,$.useState)("idle"),[ec,ed]=(0,$.useState)(null),[em,ep]=(0,$.useState)(!1),[ef,eg]=(0,$.useState)(e.timerEnabled),[ev,ex]=(0,$.useState)(e.timerInterval),ew=(0,$.useRef)(null),[ey,eb]=(0,$.useState)(!1),[eS,ej]=(0,$.useState)(null),[eM,eC]=(0,$.useState)(!0),[eN,eE]=(0,$.useState)([]),[eP,ek]=(0,$.useState)(1),[e_,eR]=(0,$.useState)(new Map),[eT,eL]=(0,$.useState)(new Set),[eI,eF]=(0,$.useState)([]),[ez,eA]=(0,$.useState)([]),[eD,eO]=(0,$.useState)([]),[eB,e$]=(0,$.useState)(!1),[eW,eK]=(0,$.useState)([]),[eV,eU]=(0,$.useState)(""),[eH,eJ]=(0,$.useState)(!1),[eq,eY]=(0,$.useState)(!1),[eX,eG]=(0,$.useState)(null),[eQ,eZ]=(0,$.useState)(()=>{{let t=localStorage.getItem("klineLimit");return t?Number.parseInt(t):100}}),[e0,e1]=(0,$.useState)(()=>localStorage.getItem("tradingPair")||"BTCUSDT"),[e2,e3]=(0,$.useState)(()=>localStorage.getItem("klineInterval")||"1h"),[e5,e4]=(0,$.useState)(()=>{{let t=localStorage.getItem("klineEndTime");return t?Number.parseInt(t):void 0}});(0,$.useEffect)(()=>{localStorage.setItem("tradingPair",e0)},[e0]),(0,$.useEffect)(()=>{localStorage.setItem("klineInterval",e2)},[e2]),(0,$.useEffect)(()=>{localStorage.setItem("klineLimit",eQ.toString())},[eQ]),(0,$.useEffect)(()=>{void 0!==e5?localStorage.setItem("klineEndTime",e5.toString()):localStorage.removeItem("klineEndTime")},[e5]);let{toast:e6}=hJ(),e9=tv.endsWith("/")?tv.slice(0,-1):tv,e7=(0,$.useCallback)(async(t,e,i,s)=>{e$(!0),console.log("[v0] Fetching K-line data:",{pair:t,interval:e,limit:i,endTime:s});try{let r=s?`&endTime=${s}`:"",n=await fetch(`https://api.binance.com/api/v3/klines?symbol=${t}&interval=${e}&limit=${i}${r}`);if(!n.ok)throw Error("Failed to fetch kline data");let l=(await n.json()).map(t=>({time:t[0],open:Number.parseFloat(t[1]),high:Number.parseFloat(t[2]),low:Number.parseFloat(t[3]),close:Number.parseFloat(t[4]),volume:Number.parseFloat(t[5])}));return eO(l),l}catch(t){throw console.error("Error fetching kline data:",t),e6({variant:"destructive",title:"èŽ·å–Kçº¿æ•°æ®å¤±è´¥",description:t instanceof Error?t.message:"è¯·æ£€æŸ¥äº¤æ˜“å¯¹æ˜¯å¦æ­£ç¡®"}),t}finally{e$(!1)}},[e6]),e8=(0,$.useCallback)(async()=>(console.log("[v0] Force reloading K-line data with current parameters:",{tradingPair:e0,klineInterval:e2,klineLimit:eQ,klineEndTime:e5}),await e7(e0,e2,eQ,e5)),[e0,e2,eQ,e5,e7]),it=(0,$.useRef)(eQ),ie=(0,$.useRef)(e5);(0,$.useEffect)(()=>{it.current=eQ},[eQ]),(0,$.useEffect)(()=>{ie.current=e5},[e5]),(0,$.useEffect)(()=>{console.log("[v0] K-line useEffect triggered:",{tradingPair:e0,klineInterval:e2,klineLimit:eQ,klineEndTime:e5}),e0&&e2&&e7(e0,e2,eQ,e5)},[e0,e2,eQ,e5,e7]);let ii=(0,$.useCallback)((t,e)=>{let i=t.map(t=>{let e=new Date(t.time+288e5),i=`${e.getUTCFullYear()}-${String(e.getUTCMonth()+1).padStart(2,"0")}-${String(e.getUTCDate()).padStart(2,"0")} ${String(e.getUTCHours()).padStart(2,"0")}:${String(e.getUTCMinutes()).padStart(2,"0")}:${String(e.getUTCSeconds()).padStart(2,"0")}`;return`æ—¶é—´: ${i}, å¼€: ${t.open}, é«˜: ${t.high}, ä½Ž: ${t.low}, æ”¶: ${t.close}, é‡: ${t.volume}`}).join("\n");tM(`äº¤æ˜“å¯¹: ${e0}
å‘¨æœŸ: ${e2}

Kçº¿æ•°æ®:
${i}`),e6({title:"Kçº¿æ•°æ®å·²å¡«å…¥",description:`å·²å°† ${t.length} æ¡Kçº¿æ•°æ®å¡«å…¥æ¶ˆæ¯æ¡†`})},[e0,e2,e6]),is=(0,$.useMemo)(()=>{if("openrouter"===i&&p){let t=p.endsWith(":free")?p.slice(0,-5):p;return g.find(e=>e.id===t)}return"cerebras"===i&&p?x.find(t=>t.id===p):"modelscope"===i&&p?y.find(t=>t.id===p):null},[i,p,g,x,y]),ir=(0,$.useMemo)(()=>{if("modelscope"===i&&is){let t=is.task_types;return(Array.isArray(t)?t.includes("ç”Ÿæˆå›¾ç‰‡"):"string"==typeof t&&t.includes("ç”Ÿæˆå›¾ç‰‡"))?"https://api-inference.modelscope.cn/v1/images/generations":"https://api-inference.modelscope.cn/v1/chat/completions"}return`${e9}${tw}`},[i,is,e9,tw]);(0,$.useEffect)(()=>{(async()=>{try{await uE(),await uT(),console.log("[v0] IndexedDB initialized")}catch(t){console.error("[v0] Failed to initialize IndexedDB:",t)}})()},[]),(0,$.useEffect)(()=>{(async()=>{try{console.log("[v0] Loading data from storage...");let t=localStorage.getItem("llm-api-test-settings");if(t){let e=JSON.parse(t);e.provider&&s(e.provider),e.model&&f(e.model),e.apiKey&&o(e.apiKey),e.baseURL&&tx(e.baseURL),e.apiPath&&ty(e.apiPath),void 0!==e.systemPrompt&&tS(e.systemPrompt),void 0!==e.userMessage&&tM(e.userMessage),void 0!==e.promptFilePath&&tN(e.promptFilePath),void 0!==e.enablePromptFile&&tP(e.enablePromptFile),void 0!==e.systemPromptFilePath&&tA(e.systemPromptFilePath),void 0!==e.enableSystemPromptFile&&tO(e.enableSystemPromptFile),void 0!==e.autoReloadPrompt&&tq(e.autoReloadPrompt),void 0!==e.autoReloadSystemPrompt&&tX(e.autoReloadSystemPrompt),void 0!==e.autoReloadImages&&tQ(e.autoReloadImages),e.maxTokens&&J(e.maxTokens),void 0!==e.temperature&&Y(e.temperature),void 0!==e.topP&&G(e.topP),void 0!==e.frequencyPenalty&&Z(e.frequencyPenalty),void 0!==e.presencePenalty&&te(e.presencePenalty),void 0!==e.showRawColumns&&et(e.showRawColumns),void 0!==e.showRequestContent&&ei(e.showRequestContent),void 0!==e.expandRequestContent&&er(e.expandRequestContent),void 0!==e.expandResponseContent&&el(e.expandResponseContent),void 0!==e.timerEnabled&&eg(e.timerEnabled),void 0!==e.timerInterval&&ex(e.timerInterval),void 0!==e.maxTokensLimit&&tp(e.maxTokensLimit),void 0!==e.pageSize&&t2(e.pageSize),void 0!==e.prompt&&tg(e.prompt),void 0!==e.isParametersExpanded&&eC(e.isParametersExpanded),void 0!==e.isPromptFromLocalFile&&t_(e.isPromptFromLocalFile),void 0!==e.isSystemPromptFromLocalFile&&t$(e.isSystemPromptFromLocalFile),e.selectedInputModalities&&E(e.selectedInputModalities),e.selectedOutputModalities&&k(e.selectedOutputModalities),void 0!==e.modelSearchQuery&&R(e.modelSearchQuery),e.availableInputModalities&&eF(e.availableInputModalities),e.availableOutputModalities&&eA(e.availableOutputModalities),void 0!==e.imageUrl&&eU(e.imageUrl),void 0!==e.showImageUrlInput&&eJ(e.showImageUrlInput),void 0!==e.isAddingImageUrl&&eY(e.isAddingImageUrl),void 0!==e.klineLimit&&eZ(e.klineLimit),void 0!==e.klineEndTime&&e4(e.klineEndTime),void 0!==e.parseResponseMarkdown&&ea(e.parseResponseMarkdown)}console.log("[v0] Loading images from IndexedDB...");let e=await uR();console.log("[v0] Loaded images from IndexedDB:",e.length,"images"),e.length>0&&(eK(e),console.log("[v0] Set messageImages state with",e.length,"images")),console.log("[v0] Loading history from IndexedDB...");let i=await uk();if(i.length>0)console.log("[v0] Loaded history from IndexedDB:",i.length,"entries"),t0(i),uV(i).then(t=>{eR(t),console.log("[v0] Loaded response images for",t.size,"history items")}).catch(t=>{console.error("[v0] Failed to load response images:",t)});else{let t=localStorage.getItem("llm_api_history");if(t){let e=JSON.parse(t);t0(e),await uP(e)}}let r=localStorage.getItem("modelHistory");if(r)try{eE(JSON.parse(r))}catch(t){console.error("Failed to load model history:",t)}}catch(t){console.error("[v0] Error loading data:",t)}})()},[]),(0,$.useEffect)(()=>{let t={provider:i,model:p,apiKey:l,baseURL:tv,apiPath:tw,systemPrompt:tb,userMessage:tj,promptFilePath:tC,enablePromptFile:tE,systemPromptFilePath:tz,enableSystemPromptFile:tD,autoReloadPrompt:tJ,autoReloadSystemPrompt:tY,autoReloadImages:tG,maxTokens:H,temperature:q,topP:X,frequencyPenalty:Q,presencePenalty:tt,showRawColumns:t8,showRequestContent:ee,expandRequestContent:es,expandResponseContent:en,timerEnabled:ef,timerInterval:ev,maxTokensLimit:tm,pageSize:t1,prompt:tf,isParametersExpanded:eM,isPromptFromLocalFile:tk,isSystemPromptFromLocalFile:tB,selectedInputModalities:Array.from(N),selectedOutputModalities:Array.from(P),modelSearchQuery:_,availableInputModalities:eI,availableOutputModalities:ez,imageUrl:eV,showImageUrlInput:eH,isAddingImageUrl:eq,klineLimit:eQ,klineEndTime:e5,parseResponseMarkdown:eo};localStorage.setItem("llm-api-test-settings",JSON.stringify(t))},[i,p,l,tv,tw,tb,tj,tC,tE,tz,tD,tJ,tY,tG,H,q,X,Q,tt,t8,ee,es,en,ef,ev,tm,t1,tf,eM,tk,tB,N,P,_,eI,ez,eV,eH,eq,eQ,e5,eo]),(0,$.useEffect)(()=>{tZ.length>0&&uP(tZ).catch(t=>{console.error("[v0] Failed to save history to IndexedDB:",t)})},[tZ]),(0,$.useEffect)(()=>{console.log("[v0] Saving images to IndexedDB, count:",eW.length),u_(eW).catch(t=>{console.error("[v0] Failed to save images to IndexedDB:",t)})},[eW]);let il=(t,e)=>{let s={id:Date.now().toString(),timestamp:Date.now(),provider:i,model:p,apiKey:l,baseURL:tv,apiPath:tw,status:t,duration:e};eE(t=>{let e=t.filter(t=>t.provider!==s.provider||t.model!==s.model||t.apiKey!==s.apiKey);return[s,...e]})},io=async t=>{try{let e=await fetch(t);if(!e.ok)throw Error(`HTTP ${e.status}: ${e.statusText}`);return await e.text()}catch(e){let t="æ— æ³•è¯»å–æŒ‡å®šçš„æ–‡ä»¶è·¯å¾„";return e instanceof TypeError&&e.message.includes("fetch")?t="è·¨åŸŸè®¿é—®è¢«é˜»æ­¢ï¼ˆCORSï¼‰ã€‚è¯·ç¡®ä¿æ–‡ä»¶æœåŠ¡å™¨æ”¯æŒ CORSï¼Œæˆ–ä½¿ç”¨æ”¯æŒ CORS çš„æ–‡ä»¶æ‰˜ç®¡æœåŠ¡ï¼ˆå¦‚ GitHub Gistã€Pastebin ç­‰ï¼‰ã€‚":e instanceof Error&&(t=e.message),e6({variant:"destructive",title:"æ–‡ä»¶è¯»å–å¤±è´¥",description:t}),null}},ia=async t=>{console.log("[v0] handleLocalFileSelect called with type:",t),console.log("[v0] enablePromptFile:",tE,"enableSystemPromptFile:",tD);let e=window.self!==window.top;try{if("showOpenFilePicker"in window&&!e){console.log("[v0] Using File System Access API");let[e]=await window.showOpenFilePicker({types:[{description:"Text Files",accept:{"text/plain":[".txt"],"text/markdown":[".md"]}}],multiple:!1}),i=await e.getFile(),s=await i.text();if(console.log("[v0] File loaded successfully:",i.name,"Content length:",s.length),"prompt"===t){tR.current=e;let t=await uB("promptFileHandle",e);return console.log("[v0] Prompt file handle save result:",t),t_(!0),tL(s),tN(i.name),e6({title:"æ–‡ä»¶åŠ è½½æˆåŠŸ",description:`å·²åŠ è½½æœ¬åœ°æ–‡ä»¶: ${i.name}`}),s}{tW.current=e;let t=await uB("systemPromptFileHandle",e);return console.log("[v0] System prompt file handle save result:",t),t$(!0),tV(s),tA(i.name),e6({title:"æ–‡ä»¶åŠ è½½æˆåŠŸ",description:`å·²åŠ è½½æœ¬åœ°æ–‡ä»¶: ${i.name}`}),s}}}catch(t){console.log("[v0] File System Access API failed, falling back to input method:",t)}return console.log("[v0] Using fallback file input method"),new Promise(e=>{let i=document.createElement("input");i.type="file",i.accept=".txt,.md",i.onchange=async i=>{let s=i.target.files?.[0];if(s){console.log("[v0] Fallback file selected:",s.name);let i=await s.text();"prompt"===t?(tR.current=null,t_(!0),tL(i),tN(s.name)):(tW.current=null,t$(!0),tV(i),tA(s.name)),e6({title:"æ–‡ä»¶åŠ è½½æˆåŠŸ",description:`å·²åŠ è½½æœ¬åœ°æ–‡ä»¶: ${s.name}`}),e(i)}else console.log("[v0] No file selected in fallback method"),e(null)},i.click()})},ih=async t=>{let e="prompt"===t?tR:tW,i="prompt"===t?tL:tV,s="prompt"===t?"promptFileHandle":"systemPromptFileHandle";console.log(`[v0] reloadLocalFile called for ${t}`),console.log("[v0] Current ref handle:",e.current?"exists":"null");let r=e.current;if(r||(console.log(`[v0] Attempting to restore ${t} handle from IndexedDB`),(r=await u$(s))?(e.current=r,console.log(`[v0] Restored ${t} file handle from IndexedDB successfully`)):console.log(`[v0] No ${t} handle found in IndexedDB`)),r){console.log(`[v0] Have handle for ${t}, verifying permission...`);try{let e=await uD(r);if(console.log(`[v0] Permission result for ${t}:`,e),e){let e=await r.getFile(),s=await e.text();return i(s),console.log(`[v0] Reloaded ${t} from file handle with permission, content length:`,s.length),s}console.log(`[v0] Permission denied for ${t} file handle`)}catch(t){console.log("[v0] Failed to reload from file handle:",t),e.current=null,await uW(s)}}return console.log(`[v0] File handle missing for ${t}, prompting user to re-select`),e6({title:"éœ€è¦é‡æ–°é€‰æ‹©æ–‡ä»¶",description:"è¯·ç‚¹å‡»ç¡®è®¤æŽˆæƒæ–‡ä»¶è®¿é—®ï¼Œæˆ–é‡æ–°é€‰æ‹©æ–‡ä»¶ã€‚"}),await ia(t)},iu=t=>t.startsWith("http://")||t.startsWith("https://");(0,$.useEffect)(()=>{tE&&tC&&iu(tC)&&!tk?io(tC).then(t=>{tL(t||"")}).catch(t=>{console.error("Failed to load prompt file:",t),tL("")}):tE||(tL(""),t_(!1),tR.current=null,uW("promptFileHandle"))},[tE,tC,tk]),(0,$.useEffect)(()=>{tD&&tz&&iu(tz)&&!tB?io(tz).then(t=>{tV(t||"")}).catch(t=>{console.error("Failed to load system prompt file:",t),tV("")}):tD||(tV(""),t$(!1),tW.current=null,uW("systemPromptFileHandle"))},[tD,tz,tB]);let ic=async()=>{if(0===eW.length)return eW;console.log("[v0] Reloading images and clearing cache...");let t=[];for(let e of eW)if("url"===e.type&&e.url)try{let i=e.url.includes("?")?`${e.url}&_t=${Date.now()}`:`${e.url}?_t=${Date.now()}`,s=await fetch(i,{cache:"no-store"});if(!s.ok){console.error(`[v0] Failed to reload image from ${e.url}:`,s.statusText),t.push(e);continue}let r=await s.blob(),n=await new Promise((t,e)=>{let i=new FileReader;i.onload=e=>t(e.target?.result),i.onerror=e,i.readAsDataURL(r)});t.push({...e,base64:n,mimeType:r.type}),console.log(`[v0] Reloaded image from ${e.url}`)}catch(i){console.error(`[v0] Error reloading image from ${e.url}:`,i),t.push(e)}else t.push(e);return eK(t),console.log("[v0] Image reload complete"),t},id=async()=>{if(l&&p&&ir&&!em){ep(!0),e6({title:"æŽ¢é’ˆæµ‹è¯•å¼€å§‹",description:`æä¾›å•†: ${i}, æ¨¡åž‹: ${p}`,className:"bg-blue-50 border-blue-200",duration:3e3});try{let t,e=performance.now(),s="modelscope"===i&&is&&(t=is.task_types,Array.isArray(t)?t.includes("ç”Ÿæˆå›¾ç‰‡"):"string"==typeof t&&t.includes("ç”Ÿæˆå›¾ç‰‡")),r={model:p,max_tokens:100,temperature:1,top_p:1,frequency_penalty:0,presence_penalty:0};s?r.prompt="hello":r.messages=[{role:"system",content:tb},{role:"user",content:"hello"}];let n=await fetch(ir,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`},body:JSON.stringify(r),signal:AbortSignal.timeout(1e4)}),o=Math.round(performance.now()-e);ed(o);let a=n.headers.get("content-type");if(!a?.includes("application/json")){await n.text(),eu("error"),il("error",o),e6({variant:"destructive",title:"æŽ¢é’ˆæµ‹è¯•å¤±è´¥",description:`æœåŠ¡å™¨è¿”å›žéžJSONå“åº” (çŠ¶æ€ç : ${n.status})`,duration:3e3}),ep(!1);return}let h=await n.json();n.ok&&h.choices?.[0]?.message?(eu("success"),il("success",o),e6({title:"æŽ¢é’ˆæµ‹è¯•æˆåŠŸ",description:`API é…ç½®æ­£å¸¸ï¼Œå“åº”ç”¨æ—¶: ${o}ms`,className:"bg-green-50 border-green-200",duration:3e3})):(eu("error"),il("error",o),e6({variant:"destructive",title:"æŽ¢é’ˆæµ‹è¯•å¤±è´¥",description:h.error?.message||"API è¿”å›žå¼‚å¸¸",duration:3e3}))}catch(t){eu("error"),ed(null),il("error",null),e6({variant:"destructive",title:"æŽ¢é’ˆæµ‹è¯•å¤±è´¥",description:t instanceof Error?t.message:"ç½‘ç»œè¯·æ±‚å¤±è´¥",duration:3e3})}finally{ep(!1)}}};(0,$.useEffect)(()=>{if(l&&p&&ir){let t=setTimeout(()=>{id()},5e3);return()=>clearTimeout(t)}eu("idle")},[l,p,ir]);let im=async()=>{j(!0);try{let t=await fetch("https://models.xiechengqi.top/cerebras.json");if(t.ok){let e=await t.json();console.log("[v0] Fetched Cerebras models:",e);let i=Array.isArray(e)?e:e.models||e.data||[];w(i)}else console.error("[v0] Failed to fetch Cerebras models:",t.statusText),w([])}catch(t){console.error("[v0] Error fetching Cerebras models:",t),w([])}finally{j(!1)}},ip=async()=>{j(!0);try{let t=await fetch("https://models.xiechengqi.top/modelscope.json");if(t.ok){let e=await t.json();console.log("[v0] Fetched ModelScope models:",e);let i=Array.isArray(e)?e:e.models||e.data||[];b(i)}else console.error("[v0] Failed to fetch ModelScope models:",t.statusText),b([])}catch(t){console.error("[v0] Error fetching ModelScope models:",t),b([])}finally{j(!1)}},ig=async()=>{j(!0);try{let t=await fetch("https://models.xiechengqi.top/openrouter.json");if(t.ok){let e=await t.json();console.log("[v0] Fetched OpenRouter models:",e);let i=Array.isArray(e)?e:e.models||e.data||[];v(i)}else console.error("[v0] Failed to fetch OpenRouter models:",t.statusText),v([])}catch(t){console.error("[v0] Error fetching OpenRouter models:",t),v([])}finally{j(!1)}};(0,$.useEffect)(()=>{"openrouter"===i?ig():"cerebras"===i?im():"modelscope"===i?ip():(eF([]),eA([]))},[i]);let iv=async()=>{let t;console.log("[v0] handleTest called, loading:",tr),tn(!0),td(""),ta(""),tu(""),ej(null),tl.current=new AbortController;let s=eW;if(tG&&eW.some(t=>"url"===t.type)){console.log("[v0] Auto-reloading images before test...");let t=e6({title:"æ­£åœ¨é‡è½½å›¾ç‰‡",description:`æ­£åœ¨é‡æ–°åŠ è½½ ${eW.filter(t=>"url"===t.type).length} å¼ å›¾ç‰‡...`,duration:1/0});s=await ic(),t.dismiss(),e6({title:"å›¾ç‰‡é‡è½½å®Œæˆ",description:"æ‰€æœ‰å›¾ç‰‡å·²æ›´æ–°ï¼Œå¼€å§‹æµ‹è¯•...",className:"bg-green-50 border-green-200",duration:2e3})}if(!l){td("Please provide an API key"),e6({variant:"destructive",title:"é”™è¯¯",description:"è¯·æä¾› API Key"}),tn(!1);return}let r=p||e.model;console.log("[v0] enablePromptFile:",tE),console.log("[v0] autoReloadPrompt:",tJ),console.log("[v0] isPromptFromLocalFile:",tk),console.log("[v0] promptFileHandleRef.current:",tR.current),console.log("[v0] promptFilePath:",tC);let n=tb;if(tD&&tz.trim())if(console.log("[v0] System prompt external loading enabled"),tY)if(console.log("[v0] Auto reload system prompt is ON"),tz.trim().startsWith("http://")||tz.trim().startsWith("https://")){console.log("[v0] Reloading system prompt from HTTP URL");let t=await io(tz.trim());null!==t?(tV(t),n=t,console.log("[v0] Reloaded system prompt from URL, length:",t.length)):n=tK||tb}else if(tB){console.log("[v0] Reloading system prompt from local file");let t=await ih("systemPrompt");null!==t?(n=t,console.log("[v0] Reloaded system prompt from local file, length:",t.length)):n=tK||tb}else n=tK||tb;else console.log("[v0] Using cached system prompt content"),n=tK||tb;console.log("[v0] Final system prompt length:",n.length);let o=tj;if(console.log("[v0] enablePromptFile:",tE),console.log("[v0] autoReloadPrompt:",tJ),console.log("[v0] isPromptFromLocalFile:",tk),console.log("[v0] promptFileHandleRef.current:",tR.current),console.log("[v0] promptFilePath:",tC),tE&&tC.trim())if(console.log("[v0] User message external loading enabled"),tJ)if(console.log("[v0] Auto reload prompt is ON"),tC.trim().startsWith("http://")||tC.trim().startsWith("https://")){console.log("[v0] Reloading user message from HTTP URL");let t=await io(tC.trim());null!==t?(tL(t),o=t,console.log("[v0] Reloaded user message from URL, length:",t.length)):o=tT||tj}else if(tk){console.log("[v0] Reloading user message from local file");let t=await ih("prompt");null!==t?(o=t,console.log("[v0] Reloaded user message from local file, length:",t.length)):o=tT||tj}else o=tT||tj;else console.log("[v0] Using cached user message content"),o=tT||tj;console.log("[v0] Final user message length:",o.length);let a=o;if(s.length>0){let t=[{type:"text",text:o}];s.forEach(e=>{e.base64&&t.push({type:"image_url",image_url:{url:e.base64}})}),a=t}let h=[{role:"user",content:a},{role:"system",content:n}],u="modelscope"===i&&is&&(Array.isArray(t=is.task_types)?t.includes("ç”Ÿæˆå›¾ç‰‡"):"string"==typeof t&&t.includes("ç”Ÿæˆå›¾ç‰‡")),c={model:r,max_tokens:H,temperature:q,top_p:X,frequency_penalty:Q,presence_penalty:tt,stream:ti};u?c.prompt=o:c.messages=h;let d=["Content-Type: application/json",`Authorization: Bearer ${l}`],m=`curl ${ir} \\
  -X POST \\
  ${d.map(t=>`-H "${t}" \\`).join("")}
  -d '${JSON.stringify(c,null,2).replace(/\n/g,"\n  ")}'`;ta(m);let f=new AbortController,g=setTimeout(()=>{f.abort()},6e4);try{let t,e=performance.now(),i=await fetch(ir,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`},body:JSON.stringify(c),signal:tl.current.signal});clearTimeout(g);let s=performance.now(),n=Math.round(s-e);ej(n);let o=await i.text();try{t=JSON.parse(o)}catch{t=o}let a=JSON.stringify({status:i.status,statusText:i.statusText,headers:Object.fromEntries(i.headers.entries()),body:t},null,2);tu(a);let u=JSON.stringify(h),d="",p=[],f=t?.images;if(f&&Array.isArray(f)&&f.length>0){let e=f.map(t=>t.url).filter(t=>t&&(t.startsWith("http://")||t.startsWith("https://")));if(e.length>0){let t=Date.now();p=e.map((e,i)=>({id:`response-${t}-${i}`,type:"url",url:e})),d=e.join("\n")}else d=JSON.stringify(t)}else{let e=t?.choices?.[0]?.message?.content,i=t?.content?.[0]?.text;if(e||t?.choices?.[0]?.message){let i=t?.choices?.[0]?.message?.reasoning_details?.[0]?.text,s=t?.choices?.[0]?.message?.reasoning_content||t?.choices?.[0]?.message?.reasoning;d=i?e?`<Thinking>
${i}
</Thinking>

${e}`:i:s?e?`<Thinking>
${s}
</Thinking>

${e}`:s:e||JSON.stringify(t?.choices?.[0]?.message)}else d=i||JSON.stringify(t)}let v=Date.now(),x={id:v.toString(),timestamp:v,model:r,requestContent:u,requestRaw:m,responseContent:d,responseRaw:a,duration:n};if(p.length>0&&uL(v,p).then(()=>{let t=p.map(t=>t.base64||t.url||"").filter(Boolean);t.length>0&&eR(e=>{let i=new Map(e);return i.set(v,t),i})}).catch(t=>{console.error("[v0] Failed to save response images to IndexedDB:",t)}),t0(t=>{let e=[x,...t];return uP(e).catch(t=>{console.error("[v0] Failed to save history to IndexedDB:",t)}),e}),i.ok)e6({title:"è¯·æ±‚æˆåŠŸ",description:`API å“åº”çŠ¶æ€: ${i.status}`});else{let e=`API Error: ${i.status} - ${t.error?.message||i.statusText}`;td(e),e6({variant:"destructive",title:"è¯·æ±‚å¤±è´¥",description:`çŠ¶æ€ç  ${i.status}: ${t.error?.message||i.statusText}`})}}catch(i){clearTimeout(g),console.error("[v0] Error during test:",i),"AbortError"===i.name?(td("æµ‹è¯•å·²ä¸­æ–­"),e6({title:"æµ‹è¯•å·²ä¸­æ–­",description:"æµ‹è¯•å·²è¢«ç”¨æˆ·ä¸­æ–­",duration:2e3})):i.message.includes("API key")?(td(i.message),e6({variant:"destructive",title:"é”™è¯¯",description:i.message})):(td(i.message||"An error occurred"),e6({variant:"destructive",title:"é”™è¯¯",description:i.message||"å‘ç”ŸæœªçŸ¥é”™è¯¯"}));let t=JSON.stringify({error:i.message||"Unknown error"},null,2);tu(t),ej(null);let e={id:Date.now().toString(),timestamp:Date.now(),model:r,requestContent:"",requestRaw:"",responseContent:"",responseRaw:t,duration:null};t0(t=>{let i=[e,...t];return uP(i).catch(t=>{console.error("[v0] Failed to save history to IndexedDB:",t)}),i})}finally{tn(!1),tl.current=null}},ix=()=>{ew.current&&(clearInterval(ew.current),ew.current=null),eb(!1)},iw=async()=>{console.log("[v0] handleStartTest called"),tM(""),console.log("[v0] Cleared user message"),e6({title:"æ­£åœ¨é‡è½½Kçº¿æ•°æ®",description:"è¯·ç¨ç­‰...",duration:2e3});try{let t=await e8();if(console.log("[v0] K-line data reload completed, data length:",t?.length||0),!t||!(t.length>0))return void e6({variant:"destructive",title:"Kçº¿æ•°æ®ä¸ºç©º",description:"æ— æ³•èŽ·å–Kçº¿æ•°æ®ï¼Œè¯·æ£€æŸ¥å‚æ•°è®¾ç½®"});{let e;e=`å·²å°†å…¨éƒ¨ ${t.length} æ¡Kçº¿æ•°æ®å†™å…¥æ¶ˆæ¯`,console.log("[v0] Using all reloaded K-line data");let i=`ã€Kçº¿æ•°æ®ã€‘
äº¤æ˜“å¯¹: ${e0}
å‘¨æœŸ: ${e2}
æ•°æ®é‡: ${t.length}æ¡

`+t.map((t,e)=>{let i=new Date(t.time).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1});return`${e+1}. æ—¶é—´: ${i}, å¼€: ${t.open}, é«˜: ${t.high}, ä½Ž: ${t.low}, æ”¶: ${t.close}, é‡: ${t.volume}`}).join("\n");tM(i),console.log("[v0] Wrote K-line data to user message, length:",i.length),e6({title:"Kçº¿æ•°æ®å·²å†™å…¥",description:e,className:"bg-green-50 border-green-200",duration:2e3}),await new Promise(t=>setTimeout(t,500))}}catch(t){console.error("[v0] Error reloading K-line data:",t),e6({variant:"destructive",title:"Kçº¿æ•°æ®åŠ è½½å¤±è´¥",description:"è¯·é‡è¯•æˆ–æ£€æŸ¥ç½‘ç»œè¿žæŽ¥"});return}ef?(ew.current&&clearInterval(ew.current),eb(!0),iv(),ew.current=setInterval(()=>{iv()},1e3*ev)):iv()},iy=()=>{tg(e.prompt),J(e.maxTokens),Y(e.temperature),G(e.topP),Z(e.frequencyPenalty),te(e.presencePenalty),ts(!1),eg(e.timerEnabled),ex(e.timerInterval),ix(),et(e.showRawColumns),er(e.expandRequestContent),el(e.expandResponseContent),tS(e.systemPrompt),tM(e.userMessage),tN(e.promptFilePath),tP(e.enablePromptFile),tq(e.autoReloadPrompt),tX(e.autoReloadSystemPrompt),tQ(e.autoReloadImages),eK([]),eU(""),eJ(!1),eY(!1),eO([]),e4(void 0),eZ(100),localStorage.removeItem("llm-api-test-settings")},ib=async t=>{if(!t.apiKey||!t.model)return;let e=t.baseURL?`${t.baseURL}${t.apiPath}`:t.apiPath;e6({title:"æŽ¢é’ˆæµ‹è¯•å¼€å§‹",description:`æä¾›å•†: ${t.provider}, æ¨¡åž‹: ${t.model}`,className:"bg-blue-50 border-blue-200",duration:3e3});try{let i=performance.now(),s={model:t.model,messages:[{role:"system",content:tb},{role:"user",content:"hello"}],max_tokens:100,temperature:1,top_p:1,frequency_penalty:0,presence_penalty:0},r=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t.apiKey}`},body:JSON.stringify(s),signal:AbortSignal.timeout(1e4)}),n=Math.round(performance.now()-i),l=r.headers.get("content-type");if(!l?.includes("application/json")){eE(e=>e.map(e=>e.id===t.id?{...e,status:"error",duration:n}:e)),e6({variant:"destructive",title:"æŽ¢é’ˆæµ‹è¯•å¤±è´¥",description:`æœåŠ¡å™¨è¿”å›žéžJSONå“åº” (çŠ¶æ€ç : ${r.status})`,duration:3e3});return}let o=await r.json();r.ok&&o.choices?.[0]?.message?(eE(e=>e.map(e=>e.id===t.id?{...e,status:"success",duration:n}:e)),e6({title:"æŽ¢é’ˆæµ‹è¯•æˆåŠŸ",description:`API é…ç½®æ­£å¸¸ï¼Œå“åº”ç”¨æ—¶: ${n}ms`,className:"bg-green-50 border-green-200",duration:3e3})):(eE(e=>e.map(e=>e.id===t.id?{...e,status:"error",duration:n}:e)),e6({variant:"destructive",title:"æŽ¢é’ˆæµ‹è¯•å¤±è´¥",description:o.error?.message||"API è¿”å›žå¼‚å¸¸",duration:3e3}))}catch(e){eE(e=>e.map(e=>e.id===t.id?{...e,status:"error",duration:null}:e)),e6({variant:"destructive",title:"æŽ¢é’ˆæµ‹è¯•å¤±è´¥",description:e instanceof Error?e.message:"æœªçŸ¥é”™è¯¯",duration:3e3})}},iS=t=>{t6(e=>{let i=new Set(e);return i.has(t)?i.delete(t):i.add(t),i})},ij=Math.ceil(tZ.length/t1),iM=tZ.slice((t3-1)*t1,t3*t1),[iC,iN]=(0,$.useState)("å¤åˆ¶"),[iE,iP]=(0,$.useState)("å¤åˆ¶"),ik=async(t,e)=>{let i="request"===e?iN:iP;try{await navigator.clipboard.writeText(t),i("å·²å¤åˆ¶!"),setTimeout(()=>i("å¤åˆ¶"),2e3)}catch(s){let e=document.createElement("textarea");e.value=t,e.style.position="fixed",e.style.left="-999999px",document.body.appendChild(e),e.select();try{document.execCommand("copy"),i("å·²å¤åˆ¶!"),setTimeout(()=>i("å¤åˆ¶"),2e3)}catch(t){e6({title:"å¤åˆ¶å¤±è´¥",description:"æ— æ³•è®¿é—®å‰ªè´´æ¿ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶",variant:"destructive"})}document.body.removeChild(e)}},i_=t=>{let e=[],i=t,s=0,r=(i=(i=(i=(i=i.replace(/\*\*(.+?)\*\*/g,(t,i)=>{let r=`bold-${s++}`;return e.push((0,L.jsx)("strong",{children:i},r)),`<<${r}>>`})).replace(/\*(.+?)\*/g,(t,i)=>{let r=`italic-${s++}`;return e.push((0,L.jsx)("em",{children:i},r)),`<<${r}>>`})).replace(/`(.+?)`/g,(t,i)=>{let r=`code-${s++}`;return e.push((0,L.jsx)("code",{className:"bg-muted px-1 py-0.5 rounded text-xs",children:i},r)),`<<${r}>>`})).replace(/\[(.+?)\]\$\$(.+?)\$\$/g,(t,i,r)=>{let n=`link-${s++}`;return e.push((0,L.jsx)("a",{href:r,className:"text-primary underline",target:"_blank",rel:"noopener noreferrer",children:i},n)),`<<${n}>>`})).split(/<<(.+?)>>/),n=[];return r.forEach((t,i)=>{if(t.startsWith("bold-")||t.startsWith("italic-")||t.startsWith("code-")||t.startsWith("link-")){let i=e.find((i,s)=>`${t}`===Object.keys(e)[s]);i&&n.push(i)}else t&&n.push(t)}),n.length>0?n:t};(0,$.useEffect)(()=>{if(eN.length>0)try{localStorage.setItem("modelHistory",JSON.stringify(eN))}catch(t){console.error("[v0] Failed to save model history to localStorage:",t)}},[eN]);let iR=Math.ceil(eN.length/5),iT=eN.slice((eP-1)*5,5*eP),iL=(0,$.useMemo)(()=>{let t=g;if(_.trim()){let e=_.toLowerCase();t=t.filter(t=>{let i=t.id.toLowerCase().includes(e),s=t.name?.toLowerCase().includes(e)||!1;return i||s})}return t},[g,_]),iI=(0,$.useMemo)(()=>{let t=x;if(_.trim()){let e=_.toLowerCase();t=t.filter(t=>{let i=t.id.toLowerCase().includes(e),s=t.name?.toLowerCase().includes(e)||!1;return i||s})}return t},[x,_]),iF=(0,$.useMemo)(()=>{let t=y;if(_.trim()){let e=_.toLowerCase();t=t.filter(t=>{let i=t.id.toLowerCase().includes(e),s=t.name?.toLowerCase().includes(e)||!1;return i||s})}return t},[y,_]),iz=(0,$.useMemo)(()=>"openrouter"===i&&p&&is||"cerebras"===i&&p&&is||"modelscope"===i&&p&&is?is.name||is.id:p||"",[i,p,is]),iA=async t=>{try{let e=await fetch("https://libretranslate.de/translate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({q:t,source:"en",target:"zh",format:"text"})});if(e.ok){let t=await e.json();if(t.translatedText)return console.log("[v0] LibreTranslate ç¿»è¯‘æˆåŠŸ"),t.translatedText}}catch(t){console.warn("[v0] LibreTranslate ç¿»è¯‘å¤±è´¥:",t)}return null},iD=async t=>{try{let e=await fetch(`https://translate.googleapis.com/translate_a/single?client=gtx&sl=en&tl=zh-CN&dt=t&q=${encodeURIComponent(t)}`);if(e.ok){let t=await e.json();if(t&&t[0]&&Array.isArray(t[0])){let e=t[0].map(t=>t[0]).join("");if(e)return console.log("[v0] Google Translate ç¿»è¯‘æˆåŠŸ"),e}}}catch(t){console.warn("[v0] Google Translate ç¿»è¯‘å¤±è´¥:",t)}return null},iO=async t=>{try{let e=await fetch(`https://api.mymemory.translated.net/get?q=${encodeURIComponent(t)}&langpair=en|zh-CN`);if(e.ok){let t=await e.json();if(console.log("[v0] MyMemory API å“åº”:",t),429===t.responseStatus||t.responseData?.translatedText&&t.responseData.translatedText.includes("MYMEMORY WARNING"))return console.warn("[v0] MyMemory API é…é¢å·²ç”¨å°½"),null;if(t.responseData&&t.responseData.translatedText)return console.log("[v0] MyMemory ç¿»è¯‘æˆåŠŸ"),t.responseData.translatedText}else 429===e.status&&console.warn("[v0] MyMemory API é…é¢å·²ç”¨å°½ (HTTP 429)")}catch(t){console.warn("[v0] MyMemory API ç¿»è¯‘å¤±è´¥:",t)}return null},iB=(0,$.useCallback)(async t=>{if(!t)return void console.log("[v0] translateDescription: æ–‡æœ¬ä¸ºç©ºï¼Œè·³è¿‡ç¿»è¯‘");console.log("[v0] translateDescription: å¼€å§‹ç¿»è¯‘ï¼Œæ–‡æœ¬é•¿åº¦:",t.length),K(!0),I(""),U("");try{if(t.length<=500){let e=null;(e=await iO(t))||(console.log("[v0] åˆ‡æ¢åˆ°å¤‡ç”¨ç¿»è¯‘ API: LibreTranslate"),e=await iA(t)),e||(console.log("[v0] åˆ‡æ¢åˆ°å¤‡ç”¨ç¿»è¯‘ API: Google Translate"),e=await iD(t)),e?(console.log("[v0] ç¿»è¯‘æˆåŠŸ:",e.substring(0,100)),I(e)):(console.warn("[v0] æ‰€æœ‰ç¿»è¯‘ API éƒ½å¤±è´¥äº†"),I(""),U("ç¿»è¯‘å¤±è´¥ï¼šæ‰€æœ‰ç¿»è¯‘æœåŠ¡æš‚æ—¶ä¸å¯ç”¨ï¼Œè¯·ç¨åŽé‡è¯•"))}else{let e=[];for(let i=0;i<t.length;i+=500){let s=t.substring(i,i+500);e.push(s)}let i=[],s=!1,r="mymemory";for(let t of e){let e=null;"mymemory"===r&&((e=await iO(t))||(console.log("[v0] MyMemory å¤±è´¥ï¼Œåˆ‡æ¢åˆ° LibreTranslate"),r="libretranslate")),!e&&"libretranslate"===r&&((e=await iA(t))||(console.log("[v0] LibreTranslate å¤±è´¥ï¼Œåˆ‡æ¢åˆ° Google Translate"),r="google")),e||"google"!==r||(e=await iD(t)),e?i.push(e):(i.push(t),s=!0),await new Promise(t=>setTimeout(t,100))}s&&U("ç¿»è¯‘å¤±è´¥ï¼šéƒ¨åˆ†å†…å®¹æ— æ³•ç¿»è¯‘"),I(i.join(""))}}catch(t){console.error("[v0] Error translating description:",t),I(""),U(`ç¿»è¯‘å¤±è´¥ï¼š${t instanceof Error?t.message:"ç½‘ç»œè¯·æ±‚å¤±è´¥"}`)}finally{K(!1)}},[]);(0,$.useEffect)(()=>{if(console.log("[v0] Translation useEffect è§¦å‘:",{provider:i,hasDescription:!!is?.description,descriptionLength:is?.description?.length,modelId:is?.id}),I(""),K(!1),U(""),"openrouter"===i&&is?.description){let t=is.description.trim();if(!t)return void console.log("[v0] Translation: description ä¸ºç©ºï¼Œè·³è¿‡ç¿»è¯‘");let e=/[\u4e00-\u9fa5]/.test(t);if(console.log("[v0] Translation: æ£€æŸ¥ä¸­æ–‡",{hasChinese:e,descriptionPreview:t.substring(0,50)}),e)console.log("[v0] Translation: æ–‡æœ¬å·²åŒ…å«ä¸­æ–‡ï¼Œè·³è¿‡ç¿»è¯‘");else{console.log("[v0] Translation: å‡†å¤‡ç¿»è¯‘ï¼Œå»¶è¿Ÿ 100ms");let e=setTimeout(()=>{console.log("[v0] Translation: å¼€å§‹è°ƒç”¨ translateDescription"),iB(t)},100);return()=>{console.log("[v0] Translation: æ¸…ç†å®šæ—¶å™¨"),clearTimeout(e)}}}else console.log("[v0] Translation: æ¡ä»¶ä¸æ»¡è¶³",{provider:i,hasDescription:!!is?.description})},[i,is?.description,is?.id,iB]);let i$=async()=>{if(!eV.trim())return void e6({variant:"destructive",title:"é”™è¯¯",description:"è¯·è¾“å…¥å›¾ç‰‡é“¾æŽ¥"});eY(!0);try{let t=eV.trim().includes("?")?`${eV.trim()}&_t=${Date.now()}`:`${eV.trim()}?_t=${Date.now()}`,e=await fetch(t,{cache:"no-store"});if(!e.ok)throw Error(`HTTP ${e.status}: ${e.statusText}`);let i=await e.blob();if(!i.type.startsWith("image/")){e6({variant:"destructive",title:"é”™è¯¯",description:"URL ä¸æ˜¯æœ‰æ•ˆçš„å›¾ç‰‡"}),eY(!1);return}let s=new FileReader;s.onload=t=>{let e=t.target?.result,s={id:Date.now().toString(),type:"url",url:eV.trim(),base64:e,mimeType:i.type};eK(t=>[...t,s]),eU(""),eJ(!1),eY(!1),e6({title:"æˆåŠŸ",description:"å›¾ç‰‡å·²åŠ è½½å¹¶æ·»åŠ "})},s.onerror=()=>{e6({variant:"destructive",title:"é”™è¯¯",description:"è½¬æ¢å›¾ç‰‡å¤±è´¥"}),eY(!1)},s.readAsDataURL(i)}catch(t){console.error("[v0] Error loading image from URL:",t),eY(!1),e6({variant:"destructive",title:"åŠ è½½å¤±è´¥",description:t instanceof Error?t.message:"æ— æ³•åŠ è½½å›¾ç‰‡"})}},iW=async()=>{let t=document.createElement("input");t.type="file",t.accept="image/*",t.onchange=async t=>{let e=t.target.files?.[0];if(e){if(!e.type.startsWith("image/"))return void e6({variant:"destructive",title:"é”™è¯¯",description:"è¯·é€‰æ‹©å›¾ç‰‡æ–‡ä»¶"});try{let t=new FileReader;t.onload=t=>{let i=t.target?.result,s={id:Date.now().toString(),type:"file",base64:i,mimeType:e.type,name:e.name};eK(t=>[...t,s]),e6({title:"æˆåŠŸ",description:`å›¾ç‰‡ ${e.name} å·²æ·»åŠ `}),tG&&(console.log("[v0] Auto-reloading images after upload..."),iv())},t.onerror=()=>{e6({variant:"destructive",title:"é”™è¯¯",description:"è¯»å–å›¾ç‰‡æ–‡ä»¶å¤±è´¥"})},t.readAsDataURL(e)}catch(t){console.error("[v0] Error reading image file:",t),e6({variant:"destructive",title:"é”™è¯¯",description:"è¯»å–å›¾ç‰‡æ–‡ä»¶å¤±è´¥"})}}},t.click()};return(0,$.useEffect)(()=>{tG&&eW.some(t=>"url"===t.type)&&console.log("[v0] Auto-reload images is enabled, images will be reloaded before next test")},[tG,eW]),(0,L.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,L.jsx)(uj,{}),(0,L.jsxs)("nav",{className:"border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:[(0,L.jsxs)("div",{className:"flex h-16 items-center gap-4 px-4 md:px-8",children:[(0,L.jsxs)("div",{className:"flex items-center gap-2",children:[(0,L.jsx)(hE,{className:"size-6 text-primary"}),"idle"!==eh&&(0,L.jsxs)("div",{className:"ml-2 flex items-center gap-1.5",children:[(0,L.jsx)("div",{className:`size-2 rounded-full ${"success"===eh?"bg-green-500":"bg-red-500"}`,title:"success"===eh?"API é…ç½®æ­£å¸¸":"API é…ç½®å¼‚å¸¸"}),"success"===eh&&ec&&(0,L.jsxs)("span",{className:"text-xs text-muted-foreground",children:[ec,"ms"]}),(0,L.jsx)(sX.Button,{variant:"ghost",size:"sm",onClick:id,disabled:em||!l||!p||!ir,className:"h-6 px-2",title:"é‡æ–°æµ‹è¯•",children:em?(0,L.jsx)(sY,{className:"size-3 animate-spin"}):(0,L.jsx)(hI,{className:"size-3"})})]})]}),(0,L.jsxs)("div",{className:"ml-auto flex items-center gap-3",children:[(0,L.jsxs)(ok,{value:i,onValueChange:t=>{s(t);let e=uK.find(e=>e.id===t);if(e)if(e.endpoint)try{let t=new URL(e.endpoint);tx(t.origin),ty(t.pathname)}catch(t){console.error("Invalid endpoint format:",e.endpoint,t),tx(""),ty(e.endpoint)}else tx(""),ty("/v1/chat/completions");"openrouter"===t?ig():"cerebras"===t?im():"modelscope"===t&&(ip(),tx("https://api-inference.modelscope.cn"),ty("/v1/chat/completions"))},children:[(0,L.jsx)(oR,{className:"w-[180px]",children:(0,L.jsx)(o_,{placeholder:"æä¾›å•†",children:uK.find(t=>t.id===i)?.name})}),(0,L.jsx)(oT,{children:uK.map(t=>(0,L.jsx)(oL,{value:t.id,children:(0,L.jsxs)("div",{className:"flex flex-col gap-0.5",children:[(0,L.jsx)("span",{className:"font-medium",children:t.name}),t.endpoint&&(0,L.jsx)("span",{className:"text-xs text-muted-foreground",children:t.endpoint})]})},t.id))})]}),"openrouter"===i||"cerebras"===i||"modelscope"===i?(0,L.jsx)("div",{className:"flex items-center gap-2",children:M?(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(hm,{value:p,onChange:t=>f(t.target.value),placeholder:"è¾“å…¥è‡ªå®šä¹‰æ¨¡åž‹ ID",className:"w-[280px]"}),(0,L.jsx)(sX.Button,{variant:"ghost",size:"sm",onClick:()=>C(!1),title:"è¿”å›žä¸‹æ‹‰é€‰æ‹©",children:(0,L.jsx)(hv,{className:"size-4"})})]}):(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)(o4,{children:[(0,L.jsx)(o6,{asChild:!0,children:(0,L.jsx)(sX.Button,{variant:"outline",role:"combobox",disabled:S,className:"w-[280px] justify-between bg-transparent",children:(0,L.jsx)("span",{className:"truncate",children:iz||(S?"åŠ è½½ä¸­...":"é€‰æ‹©æ¨¡åž‹")})})}),(0,L.jsx)(o9,{className:"w-[280px] p-0",align:"start",children:(0,L.jsxs)(ho,{children:[(0,L.jsx)(ha,{placeholder:"æœç´¢æ¨¡åž‹...",value:_,onValueChange:R}),(0,L.jsxs)(hh,{children:[(0,L.jsx)(hu,{children:"æœªæ‰¾åˆ°æ¨¡åž‹"}),(0,L.jsx)(hc,{children:"openrouter"===i?iL.map(t=>{let e=t.name?.includes("(free)")?`${t.id}:free`:t.id,i=[t.id,t.name].filter(Boolean).join(" ");return(0,L.jsx)(hd,{value:i,onSelect:()=>{f(e)},children:(0,L.jsxs)("div",{className:"flex flex-col gap-0.5",children:[(0,L.jsx)("span",{className:"font-medium",children:t.name||t.id}),t.context_length&&(0,L.jsxs)("span",{className:"text-xs text-muted-foreground",children:[t.context_length," tokens"]})]})},t.id)}):"cerebras"===i?iI.map(t=>{let e=[t.id,t.name].filter(Boolean).join(" ");return(0,L.jsx)(hd,{value:e,onSelect:()=>{f(t.id)},children:(0,L.jsxs)("div",{className:"flex flex-col gap-0.5",children:[(0,L.jsx)("span",{className:"font-medium",children:t.name||t.id}),t.context_length&&(0,L.jsxs)("span",{className:"text-xs text-muted-foreground",children:[t.context_length," tokens"]})]})},t.id)}):iF.map(t=>{let e=[t.id,t.name].filter(Boolean).join(" ");return(0,L.jsx)(hd,{value:e,onSelect:()=>{f(t.id)},children:(0,L.jsxs)("div",{className:"flex flex-col gap-0.5",children:[(0,L.jsx)("span",{className:"font-medium",children:t.name||t.id}),t.context_length&&(0,L.jsxs)("span",{className:"text-xs text-muted-foreground",children:[t.context_length," tokens"]}),t.task_types&&(0,L.jsx)("span",{className:"text-xs text-muted-foreground",children:Array.isArray(t.task_types)?t.task_types.join(", "):t.task_types})]})},t.id)})})]})]})})]}),(0,L.jsx)(sX.Button,{variant:"ghost",size:"sm",onClick:()=>C(!0),title:"è‡ªå®šä¹‰æ¨¡åž‹",children:(0,L.jsx)(hg,{className:"size-4"})})]})}):(0,L.jsx)(hm,{value:p,onChange:t=>f(t.target.value),placeholder:"eg: gpt-3.5-turbo",className:"w-[200px]"}),(0,L.jsxs)("div",{className:"relative flex items-center",children:[(0,L.jsx)(hm,{type:a?"text":"password",value:l,onChange:t=>o(t.target.value),placeholder:"API Key",className:"w-[200px] pr-10"}),(0,L.jsx)(sX.Button,{variant:"ghost",size:"sm",onClick:()=>h(!a),className:"absolute right-0 h-full px-3 hover:bg-transparent",title:a?"éšè— API Key":"æ˜¾ç¤º API Key",children:a?(0,L.jsx)(hw,{className:"size-4"}):(0,L.jsx)(hx,{className:"size-4"})})]}),(0,L.jsxs)(sX.Button,{variant:"outline",size:"sm",onClick:()=>{s(e.provider),tx(e.baseURL),ty(e.apiPath),o(""),f(""),td(""),h(!1),eu("idle"),tS(e.systemPrompt),tM(e.userMessage),tN(e.promptFilePath),tP(e.enablePromptFile),tA(e.systemPromptFilePath),tO(e.enableSystemPromptFile),tV(""),t_(!1),tR.current=null,t$(!1),tW.current=null,uW("promptFileHandle"),uW("systemPromptFileHandle"),E([]),k([]),R(""),eF([]),eA([]),eK([]),eU(""),eJ(!1),eY(!1),tQ(e.autoReloadImages),eO([]),e4(void 0),eZ(100),localStorage.removeItem("llm-api-test-settings"),iy()},children:[(0,L.jsx)(hy,{className:"mr-2 size-4"}),"é‡ç½®"]})]})]}),("custom"===i||!uK.find(t=>t.id===i)?.endpoint)&&(0,L.jsxs)("div",{className:"border-t px-4 py-3 md:px-8",children:[(0,L.jsxs)("div",{className:"flex items-center gap-2",children:[(0,L.jsx)(hD,{htmlFor:"baseURL",className:"text-sm font-medium whitespace-nowrap",children:"Base URL"}),(0,L.jsx)(hm,{id:"baseURL",value:tv,onChange:t=>tx(t.target.value),placeholder:"https://api.example.com",className:"max-w-2xl"})]}),(0,L.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,L.jsx)(hD,{htmlFor:"apiPath",className:"text-sm font-medium whitespace-nowrap",children:"API Path"}),(0,L.jsx)(hm,{id:"apiPath",value:tw,onChange:t=>ty(t.target.value),placeholder:"/v1/chat/completions",className:"max-w-2xl"})]})]})]}),("openrouter"===i||"cerebras"===i||"modelscope"===i)&&is&&(0,L.jsx)("div",{className:"border-b bg-muted/30 px-4 py-3 md:px-8",children:(0,L.jsxs)("div",{className:"max-w-7xl mx-auto space-y-2",children:[is.description&&(0,L.jsx)("div",{className:"space-y-2",children:W?(0,L.jsxs)("p",{className:"text-sm text-muted-foreground leading-relaxed",children:[is.description,(0,L.jsx)("span",{className:"ml-2 text-xs opacity-60",children:"ç¿»è¯‘ä¸­..."})]}):T?(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)("p",{className:"text-sm text-muted-foreground leading-relaxed",children:T}),(0,L.jsxs)("details",{className:"text-xs",children:[(0,L.jsx)("summary",{className:"cursor-pointer text-muted-foreground hover:text-foreground",children:"æŸ¥çœ‹åŽŸæ–‡"}),(0,L.jsx)("p",{className:"mt-2 text-muted-foreground leading-relaxed",children:is.description})]})]}):V?(0,L.jsxs)("div",{className:"space-y-1",children:[(0,L.jsx)("p",{className:"text-sm text-destructive leading-relaxed",children:V}),(0,L.jsxs)("details",{className:"text-xs",children:[(0,L.jsx)("summary",{className:"cursor-pointer text-muted-foreground hover:text-foreground",children:"æŸ¥çœ‹åŽŸæ–‡"}),(0,L.jsx)("p",{className:"mt-2 text-muted-foreground leading-relaxed",children:is.description})]})]}):(0,L.jsx)("p",{className:"text-sm text-muted-foreground leading-relaxed",children:is.description})}),(0,L.jsxs)("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[is.link&&(t=is.name?.includes("(free)")?`${is.link}:free`:is.link,(0,L.jsxs)("a",{href:t,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 hover:text-primary transition-colors",children:[(0,L.jsx)(hT,{className:"size-3"}),"æŸ¥çœ‹æ¨¡åž‹è¯¦æƒ…"]})),is.pub_date&&(0,L.jsx)("span",{className:"flex items-center gap-1",children:(0,L.jsxs)("span",{children:["å‘å¸ƒæ—¥æœŸ: ",is.pub_date]})}),"modelscope"===i&&(0,L.jsxs)(L.Fragment,{children:[is.time&&(0,L.jsx)("span",{className:"flex items-center gap-1",children:(0,L.jsx)("span",{children:is.time})}),is.task_types&&(0,L.jsx)("span",{className:"flex items-center gap-1",children:(0,L.jsx)("span",{children:Array.isArray(is.task_types)?is.task_types.join(", "):is.task_types})}),void 0!==is.downloads&&(0,L.jsxs)("span",{className:"flex items-center gap-1",children:[(0,L.jsx)(hN,{className:"size-3"}),(0,L.jsx)("span",{children:is.downloads.toLocaleString()})]}),void 0!==is.stars&&(0,L.jsxs)("span",{className:"flex items-center gap-1",children:[(0,L.jsx)(hF,{className:"size-3 fill-current"}),(0,L.jsx)("span",{children:is.stars.toLocaleString()})]})]})]})]})}),(0,L.jsxs)("main",{className:"container mx-auto p-4 md:p-8 space-y-6",children:[(0,L.jsxs)(hf.Card,{children:[(0,L.jsx)(hf.CardHeader,{children:(0,L.jsxs)("div",{className:"flex items-center justify-between",children:[(0,L.jsxs)("div",{children:[(0,L.jsx)(hf.CardTitle,{children:"åŽ†å²æ¨¡åž‹"}),(0,L.jsxs)(hf.CardDescription,{children:["å·²æµ‹è¯•çš„æ¨¡åž‹é…ç½®åŽ†å² (å…± ",eN.length," æ¡)"]})]}),(0,L.jsxs)("div",{className:"flex items-center gap-2",children:[(0,L.jsxs)(sX.Button,{variant:"outline",size:"sm",onClick:()=>{eE([]),ek(1);try{localStorage.removeItem("modelHistory")}catch(t){console.error("[v0] Failed to clear model history from localStorage:",t)}e6({title:"åŽ†å²è®°å½•å·²æ¸…ç©º",duration:2e3})},disabled:0===eN.length,children:[(0,L.jsx)(hy,{className:"mr-2 size-4"}),"æ¸…ç©º"]}),(0,L.jsxs)(sX.Button,{variant:"outline",size:"sm",onClick:()=>{if(0===eN.length)return void e6({variant:"destructive",title:"æ— æ•°æ®å¯¼å‡º",description:"åŽ†å²è®°å½•ä¸ºç©º",duration:2e3});let t=new Blob(["\uFEFF"+["æ—¶é—´,æä¾›å•†,æ¨¡åž‹å,API Key,çŠ¶æ€,å“åº”å»¶è¿Ÿ(ms)",...eN.map(t=>[new Date(t.timestamp).toLocaleString("zh-CN"),t.provider,t.model,t.apiKey.substring(0,10)+"...","success"===t.status?"æˆåŠŸ":"error"===t.status?"å¤±è´¥":"æœªæµ‹è¯•",t.duration?t.duration.toString():"N/A"]).map(t=>t.map(t=>`"${t}"`).join(","))].join("\n")],{type:"text/csv;charset=utf-8;"}),e=document.createElement("a");e.href=URL.createObjectURL(t),e.download=`model-history-${Date.now()}.csv`,e.click(),e6({title:"å¯¼å‡ºæˆåŠŸ",description:`å·²å¯¼å‡º ${eN.length} æ¡è®°å½•`,className:"bg-green-50 border-green-200",duration:2e3})},disabled:0===eN.length,children:[(0,L.jsx)(hN,{className:"mr-2 size-4"}),"å¯¼å‡º"]})]})]})}),(0,L.jsx)(hf.CardContent,{children:0===eN.length?(0,L.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"æš‚æ— åŽ†å²è®°å½•"}):(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)("div",{className:"border rounded-lg overflow-hidden",children:(0,L.jsx)("div",{className:"overflow-x-auto",children:(0,L.jsxs)(F,{children:[(0,L.jsx)(z,{children:(0,L.jsxs)(D,{children:[(0,L.jsx)(O,{className:"w-[140px]",children:"æ—¶é—´"}),(0,L.jsx)(O,{className:"w-[120px]",children:"æä¾›å•†"}),(0,L.jsx)(O,{children:"æ¨¡åž‹"}),(0,L.jsx)(O,{className:"w-[150px]",children:"API Key"}),(0,L.jsx)(O,{className:"w-[100px]",children:"çŠ¶æ€"}),(0,L.jsx)(O,{className:"w-[100px]",children:"å»¶è¿Ÿ"}),(0,L.jsx)(O,{className:"w-[160px] text-center",children:"æ“ä½œ"})]})}),(0,L.jsx)(A,{children:iT.map(t=>(0,L.jsxs)(D,{children:[(0,L.jsx)(B,{className:"text-xs",children:new Date(t.timestamp).toLocaleString("zh-CN",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}),(0,L.jsx)(B,{className:"text-xs",children:t.provider}),(0,L.jsx)(B,{className:"text-xs font-mono",children:t.model}),(0,L.jsx)(B,{className:"text-xs",children:(0,L.jsxs)("div",{className:"flex items-center gap-1",children:[(0,L.jsx)("span",{className:"font-mono",children:eT.has(t.id)?t.apiKey:`${t.apiKey.substring(0,10)}...`}),(0,L.jsx)(sX.Button,{variant:"ghost",size:"sm",onClick:()=>{var e;return e=t.id,void eL(t=>{let i=new Set(t);return i.has(e)?i.delete(e):i.add(e),i})},className:"h-6 w-6 p-0",children:eT.has(t.id)?(0,L.jsx)(hw,{className:"size-3"}):(0,L.jsx)(hx,{className:"size-3"})})]})}),(0,L.jsx)(B,{children:(0,L.jsx)("span",{className:`text-xs px-2 py-1 rounded ${"success"===t.status?"bg-green-100 text-green-700":"error"===t.status?"bg-red-100 text-red-700":"bg-gray-100 text-gray-700"}`,children:"success"===t.status?"æˆåŠŸ":"error"===t.status?"å¤±è´¥":"æœªæµ‹è¯•"})}),(0,L.jsx)(B,{className:"text-xs",children:null!==t.duration?`${t.duration}ms`:"-"}),(0,L.jsx)(B,{className:"text-center",children:(0,L.jsxs)("div",{className:"flex items-center justify-center gap-1",children:[(0,L.jsx)(sX.Button,{variant:"outline",size:"sm",onClick:()=>{s(t.provider),f(t.model),o(t.apiKey),tx(t.baseURL),ty(t.apiPath),t_(!1),tR.current=null,t$(!1),tW.current=null,e6({title:"é…ç½®å·²åº”ç”¨",description:`å·²åº”ç”¨ ${t.provider} - ${t.model} çš„é…ç½®`,className:"bg-blue-50 border-blue-200",duration:2e3})},className:"h-7 text-xs",children:"åº”ç”¨"}),(0,L.jsx)(sX.Button,{variant:"outline",size:"sm",onClick:()=>ib(t),className:"h-7 text-xs",children:"æµ‹è¯•"}),(0,L.jsx)(sX.Button,{variant:"ghost",size:"sm",onClick:()=>{var e;return e=t.id,void(eE(t=>t.filter(t=>t.id!==e)),e6({title:"è®°å½•å·²åˆ é™¤",duration:2e3}))},className:"h-7 w-7 p-0",children:(0,L.jsx)(hb,{className:"size-4"})})]})})]},t.id))})]})})}),iR>1&&(0,L.jsxs)("div",{className:"flex items-center justify-between mt-4",children:[(0,L.jsxs)("div",{className:"text-sm text-muted-foreground",children:["ç¬¬ ",eP," / ",iR," é¡µ"]}),(0,L.jsxs)("div",{className:"flex items-center gap-2",children:[(0,L.jsxs)(sX.Button,{variant:"outline",size:"sm",onClick:()=>ek(t=>Math.max(1,t-1)),disabled:1===eP,children:[(0,L.jsx)(hS,{className:"size-4"}),"ä¸Šä¸€é¡µ"]}),(0,L.jsxs)(sX.Button,{variant:"outline",size:"sm",onClick:()=>ek(t=>Math.min(iR,t+1)),disabled:eP===iR,children:["ä¸‹ä¸€é¡µ",(0,L.jsx)(hj,{className:"size-4"})]})]})]})]})})]}),(0,L.jsxs)(hf.Card,{children:[(0,L.jsx)(hf.CardHeader,{children:(0,L.jsx)("div",{className:"flex items-center justify-between",children:(0,L.jsxs)("div",{children:[(0,L.jsx)(hf.CardTitle,{children:"åŠ å¯†è´§å¸Kçº¿å›¾"}),(0,L.jsx)(hf.CardDescription,{children:"ç‚¹å‡»Kçº¿æ—¶é—´ç‚¹å°†æ•°æ®å¡«å…¥æ¶ˆæ¯æ¡†ï¼Œæˆ–é€‰æ‹©æ—¶é—´ç‚¹åŠ è½½åŽ†å²æ•°æ®"})]})})}),(0,L.jsx)(hf.CardContent,{className:"p-6",children:(0,L.jsx)(hp,{data:eD,onCandleClick:ii,isLoading:eB,tradingPair:e0,onTradingPairChange:e1,klineInterval:e2,onIntervalChange:e3,popularPairs:["BTCUSDT","ETHUSDT","BNBUSDT","SOLUSDT","XRPUSDT","ADAUSDT","DOGEUSDT","MATICUSDT","DOTUSDT","AVAXUSDT"],intervals:[{value:"1m",label:"1åˆ†é’Ÿ"},{value:"5m",label:"5åˆ†é’Ÿ"},{value:"15m",label:"15åˆ†é’Ÿ"},{value:"30m",label:"30åˆ†é’Ÿ"},{value:"1h",label:"1å°æ—¶"},{value:"4h",label:"4å°æ—¶"},{value:"1d",label:"1å¤©"},{value:"1w",label:"1å‘¨"}],onTimePointChange:e4,endTime:e5,limit:eQ,onLimitChange:eZ,onForceReload:e8})})]}),(0,L.jsxs)(hf.Card,{children:[(0,L.jsx)(hf.CardHeader,{children:(0,L.jsxs)("div",{className:"flex items-center justify-between",children:[(0,L.jsxs)("div",{className:"flex items-center gap-2",children:[(0,L.jsx)(sX.Button,{variant:"ghost",size:"sm",onClick:()=>eC(!eM),children:eM?(0,L.jsx)(oP,{className:"size-4"}):(0,L.jsx)(oE,{className:"size-4"})}),(0,L.jsxs)("div",{children:[(0,L.jsx)(hf.CardTitle,{children:"å‚æ•°é…ç½®"}),(0,L.jsx)(hf.CardDescription,{children:"è°ƒæ•´ Chat Completion å‚æ•°"})]})]}),(0,L.jsxs)("div",{className:"flex items-center gap-2",children:[(0,L.jsxs)(sX.Button,{variant:"outline",size:"sm",onClick:iy,children:[(0,L.jsx)(hy,{className:"mr-2 size-4"}),"é‡ç½®å‚æ•°"]}),ey?(0,L.jsxs)(sX.Button,{onClick:ix,variant:"destructive",size:"sm",children:[(0,L.jsx)(hC,{className:"mr-2 size-4"}),"åœæ­¢å®šæ—¶"]}):tr?(0,L.jsxs)(sX.Button,{onClick:()=>{console.log("[v0] handleInterruptTest called"),tl.current&&(tl.current.abort(),tn(!1),tl.current=null,e6({title:"æµ‹è¯•å·²ä¸­æ–­",description:"æµ‹è¯•å·²è¢«ç”¨æˆ·ä¸­æ–­",duration:2e3}))},variant:"destructive",size:"sm",children:[(0,L.jsx)(hR.X,{className:"mr-2 size-4"}),"ä¸­æ–­"]}):(0,L.jsxs)(sX.Button,{onClick:iw,disabled:tr,size:"sm",children:[(0,L.jsx)(hM,{className:"mr-2 size-4"}),"å¼€å§‹æµ‹è¯•"]})]})]})}),eM&&(0,L.jsx)(hf.CardContent,{className:"space-y-4",children:(0,L.jsxs)("div",{className:"space-y-4",children:[!tE&&(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)("div",{className:"flex items-center justify-between",children:[(0,L.jsxs)("div",{children:[(0,L.jsx)(hD,{htmlFor:"userMessage",children:"ç”¨æˆ·æ¶ˆæ¯"}),(0,L.jsx)("p",{className:"text-xs text-muted-foreground",children:"è¾“å…¥æµ‹è¯•ç”¨çš„æ¶ˆæ¯å†…å®¹"})]}),(0,L.jsx)(sX.Button,{type:"button",variant:"ghost",size:"sm",onClick:()=>c(!u),children:u?(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(oP,{className:"mr-1 h-4 w-4"}),"æ”¶èµ·"]}):(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(oE,{className:"mr-1 h-4 w-4"}),"å±•å¼€"]})})]}),(0,L.jsx)(hO,{id:"userMessage",value:tj,onChange:t=>tM(t.target.value),placeholder:"è¾“å…¥ä½ çš„æç¤ºè¯...",rows:3,className:u?"":"max-h-32 overflow-y-auto"})]}),(0,L.jsxs)("div",{className:"space-y-2 pt-2",children:[(0,L.jsxs)("div",{className:"flex items-center justify-between",children:[(0,L.jsxs)(hD,{className:"flex items-center gap-1.5",children:[(0,L.jsx)(h_,{className:"h-3.5 w-3.5"}),"å›¾ç‰‡é™„ä»¶"]}),(0,L.jsxs)("div",{className:"flex items-center gap-2",children:[(0,L.jsxs)(sX.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>eJ(!eH),children:[(0,L.jsx)(hT,{className:"mr-1 h-3.5 w-3.5"}),"æ·»åŠ é“¾æŽ¥"]}),(0,L.jsxs)(sX.Button,{type:"button",variant:"outline",size:"sm",onClick:iW,children:[(0,L.jsx)(hk,{className:"h-4 w-4 mr-1"}),"ä¸Šä¼ æ–‡ä»¶"]}),(0,L.jsxs)("div",{className:"flex items-center gap-2 ml-auto",children:[(0,L.jsx)("input",{type:"checkbox",id:"autoReloadImages",checked:tG,onChange:t=>tQ(t.target.checked),className:"h-4 w-4 rounded border-input bg-background accent-primary cursor-pointer"}),(0,L.jsx)(hD,{htmlFor:"autoReloadImages",className:"cursor-pointer font-normal text-sm",children:"è‡ªåŠ¨é‡è½½"})]})]})]}),eH&&(0,L.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,L.jsxs)("div",{className:"flex gap-2",children:[(0,L.jsx)(hm,{placeholder:"è¾“å…¥å›¾ç‰‡é“¾æŽ¥ (https://...)",value:eV,onChange:t=>eU(t.target.value),onKeyDown:t=>{"Enter"===t.key&&i$()},disabled:eq}),(0,L.jsx)(sX.Button,{onClick:i$,size:"sm",disabled:eq,children:eq?(0,L.jsx)(L.Fragment,{children:(0,L.jsx)(sY,{className:"h-4 w-4 animate-spin"})}):"æ·»åŠ "}),(0,L.jsx)(sX.Button,{onClick:()=>{eJ(!1),eU("")},variant:"ghost",size:"sm",disabled:eq,children:"å–æ¶ˆ"})]}),(0,L.jsx)("p",{className:"text-xs text-muted-foreground",children:"ç¤ºä¾‹: https://api.btstu.cn/sjbz/api.php?lx=dongman&format=images"})]}),eW.length>0&&(0,L.jsx)("div",{className:"grid grid-cols-2 gap-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5",children:eW.map(t=>(0,L.jsxs)("div",{className:"relative group rounded-md border overflow-hidden",children:[(0,L.jsx)("img",{src:t.base64||t.url,alt:t.name||"Image",className:"w-full h-24 object-cover cursor-pointer hover:opacity-80 transition-opacity",onClick:()=>eG(t)}),(0,L.jsxs)("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-2",children:[(0,L.jsx)(sX.Button,{type:"button",variant:"secondary",size:"sm",onClick:()=>eG(t),title:"æ”¾å¤§æŸ¥çœ‹",children:(0,L.jsx)(hL,{className:"h-4 w-4"})}),(0,L.jsx)(sX.Button,{type:"button",variant:"destructive",size:"sm",onClick:()=>{var e;return e=t.id,void eK(t=>t.filter(t=>t.id!==e))},title:"åˆ é™¤å›¾ç‰‡",children:(0,L.jsx)(hR.X,{className:"h-4 w-4"})})]})]},t.id))})]}),(0,L.jsxs)("div",{className:"space-y-1.5 pt-2",children:[(0,L.jsxs)("div",{className:"flex items-center justify-between",children:[(0,L.jsxs)(hD,{className:"flex items-center gap-1.5",children:[(0,L.jsx)(hP,{className:"h-3.5 w-3.5"}),"ä»Žå¤–éƒ¨åŠ è½½ç”¨æˆ·æ¶ˆæ¯"]}),(0,L.jsxs)("div",{className:"flex items-center gap-2",children:[(0,L.jsx)("input",{type:"checkbox",id:"enablePromptFile",checked:tE,onChange:t=>tP(t.target.checked),className:"h-4 w-4 rounded border-input bg-background accent-primary cursor-pointer"}),(0,L.jsx)(hD,{htmlFor:"enablePromptFile",className:"cursor-pointer font-normal text-sm",children:"å¯ç”¨"}),(0,L.jsx)("input",{type:"checkbox",id:"autoReloadPrompt",checked:tJ,onChange:t=>tq(t.target.checked),disabled:!tE,className:"h-4 w-4 rounded border-input bg-background accent-primary cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed"}),(0,L.jsx)(hD,{htmlFor:"autoReloadPrompt",className:"cursor-pointer font-normal text-sm",children:"è‡ªåŠ¨é‡è½½"})]})]}),tE&&(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)("div",{className:"flex gap-2",children:[(0,L.jsx)(hm,{id:"promptFilePath",value:tC,onChange:t=>{tN(t.target.value),t_(!1),tR.current=null,tL("")},placeholder:"https://example.com/prompt.txt æˆ–ç‚¹å‡»é€‰æ‹©æœ¬åœ°æ–‡ä»¶",className:"text-sm flex-1"}),(0,L.jsxs)(sX.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>ia("prompt"),className:"shrink-0",children:[(0,L.jsx)(hk,{className:"h-4 w-4 mr-1"}),"é€‰æ‹©æ–‡ä»¶"]})]}),(0,L.jsx)("p",{className:"text-xs text-muted-foreground",children:'æ”¯æŒ HTTP/HTTPS é“¾æŽ¥æˆ–æœ¬åœ°æ–‡ä»¶ã€‚ç‚¹å‡»"é€‰æ‹©æ–‡ä»¶"æŒ‰é’®å¯ç›´æŽ¥é€‰æ‹©æœ¬åœ° .txt æˆ– .md æ–‡ä»¶ã€‚'})]}),tE&&tT&&(0,L.jsxs)("div",{className:"space-y-1.5 pt-2",children:[(0,L.jsxs)("div",{className:"flex items-center justify-between",children:[(0,L.jsxs)(hD,{className:"text-xs text-muted-foreground flex items-center gap-1.5",children:["å¤–éƒ¨åŠ è½½çš„æ¶ˆæ¯é¢„è§ˆ",tk&&(0,L.jsx)("span",{className:"bg-blue-100 text-blue-700 px-1.5 py-0.5 rounded text-[10px]",children:"æœ¬åœ°æ–‡ä»¶"})]}),(0,L.jsxs)("div",{className:"flex items-center gap-1",children:[tk&&tR.current&&(0,L.jsx)(sX.Button,{type:"button",variant:"ghost",size:"sm",onClick:()=>ih("prompt"),title:"é‡æ–°åŠ è½½æ–‡ä»¶",children:(0,L.jsx)(hy,{className:"h-4 w-4"})}),(0,L.jsx)(sX.Button,{type:"button",variant:"ghost",size:"sm",onClick:()=>tF(!tI),children:tI?(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(oP,{className:"mr-1 h-4 w-4"}),"æ”¶èµ·"]}):(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(oE,{className:"mr-1 h-4 w-4"}),"å±•å¼€"]})})]})]}),(0,L.jsx)(hO,{value:tT,readOnly:!0,className:`bg-muted/50 text-sm font-mono cursor-default overflow-y-auto transition-all duration-200 ${tI?"h-60":"h-20"}`})]})]}),(0,L.jsxs)("div",{className:"space-y-4",children:[!tD&&(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)("div",{className:"flex items-center justify-between",children:[(0,L.jsxs)("div",{children:[(0,L.jsx)(hD,{htmlFor:"systemPrompt",children:"ç³»ç»Ÿæç¤ºè¯"}),(0,L.jsx)("p",{className:"text-xs text-muted-foreground",children:"ä¸ºAIè®¾ç½®è§’è‰²æˆ–è¡Œä¸ºæŒ‡ä»¤"})]}),(0,L.jsx)(sX.Button,{type:"button",variant:"ghost",size:"sm",onClick:()=>m(!d),children:d?(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(oP,{className:"mr-1 h-4 w-4"}),"æ”¶èµ·"]}):(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(oE,{className:"mr-1 h-4 w-4"}),"å±•å¼€"]})})]}),(0,L.jsx)(hO,{id:"systemPrompt",value:tb,onChange:t=>tS(t.target.value),placeholder:"ä¾‹å¦‚: ä½ æ˜¯ä¸€ä¸ªä¹äºŽåŠ©äººçš„åŠ©æ‰‹ã€‚",rows:2,className:d?"":"max-h-32 overflow-y-auto"})]}),(0,L.jsxs)("div",{className:"space-y-1.5 pt-2",children:[(0,L.jsxs)("div",{className:"flex items-center justify-between",children:[(0,L.jsxs)(hD,{htmlFor:"systemPromptFilePath",className:"flex items-center gap-1.5",children:[(0,L.jsx)(hP,{className:"h-3.5 w-3.5"}),"ä»Žå¤–éƒ¨åŠ è½½ç³»ç»Ÿæç¤ºè¯"]}),(0,L.jsxs)("div",{className:"flex items-center gap-2",children:[(0,L.jsx)("input",{type:"checkbox",id:"enableSystemPromptFile",checked:tD,onChange:t=>tO(t.target.checked),className:"h-4 w-4 rounded border-input bg-background accent-primary cursor-pointer"}),(0,L.jsx)(hD,{htmlFor:"enableSystemPromptFile",className:"cursor-pointer font-normal text-sm",children:"å¯ç”¨"}),(0,L.jsx)("input",{type:"checkbox",id:"autoReloadSystemPrompt",checked:tY,onChange:t=>tX(t.target.checked),disabled:!tD,className:"h-4 w-4 rounded border-input bg-background accent-primary cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed"}),(0,L.jsx)(hD,{htmlFor:"autoReloadSystemPrompt",className:"cursor-pointer font-normal text-sm",children:"è‡ªåŠ¨é‡è½½"})]})]}),tD&&(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)("div",{className:"flex gap-2",children:[(0,L.jsx)(hm,{id:"systemPromptFilePath",value:tz,onChange:t=>{tA(t.target.value),t$(!1),tW.current=null,tV("")},placeholder:"https://example.com/system-prompt.txt æˆ–ç‚¹å‡»é€‰æ‹©æœ¬åœ°æ–‡ä»¶",className:"text-sm flex-1"}),(0,L.jsxs)(sX.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>ia("systemPrompt"),className:"shrink-0",children:[(0,L.jsx)(hk,{className:"h-4 w-4 mr-1"}),"é€‰æ‹©æ–‡ä»¶"]})]}),(0,L.jsx)("p",{className:"text-xs text-muted-foreground",children:'æ”¯æŒ HTTP/HTTPS é“¾æŽ¥æˆ–æœ¬åœ°æ–‡ä»¶ã€‚ç‚¹å‡»"é€‰æ‹©æ–‡ä»¶"æŒ‰é’®å¯ç›´æŽ¥é€‰æ‹©æœ¬åœ° .txt æˆ– .md æ–‡ä»¶ã€‚'})]}),tD&&tK&&(0,L.jsxs)("div",{className:"space-y-1.5 pt-2",children:[(0,L.jsxs)("div",{className:"flex items-center justify-between",children:[(0,L.jsxs)(hD,{className:"text-xs text-muted-foreground flex items-center gap-1.5",children:["å¤–éƒ¨åŠ è½½çš„ç³»ç»Ÿæç¤ºè¯é¢„è§ˆ",tB&&(0,L.jsx)("span",{className:"bg-blue-100 text-blue-700 px-1.5 py-0.5 rounded text-[10px]",children:"æœ¬åœ°æ–‡ä»¶"})]}),(0,L.jsxs)("div",{className:"flex items-center gap-1",children:[tB&&tW.current&&(0,L.jsx)(sX.Button,{type:"button",variant:"ghost",size:"sm",onClick:()=>ih("systemPrompt"),title:"é‡æ–°åŠ è½½æ–‡ä»¶",children:(0,L.jsx)(hy,{className:"h-4 w-4"})}),(0,L.jsx)(sX.Button,{type:"button",variant:"ghost",size:"sm",onClick:()=>tH(!tU),children:tU?(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(oP,{className:"mr-1 h-4 w-4"}),"æ”¶èµ·"]}):(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(oE,{className:"mr-1 h-4 w-4"}),"å±•å¼€"]})})]})]}),(0,L.jsx)(hO,{value:tK,readOnly:!0,className:`bg-muted/50 text-sm font-mono cursor-default overflow-y-auto transition-all duration-200 ${tU?"h-60":"h-20"}`})]})]})]})]})})]}),(0,L.jsxs)(hf.Card,{children:[(0,L.jsx)(hf.CardHeader,{children:(0,L.jsxs)("div",{className:"flex items-center justify-between",children:[(0,L.jsxs)("div",{children:[(0,L.jsx)(hf.CardTitle,{children:"åŽ†å²å¯¹è¯"}),(0,L.jsxs)(hf.CardDescription,{children:["å…± ",tZ.length," æ¡è®°å½•"]})]}),(0,L.jsxs)("div",{className:"flex items-center gap-2",children:[(0,L.jsxs)("label",{className:"flex items-center gap-2 text-sm cursor-pointer",children:[(0,L.jsx)("input",{type:"checkbox",checked:t8,onChange:t=>et(t.target.checked),className:"size-3 cursor-pointer"}),(0,L.jsx)("span",{children:"æ˜¾ç¤º Raw"})]}),(0,L.jsxs)("label",{className:"flex items-center gap-2 text-sm cursor-pointer",children:[(0,L.jsx)("input",{type:"checkbox",checked:ee,onChange:t=>ei(t.target.checked),className:"size-3 cursor-pointer"}),(0,L.jsx)("span",{children:"æ˜¾ç¤ºè¯·æ±‚å†…å®¹"})]}),(0,L.jsxs)("label",{className:"flex items-center gap-2 text-sm cursor-pointer",children:[(0,L.jsx)("input",{type:"checkbox",checked:eo,onChange:t=>ea(t.target.checked),className:"size-3 cursor-pointer"}),(0,L.jsx)("span",{children:"è§£æžå“åº”markdown"})]}),(0,L.jsxs)(ok,{value:String(t1),onValueChange:t=>t2(Number(t)),children:[(0,L.jsx)(oR,{className:"w-[120px]",children:(0,L.jsx)(o_,{})}),(0,L.jsxs)(oT,{children:[(0,L.jsx)(oL,{value:"3",children:"3 æ¡/é¡µ"}),(0,L.jsx)(oL,{value:"10",children:"10 æ¡/é¡µ"}),(0,L.jsx)(oL,{value:"50",children:"50 æ¡/é¡µ"}),(0,L.jsx)(oL,{value:"100",children:"100 æ¡/é¡µ"})]})]}),(0,L.jsxs)(sX.Button,{variant:"outline",size:"sm",onClick:()=>{t0([]),eR(new Map),uz().catch(t=>{console.error("[v0] Failed to clear IndexedDB:",t)}),t5(1),e6({title:"åŽ†å²è®°å½•å·²æ¸…ç©º",description:"æ‰€æœ‰åŽ†å²æµ‹è¯•æ•°æ®å·²è¢«åˆ é™¤"})},disabled:0===tZ.length,children:[(0,L.jsx)(hy,{className:"mr-2 size-4"}),"æ¸…ç©º"]}),(0,L.jsxs)(sX.Button,{variant:"outline",size:"sm",onClick:()=>{let t;if(0===tZ.length)return;let e=(t=["æ—¶é—´","æ¨¡åž‹","ç”¨æ—¶(ms)"],ee&&t.push("è¯·æ±‚ Content"),t8&&t.push("è¯·æ±‚ Raw"),t.push("å“åº” Content"),t8&&t.push("å“åº” Raw"),e),i=tZ.map(t=>{let e=new Date(t.timestamp).toLocaleString("zh-CN",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}),i=void 0!==t.duration&&null!==t.duration?t.duration:"-",s=t=>null==t?'""':`"${String(t).replace(/"/g,'""')}"`,r=[s(e),s(t.model),s(String(i))];return ee&&r.push(s(t.requestContent)),t8&&r.push(s(t.requestRaw)),r.push(s(t.responseContent)),t8&&r.push(s(t.responseRaw)),r.join(",")}),s=new Blob(["\uFEFF"+[e.join(","),...i].join("\n")],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a"),n=URL.createObjectURL(s);r.setAttribute("href",n),r.setAttribute("download",`llm_api_history_${Date.now()}.csv`),r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r)},disabled:0===tZ.length,children:[(0,L.jsx)(hN,{className:"mr-2 size-4"}),"å¯¼å‡º CSV"]})]})]})}),(0,L.jsx)(hf.CardContent,{children:0===tZ.length?(0,L.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"æš‚æ— åŽ†å²è®°å½•"}):(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)("div",{className:"border rounded-lg overflow-hidden",children:(0,L.jsx)("div",{className:"overflow-x-auto",children:(0,L.jsxs)(F,{children:[(0,L.jsx)(z,{children:(0,L.jsxs)(D,{children:[(0,L.jsx)(O,{className:"w-[160px]",children:"æ—¶é—´/æ¨¡åž‹/ç”¨æ—¶"}),ee&&(0,L.jsx)(O,{children:(0,L.jsxs)("div",{className:"flex items-center gap-2",children:[(0,L.jsx)("span",{children:"è¯·æ±‚ Content"}),(0,L.jsx)("label",{className:"flex items-center gap-1 cursor-pointer",title:"å±•å¼€æ‰€æœ‰è¯·æ±‚å†…å®¹",children:(0,L.jsx)("input",{type:"checkbox",checked:es,onChange:t=>er(t.target.checked),className:"size-3 cursor-pointer"})})]})}),t8&&(0,L.jsx)(O,{className:"w-[100px]",children:"è¯·æ±‚ Raw"}),(0,L.jsx)(O,{children:(0,L.jsxs)("div",{className:"flex items-center gap-2",children:[(0,L.jsx)("span",{children:"å“åº” Content"}),(0,L.jsx)("label",{className:"flex items-center gap-1 cursor-pointer",title:"å±•å¼€æ‰€æœ‰å“åº”å†…å®¹",children:(0,L.jsx)("input",{type:"checkbox",checked:en,onChange:t=>el(t.target.checked),className:"size-3 cursor-pointer"})})]})}),t8&&(0,L.jsx)(O,{className:"w-[100px]",children:"å“åº” Raw"}),(0,L.jsx)(O,{className:"px-4 py-3 text-center font-medium w-[80px]",children:"æ“ä½œ"})]})}),(0,L.jsx)(A,{className:"divide-y",children:iM.map(t=>{let e,i=`request-${t.timestamp}`,s=`response-${t.timestamp}`,r=((t,e,i,s)=>{if(!t||""===t.trim())return[];if(void 0!==s&&i){let t=i.get(s);if(t&&t.length>0)return t}if(t.startsWith("data:image"))return[t];if(t.includes("\n")&&t.split("\n").every(t=>t.startsWith("data:image")))return t.split("\n").filter(Boolean);try{let t=JSON.parse(e),i=[],s=t;return t.body&&"object"==typeof t.body&&(s=t.body),s.images&&Array.isArray(s.images)&&s.images.forEach(t=>{t.url&&(t.url.startsWith("http://")||t.url.startsWith("https://"))&&i.push(t.url)}),s.choices&&Array.isArray(s.choices)&&s.choices.forEach(t=>{t.message&&t.message.images&&Array.isArray(t.message.images)&&t.message.images.forEach(t=>{if(t.image_url&&t.image_url.url){let e=t.image_url.url;(e.startsWith("data:image")||e.startsWith("http://")||e.startsWith("https://"))&&i.push(e)}})}),i}catch(t){return console.error("[v0] Error extracting images from response:",t),[]}})(t.responseContent,t.responseRaw,e_,t.timestamp);return(0,L.jsxs)(D,{className:"hover:bg-muted/50",children:["\\",(0,L.jsx)(B,{className:"px-4 py-3 text-xs text-muted-foreground whitespace-nowrap align-top",children:(0,L.jsxs)("div",{className:"flex flex-col gap-0.5",children:[(0,L.jsx)("span",{children:new Date(t.timestamp).toLocaleString("zh-CN",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}),(0,L.jsx)("span",{className:"font-mono text-[10px] text-foreground truncate",title:t.model,children:t.model}),(0,L.jsx)("span",{className:"font-mono text-[10px]",children:void 0!==t.duration&&null!==t.duration?(0,L.jsxs)(L.Fragment,{children:[t.duration,"ms"]}):(0,L.jsx)("span",{className:"text-muted-foreground/50",children:"-"})})]})}),ee&&(0,L.jsx)(B,{children:(0,L.jsxs)("div",{className:"max-w-xl space-y-2",children:[(e=(t=>{if(!t||""===t.trim())return[];try{let e=JSON.parse(t),i=[];return Array.isArray(e)&&e.forEach(t=>{t.content&&Array.isArray(t.content)?t.content.forEach(t=>{if("image_url"===t.type&&t.image_url?.url){let e=t.image_url.url;(e.startsWith("data:image/")||e.startsWith("http://")||e.startsWith("https://"))&&i.push(e)}}):t.content&&t.content}),i}catch(t){return[]}})(t.requestContent)).length>0?(0,L.jsx)("div",{className:"grid grid-cols-3 gap-1 mb-2",children:e.map((e,i)=>(0,L.jsxs)("div",{className:"relative group rounded border overflow-hidden bg-muted",children:[(0,L.jsx)("img",{src:e||"/placeholder.svg",alt:`Request image ${i+1}`,className:"w-full h-16 object-cover cursor-pointer hover:opacity-80 transition-opacity",onClick:()=>eG({id:`history-${t.timestamp}-${i}`,type:"url",base64:e})}),(0,L.jsx)("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:(0,L.jsx)(sX.Button,{type:"button",variant:"secondary",size:"sm",onClick:()=>eG({id:`history-${t.timestamp}-${i}`,type:"url",base64:e}),title:"æ”¾å¤§æŸ¥çœ‹",children:(0,L.jsx)(hL,{className:"h-3 w-3"})})})]},i))}):null,(0,L.jsx)("pre",{className:`text-xs whitespace-pre-wrap break-words ${!es&&!t4.has(i)?"line-clamp-2":""}`,children:(t=>{try{let e=JSON.parse(t);if(Array.isArray(e)){let t=[];return e.forEach(e=>{if(e.content){if("string"==typeof e.content)t.push(e.content);else if(Array.isArray(e.content)){let i=e.content.filter(t=>"text"===t.type).map(t=>t.text);t=t.concat(i)}}}),t.join("\n")}return t}catch(e){return t}})(t.requestContent)}),!es&&t.requestContent.length>100&&(0,L.jsx)("button",{onClick:()=>iS(i),className:"text-xs text-primary hover:underline flex items-center gap-1",children:t4.has(i)?(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(oP,{className:"h-3 w-3"}),"æ”¶èµ·"]}):(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(oE,{className:"h-3 w-3"}),"å±•å¼€"]})})]})}),t8&&(0,L.jsx)(B,{className:"px-4 py-3 align-top",children:(0,L.jsx)("pre",{className:"text-xs whitespace-pre-wrap break-words max-h-[160px] overflow-y-auto",children:t.requestRaw})}),(0,L.jsx)(B,{className:"px-4 py-3 align-top",children:(0,L.jsxs)("div",{className:"max-w-xl space-y-2",children:[r.length>0&&(0,L.jsx)("div",{className:"grid grid-cols-3 gap-1 mb-2",children:r.map((e,i)=>(0,L.jsxs)("div",{className:"relative group rounded border overflow-hidden bg-muted",children:[(0,L.jsx)("img",{src:e||"/placeholder.svg",alt:`Response image ${i+1}`,className:"w-full h-16 object-cover cursor-pointer hover:opacity-80 transition-opacity",onClick:()=>eG({id:`history-${t.timestamp}-${i}`,type:"url",base64:e})}),(0,L.jsx)("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:(0,L.jsx)(sX.Button,{type:"button",variant:"secondary",size:"sm",onClick:()=>eG({id:`history-${t.timestamp}-${i}`,type:"url",base64:e}),title:"æ”¾å¤§æŸ¥çœ‹",children:(0,L.jsx)(hL,{className:"h-3 w-3"})})})]},i))}),(0,L.jsx)("pre",{className:`text-xs whitespace-pre-wrap break-words ${!en&&!t4.has(s)?"line-clamp-2":""}`,children:((t,e,i,s)=>{let r=t;if(eo&&!t.includes("```"))return(0,L.jsxs)(L.Fragment,{children:[s&&s.length>0&&(0,L.jsx)("div",{className:"flex flex-wrap gap-2 mb-2",children:s.map((t,i)=>(0,L.jsxs)("div",{className:"relative group rounded border overflow-hidden bg-muted",children:[(0,L.jsx)("img",{src:t||"/placeholder.svg",alt:`Generated image ${i+1}`,className:"size-20 object-cover cursor-pointer hover:opacity-80 transition-opacity",onClick:()=>eG({id:`response-${e}-${i}`,type:"url",base64:t}),title:"ç‚¹å‡»æŸ¥çœ‹å¤§å›¾"}),(0,L.jsx)("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:(0,L.jsx)(sX.Button,{type:"button",variant:"secondary",size:"sm",onClick:()=>eG({id:`response-${e}-${i}`,type:"url",base64:t}),title:"æ”¾å¤§æŸ¥çœ‹",children:(0,L.jsx)(hL,{className:"h-3 w-3"})})})]},i))}),(t=>{let e=t.split("\n"),i=[],s=0;for(;s<e.length;){let t=e[s];if(t.startsWith("# ")){i.push((0,L.jsx)("h1",{className:"text-xl font-bold mt-4 mb-2",children:t.slice(2)},s)),s++;continue}if(t.startsWith("## ")){i.push((0,L.jsx)("h2",{className:"text-lg font-bold mt-3 mb-2",children:t.slice(3)},s)),s++;continue}if(t.startsWith("### ")){i.push((0,L.jsx)("h3",{className:"text-base font-bold mt-2 mb-1",children:t.slice(4)},s)),s++;continue}if(t.trim().startsWith("- ")||t.trim().startsWith("* ")){let t=[];for(;s<e.length&&(e[s].trim().startsWith("- ")||e[s].trim().startsWith("* "));){let i=e[s].trim().slice(2);t.push((0,L.jsx)("li",{className:"ml-4",children:i_(i)},s)),s++}i.push((0,L.jsx)("ul",{className:"list-disc my-2",children:t},`ul-${s}`));continue}if(/^\d+\.\s/.test(t.trim())){let t=[];for(;s<e.length&&/^\d+\.\s/.test(e[s].trim());){let i=e[s].trim().replace(/^\d+\.\s/,"");t.push((0,L.jsx)("li",{className:"ml-4",children:i_(i)},s)),s++}i.push((0,L.jsx)("ol",{className:"list-decimal my-2",children:t},`ol-${s}`));continue}if(t.startsWith("> ")){let t=[];for(;s<e.length&&e[s].startsWith("> ");)t.push(e[s].slice(2)),s++;i.push((0,L.jsx)("blockquote",{className:"border-l-4 border-muted pl-4 my-2 italic text-muted-foreground",children:t.join("\n")},`quote-${s}`));continue}if("---"===t.trim()||"***"===t.trim()){i.push((0,L.jsx)("hr",{className:"my-4 border-t border-border"},s)),s++;continue}if(""===t.trim()){i.push((0,L.jsx)("br",{},s)),s++;continue}i.push((0,L.jsx)("p",{className:"my-1",children:i_(t)},s)),s++}return(0,L.jsx)("div",{children:i})})(t)]});try{let e=t.trim();(e.startsWith("{")&&e.endsWith("}")||e.startsWith("[")&&e.endsWith("]"))&&(JSON.parse(e),r="```json\n"+e+"\n```")}catch(t){}let n=r.split(/(```[\s\S]*?```)/g);return(0,L.jsxs)(L.Fragment,{children:[s&&s.length>0&&(0,L.jsx)("div",{className:"flex flex-wrap gap-2 mb-2",children:s.map((t,i)=>(0,L.jsxs)("div",{className:"relative group rounded border overflow-hidden bg-muted",children:[(0,L.jsx)("img",{src:t||"/placeholder.svg",alt:`Generated image ${i+1}`,className:"size-20 object-cover cursor-pointer hover:opacity-80 transition-opacity",onClick:()=>eG({id:`response-${e}-${i}`,type:"url",base64:t}),title:"ç‚¹å‡»æŸ¥çœ‹å¤§å›¾"}),(0,L.jsx)("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:(0,L.jsx)(sX.Button,{type:"button",variant:"secondary",size:"sm",onClick:()=>eG({id:`response-${e}-${i}`,type:"url",base64:t}),title:"æ”¾å¤§æŸ¥çœ‹",children:(0,L.jsx)(hL,{className:"h-3 w-3"})})})]},i))}),n.map((t,e)=>{if(t.startsWith("```")&&t.endsWith("```")){let s=t.split("\n"),r=s[0].replace("```","").trim(),n=s.slice(1,-1),l=n.join("\n"),o=n.length;return(0,L.jsxs)("div",{className:"my-2 rounded-md bg-muted overflow-hidden border relative",children:[r&&(0,L.jsx)("div",{className:"px-3 py-1 text-xs text-muted-foreground bg-muted/50 border-b",children:r}),(0,L.jsx)("pre",{className:`p-3 overflow-x-auto text-xs ${!i&&o>3?"max-h-24 overflow-y-hidden":""}`,children:(0,L.jsx)("code",{className:"block",children:l})}),!i&&o>3&&(0,L.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-8 bg-gradient-to-t from-muted to-transparent pointer-events-none"})]},e)}return(0,L.jsx)("span",{className:`${!i&&t.trim().length>100?"line-clamp-2":""}`,children:t},e)})]})})(t.responseContent,t.timestamp.toString(),en)}),!en&&t.responseContent.length>100&&(0,L.jsx)("button",{onClick:()=>iS(s),className:"text-xs text-primary hover:underline flex items-center gap-1",children:t4.has(s)?(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(oP,{className:"h-3 w-3"}),"æ”¶èµ·"]}):(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(oE,{className:"h-3 w-3"}),"å±•å¼€"]})})]})}),t8&&(0,L.jsx)(B,{className:"px-4 py-3 align-top",children:(0,L.jsx)("pre",{className:"text-xs whitespace-pre-wrap break-words max-h-[160px] overflow-y-auto",children:t.responseRaw})}),(0,L.jsx)(B,{className:"px-4 py-3 text-center align-top",children:(0,L.jsxs)("div",{className:"flex items-center justify-center gap-1",children:[(0,L.jsx)(sX.Button,{variant:"ghost",size:"sm",onClick:()=>ik(t.requestRaw,"request"),className:"h-7 w-7 p-0",title:"å¤åˆ¶è¯·æ±‚ Raw",children:"å·²å¤åˆ¶!"===iC?(0,L.jsx)(oN,{className:"size-3"}):(0,L.jsx)(hz,{className:"size-3"})}),(0,L.jsx)(sX.Button,{variant:"ghost",size:"sm",onClick:()=>ik(t.responseRaw,"response"),className:"h-7 w-7 p-0",title:"å¤åˆ¶å“åº” Raw",children:"å·²å¤åˆ¶!"===iE?(0,L.jsx)(oN,{className:"size-3"}):(0,L.jsx)(hz,{className:"size-3"})}),(0,L.jsx)(sX.Button,{variant:"ghost",size:"sm",onClick:()=>{var e;let i,s;return e=t.id,i=tZ.find(t=>t.id===e),void(t0(s=tZ.filter(t=>t.id!==e)),i&&(uF(i.timestamp).catch(t=>{console.error("[v0] Failed to delete response images:",t)}),eR(t=>{let e=new Map(t);return e.delete(i.timestamp),e})),uP(s).catch(t=>{console.error("[v0] Failed to update history in IndexedDB:",t)}),e6({title:"è®°å½•å·²åˆ é™¤",description:"åŽ†å²è®°å½•é¡¹å·²è¢«åˆ é™¤"}))},className:"h-7 w-7 p-0",children:(0,L.jsx)(hb,{className:"size-4"})})]})})]},t.timestamp)})})]})})}),ij>1&&(0,L.jsxs)("div",{className:"flex items-center justify-between mt-4",children:[(0,L.jsxs)("div",{className:"text-sm text-muted-foreground",children:["ç¬¬ ",t3," / ",ij," é¡µ"]}),(0,L.jsxs)("div",{className:"flex items-center gap-2",children:[(0,L.jsxs)(sX.Button,{variant:"outline",size:"sm",onClick:()=>t5(t=>Math.max(1,t-1)),disabled:1===t3,children:[(0,L.jsx)(hS,{className:"size-4"}),"ä¸Šä¸€é¡µ"]}),(0,L.jsxs)(sX.Button,{variant:"outline",size:"sm",onClick:()=>t5(t=>Math.min(ij,t+1)),disabled:t3===ij,children:["ä¸‹ä¸€é¡µ",(0,L.jsx)(hj,{className:"size-4"})]})]})]})]})})]})]}),eX&&(0,L.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-75 p-4",children:(0,L.jsxs)("div",{className:"relative max-w-full max-h-[80vh] overflow-hidden rounded-lg shadow-xl",children:[(0,L.jsx)("img",{src:eX.base64||eX.url,alt:eX.name||"Zoomed Image",className:"block max-w-full max-h-[80vh] object-contain"}),(0,L.jsx)(sX.Button,{variant:"outline",size:"icon",className:"absolute top-2 right-2 rounded-full bg-background/70 backdrop-blur",onClick:()=>eG(null),"aria-label":"Close",children:(0,L.jsx)(hR.X,{className:"size-6"})})]})})]})}t.s(["default",()=>uU],31713)}]);